jQuery((function(t){"use strict";t.fn.ea_modal=function(o){return this.each((function(){new t.ea_modal(this,t.extend({},t(this).data(),o))}))};const o={title:!1,onSubmit:!1,onReady:!1,submit:"Submit",url:!1};t.ea_modal=function(e,n){const i=this;this.template_id=e,this.modal_id=t(e).attr("id"),this.$template=t(e),this.options=t.extend({},o,n);const a='<div class="ea-modal" tabindex="-1" role="document"><div class="ea-modal__content"><div class="ea-modal__inner"><header class="ea-modal__header"><h1 class="ea-modal__title">'+this.options.title+'&nbsp;</h1><button class="ea-modal__close dashicons">&nbsp;</button></header><div class="ea-modal__body">'+this.$template.html()+'</div><div class="ea-modal__footer"><button type="button" class="button button-secondary ea-modal__close">Cancel</button></div></div></div><div class="ea-modal__backdrop ea-modal__close">&nbsp;</div>';if(this.$modal=t(a),this.$modal.find('form [type="submit"]').remove(),this.$modal.find("form").append('<input type="submit" value="submit" style="display: none;">'),this.$modal.find("form")&&this.options.submit){const o=t('<button type="button" class="button button-primary">').html(this.options.submit);o.on("click",(function(){i.$modal.find('form [type="submit"]').trigger("click")})),this.$modal.find(".ea-modal__footer").append(o)}return this.block=function(){t(".ea-modal__body",i.$modal).block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),t(".ea-modal__footer button",i.$modal).attr("disabled","disabled")},this.unblock=function(){t(".ea-modal__body",i.$modal).unblock(),t(".ea-modal__footer button",i.$modal).removeAttr("disabled")},this.delegate=function(){t(window).bind("resize",i.resize),t(document).bind("keydown",i.keyboard_events)},this.undelegate=function(){t(window).unbind("resize",i.resize),t(document).unbind("keydown",i.keyboard_events)},this.resize=function(){},t(".ea-modal__close",i.$modal).on("click",(function(t){t.preventDefault(),i.close()})),this.keyboard_events=function(t){const o=t.keyCode||t.which;if(13===o&&i.$modal.find("form").length)return t.preventDefault(),i.$modal.find('[type="submit"]').trigger("click"),!1;27===o&&i.close()},this.close=function(){t(document.body).trigger("ea_modal_closed",[i]),t(document).off("focusin"),t(document.body).css({overflow:"auto"}).removeClass("ea-modal-open"),i.undelegate(),t(".ea-modal").remove(),t(document.body).trigger("ea_modal_removed",[i])},this.init=function(){t(document.body).css({overflow:"hidden"}).append(this.$modal).addClass("ea-modal-open"),t(".ea-modal-content",this.$modal).attr("tabindex","0").focus(),t(".ea-modal__content .ea-input-date").datepicker({dateFormat:"yy-mm-dd"}),this.delegate(),this.resize(),t(document.body).trigger("ea_modal_loaded",[i]),"function"==typeof this.options.onReady&&this.options.onReady(this),t("form",i.$modal).on("submit",(function(o){o.preventDefault(),i.block();const e=t("form",i.$modal).serializeObject();if("function"==typeof i.options.onSubmit)return i.options.onSubmit(e,i);t("form #action",i.$modal).length?t.post(ajaxurl,e,(function(o){t.eaccounting_notice(o),o.success&&(i.close(),t(document.body).trigger("ea_modal_form_submitted",[o,i,e]))})).always((function(t){i.unblock()})):t(document.body).trigger("ea_modal_form_submitted",[i,e])}))},this.init(),this}}));
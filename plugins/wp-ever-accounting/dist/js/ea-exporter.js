jQuery((function(t){t.fn.eaccounting_exporter=function(e){return this.each((function(){new t.eaccounting_exporter(this,e)}))},t.eaccounting_exporter=function(e,s){this.defaults={},this.form=e,this.$form=t(e),this.$submit_btn=t('input[type="submit"]',this.$form),this.options=t.extend(this.defaults,s),this.action="eaccounting_do_ajax_export",this.nonce=this.$form.data("nonce"),this.type=this.$form.data("type");const i=this;return this.submit=function(t){if(t.preventDefault(),i.$submit_btn.hasClass("disabled"))return!1;i.$submit_btn.addClass("disabled"),i.reset(),i.$submit_btn.parent("p").append('<span class="spinner is-active"></span>'),i.$form.append('<div class="ea-batch-notice"><div class="ea-batch-progress"><div></div></div></div>'),i.process_step(1)},this.process_step=function(t){window.wp.ajax.send(i.action,{data:{_wpnonce:i.nonce,type:i.type,step:t},success(t){if("done"===t.step)return i.reset(),i.$form.append('<div class="ea-batch-notice"><div class="updated success"><p>'+t.message+"</p></div></div>"),window.location=t.url,!1;i.$form.find(".ea-batch-progress div").animate({width:t.percentage+"%"},50,(function(){})),i.process_step(parseInt(t.step,10))},error(t){i.reset(),t.message&&i.$form.append('<div class="ea-batch-notice"><div class="updated error"><p>'+t.message+"</p></div></div>"),console.warn(t)}})},this.reset=function(){t(".ea-batch-notice",i.$form).remove(),i.$submit_btn.removeClass("disabled"),t(".spinner",i.$form).remove()},this.init=function(){this.$form.on("submit",this.submit)},this.init(),this},t(".ea-exporter").eaccounting_exporter()}));
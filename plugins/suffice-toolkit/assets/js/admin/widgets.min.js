jQuery(function(n){var c;function i(e){e.find(".suffice-toolkit-color-picker").wpColorPicker({change:_.throttle(function(){n(this).trigger("change")},3e3)})}function s(e){var t=e.find(".tg-widget-repeater-field-items"),i=t.find("li.tg-widget-accordion-item"),o=wp.template("tg-widget-repeater-field-blank");i.length?(e.find(".tg-widget-repeater-field-button").show(),i.length<sufficeToolkitLocalizeScript.i18n_max_field_entries&&e.find(".tg-widget-repeater-field-button a").removeClass("disabled")):(e.find(".tg-widget-repeater-field-button").hide(),e.find(".tg-widget-repeater-field-blank-state").remove(),t.append(o))}function o(e){e.find(".tg-widget-repeater-field-items").sortable({items:"> li",handle:"> .accordion-top > .accordion-title",cursor:"move",axis:"y",distance:2,opacity:.65,scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,placeholder:"tg-widget-sortable-placeholder",start:function(e,t){var i=t.item.children(".accordion-inside");"block"===i.css("display")&&(t.item.removeClass("open"),i.hide(),n(this).sortable("refreshPositions"))},stop:function(e,t){t.item.removeAttr("style")}})}n(document.body).on("click",".tg-image-upload",function(e){var t=n(this),i=t.parent().find(".tg-media-input"),o=t.parent().parent().find(".tg-media-preview");e.preventDefault(),(c=wp.media.frames.media_file=wp.media({title:t.data("choose"),button:{text:t.data("update")},states:[new wp.media.controller.Library({title:t.data("choose"),library:wp.media.query({type:"image"})})]})).on("select",function(){var e=c.state().get("selection").first().toJSON();i.val(e.url),o.css({display:"none"}).find("img").remove(),o.css({display:"block"}).append('<img src="'+e.url+'">')}),c.open()}),n(document.body).on("click",".tg-media-remove",function(){var e=n(this).closest(".media-uploader");return e.find(".tg-media-input").val(""),e.find(".tg-media-preview").css({display:"none"}).find("img").remove(),!1}),n(document.body).on("suffice-toolkit-init-media-preview",function(){n("input.tg-media-input").each(function(){var e=n(this).val(),t=n(this).parent().siblings(".tg-media-preview");""!==e&&(t.find("img.tg-media-preview-default").remove(),t.css({display:"block"}).append('<img src="'+e+'">'))})}).trigger("suffice-toolkit-init-media-preview"),n(document).on("widget-added widget-updated",function(e,t){i(t)}),n(document.body).on("suffice-toolkit-color-picker",function(){n("#widgets-right .widget:has(.suffice-toolkit-color-picker)").each(function(){i(n(this))})}).trigger("suffice-toolkit-color-picker"),n(document.body).on("panelsopen",function(){n("input.suffice-toolkit-color-picker").each(function(){n(this).wpColorPicker()})}),n(document.body).on("suffice-toolkit-tabs",function(){n(document.body).on("click",".suffice-tab-title-container .suffice-tab-title",function(e){e.preventDefault(),n(this).addClass("active"),n(this).siblings().removeClass("active");e=n(this).attr("href");n(this).parent().siblings(".suffice-toolkit-tab-content-container").find(".suffice-toolkit-tab").css("display","none"),n(this).parent().siblings(".suffice-toolkit-tab-content-container").find(e).fadeIn()})}).trigger("suffice-toolkit-tabs"),n(document.body).on("suffice-toolkit-init-availability",function(){n("select.icon_chooser").change(function(){"image"===n(this).val()?(n(this).closest("p").next(".show_if_icon").hide(),n(this).closest("p").next().next(".show_if_image").show()):(n(this).closest("p").next(".show_if_icon").show(),n(this).closest("p").next().next(".show_if_image").hide())}).change(),n("select.media_chooser").change(function(){"image"===n(this).val()?(n(this).closest(".widget-content").find(".show_if_image").show(),n(this).closest(".widget-content").find(".show_if_video").closest("p").hide()):(n(this).closest(".widget-content").find(".show_if_image").hide(),n(this).closest(".widget-content").find(".show_if_video").closest("p").show())}).change(),n("select.filter_availability").change(function(){"0"===n(this).val()?n(this).closest(".widget-content").find(".show_if_all_category").closest("p").show():n(this).closest(".widget-content").find(".show_if_all_category").closest("p").hide()}).change(),n("select.availability").change(function(){"post-style-carousel"===n(this).val()?n(this).closest("p").next("p").hide():n(this).closest("p").next("p").show()}).change(),n("select.availability").change(function(){"latest"===n(this).val()?n(this).closest("p").next("p").hide():n(this).closest("p").next("p").show()}).change(),n("select.cta-style").change(function(){"cta-boxed-one"===n(this).val()?n(this).parents("p").siblings().find("input.show_if_not_hexagon").parent("p").hide():n(this).parents("p").siblings().find("input.show_if_not_hexagon").parent("p").show()}).change(),n("input.availability").change(function(){n(this).is(":checked")?n(this).closest("p").next("p").hide():n(this).closest("p").next("p").show()}).change()}).trigger("suffice-toolkit-init-availability"),n(document.body).on("suffice-toolkit-init-accordion-title",function(){n(".tg-widget-repeater-field-items").children("li").each(function(){var e=(e=n('input[id*="-title"]',this).val()||"")&&": "+e.replace(/<[^<>]+>/g,"").replace(/</g,"&lt;").replace(/>/g,"&gt;");n(this).children(".accordion-top").children(".accordion-title").children().children(".in-accordion-title").html(e)})}).trigger("suffice-toolkit-init-accordion-title"),n(document.body).on("click",".tg-widget-repeater-field-add",function(e){var t,i;e.preventDefault(),n(this).is(".disabled")?window.alert(sufficeToolkitLocalizeScript.i18n_max_field_message):(t=n(this).parents(".widget-content"),i=t.find("li.tg-widget-accordion-item").length+1,e=t.find(".tg-widget-repeater-field-items").data("widget_id"),e=wp.template("tg-widget-repeater-field-"+e),t.find("li.tg-widget-accordion-item").each(function(e,t){i===parseInt(n(t).data("id").replace(/[^0-9\.]/g,""),10)&&i++}),t.find(".tg-widget-repeater-field-button").show(),t.find(".tg-widget-repeater-field-blank-state").remove(),t.find(".tg-widget-repeater-field-items").append(e({field_id:i})),i>=sufficeToolkitLocalizeScript.i18n_max_field_entries&&t.find(".tg-widget-repeater-field-button a").addClass("disabled"),n(document.body).trigger("suffice-enhanced-select-init"))}),n(document.body).on("click.accordion-toggle",function(e){var t,i,o=n(e.target);o.parents(".accordion-top").length&&!o.parents("#available-fields").length?((i=(t=o.closest("li.tg-widget-accordion-item")).children(".accordion-inside")).is(":hidden")?(t.addClass("open"),i.slideDown("fast")):i.slideUp("fast",function(){t.attr("style",""),t.removeClass("open")}),e.preventDefault()):o.hasClass("accordion-control-close")?((t=o.closest("li.tg-widget-accordion-item")).children(".accordion-inside").slideUp("fast",function(){t.attr("style",""),t.removeClass("open")}),e.preventDefault()):o.hasClass("accordion-control-remove")&&(t=o.closest("li.tg-widget-accordion-item"),o=o.parents(".widget[id*=themegrill_suffice], .widget-content"),t.remove(),s(o),e.preventDefault())}),n(document.body).on("panelsopen",function(e){e=n(e.target);if(!e.has(".tg-widget-repeater-field-items"))return!1;e.addClass("widget-content"),s(e),o(e),n(document.body).trigger("suffice-enhanced-select-init"),n(document.body).trigger("suffice-toolkit-init-availability"),n(document.body).trigger("suffice-toolkit-init-media-preview"),n(document.body).trigger("suffice-toolkit-init-accordion-title")}),n(document.body).on("click",".so-close",function(){n(document.body).trigger("suffice-toolkit-init-accordion-title")}),n(document.body).on("click","div.widget[id*=themegrill_suffice] .widget-title, div.widget[id*=themegrill_suffice] .widget-title-action",function(){n(this).parents("#available-widgets").length||(s(n(this).parents(".widget[id*=themegrill_suffice]")),o(n(this).parents(".widget[id*=themegrill_suffice]")))}),n(document).on("widget-added widget-updated",function(e,t){t.is("[id*=themegrill_suffice]")&&(e.preventDefault(),s(t),o(t),n(document.body).trigger("suffice-enhanced-select-init"),n(document.body).trigger("suffice-toolkit-init-availability"),n(document.body).trigger("suffice-toolkit-init-media-preview"),n(document.body).trigger("suffice-toolkit-init-accordion-title"))})});
var dominator_ui={};jQuery((function(t){dominator_ui={init:function(e,a){"string"==typeof e&&(e=t(e));var r=this,c=e.find("[wcpt-controller]").addBack(),n=e.find("[wcpt-model-key]").addBack(),o=e.find("[wcpt-value-forward]"),i=e.find("[wcpt-content-template]"),d=e.find("[wcpt-row-template]").parent(),p=e.find("[wcpt-add-row-template]"),l=e.find("[wcpt-duplicate-row]"),s=e.find("[wcpt-move-up]"),w=e.find("[wcpt-move-down]"),f=e.find("[wcpt-remove-row]"),u=e.find("[wcpt-panel-condition]");if(e.attr("wcpt-initial-data")){t.each(a,(function(t,e){null!==e&&"object"==typeof e&&-1==e.constructor.toString().indexOf("Array")&&jQuery.isEmptyObject(e)&&delete a[t]}));var h=t.extend({},r.initial_data[e.attr("wcpt-initial-data")]);t.each(h,(function(t,e){void 0!==a[t]&&delete h[t]})),a=t.extend(!0,{},h,a),e.data(a)}c.add(n).each((function(){var e=t(this),a=e.parent().closest("[wcpt-model-key]"),r=a.data("wcpt-children");r||(r=t()),r=r.add(e),a.data("wcpt-children",r),e.data("wcpt-parent",a)})),o.each((function(){var e=t(this),a=e.attr("wcpt-value-forward"),r=e.closest(a);e.data("wcpt-data-node",r),r.data("wcpt-value-forward",e)})),i.each((function(){var e=t(this),a=e.closest("[wcpt-model-key]");e.data("wcpt-data-node",a);var r=a.data("wcpt-content-templates");r||(r=t()),r=r.add(e),a.data("wcpt-content-templates",r)})),u.each((function(){var e=t(this),a=e.attr("wcpt-panel-ancestor-skip"),r=e.parent().closest("[wcpt-model-key]");for(a||(a=0);a>0;)r=r.parent().closest("[wcpt-model-key]"),--a;e.data("wcpt-parent",r);var c=r.data("wcpt-panel-conditions");c||(c=t()),c=c.add(e),r.data("wcpt-panel-conditions",c)})),d.each((function(){var e=t(this),a=e.attr("wcpt-connect-with");e.hasClass("wcpt-sortable")&&e.sortable({handle:function(){return e.find(".wcpt-sortable-handle").first()},connectWith:a,items:'>[wcpt-model-key="[]"]:not(.wcpt-sortable__disabled)',update:function(t,e){var a=e.item.siblings(".wcpt-button[wcpt-add-row-template]"),r=e.item.siblings().addBack().filter("[wcpt-row-template].wcpt-last-row");a.length&&r.length&&a.index()<r.index()&&a.detach().insertAfter(r)}})})),p.add(l).add(f).add(s).add(w).each((function(){var e=t(this),a=e.closest("[wcpt-model-key]");a.data("wcpt-parent").data("wcpt-data");e.data("wcpt-parent",a)})),f.each((function(){var e=t(this),a=e.data("wcpt-parent"),r=a.attr("wcpt-min-rows")?parseInt(a.attr("wcpt-min-rows")):0,c=a.data("wcpt-parent").data("wcpt-data");r&&void 0!==c&&"[object Array]"==Object.prototype.toString.call(c)&&(c.length>r?e.removeAttr("wcpt-disabled"):e.attr("wcpt-disabled",""))})),e.find("[wcpt-row-template]").each((function(){var e=t(this),a=e.attr("wcpt-row-template");r.row_templates[a]||(r.row_templates[a]=e[0].outerHTML,e.attr("wcpt-disabled",""))})),c.add(n).each((function(){var e=t(this).data("wcpt-children"),a=[];e&&e.length&&e.filter('[type="radio"]').each((function(){var r=t(this).attr("wcpt-model-key");if(-1===t.inArray(r,a)){a.push(r);var c="wcpt-"+r+"-"+Math.random(0,1e9);e.filter('[type="radio"][wcpt-model-key="'+r+'"]').each((function(){t(this).attr("name",c)}))}}))})),c.add(n).off("change keyup").on("change keyup",(function(e){var a=t(this),c=a.attr("wcpt-model-key"),n=a.attr("wcpt-model-key-index"),o=a.data("wcpt-parent");if(p=-1!==t.inArray(a[0].tagName,["SELECT","INPUT","TEXTAREA"])?-1!==t.inArray(a[0].type,["checkbox"])?a[0].checked:a.val():a.data("wcpt-data"),o&&o.length){var i=o.data("wcpt-data");switch(c){case"[]":i||(i=[]),i[n]=p;break;default:if(c.length>2&&"[]"==c.slice(-2)){var d=c.slice(0,-2),p=a.val();if(void 0!==i[d]&&Array.isArray(i[d])||(i[d]=[]),a.prop("checked"))-1===i[d].indexOf(p)&&i[d].push(p);else(n=i[d].indexOf(p))>-1&&i[d].splice(n,1)}else i&&!Array.isArray(i)||(i={}),i[c]=p}o.data("wcpt-data",i)}var l=a.data("wcpt-content-templates");l&&"object"==typeof p&&l.each((function(){var e=t(this),a=e.attr("wcpt-content-template"),c=p.hasOwnProperty(a)?p[a]:"",n=e.attr("wcpt-value-modifier");"function"==typeof r.value_modifiers[n]&&(c=r.value_modifiers[n](c)),e.text(c)}));var s=a.data("wcpt-panel-conditions");if(s){var w=a.data("wcpt-data");s.each((function(){var e=t(this),a=e.attr("wcpt-panel-condition");if(r.panel_conditions[a](e,w)){e.removeAttr("wcpt-disabled");var c=e.attr("wcpt-panel-enable");c&&r.panel_enable[c](e)}else{e.attr("wcpt-disabled","");var n=e.attr("wcpt-panel-disable");n&&r.panel_disable[n](e)}}))}if((o=a.data("wcpt-parent"))&&o.length&&c&&"[]"!==c&&"[]"!==c.slice(-2))i=o.data("wcpt-data"),o.data("wcpt-children");if(a.attr("wcpt-controller")){var f=a.attr("wcpt-controller");void 0!==r.controllers[f]&&r.controllers[f](a,p,e)}})),c.add(n).off("sortupdate").on("sortupdate",(function(e){var a=t(this),c=t(e.target);a.is(c)&&void 0!==a.data("wcpt-children")&&(a.trigger("dom_ui_before_row_sortupdate"),r.reindex_rows(a))})),c.add(n).off("sortreceive").on("sortreceive",(function(e,a){var c=t(this),n=t(e.target);if(c.is(n)&&void 0!==c.data("wcpt-children")){var o=a.item,i=c.data("wcpt-data"),d=o.data("wcpt-data"),p=o.index();c.trigger("dom_ui_before_row_sortreceive"),r.init(o,d),i.splice(p,0,d),r.reindex_rows(c)}})),o.off("change").on("change",(function(){var e=t(this),a=e.val();$data_node=e.data("wcpt-data-node"),$data_node.data("wcpt-data",a)})),p.off("click").on("click",(function(){var e=t(this),a=e.attr("wcpt-add-row-template"),c=e.attr("wcpt-direction"),n=t(r.row_templates[a]),o=e.prev("[wcpt-row-template]"),i=e.data("wcpt-parent");if(i.trigger("dom_ui_before_add_row"),o.length&&o.attr("wcpt-row-template")==a&&o.attr("wcpt-model-key-index"))parseInt(o.attr("wcpt-model-key-index"));c&&"before"!=c?n.insertAfter(e):n.insertBefore(e),r.init(n,{}),r.reindex_rows(i),window.wcpt_feedback_anim("add_new_row",n)})),l.off("click").on("click",(function(){var e=t(this).data("wcpt-parent"),a=e.data("wcpt-data"),c=e.attr("wcpt-row-template"),n=t(r.row_templates[c]);e.trigger("dom_ui_before_duplicate_row"),n.insertAfter(e);var o={};t.extend(!0,o,a),r.init(n,r.refresh_ids(o));var i=e.data("wcpt-parent");r.reindex_rows(i),n.toggleClass("wcpt-toggle-column-expand",e.hasClass("wcpt-toggle-column-expand")),window.wcpt_feedback_anim("duplicate_row",n)})),f.off("click").on("click",(function(){var e=t(this).data("wcpt-parent"),a=e.data("wcpt-parent");window.wcpt_feedback_anim("delete_row",e),e.trigger("dom_ui_before_remove_row"),e.remove(),r.reindex_rows(a)})),s.off("click").on("click",(function(){var e=t(this).data("wcpt-parent"),a=e.prev("[wcpt-row-template]"),c=e.data("wcpt-parent");a.length&&(e.trigger("dom_ui_before_row_move_up"),e.insertBefore(a),r.reindex_rows(c),wcpt_feedback_anim("move_row_up",e))})),w.off("click").on("click",(function(){var e=t(this).data("wcpt-parent"),a=e.next("[wcpt-row-template]"),c=e.data("wcpt-parent");a.length&&(e.trigger("dom_ui_before_row_move_down"),e.insertAfter(a),r.reindex_rows(c),wcpt_feedback_anim("move_row_down",e))})),a&&r.set_data(e,a)},set_data:function(e,a){if(e.data("wcpt-data",a),void 0===e.attr("wcpt-block-editor")){var r=this,c=e.data("wcpt-children");c&&c.each((function(){var e=t(this),c=e.attr("wcpt-model-key");switch(c){case"[]":var n=e.attr("wcpt-row-template"),o=t(r.row_templates[n]);if(e.siblings('[wcpt-row-template="'+n+'"]').remove(),e.replaceWith(o),e=o,void 0===a[0]){e.remove();break}if(r.init(e,a[0]),e.addClass("wcpt-first-row wcpt-last-row"),a.length>1){e.removeClass("wcpt-last-row");for(var i=o,d=1;d<a.length;){var p=t(r.row_templates[n]);p.attr("wcpt-model-key-index",d),i.after(p),i=p,r.init(i,a[d]),++d}i.addClass("wcpt-last-row")}break;default:if(c.length>2&&"[]"==c.slice(-2)){var l=c.slice(0,-2),s=e.val();if(void 0!==a[l]&&Array.isArray(a[l])||(a[l]=[]),e.prop("checked",a[l].indexOf(s)>-1),e.attr("wcpt-controller")){var w=e.attr("wcpt-controller");void 0!==r.controllers[w]&&r.controllers[w](e)}}else void 0!==a[c]&&(-1!==t.inArray(e[0].tagName,["INPUT","SELECT","TEXTAREA"])&&("checkbox"==e[0].type?a[c]?e.prop("checked",!0):e.prop("checked",!1):"radio"==e[0].type?a[c]==e.attr("value")?e.prop("checked",!0):e.prop("checked",!1):e.val(a[c])),r.set_data(e,a[c]))}}));var n=e.data("wcpt-value-forward");n&&n.val(a);var o=e.data("wcpt-content-templates");o&&o.each((function(){var a=t(this),c=a.attr("wcpt-content-template"),n=e.data("wcpt-data")[c],o=a.attr("wcpt-value-modifier");o&&(n=r.value_modifiers[o](n)),n=String(n).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),a.text(n)}));var i=e.data("wcpt-panel-conditions");if(i&&i.each((function(){var e=t(this),c=e.attr("wcpt-panel-condition");r.panel_conditions[c](e,a)?e.removeAttr("wcpt-disabled"):e.attr("wcpt-disabled","")})),e.attr("wcpt-controller")){var d=e.attr("wcpt-controller");void 0!==r.controllers[d]&&r.controllers[d](e,a)}}else e.wcpt_block_editor()},reindex_rows:function(e){var a=e.children('[wcpt-model-key="[]"]'),r=[];a.each((function(e){var a=t(this);r.push(a.data("wcpt-data")),a.attr("wcpt-model-key-index",e)})).removeClass("wcpt-first-row wcpt-last-row").first().addClass("wcpt-first-row").end().last().addClass("wcpt-last-row").end(),e.data("wcpt-data",r).data("wcpt-children",a).change()},controllers:{column_row:function(e,a,r){if("property"==a.type){var c=a.property?a.property:e.data("wcpt-children").filter('[wcpt-model-key="property"]').val(),n="";t.each(a,(function(t,e){t.substring(0,c.length)==c&&(n+=" "+t.substring(c.length+1)+'="'+e+'" ')})),a.content="["+c+n+"]",e.data("wcpt-children").filter("[wcpt-model-key='template']").val(a.content)}else if("custom_field"==a.type){var o=a.custom_field?a.custom_field:"";a.content='[custom_field key="'+o+'"]',e.data("wcpt-children").filter("[wcpt-model-key='template']").val(a.content)}else if("attribute"==a.type){var i=a.attribute?a.attribute:"";a.content='[attribute name="'+i+'"]',e.data("wcpt-children").filter("[wcpt-model-key='template']").val(a.content)}else"buttons"==a.type&&(a.content="",a.buttons instanceof Array&&t.each(a.buttons,(function(e,r){var c="[button ";t.each(r,(function(t,e){c+=t+'="'+e+'" '})),c+="]",a.content+=c})),e.data("wcpt-children").filter("[wcpt-model-key='template']").val(a.content))},header_row:function(t,e,a){t.removeClass("wcpt-editor-columns-enabled-left wcpt-editor-columns-enabled-left-right wcpt-editor-columns-enabled-left-center-right"),t.addClass("wcpt-editor-columns-enabled-"+e.columns_enabled)},filters:function(t,e,a){e&&e.length?t.prev(".wcpt-filter-headings").show():t.prev(".wcpt-filter-headings").hide()}},row_templates:{},refresh_ids:function(e){var a=this;return t.each(e,(function(t,r){"object"==typeof r&&(e[t]=a.refresh_ids(r)),"id"==t&&(e[t]=Math.round(1e9*Math.random()))})),e},value_modifiers:{escape_html:function(t){return!!t&&t.replace(/[\u00A0-\u9999<>\&]/gim,(function(t){return"&#"+t.charCodeAt(0)+";"}))},unlsug_filter_options_source:function(t){return{product_cat:"Categories",product_tag:"Product tags",product_name:"Product names",attribute:"Attribute",price:"Price",rating:"Rating",custom_field:"Custom field",in_stock:"In stock",on_sale:"On sale"}[t]},unlsug_filter_template:function(t){return{dropdown:"Dropdown",checkbox:"Checkbox",radio:"Radio",search:"Search",min_max:"Min-max"}[t]}},initial_data:{column_row:{heading:"",template:"",orderby:"title"},header_row:{columns_enabled:"left-right",columns:{left:{template:""},center:{template:""},right:{template:""}}}},panel_conditions:{prop:function(e,a){var r=e.attr("wcpt-condition-prop"),c=e.attr("wcpt-condition-val"),n=t.extend({},a);return"true"===c?!!n[r]:"false"===c?!n[r]:"!"===c.substr(0,1)?(c=c.substr(1))!=n[r]:void 0!==n[r]&&n[r].constructor===Array?-1!==t.inArray(c,n[r]):(vals_arr=c.split("||"),-1!==t.inArray(n[r],vals_arr))}},panel_enable:{custom_content:function(t){t.find(".CodeMirror").each((function(){this.CodeMirror.refresh()}))}},panel_disable:{}},t(window).trigger("dominator_ui_ready")}));
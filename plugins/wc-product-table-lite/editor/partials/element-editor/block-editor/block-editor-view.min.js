!function(e,t){t.parent,t.render=function(){var t=this.parent.$elm,a=this.parent,i=this,o=this.parent.model.get_data();if(t.empty(),e.each(o,(function(r,c){var s=e('<div class="wcpt-block-editor-row" data-id="'+c.id+'">').data("wcpt-data",c);e.each(c.elements,(function(t,a){var o=e('<div class="wcpt-element-block" data-type="'+a.type+'" data-id="'+a.id+'">'+i.get_label(a)+"</div>");s.append(o.data("wcpt-data",a))}));var n=e('<a href="#" class="wcpt-block-editor-add-element">+ Add Element</a>');if(s.append(n),a.config.edit_row){var l=e("#wcpt-icon-sliders").length?e("#wcpt-icon-sliders").text():"*",p=e('<span class="wcpt-block-editor-edit-row" title="Edit row settings">'+l+"</span>");i.maybe_add_active_settings_class(p,c),s.append(p)}if(a.config.delete_row&&(o.length>1||void 0!==o[0].elements&&o[0].elements.length)){l=e("#wcpt-icon-x").length?e("#wcpt-icon-x").text():"x";var d=e('<span class="wcpt-block-editor-delete-row" title="Delete row">'+l+"</span>");s.append(d)}t.append(s)})),this.parent.config.add_row){var r=e('<a href="#" class="wcpt-block-editor-add-row">+ Add Row</a>');t.append(r)}e(".wcpt-block-editor-row",t).length>1?t.sortable({items:".wcpt-block-editor-row",disabled:!1}):t.sortable({items:".wcpt-block-editor-row",disabled:!0});var c=this.parent.config.connect_with,s=t.closest(".wcpt-block-editor-lightbox-screen");s.length&&(c='[data-partial="'+s.attr("data-partial")+'"].wcpt-block-editor-lightbox-screen '+c),e(".wcpt-block-editor-row",t).sortable({items:".wcpt-element-block",connectWith:c,placeholder:"wcpt-element-block-placeholder",forcePlaceholderSize:!0,start:function(e,t){t.helper.width(t.helper.width()+1).height(""),t.placeholder.width(t.item.outerWidth()).addClass("wcpt-element-block")},sort:function(t,a){var i=e(t.target);if(i.closest(".wcpt-block-editor-lightbox-screen").length&&!/html|body/i.test(i.offsetParent()[0].tagName)){var o=t.pageY-i.offsetParent().offset().top-1.5*a.helper.outerHeight(!0);a.helper.css({top:o+"px"})}}})},t.maybe_add_active_settings_class=function(e,t){if(active_settings=!1,conditions=["custom_field_enabled","attribute_enabled","category_enabled","price_enabled","stock_enabled","product_type_enabled","store_timings_enabled","user_role_enabled"],t.condition&&conditions.forEach((e=>{t.condition[e]&&(active_settings=!0)})),t.style)for(const[e,a]of Object.entries(t.style))for(const[e,t]of Object.entries(a))t&&(active_settings=!0);active_settings?(e.addClass("wcpt-block-editor-edit-row--has-settings"),e.attr("title","The blue indicator shows this row has active style / condition settings")):(e.removeClass("wcpt-block-editor-edit-row--has-settings"),e.attr("title","This row has no active style or condition settings"))},t.lightbox=function(t){e.extend(!0,{$element:null,duplicate_remove:!0,attr:{}},t);var a=e('<div class="wcpt-block-editor-lightbox-screen"><div class="wcpt-block-editor-lightbox-content"></div></div>'),i=e('<div class="wcpt-block-editor-lightbox-tray"></div>'),o=e("#wcpt-icon-check").length?e("#wcpt-icon-check").text():"",r=e('<span class="wcpt-block-editor-lightbox-done" title="Done">'+o+"</span>"),c=e("#wcpt-icon-x").length?e("#wcpt-icon-x").text():"",s=e('<span class="wcpt-block-editor-lightbox-close" title="Close">'+c+"</span>"),n=e("#wcpt-icon-trash").length?e("#wcpt-icon-trash").text():"",l=e('<span class="wcpt-block-editor-lightbox-remove" title="Trash">'+n+"</span>"),p=e("#wcpt-icon-copy").length?e("#wcpt-icon-copy").text():"",d=e('<span class="wcpt-block-editor-lightbox-duplicate" title="Clone">'+p+"</span>");t.duplicate_remove?(i.append(r),i.append(d.add(l))):i.append(s),e("> .wcpt-block-editor-lightbox-content",a).append(i),e("body").append(a),a.data("wcpt-block-element",t.$element?t.$element:"").attr({"wcpt-controller":"edit-element-lightbox","wcpt-model-key":"block_element_data"}).attr(t.attr).children(".wcpt-block-editor-lightbox-content").append(e('script[data-wcpt-partial="'+t.partial+'"]').text()).end().show(),e("body").addClass("wcpt-be-lightbox-on");a.on("click",(function(t){e(t.target).is(a)&&a.trigger("destroy")})),e("> .wcpt-block-editor-lightbox-content > .wcpt-block-editor-lightbox-tray > .wcpt-block-editor-lightbox-close, > .wcpt-block-editor-lightbox-content > .wcpt-block-editor-lightbox-tray > .wcpt-block-editor-lightbox-done",a).on("click",(function(){a.trigger("destroy")})),a.on("destroy",(function(){a.change(),a.remove(),e(".wcpt-block-editor-lightbox-screen").length||e("body").removeClass("wcpt-be-lightbox-on")}));var b=e(".wcpt-block-editor-element-type-list__search__input",a);return b.on("keyup",(function(){var t=e(this),a=t.val().trim(),i=t.closest(".wcpt-block-editor-element-type-list"),o=e(".wcpt-block-editor-element-type",i);a?o.each((function(){var t=e(this);-1==t.text().toLowerCase().trim().indexOf(a)?t.hide():t.show()})):o.show()})),b.first().focus(),a},t.get_label=function(a){var i=a.type.replace(/(_|^)([^_]?)/g,(function(e,t,a){return(t&&" ")+a.toUpperCase()}));switch(a.type){case"attribute":case"attribute_filter":a.attribute_name&&("_custom"==a.attribute_name&&a.custom_attribute_name?i=a.custom_attribute_name+" (custom)":(i=a.attribute_name,"object"==typeof window.wcpt_attributes&&e.each(window.wcpt_attributes,(function(e,t){t.attribute_name==a.attribute_name&&(i=t.attribute_label)}))),i="Attribute: <span>"+t.sanitize(i.charAt(0).toUpperCase()+i.substr(1))+"</span>");break;case"custom_field":case"custom_field_filter":a.field_name&&(i="Custom field: <span>"+t.sanitize(a.field_name)+"</span>");break;case"taxonomy":case"taxonomy_filter":a.taxonomy&&(i="Taxonomy: <span>"+t.sanitize(a.taxonomy)+"</span>");break;case"text":case"text__col":a.text?((i=t.sanitize(a.text)).length>30&&(i=i.substring(0,30)+"..."),i='Text: <span>"'+i+'"<span>'):i="Text";break;case"html":case"html__col":a.html?((i=t.sanitize(a.html)).length>20&&(i=i.substring(0,20)+"..."),i='HTML: <span>"'+i+'"<span>'):i="HTML";break;case"shortcode":if(a.shortcode){var o=a.shortcode;o.length>30&&(o=o.substring(0,30)+"..."),i="Shortcode: <span>"+t.sanitize(o)+"</span>"}break;case"sku":i="SKU";break;case"download_csv":i="Download CSV";break;case"media_image":case"media_image__col":i="Media Image";break;case"line_separator":i="← Line separator →";break;case"space":case"space__col":i="← Space →";break;case"product_id":i="Product ID";break;case"sorting":if(a.orderby){if(i="Sort by: <span>","meta_value_num"==a.orderby||"meta_value"==a.orderby)i+=" CF - "+a.meta_key;else if("id"==a.orderby)i+=" Product ID";else if("sku"==a.orderby)i+=" SKU as text";else if("sku_num"==a.orderby)i+=" SKU as integer";else if(-1!==e.inArray(a.orderby,["attribute","attribute_num"])&&a.orderby_attribute){var r=a.orderby_attribute;e.each(wcpt_attributes,(function(e,t){if("pa_"+t.attribute_name==a.orderby_attribute)return r=t.attribute_label,!1})),i+=" Attribute - "+t.sanitize(r)}else i+=a.orderby[0].toUpperCase()+a.orderby.substring(1);i+="</span>"}break;case"search":if(a.target&&Array.isArray(a.target)&&a.target.length){if(1==a.target.length){"attribute"==(s=a.target[0])&&a.attributes&&a.attributes.length&&(s+=": "+a.attributes.join(", ")),"custom_field"==s&&a.custom_fields&&a.custom_fields.length&&(s+=": "+a.custom_fields.join(", ")),"sku"==s&&(s="SKU")}else{var c=a.target.join(", ");c.length>45&&(c=c.substring(0,45)+"...");var s="mixed "+a.target.length+" ("+c+")"}(s=t.sanitize(s)).length>70&&(s=s.substring(0,70)+"..."),i="Search: <span>"+s+"</span>"}break;case"apply_reset":i="Apply / Reset";break;case"date":case"date_picker_filter":if("date"==a.type?i="Date":"date_picker_filter"==a.type&&(i="Date Picker Filter"),a.date_source)if("publish_date"==a.date_source)i+=": <span>publish date</span>";else if("wordpress_custom_field"==a.date_source){var n="";a.custom_field_name&&(n=" ("+t.truncate(a.custom_field_name,15)+")"),i+=": <span>custom field"+n+"</span>"}else if("acf_custom_field"==a.date_source){n="";a.acf_field_name&&(n=" ("+t.truncate(a.acf_field_name,15)+")"),i+=": <span>acf"+n+"</span>"}break;case"regular_price__on_sale":i="Regular price";break;case"icon":case"icon__col":a.name&&(i='<img class="wcpt-icon-rep" src="'+wcpt_icons+a.name+'.svg">');break;case"dot":case"dot__col":i="⋅";break;case"select_variation":if(i="Select variation",void 0===a.display_type||"radio_single"==a.display_type)if(a.variation_name){var l=t.sanitize(a.variation_name);i="Select variation: <span>"+l+"</span>"}else i="Select variation: <span>*Single variation*</span>";else"radio_multiple"==a.display_type?i="Select variation: <span>*Radio buttons*</span>":"dropdown"==a.display_type&&(i="Select variation: <span>*Dropdown*</span>");break}if(2==a.type.split("__").length&&-1==e.inArray(a.type,["space__col","text__col","html__col","media_image__col","icon__col","dot__col"])){var p=a.type.split("__")[0];i=p.charAt(0).toUpperCase()+p.slice(1).replace("_"," ")}return t.sanitize_preserve_span_and_image(i)},t.mark_elm=function(e,t){var a,i=this.parent.$elm.children(".wcpt-block-editor-row").eq(e);if(i.length){var o=i.children(".wcpt-element-block").eq(t);a=o.length?o:i}a.addClass("wcpt-be-mark"),setTimeout((function(){a.removeClass("wcpt-be-mark")}),1250)},t.sanitize=function(e,t){if(t){var a=(e=e.replace(/<span>/g,"{span_open}").replace(/<\/span>/g,"{span_close}")).match(/<img[^<]+?>/gim),i=[];if(a)for(var o=0;o<a.length;o++)i.push(a[o]),e=e.replace(a[o],"#img-placeholder-"+o+"#")}if(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),t&&(e=e.replace(/{span_open}/g,"<span>").replace(/{span_close}/g,"</span>"),a))for(o=0;o<a.length;o++)e=e.replace("#img-placeholder-"+o+"#",a[o]);return e},t.sanitize_preserve_span_and_image=function(e){return t.sanitize(e,!0)},t.truncate=function(e,t){return t||(t=20),e.length>t&&(e=e.substring(0,t)+"..."),e}}(jQuery,WCPT_Block_Editor.View);
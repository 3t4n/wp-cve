jQuery((function(e){function t(t,r){var l=e(t);this.el={$table:l},this.ev={touchstart:!1},this.options=e.extend(!0,{},this.default_options,"object"==typeof r?r:{}),this.namespace=Math.floor(1e5*Math.random()+1),this.options.height&&!this.options.force_sticky_outer_heading?this.options._sticky_outer_heading=!1:this.options.force_sticky_outer_heading&&(this.options._sticky_outer_heading=!0),l.trigger("before_freeze_table_build",this),this.build(),l.trigger("after_freeze_table_build",this)}e.fn.freezeTable=function(t){return this.each((function(){var r=e(this);if(!r.hasClass("frzTbl-clone-table"))return"destroy"==t?(r.data("freezeTable")&&r.data("freezeTable").destroy(),!0):r.data("freezeTable")?"resize"==t?(r.data("freezeTable").resize(),!0):"cell_resize"==t?(r.data("freezeTable").cell_resize(),!0):void r.data("freezeTable").reload(t):(r.data("freezeTable",new e.FreezeTable(this,t)),!0)}))},e.FreezeTable=t,t.prototype.default_options={left:0,right:0,heading:0,offset:0,wrapperWidth:0,wrapperHeight:0,tableWidth:0,grab_and_scroll:0,grab_and_scroll_click_selectors:!1,captureScroll:!1,force_sticky_outer_heading:!1,_sticky_outer_heading:!0},t.prototype.maybe_disable=function(){var t=this.get_breakpoint_options(),r=this.el.$table,l=r.closest(".frzTbl").length?r.closest(".frzTbl"):r.parent(),i=t.wrapperWidth?t.wrapperWidth:l.width(),a=r[0].style.width,s=r.outerWidth(i).outerWidth();if(r[0].style.width=a,e(window).off("resize.ft"+this.namespace),!t.tableWidth&&s<=i&&!t.left&&!t.right&&!t.heading)return this.unwrap(),e(window).on("resize.ft"+this.namespace,e.proxy(this,"try_enable")),!0},t.prototype.try_enable=function(){var t=e.proxy(this,"build");clearTimeout(this.try_enable_clear),this.try_enable_clear=setTimeout(t,200)},t.prototype.get_overflow_permission=function(){var e=this.el.$table,t=e.parent(),r=this.get_breakpoint_options(),l=!1;return!(!r.left&&!r.right)&&(t.hasClass("frzTbl-table-wrapper__inner")?(t.addClass("frzTbl-table-wrapper__inner--overflow-check"),l=e.outerWidth()>t.width(),t.removeClass("frzTbl-table-wrapper__inner--overflow-check")):l=e.outerWidth()>t.width(),l||r.left||r.right)},t.prototype.build=function(){if(!this.maybe_disable()){var t=this.el.$table,r=e('<div class="frzTbl frzTbl--temp-wrapper">').insertBefore(t),l=e("#frzTbl-tpl").html();t.css({width:"",minWidth:"",height:""}),r[0].innerHTML="<div>"+t[0].outerHTML+"</div>";var i=e(">div>table",r),a=Math.max(i.outerWidth(),r.width()),s=i.outerHeight();a>r.width()&&++a;var o=this.options.wrapperWidth?this.options.wrapperWidth:"",n=this.options.wrapperHeight?this.options.wrapperHeight:s;r.remove(),this.tpl=l.replace(/{{wrapper_height}}/g,"height:"+n+"px; ").replace(/{{wrapper_width}}/g,o?"width:"+o+"px; ":"").replace(/{{table_height}}/g,"height:"+s+"px; ").replace(/{{table_width}}/g,"width:"+a+"px; "),this.build_heading(),this.build_left(),this.build_right(),t.addClass("frzTbl-table"),(this.el.$wrapper=e(this.tpl).insertBefore(t)).find(".frzTbl-table-placeholder").replaceWith(t);var h=e(window);if(this.el.$firstCell=this.el.$table.find(".wcpt-cell:first"),this.el.$scrollOverlay=this.el.$wrapper.children(".frzTbl-scroll-overlay"),this.el.$scrollOverlayInner=this.el.$scrollOverlay.children(".frzTbl-scroll-overlay__inner"),this.el.$contentWrapper=this.el.$wrapper.children(".frzTbl-content-wrapper"),this.el.$frozenColumnsWrapper=this.el.$contentWrapper.children(".frzTbl-frozen-columns-wrapper"),this.el.$frozenColumnsInner=this.el.$frozenColumnsWrapper.children(".frzTbl-frozen-columns-wrapper__inner"),this.el.$frozenColumnsLeft=this.el.$frozenColumnsInner.children(".frzTbl-frozen-columns-wrapper__columns--left"),this.el.$frozenColumnsLeftSticky=this.el.$frozenColumnsLeft.children(".frzTbl-top-sticky"),this.el.$frozenColumnsRight=this.el.$frozenColumnsInner.children(".frzTbl-frozen-columns-wrapper__columns--right"),this.el.$frozenColumnsRightSticky=this.el.$frozenColumnsRight.children(".frzTbl-top-sticky"),this.el.$fixedHeadingWrapperOuter=this.el.$contentWrapper.children(".frzTbl-fixed-heading-wrapper-outer"),this.el.$fixedHeadingWrapper=this.el.$fixedHeadingWrapperOuter.children(".frzTbl-fixed-heading-wrapper"),this.el.$fixedHeadingLeftColumn=this.el.$fixedHeadingWrapperOuter.children(".frzTbl-fixed-heading-wrapper__columns--left"),this.el.$fixedHeadingRightColumn=this.el.$fixedHeadingWrapperOuter.children(".frzTbl-fixed-heading-wrapper__columns--right"),this.el.$fixedHeadingInner=this.el.$fixedHeadingWrapper.children(".frzTbl-fixed-heading-wrapper__inner"),this.el.$tableWrapper=this.el.$contentWrapper.children(".frzTbl-table-wrapper"),this.el.$tableInner=this.el.$tableWrapper.children(".frzTbl-table-wrapper__inner"),this.el.$tableWrapperSticky=this.el.$tableInner.children(".frzTbl-top-sticky"),this.get_overflow_permission()){this.el.$tableInner.removeClass("frzTbl-table-wrapper__inner--deflate"),this.el.$table.css("min-width",r.innerWidth()),this.antiscroll(),e(window).on("scroll",e.proxy(this,"page_scroll")),this.page_scroll({target:document}),this.el.$wrapper.on("wheel",e.proxy(this,"wrapper_wheel")),this.el.$wrapper.on("touchstart touchmove touchend",e.proxy(this,"wrapper_touch")),this.el.$scrollOverlay.on("wheel scroll",e.proxy(this,"scrollOverlay_wheel"));var p=[this.el.$scrollOverlay,this.el.$tableWrapper,this.el.$fixedHeadingWrapper,this.el.$frozenColumnsWrapper];e.each(p,(function(e,t){t[0].scrollTop=0,t[0].scrollLeft=0}))}else this.el.$tableInner.addClass("frzTbl-table-wrapper__inner--deflate"),this.el.$table.css("min-width",""),this.el.$table.css("width","100%");1>Math.abs(this.el.$wrapper.innerWidth()-this.el.$table.outerWidth())&&this.el.$wrapper.addClass("frzTbl--scrolled-to-left-edge frzTbl--scrolled-to-right-edge"),this.sticky_heading(),this.resize_clone_cells(),this.grab_and_scroll(),h.on("resize.ft"+this.namespace,e.proxy(this,"resize")),t[0].addEventListener("load",this.load_image,!0),this.recordEnv()}},t.prototype.load_image=function(t){var r=e(this).data("freezeTable"),l=e.proxy(r,"cell_resize");"IMG"===t.target.tagName&&l(t.target)},t.prototype.grab_and_scroll=function(){var t=this,r=t.el.$wrapper,l=e("body");r.off("mousedown.freeze_table.grab_and_scroll"),l.off("mousemove.freeze_table.grab_and_scroll_"+t.namespace),l.off("mousemove.freeze_table.grab_and_scroll_"+t.namespace),e("img, a",r).off("dragstart.freeze_table.grab_and_scroll_"+t.namespace),r.removeClass("frzTbl--grab-and-scroll frzTbl--grab-and-scroll--grabbing"),this.get_breakpoint_options().grab_and_scroll&&(t.grab_and_scroll__grabbed=!1,t.grab_and_scroll__last_clientX=!1,t.grab_and_scroll__last_pos_x=!1,t.grab_and_scroll__last_clientY=!1,t.grab_and_scroll__last_pos_y=!1,t.grab_and_scroll__$el=!1,r.addClass("frzTbl--grab-and-scroll"),r.on("mousedown.freeze_table.grab_and_scroll",(function(i){3!==i.which&&"SELECT"!=i.target.tagName&&(t.grab_and_scroll__grabbed=!0,t.grab_and_scroll__first_clientX=i.clientX,t.grab_and_scroll__first_clientY=i.clientY,t.grab_and_scroll__last_clientX=i.clientX,t.grab_and_scroll__last_clientY=i.clientY,t.grab_and_scroll__$el=e(i.target).parentsUntil(r),t.grab_and_scroll__$el__ev_handler_attached=!1,r.addClass("frzTbl--grab-and-scroll--grabbing"),t.el.$table.trigger("freeze_table__grab_and_scroll__start"),l.one("mouseup",(function(){t.grab_and_scroll__grabbed=!1,r.removeClass("frzTbl--grab-and-scroll--grabbing"),t.el.$table.trigger("freeze_table__grab_and_scroll__stop"),setTimeout((function(){t.grab_and_scroll__$el.off("click.freeze_table.grab_and_scroll_"+t.namespace)}),1)})))})),l.on("mousemove.freeze_table.grab_and_scroll_"+t.namespace,(function(e){if(t.grab_and_scroll__grabbed){var r=e.clientX-t.grab_and_scroll__last_clientX;t.grab_and_scroll__last_pos_x+=parseFloat(r),t.horizontal_scroll(-r),t.grab_and_scroll__last_clientX=e.clientX;var l=e.clientY-t.grab_and_scroll__last_clientY;t.grab_and_scroll__last_pos_y+=parseFloat(l),t.vertical_scroll(-l),t.grab_and_scroll__last_clientY=e.clientY,(Math.abs(t.grab_and_scroll__last_clientX-t.grab_and_scroll__first_clientX)>2||Math.abs(t.grab_and_scroll__last_clientY-t.grab_and_scroll__first_clientY)>2)&&!t.grab_and_scroll__$el__ev_handler_attached&&(t.grab_and_scroll__$el.one("click.freeze_table.grab_and_scroll_"+t.namespace,(function(e){e.preventDefault(),e.stopPropagation()})),t.grab_and_scroll__$el__ev_handler_attached=!0),t.el.$table.trigger("freeze_table__grab_and_scroll__dragging")}})),e("img, a",r).on("dragstart.freeze_table.grab_and_scroll_"+t.namespace,(function(e){e.preventDefault()})))},t.prototype.build_heading=function(){if(this.get_breakpoint_options().heading){var e=this.clone_table();e.find("tbody").remove(),this.tpl=this.tpl.replace(/{{heading}}/g,e[0].outerHTML)}else this.tpl=this.tpl.replace(/{{heading}}/g,"")},t.prototype.sticky_heading=function(){var t=this.get_breakpoint_options(),r=t.offset?t.offset:0,l=this.el.$table.children("thead")[0].getBoundingClientRect().height,i=parseInt(this.el.$table.css("border-top-width")),a=parseInt(this.el.$table.find("> thead > tr").css("border-bottom-width"));isNaN(r)&&("string"==typeof r?r=e(r).height():"object"==typeof r&&(r=r.height())),i%2&&--i,i*=.5,this.el.$fixedHeadingWrapperOuter.css({height:l+i+a,top:parseFloat(r)+"px"}),t._sticky_outer_heading?this.el.$fixedHeadingWrapperOuter.show():this.el.$fixedHeadingWrapperOuter.hide(),e("> div > table",this.el.$frozenColumnsInner).each((function(){var t=e(this);e("> thead",t).remove(),t.css("margin-top",l+i+"px")})),t.heading||this.el.$fixedHeadingWrapperOuter.css({position:"relative",top:0}),this.el.$wrapper.parents().each((function(){var t=e(this),r=t.css("overflow");t.is("html")||t.is("body")||!r||"visible"===r||t.addClass("frzTbl-force-parent-overlow-visible")}))},t.prototype.build_left=function(){var t=this.get_breakpoint_options();if(!t.left)return this.tpl=this.tpl.replace(/{{left-columns}}/g,""),this.tpl=this.tpl.replace(/{{left-columns-heading}}/g,""),this.tpl=this.tpl.replace(/{{hide-left-columns-heading}}/g,"frzTbl-fixed-heading-wrapper__columns--empty"),void(this.tpl=this.tpl.replace(/{{hide-left-column}}/g,"frzTbl-frozen-columns-wrapper__columns--empty"));var r=this.clone_table();r.find("td, th").each((function(){var r=e(this);r.index()>=t.left&&r.remove()})),this.tpl=this.tpl.replace(/{{left-columns}}/g,r[0].outerHTML||""),$left_heading=r.clone(),$left_heading.find("tbody").remove(),this.tpl=this.tpl.replace(/{{left-columns-heading}}/g,$left_heading[0].outerHTML||""),this.tpl=this.tpl.replace(/{{hide-left-column}}/g,""),e("> thead > tr.wcpt-heading-row.wcpt-hide",this.el.$table).length?this.tpl=this.tpl.replace(/{{hide-top-sticky}}/g," frzTbl-top-sticky--empty "):this.tpl=this.tpl.replace(/{{hide-top-sticky}}/g,"")},t.prototype.build_right=function(){var t=this.get_breakpoint_options();if(!t.right)return this.tpl=this.tpl.replace(/{{right-columns}}/g,""),this.tpl=this.tpl.replace(/{{right-columns-heading}}/g,""),this.tpl=this.tpl.replace(/{{hide-right-columns-heading}}/g,"frzTbl-fixed-heading-wrapper__columns--empty"),void(this.tpl=this.tpl.replace(/{{hide-right-column}}/g,"frzTbl-frozen-columns-wrapper__columns--empty"));var r=this.clone_table();r.find("td, th").each((function(){var r=e(this);r.siblings().length-r.index()>=t.right&&r.remove()})),this.tpl=this.tpl.replace(/{{right-columns}}/g,r[0].outerHTML||""),$right_heading=r.clone(),$right_heading.find("tbody").remove(),this.tpl=this.tpl.replace(/{{right-columns-heading}}/g,$right_heading[0].outerHTML||""),this.tpl=this.tpl.replace(/{{hide-right-column}}/g,""),e("> thead > tr.wcpt-heading-row.wcpt-hide",this.el.$table).length?this.tpl=this.tpl.replace(/{{hide-top-sticky}}/g," frzTbl-top-sticky--empty "):this.tpl=this.tpl.replace(/{{hide-top-sticky}}/g,"")},t.prototype.clone_table=function(){var t=this.el.$table.clone();return t.css({width:"","min-width":""}).addClass("frzTbl-clone-table"),e("> tbody > tr > td, > thead > tr > th",t).each((function(){var t=e(this);t.attr({"data-index":t.index()})})),t},t.prototype.resize_clone_cells=function(){var t=this.el.$table,r=this.get_clone_tables(),l=e("> tbody > tr > td, > thead > tr > th",r),i=[];l.each((function(){var r=e(this),l=r.parent(),a="> "+(l.parent().is("thead")?"thead":"tbody")+" > tr:nth-child("+(l.index()+1)+") > *:nth-child("+(parseInt(r.attr("data-index"))+1)+")",s=e(a,t);i.push({width:s[0].getBoundingClientRect().width,rowOuterHeight:s.parent()[0].getBoundingClientRect().height})})),l.each((function(t){var r=e(this);r.css({width:i[t].width,minWidth:i[t].width}),r.parent().outerHeight(i[t].rowOuterHeight)}));var a=this.el.$table.children("thead")[0].getBoundingClientRect().height,s=parseInt(this.el.$table.css("border-top-width"));s%2&&--s,s*=.5,e("> div > table",this.el.$frozenColumnsInner).each((function(){e(this).css("margin-top",a+s+"px")}))},t.prototype.get_clone_tables=function(){var t=this.el.$table,r=e();return e.each(this.el,(function(l,i){var a=i.children().filter((function(){return e(this).is("table")&&this!==t[0]}));r=r.add(a)})),r},t.prototype.page_scroll=function(e){if(e.target===document){var t=this.el.$fixedHeadingWrapperOuter[0].getBoundingClientRect(),r=this.el.$table[0].getBoundingClientRect();t.top==r.top?this.el.$wrapper.addClass("frzTbl--scrolled-to-top"):this.el.$wrapper.removeClass("frzTbl--scrolled-to-top")}},t.prototype.wrapper_wheel=function(t){if(t.originalEvent.deltaY&&(!t.originalEvent.deltaX||Math.abs(t.originalEvent.deltaY/t.originalEvent.deltaX)>.1)&&!this.get_breakpoint_options().wrapperHeight)return!0;var r=this.el.$wrapper,l="frzTbl--scrolling";r.addClass(l),clearTimeout(this.scroll_clear),this.scroll_clear=setTimeout((function(){r.removeClass(l)}),300),t.preventDefault(),this.options.captureScroll&&this.options.wrapperHeight||(this.el.$scrollOverlay[0].scrollHeight==this.el.$scrollOverlay.height()||t.originalEvent.deltaY>0&&this.el.$scrollOverlay[0].scrollTop+this.el.$scrollOverlay.height()==this.el.$scrollOverlayInner.height()||t.originalEvent.deltaY<0&&!this.el.$scrollOverlay[0].scrollTop)&&(e("html")[0].scrollTop+=t.originalEvent.deltaY,e("body")[0].scrollTop+=t.originalEvent.deltaY)},t.prototype.wrapper_touch=function(e){if("touchstart"==e.type&&this.el.$scrollOverlay.stop(!0),"touchmove"==e.type&&!1!==this.ev.prevClientX){var t=this.ev.prevClientX-e.originalEvent.touches[0].clientX,r={originalEvent:{deltaX:t,deltaY:this.ev.prevClientY-e.originalEvent.touches[0].clientY}};this.scrollOverlay_wheel(r),Math.abs(t)>5?this.ev.animScroll=20*t+this.el.$scrollOverlay[0].scrollLeft:this.ev.animScroll=!1}"touchend"==e.type?(this.ev.animScroll&&(this.el.$scrollOverlay.animate({scrollLeft:this.ev.animScroll},{specialEasing:{scrollLeft:"FreezeTable_easeOutQuad"}}),this.ev.animScroll=!1),this.ev.prevClientX=!1,this.ev.prevClientY=!1):(this.ev.prevClientX=e.originalEvent.touches[0].clientX,this.ev.prevClientY=e.originalEvent.touches[0].clientY)},t.prototype.scrollOverlay_wheel=function(e){var t=e.originalEvent.deltaX||0;e.originalEvent.deltaY;this.horizontal_scroll(t)},t.prototype.horizontal_scroll=function(e,t){var r=this.el.$scrollOverlay,l=this.layout_memory.scrollTop,i=this.layout_memory.scrollLeft,a=this.layout_memory.scrollOverlayWidth,s=this.layout_memory.scrollOverlayInnerWidth;e||(e=0),t||(t=0),0==e&&0==t&&(e=r[0].scrollLeft-this.layout_memory.scrollLeft),l+=t,(i+=e)<0&&(i=0),i+a+1>s&&(i=s-a),this.layout_memory.scrollTop=l,this.layout_memory.scrollLeft=i,r[0].scrollTop=l,r[0].scrollLeft=i,this.el.$tableInner[0].style.transform="translate3d(-"+i+"px, 0, 0)",this.el.$fixedHeadingInner[0].style.transform="translate3d(-"+i+"px, 0, 0)",this.el.$wrapper.removeClass("frzTbl--scrolled-to-left-edge frzTbl--scrolled-to-right-edge"),i||this.el.$wrapper.addClass("frzTbl--scrolled-to-left-edge"),i+a>=s&&this.el.$wrapper.addClass("frzTbl--scrolled-to-right-edge")},t.prototype.vertical_scroll=function(t){e("html")[0].scrollTop+=t,e("body")[0].scrollTop+=t},t.prototype.get_breakpoint_options=function(){var t=this.get_options(),r=this.current_breakpoint();return r?e.extend(!0,{},this.default_options,t.breakpoint[r]):t},t.prototype.get_options=function(){return e.extend(!0,{},this.options)},t.prototype.resize=function(){var t=e.proxy(this,"_resize");clearTimeout(this.resize_clear),this.resize_clear=setTimeout(t,200)},t.prototype._resize=function(){var e=this.el.$wrapper.width();if(this.env.wrapperWidth!==e){if(this.crossed_breakpoint())return void this.reload(this.get_options());this.antiscroll(),this.recordEnv()}},t.prototype.cell_resize=function(){var t=e.proxy(this,"_cell_resize");clearTimeout(this.cell_resize_timeout),this.cell_resize_timeout=setTimeout(t,200)},t.prototype._cell_resize=function(){if(this.el.$table.hasClass("frzTbl-table")&&void 0!==this.el.$scrollOverlay){var t=this.el.$scrollOverlay[0].scrollLeft;if(this.el.$table.css({width:"",minWidth:"",height:""}),this.get_overflow_permission()){this.el.$tableInner.removeClass("frzTbl-table-wrapper__inner--deflate"),this.el.$tableInner.addClass("frzTbl-table-wrapper__inner--unrestrict-table-wrapper");var r=Math.max(this.el.$table.outerWidth(),this.el.$wrapper.innerWidth());table_height=this.el.$table.outerHeight(),r>this.el.$wrapper.width()&&++r,this.el.$tableInner.removeClass("frzTbl-table-wrapper__inner--unrestrict-table-wrapper"),this.el.$table.css("min-width",r);var l=[this.el.$scrollOverlayInner,this.el.$frozenColumnsInner];this.get_breakpoint_options.wrapperHeight||l.push(this.el.$wrapper),e.each(l,(function(e,t){t.css({height:table_height,width:r})})),this.antiscroll(),this.el.$scrollOverlay[0].scrollLeft=t}else this.el.$tableInner.addClass("frzTbl-table-wrapper__inner--deflate"),this.el.$table.css("min-width",""),this.el.$table.css("width","100%");this.resize_clone_cells(),this.recordEnv()}},t.prototype.antiscroll=function(){var e=this.el.$scrollOverlay;this.layout_memory={scrollTop:e[0].scrollTop=0,scrollLeft:e[0].scrollLeft=0,scrollOverlayWidth:e.width(),scrollOverlayInnerWidth:this.el.$scrollOverlayInner.width()},this.el.$table.width()-this.el.$wrapper.width()>5&&this.el.$wrapper.antiscroll(),this.el.$wrapper.children("> .frzTbl-antiscroll-wrap").remove().end().children(".antiscroll-scrollbar-horizontal").wrap('<div class="frzTbl-antiscroll-wrap">')},t.prototype.crossed_breakpoint=function(){return this.current_breakpoint()!==this.env.breakpoint},t.prototype.recordEnv=function(){var t=this;t.env={windowWidth:e(window).width(),windowHeight:e(window).height(),wrapperWidth:this.el.$wrapper.width(),wrapperHeight:this.el.$wrapper.height(),tableWidth:t.el.$table.width(),tableHeight:t.el.$table.height(),firstCellWidth:t.el.$firstCell.width(),firstCellHeight:t.el.$firstCell.height(),breakpoint:t.current_breakpoint()}},t.prototype.current_breakpoint=function(){var t=this.get_options(),r=!1,l=e(window).width();return!!t.breakpoint&&(e.each(t.breakpoint,(function(e,t){if((e=parseInt(e))<l)return!0;(!r||e<r)&&(r=e)})),r)},t.prototype.destroy=function(){this.clear_handlers(),this.unwrap(),this.el.$table.removeData("freezeTable")},t.prototype.clear_handlers=function(){e(window).off("resize.ft"+this.namespace)},t.prototype.unwrap=function(){var e=this.el.$table,t=this.el.$wrapper;e.removeClass("frzTbl-table").css({width:"","min-width":""}),t&&t.length&&(e.insertBefore(t),t.remove())},t.prototype.reload=function(t){var r=this.el.$table;this.destroy(),r.data("freezeTable",new e.FreezeTable(r[0],t))},e.extend(e.easing,{FreezeTable_easeOutQuad:function(e,t,r,l,i){return-l*(t/=i)*(t-2)+r}})}));
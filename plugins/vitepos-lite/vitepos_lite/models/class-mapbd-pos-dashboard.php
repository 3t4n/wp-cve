<?php
/**
 * Pos Warehouse Database Model
 *
 * @package VitePos_Lite\Models\Database
 */

namespace VitePos_Lite\Models;

use VitePos_Lite\Core\ViteposModelLite;
use VitePos_Lite\Models\Database\Mapbd_Pos_Warehouse;

/**
 * Class Mapbd_Pos_Cash_Drawer
 *
 * @package VitePos_Lite\Models
 */
class Mapbd_POS_Dashboard extends ViteposModelLite {
	/**
	 * The get order statistics is generated by appsbd
	 *
	 * @return \stdClass
	 */
	public static function get_order_statistics() {
		$db     = self::get_db_object();
		$prefix = $db->prefix;
		$query = vitepos_get_dashboard_query( $prefix );
		$response               = new \stdClass();
		$response->total_order  = 0;
		$response->total_amount = 0.0;
		$response->outlets      = $db->get_results( $query );

		$outlets                 = Mapbd_Pos_Warehouse::fetch_all_key_value( 'id', 'name' );
		$response->total_outlets = count( $outlets );
		foreach ( $response->outlets as &$item ) {
			$response->total_order   += $item->total_order;
			$response->total_amount  += $item->total_amount;
			$item->total_amount      = vitepos_number_format( $item->total_amount );
			$item->total_amount_text = wc_price( $item->total_amount );
			$item->outlet_name       = appsbd_get_text_by_key( $item->outlet_id, $outlets );

		}
		$response->total_amount_text = wc_price( $response->total_amount );

		return $response;
	}

	/**
	 * The get order statistics hpos is generated by appsbd
	 */
	public static function get_order_statistics_hpos() {
		$db     = self::get_db_object();
	}
}

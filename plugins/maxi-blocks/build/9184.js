(self.webpackChunkmaxi_blocks=self.webpackChunkmaxi_blocks||[]).push([[9184],{14438:function(e,t,a){"use strict";a.r(t);var n=a(15861),o=a(70885),l=a(69307),r=(a(99196),a(11284)),c=a.n(r),i=a(65736),s=a(9818),u=a(19848),m=a(41372),d=a(34261),_=a(58026),p=a(94184),b=a.n(p),x=a(18871),v=a(92819),g=function(e){var t=e.label,a=e.onClick,n=e.icon,o=e.className,r=e.isSelected,c=b()("maxi-cloud-toolbar__button",o);return(0,l.createElement)("button",{className:c,onClick:a,"aria-pressed":r,type:"button"},n,(0,l.createElement)("span",null,t))};t.default=function(e){var t=e.type,a=e.onChange,r=e.onRequestClose,p=e.title,b=void 0===p?"":p,f=e.cost,h=void 0===f?"":f,k=e.toneUrl,y=e.isMaxiProActive,E=e.isMaxiProExpired,w=e.isPro,C=e.isBeta,N=e.gutenbergCode,B=e.onInsert,S=e.isSwapChecked,T=e.onChangeTone,L=e.userName,I=e.onLogOut,Z=e.onClickConnect,j=e.showNotValidEmail,F=(0,l.useState)(!1),R=(0,o.Z)(F,2),O=R[0],P=R[1],q=(0,l.useState)(0),U=(0,o.Z)(q,2),M=U[0],z=U[1],D=new x.SearchClient({nodes:[{host:"24q17endjv0kacilp.a1.typesense.net",port:"443",protocol:"https"}],apiKey:"0DpJlIVm3kKOiQ9kAPTklrXrIbFLgWk6",connectionTimeoutSeconds:2});function V(e,t){for(var a=0;a<e.length;a+=1){var n=e[a];n.classList?n.classList.add(t):n.className+=" ".concat(t)}}function A(e,t){for(var a=0;a<e.length;a+=1){var n=e[a];n.classList?n.classList.remove(t):n.className=n.className.replace(new RegExp("(^|\\b)".concat(t.split(" ").join("|"),"(\\b|$)"),"gi")," ")}}document.addEventListener("fullscreenchange",(function(e){document.fullscreenElement?(V(document.getElementsByClassName("maxi-cloud-toolbar"),"maxi-cloud-toolbar__fullwidth"),V(document.getElementsByClassName("maxi-cloud-toolbar__button-fullwidth"),"maxi-cloud-toolbar__button_active")):(A(document.getElementsByClassName("maxi-cloud-toolbar"),"maxi-cloud-toolbar__fullwidth"),A(document.getElementsByClassName("maxi-cloud-toolbar__button-fullwidth"),"maxi-cloud-toolbar__button_active"))}));var K=(0,(0,s.select)("core/block-editor").getSelectedBlockClientId)(),Y=function(e){var t=document.getElementsByClassName("maxi-library-modal__preview")[0];if(t){var a=null==t?void 0:t.getElementsByClassName("maxi-cloud-container__preview-iframe_wrap")[0],n=null==t?void 0:t.getElementsByClassName("maxi-cloud-container")[0],o=null==t?void 0:t.getElementsByClassName("maxi-cloud-container__preview-iframe_main-wrap")[0],l=null==t?void 0:t.getElementsByClassName("maxi-cloud-container__preview-iframe_space")[0],r=null==t?void 0:t.getElementsByClassName("components-modal__content")[0];if(a){var c="100%",i="100%",s=null==t?void 0:t.getElementsByClassName("maxi-cloud-container__preview-tablet__label")[0],u=null==t?void 0:t.getElementsByClassName("maxi-cloud-container__preview-mobile__label")[0];switch(e){case"t":c="768px",i="1024px",a.style.outline="#96b0cb  30px solid",a.style["border-radius"]="15px",s.style.display="block",u.style.display="none",l.style.height="20px",n.style.overflowY="scroll",a.style.margin="50px auto 35px auto",d(document.getElementsByClassName("maxi-cloud-toolbar__button-desktop"),"maxi-cloud-toolbar__button_active"),m(document.getElementsByClassName("maxi-cloud-toolbar__button-tablet"),"maxi-cloud-toolbar__button_active"),d(document.getElementsByClassName("maxi-cloud-toolbar__button-mobile"),"maxi-cloud-toolbar__button_active");break;case"m":c="390px",i="844px",a.style.outline="#96b0cb  30px solid",a.style["border-radius"]="15px",s.style.display="none",u.style.display="block",l.style.height="20px",a.style.margin="50px auto 35px auto",n.style.overflowY="scroll",d(document.getElementsByClassName("maxi-cloud-toolbar__button-desktop"),"maxi-cloud-toolbar__button_active"),d(document.getElementsByClassName("maxi-cloud-toolbar__button-tablet"),"maxi-cloud-toolbar__button_active"),m(document.getElementsByClassName("maxi-cloud-toolbar__button-mobile"),"maxi-cloud-toolbar__button_active");break;default:a.style.outline="none",a.style["border-radius"]=0,s.style.display="none",u.style.display="none",l.style.height="0px",r.style.overflowY="hidden",a.style.margin="0 auto 35px auto",n.style.overflowY="hidden",m(document.getElementsByClassName("maxi-cloud-toolbar__button-desktop"),"maxi-cloud-toolbar__button_active"),d(document.getElementsByClassName("maxi-cloud-toolbar__button-tablet"),"maxi-cloud-toolbar__button_active"),d(document.getElementsByClassName("maxi-cloud-toolbar__button-mobile"),"maxi-cloud-toolbar__button_active")}a.style.width=c,a.style.height=i,o.style.left=0,o.style.right=0}}function m(e,t){for(var a=0;a<e.length;a+=1){var n=e[a];n.classList?n.classList.add(t):n.className+=" ".concat(t)}}function d(e,t){for(var a=0;a<e.length;a+=1){var n=e[a];n.classList?n.classList.remove(t):n.className=n.className.replace(new RegExp("(^|\\b)".concat(t.split(" ").join("|"),"(\\b|$)"),"gi")," ")}}},H=function(){var e,t=encodeURIComponent(O),a="https://my.maxiblocks.com/login?plugin&email=".concat(t);null===(e=window.open(a,"_blank"))||void 0===e||e.focus(),Z(O)};return(0,l.createElement)("div",{className:"maxi-cloud-toolbar"},"preview"!==t&&"switch-tone"!==t&&(0,l.createElement)("a",{className:"maxi-cloud-toolbar__logo"},u.vIZ,"svg"===t&&(0,i.__)("Icon library","maxi-blocks"),"patterns"===t&&(0,i.__)("Template library","maxi-blocks"),"sc"===t&&(0,i.__)("Style cards","maxi-blocks"),t.includes("shape")&&(0,i.__)("Shape library","maxi-blocks"),t.includes("button")&&(0,i.__)("Button icon library","maxi-blocks"),t.includes("video")&&(0,i.__)("Video icon library","maxi-blocks")),("preview"===t||"switch-tone"===t)&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)("div",{className:"maxi-cloud-toolbar__buttons-group"},(0,l.createElement)(g,{label:(0,i.__)("Back","maxi-blocks"),onClick:r}),(0,l.createElement)("h2",null,b),(0,l.createElement)("span",{className:"maxi-cloud-toolbar__line"},"|"),(0,l.createElement)("span",null,h),!(0,v.isUndefined)(k)&&!(0,v.isNil)(k)&&(0,l.createElement)(g,{onClick:function(){!function(){var e=k.toLowerCase();if(k.includes("/")){var t=k.replace(/:$/,"").split("/");e=t.pop()||t.pop()}var a={q:e,query_by:"post_number",per_page:1},n=!1;document.fullscreenElement&&(n=!0),D.collections("post").documents().search(a).then((function(e){var t,a=null==e||null===(t=e.hits[0])||void 0===t?void 0:t.document;window.setTimeout((function(){if(n){var e=document.getElementsByClassName("maxi-library-modal maxi-preview")[0];(null==e?void 0:e.getElementsByClassName("components-modal__content")[0]).requestFullscreen().catch((function(e){console.warn("Error attempting to enable fullscreen mode: ".concat(e.message," (").concat(e.name,")"))}))}}),100),T(a)}))}()},label:(0,i.__)("Switch tone","maxi-blocks")})),(0,l.createElement)("div",{className:"maxi-cloud-toolbar__responsive-buttons"},(0,l.createElement)(g,{className:"maxi-cloud-toolbar__button-fullwidth",onClick:function(){var e=document.getElementsByClassName("maxi-library-modal maxi-library-modal__preview")[0],t=null==e?void 0:e.getElementsByClassName("components-modal__content")[0];document.fullscreenElement?document.exitFullscreen():t.requestFullscreen().catch((function(e){console.warn("Error attempting to enable fullscreen mode: ".concat(e.message," (").concat(e.name,")"))}))},icon:u.dKu,label:(0,i.__)("Full screen","maxi-blocks")}),(0,l.createElement)(g,{className:"maxi-cloud-toolbar__button-desktop maxi-cloud-toolbar__button_active",onClick:function(){Y("d")},icon:u.dT7,label:(0,i.__)("Desktop","maxi-blocks")}),(0,l.createElement)(g,{className:"maxi-cloud-toolbar__button-tablet",onClick:function(){Y("t")},icon:u.ly8,label:(0,i.__)("Tablet","maxi-blocks")}),(0,l.createElement)(g,{className:"maxi-cloud-toolbar__button-mobile",onClick:function(){Y("m")},icon:u.wwI,label:(0,i.__)("Mobile","maxi-blocks")}))),"all"===t&&(0,l.createElement)("div",null,[{label:"Style Cards",value:"styleCards"},{label:"Pages",value:"pages"},{label:"Block Patterns",value:"patterns"},{label:"Global",value:"global"},{label:"Blocks",value:"blocks"},{label:"Preview",value:"preview"}].map((function(e){return(0,l.createElement)(g,{key:"maxi-cloud-toolbar__button__".concat(e.value),label:e.label,onClick:function(){return a(e.value)},isSelected:t===e.value})}))),"patterns"===t&&y&&L&&(0,l.createElement)("div",{className:"maxi-cloud-toolbar__sign-in"},(0,l.createElement)("h5",{className:"maxi-cloud-container__patterns__top-menu__text_pro"},(0,i.__)("Signed in: ","maxi-blocks"),(0,l.createElement)("span",{className:"maxi-username",title:M%2!=0?(0,i.__)("Click to hide","maxi-blocks"):(0,i.__)("Click to show","maxi-blocks"),onClick:function(e){z((function(e){return e+1}))}},(0,_.vV)(L)?M%2!=0?L:"******@***.***":L)),(0,l.createElement)(d.zx,{key:"maxi-cloud-toolbar__button__sing-out",className:"maxi-cloud-container__patterns__top-menu__button-go-pro",label:(0,i.__)("Sign out","maxi-blocks"),onClick:function(){I(!0),I()}},(0,i.__)("Sign out","maxi-blocks"))),!y&&L&&E&&(0,l.createElement)("div",{className:"maxi-cloud-toolbar__sign-in"},(0,l.createElement)("h5",{className:"maxi-cloud-container__patterns__top-menu__text_pro"},(0,i.__)("Expired: ","maxi-blocks"),(0,l.createElement)("span",{className:"maxi-username"},L)),(0,l.createElement)(d.zx,{key:"maxi-cloud-toolbar__button__connect",className:"maxi-cloud-container__patterns__top-menu__button-connect-pro",label:(0,i.__)("Sign in","maxi-blocks"),onClick:function(){return H()}},(0,i.__)("Sign in","maxi-blocks"))),!y&&L&&!E&&(0,l.createElement)("div",{className:"maxi-cloud-toolbar__sign-in"},(0,l.createElement)("h5",{className:"maxi-cloud-container__patterns__top-menu__text_pro"},(0,l.createElement)("span",{className:"maxi-username"},L)),(0,l.createElement)(d.zx,{key:"maxi-cloud-toolbar__button__sing-out",className:"maxi-cloud-container__patterns__top-menu__button-go-pro",label:(0,i.__)("Sign out","maxi-blocks"),onClick:I},(0,i.__)("Sign out","maxi-blocks"))),"patterns"===t&&!y&&!L&&(0,l.createElement)("div",{className:"maxi-cloud-toolbar__sign-in"},(0,l.createElement)("div",{className:"maxi-cloud-container__patterns__top-menu__input"},(0,l.createElement)(d.w4,{placeholder:(0,i.__)("Pro user email","maxi-blocks"),value:O,onChange:function(e){return P(e)}}),j&&(0,l.createElement)("span",null,(0,i.__)("The email is not valid","maxi-blocks"))),(0,l.createElement)(d.zx,{key:"maxi-cloud-toolbar__button__connect",className:"maxi-cloud-container__patterns__top-menu__button-connect-pro",label:(0,i.__)("Sign in","maxi-blocks"),onClick:function(){return H()}},(0,i.__)("Sign in","maxi-blocks"))),"preview"!==t&&"switch-tone"!==t&&(0,l.createElement)("a",{href:"https://maxiblocks.com/go/help-center",target:"_blank",rel:"noopener noreferrer",className:"maxi-cloud-toolbar__help-button"},u.R_2,(0,i.__)("Help","maxi-blocks")),("preview"===t||"switch-tone"===t)&&(0,l.createElement)("div",{className:"maxi-cloud-toolbar__buttons-group_close"},(!w||C||y&&L)&&(0,l.createElement)(g,{label:(0,i.__)("Insert","maxi-blocks"),onClick:(0,n.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B(),e.next=3,(0,m.Z)(N,S,K);case 3:case"end":return e.stop()}}),e)})))}),(0,l.createElement)(g,{onClick:r,icon:u.UFW})))}},41372:function(e,t,a){"use strict";a.d(t,{Z:function(){return f}});var n=a(70885),o=a(4942),l=a(15861),r=a(11284),c=a.n(r),i=a(65736),s=a(4981),u=a(9818),m=a(58141),d=a(92819),_=function(){var e=(0,l.Z)(c().mark((function e(){var t,a,o,l,r,s,_,p,b,x,v,g;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=(0,u.resolveSelect)("core"),l=o.getEntityRecords,e.next=4,l("postType","attachment",{post_status:"inherit",posts_per_page:1,search:"maxi-pattern-placeholder"});case 4:if(r=e.sent,(0,d.isEmpty)(r)){e.next=7;break}return e.abrupt("return",{id:r[0].id,url:r[0].media_details.sizes.full.source_url});case 7:return e.next=9,(0,u.resolveSelect)("maxiBlocks").receiveMaxiSettings();case 9:return s=e.sent,_=s.placeholder_url,e.next=13,fetch(_).then((function(e){return e.blob()})).catch((function(e){return console.warn((0,i.__)("The Cloud server is down, using the placeholder image. Error: ".concat(e),"maxi-blocks")),!1}));case 13:return p=e.sent,b=!1,e.next=17,l("taxonomy","maxi-image-type");case 17:return x=e.sent,v=x[0].id,e.next=21,(0,m.uploadMedia)({filesList:[new File([p],"maxi-pattern-placeholder.jpg",{type:"image/jpeg"})],onFileChange:function(e){var t=(0,n.Z)(e,1);b=t[0]},onError:function(e){return console.warn((0,i.__)("Can't upload the placeholder image, check directory's permissions. Error: ".concat(e),"maxi-blocks"))}});case 21:return g=""===(null===(t=b)||void 0===t?void 0:t.comment_status)?"closed":null===(a=b)||void 0===a?void 0:a.comment_status,(0,u.dispatch)("core").saveEntityRecord("postType","attachment",Object.assign({},b,{"maxi-image-type":v,comment_status:g}),{throwOnError:!0}),e.abrupt("return",b);case 26:e.prev=26,e.t0=e.catch(0),console.error((0,i.__)("Error uploading the placeholder image: ".concat(e.t0),"maxi-blocks"));case 29:return e.abrupt("return",null);case 30:case"end":return e.stop()}}),e,null,[[0,26]])})));return function(){return e.apply(this,arguments)}}(),p=function(e){var t=e.substring(e.lastIndexOf("/")+1),a=t.split(".").pop(),n={jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",webp:"image/webp"}[a.toLowerCase()];return{title:t.replace(".".concat(a),""),fileName:t,mimeType:n}},b=function(){var e=(0,l.Z)(c().mark((function e(t,a){var o,l,r,s,b,x,v,g,f,h,k,y,E,w,C,N,B,S,T,L;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=2;break}return e.abrupt("return",_());case 2:return o=(0,u.resolveSelect)("core"),l=o.getEntityRecords,r=p(t),s=r.title,b=r.fileName,x=r.mimeType,e.next=6,l("postType","attachment",{post_status:"inherit",search:s,exact:!0});case 6:if(v=e.sent,(0,d.isEmpty)(v)){e.next=20;break}if(0!==v.length){e.next=10;break}return e.abrupt("return",_());case 10:if(1!==v.length){e.next=15;break}w=(0,n.Z)(v,1),E=w[0],e.next=19;break;case 15:if(-1!==(C=v.findIndex((function(e){var t=e.title.raw;return t===s||t==="".concat(s,"-1")})))){e.next=18;break}return e.abrupt("return",_());case 18:E=v[C];case 19:return e.abrupt("return",{id:E.id,url:null!==(g=null===(f=E)||void 0===f||null===(h=f.media_details)||void 0===h||null===(k=h.sizes)||void 0===k||null===(y=k.full)||void 0===y?void 0:y.source_url)&&void 0!==g?g:E.guid.rendered});case 20:return e.next=22,fetch(t).then((function(e){return e.blob()})).catch((function(e){return console.warn((0,i.__)("The Cloud server is down, using the placeholder image. Error: ".concat(e),"maxi-blocks")),!1}));case 22:if(N=e.sent){e.next=25;break}return e.abrupt("return",_());case 25:return B=!1,e.next=28,l("taxonomy","maxi-image-type");case 28:return S=e.sent,T=S[0].id,e.next=32,(0,m.uploadMedia)({filesList:[new File([N],b,{type:x})],onFileChange:function(e){var t=(0,n.Z)(e,1);B=t[0]},onError:function(e){return console.warn((0,i.__)("The original image not found (404) on the Cloud Site, using the placeholder image. Error: ".concat(e.code,", ").concat(e.message),"maxi-blocks"))}});case 32:return L=""===B.comment_status?"closed":B.comment_status,(0,u.dispatch)("core").saveEntityRecord("postType","attachment",Object.assign({},B,{"maxi-image-type":T,comment_status:L}),{throwOnError:!0}),e.abrupt("return",B);case 35:case"end":return e.stop()}}),e)})));return function(_x,t){return e.apply(this,arguments)}}(),x=b,v=function(){var e=(0,l.Z)(c().mark((function e(t,a){var n,o,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,u.dispatch)("core/block-editor"),o=n.replaceBlock,l=(0,s.rawHandler)({HTML:t,mode:"BLOCKS"}),o(a,l);case 3:case"end":return e.stop()}}),e)})));return function(_x,t){return e.apply(this,arguments)}}(),g=function(){var e=(0,l.Z)(c().mark((function e(t,a,r){var s,m,p,b,g,f,h,k,y,E,w;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.resolveSelect)("core/block-editor").isValidTemplate(t);case 2:if(!e.sent){e.next=39;break}if(s=[],m=[],p=/(mediaID|imageID)":(.*)",/g,null==(b=t.match(p))||b.forEach((function(e){var t,a,n=e.replace(/\\/g,""),o=null==n||null===(t=n.match(/(mediaID|imageID)":(\d+),/g))||void 0===t?void 0:t.map((function(e){return e.match(/\d+/)[0]}));(0,d.isEmpty)(o)||m.push.apply(m,o);var l=null==n||null===(a=n.match(/(mediaURL|imageURL)":"([^"]+)"/g))||void 0===a?void 0:a.map((function(e){return e.split(/:(.+)/,2)[1].replace(/"/g,"")}));(0,d.isEmpty)(l)||s.push.apply(s,l)})),(0,d.isEmpty)(s)||(0,d.isEmpty)(m)){e.next=36;break}if(g=t,f=(0,d.uniq)(s),h=(0,d.uniq)(m),k=f.length,y=h.length,k===y){e.next=19;break}return console.error((0,i.__)("Error processing images' links and ids - counts do not match","maxi-blocks")),v(t,r),e.abrupt("return");case 19:if(E=h.reduce((function(e,t,a){return Object.assign({},e,(0,o.Z)({},t,f[a]))}),{}),!a){e.next=26;break}return e.next=23,_();case 23:e.t0=e.sent,e.next=27;break;case 26:e.t0=null;case 27:return w=e.t0,e.next=30,Promise.all(Object.entries(E).map(function(){var e=(0,l.Z)(c().mark((function e(t){var o,l,r,i,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(0,n.Z)(t,2),i=r[0],s=r[1],!a){e.next=5;break}e.t0=w,e.next=8;break;case 5:return e.next=7,x(s,a);case 7:e.t0=e.sent;case 8:return w=e.t0,e.abrupt("return",{id:null===(o=w)||void 0===o?void 0:o.id,oldId:i,url:null===(l=w)||void 0===l?void 0:l.url,oldUrl:s});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 30:return e.sent.forEach((function(e){var t=e.id,a=e.oldId,n=e.url,o=e.oldUrl;g=(g=g.replaceAll(o,n)).replaceAll(a,t)})),e.next=34,v(g,r);case 34:e.next=37;break;case 36:v(t,r);case 37:e.next=40;break;case 39:console.error((0,i.__)("The Code is not valid","maxi-blocks"));case 40:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),f=g},99964:function(){}}]);
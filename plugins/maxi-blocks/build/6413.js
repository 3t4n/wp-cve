"use strict";(self.webpackChunkmaxi_blocks=self.webpackChunkmaxi_blocks||[]).push([[6413,1971,3035],{1971:function(t,e,n){n.r(e);var i=n(15861),r=n(69307),o=(n(99196),n(11284)),l=n.n(o),a=n(65736),s=n(9818),u=n(35674),c=n(38207),m=n(19693),d=n(13035),f=n(69663),v=n(66545),p=n(12394),b=n(92819),k=n(19848),h=n(14412),g=n(54635);e.default=function(t){var e,n=t.blockName,o=t.onChange,x=t.linkSettings,y=t.clientId,_=t.disableCustomFormats,E=void 0!==_&&_,C=t["dc-status"],O=t["dc-link-status"],V=t["dc-link-target"],Z=t["dc-type"],w=(null!==(e=(0,r.useContext)(v.HW))&&void 0!==e?e:{}).contextLoop,N=null!=w?w:{},L=N["cl-status"],j=N["cl-type"],P=L&&p.Z.includes(n),A=C||P,S=null!=Z?Z:j;if(("maxi-blocks/divider-maxi"===n||"maxi-blocks/accordion-maxi"===n||"maxi-blocks/text-maxi"===n||"maxi-blocks/slider-maxi"===n)&&!E)return null;var F=!1;if(null!=x&&x.disabled)F=!0;else{var R=(0,s.select)("core/block-editor").getClientIdsOfDescendants([y]);null!=R&&R.length&&R.forEach((function(t){var e,n,i=(0,s.select)("core/block-editor").getBlockAttributes(t);(!(0,b.isEmpty)(null===(e=i.linkSettings)||void 0===e?void 0:e.url)||"maxi-blocks/text-maxi"===(0,s.select)("core/block-editor").getBlockName(t)&&(i.content.includes("<a ")||null!==(n=i["dc-content"])&&void 0!==n&&n.includes("<a ")))&&(F=!0)}))}return(0,r.createElement)("div",{className:"toolbar-item toolbar-item__link"},(0,r.createElement)(d.default,{icon:k._qv,tooltip:(0,a.__)("Link","maxi-blocks"),className:(!(0,b.isNil)(x)&&!(0,b.isEmpty)(x.url)||O)&&"toolbar-item__link--active",disabled:F},!F&&(0,r.createElement)("div",{className:"toolbar-item__link-popover"},A&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)(c.default,{label:(0,a.__)("Use dynamic content link","maxi-blocks"),selected:O,onChange:function(){var e=(0,i.Z)(l().mark((function e(n){var i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n,!e.t0){e.next=5;break}return e.next=4,(0,v.vp)((0,v.bp)((0,f.t5)(t,"dynamicContent")),y);case 4:e.t0=e.sent;case 5:i=e.t0,o(n?Object.assign({},x,{url:i,title:i}):Object.assign({},x,{url:null,title:null}),Object.assign({"dc-link-status":n},P&&{"dc-status":n}));case 7:case"end":return e.stop()}}),e)})));return function(_x){return e.apply(this,arguments)}}()}),h.gl.includes(S)&&O&&(0,r.createElement)(g.default,{label:(0,a.__)("Link target","maxi-blocks"),value:V,options:h.Nz[S],newStyle:!0,onChange:function(){var e=(0,i.Z)(l().mark((function e(n){var i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n,!e.t0){e.next=5;break}return e.next=4,(0,v.vp)((0,v.bp)((0,f.t5)(Object.assign({},t,{"dc-link-target":n}),"dynamicContent")),y);case 4:e.t0=e.sent;case 5:i=e.t0,o(Object.assign({},x,{url:i,title:i}),{"dc-link-target":n});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})),(0,r.createElement)(m.Z.Consumer,null,(function(t){return(0,r.createElement)(u.Z,{linkValue:x,isDCLinkActive:A&&O,onChangeLink:o,onRemoveLink:function(){o({url:""}),t.onClose()}})})))))}},86413:function(t,e,n){n.r(e),n.d(e,{default:function(){return h}});var i=n(70885),r=n(69307),o=(n(99196),n(65736)),l=n(72629),a=n(35674),s=n(69663),u=n(19693),c=n(13035),m=n(92819),d=function(t){var e=t.url,n=t.type,r=t.id,o=t.opensInNewTab,l=t.noFollow,a=t.sponsored,s=t.ugc,u=t.title,c=void 0===u?"":u,d=t.linkValue,f={url:e,rel:"",title:c};return n&&(f.type=n),r&&(f.id=r),o&&(f.target="_blank",f.rel+="noreferrer noopener"),l&&(f.rel+=" nofollow"),a&&(f.rel+=" sponsored"),s&&(f.rel+=" ugc"),"_blank"===f.target||l||a||s?f.rel=f.rel.trim():delete f.rel,Object.entries(f).forEach((function(t){var e=(0,i.Z)(t,2),n=e[0],r=e[1];(0,m.isEmpty)(r)&&delete f[n],f[n]=(0,m.trim)(r)})),e!==(null==d?void 0:d.url)&&c===(null==d?void 0:d.title)&&(f.title=""),f},f=function(t){var e=t.formatOptions,n=t.formatValue;if(!e||(0,m.isEmpty)(n))return{url:""};var i=e.attributes,r=i.url,o=i.target,l=i.id,a=i.rel,s=i.title,u=void 0===s?"":s;return{url:r,opensInNewTab:"_blank"===o,id:l,noFollow:a&&a.indexOf("nofollow")>=0,sponsored:a&&a.indexOf("sponsored")>=0,ugc:a&&a.indexOf("ugc")>=0,title:u}},v=n(27119),p=n(1971),b=n(19848),k=function(t){var e=t.onChange,n=t.isList,o=t.textLevel,u=t.onClose,c=t.blockStyle,p=t.styleCard,b=Object.assign({},(0,s.t5)(t,"typography")),k="maxi-blocks/text-link",h=(0,r.useContext)(v.HP),g=h.formatValue,x=h.onChangeTextFormat,y=function(){var t,e,n,i,r=(0,m.isEqual)((0,v.Dw)({formatValue:g,formatName:"maxi-blocks/text-link",formatClassName:null,formatAttributes:null}),[0,null==g||null===(t=g.formats)||void 0===t?void 0:t.length])&&(null==g||null===(e=g.formats)||void 0===e?void 0:e.every((function(t){return t.every((function(t){return t.type!==k||(i||(i=t.attributes.url),"maxi-blocks/text-link"===t.type&&t.attributes.url===i)}))}))),o=(null==g?void 0:g.end)||((null==g||null===(n=g.formats)||void 0===n?void 0:n.length)||0)+1,a=r&&(null==g?void 0:g.start)===(null==g?void 0:g.end)?0:null==g?void 0:g.start;return(0,l.getActiveFormat)(Object.assign({},g,{start:a,end:o}),k)},_=(0,r.useRef)(y()),E=(0,r.useState)(f({formatOptions:_.current,formatValue:g})),C=(0,i.Z)(E,2),O=C[0],V=C[1];(0,r.useEffect)((function(){if(_.current=y(),_.current){var t=f({formatOptions:_.current,formatValue:g});(0,m.isEqual)(O,t)||V(t)}}),[g.start,g.end]),(0,r.useEffect)((function(){(0,m.isEmpty)(O.url)&&Object.keys(O).length>1&&u()}),[O.url]);var Z=function(t,e){var n,r,o,l,a=(0,v.Dw)({formatValue:t,formatName:k,formatClassName:null,formatAttributes:null===(n=_.current)||void 0===n?void 0:n.attributes})||[null!==(r=t.start)&&void 0!==r?r:0],s=(0,i.Z)(a,1)[0];return null==t||null===(o=t.formats)||void 0===o||null===(l=o[s])||void 0===l||l.forEach((function(n,i){"maxi-blocks/text-link"===n.type&&(t.formats[s][i].attributes=e)})),t};return(0,r.createElement)(a.Z,{linkValue:O,onChangeLink:function(t){var i=function(t){var e=t.url;return!e||e.startsWith("#")||e.startsWith("http")||e.startsWith("localhost")||e.startsWith("tel:")||e.startsWith("mailto:")||e.startsWith("sftp:")||e.startsWith("magnet:")||(e.includes("http:")?e.includes("http:")&&(t.url=e.replace(/^http:\/\//i,"https://")):t.url="https://".concat(e)),t}(t),r=d(Object.assign({},i,{linkValue:O}));_.current||(0,m.isEmpty)(i.url)?function(t){var i=d(Object.assign({},t,{linkValue:O})),r=(0,v.EA)({formatValue:Z(g,i),isList:n});e(i,{content:r})}(i):function(t,i){var r=g.start===g.end,l=Z(g,t),a=(0,v.MZ)({formatValue:r?Object.assign({},l,{start:0,end:l.formats.length}):l,typography:b,linkAttributes:d(Object.assign({},t,{newLinkValue:i})),isList:n,textLevel:o,saveFormatValue:!0,onChangeTextFormat:x,returnFormatValue:!0});x(Object.assign({},a.formatValue,{start:l.start,end:l.end})),delete a.formatValue,e(i,a)}(i,r);var l=f({formatOptions:{attributes:r},formatValue:g});V(l)},onRemoveLink:function(){var t=(0,v.bk)({formatValue:g,isList:n,typography:b,textLevel:o,attributes:O,blockStyle:c,styleCard:p}),i=d({url:"",linkValue:O}),r=f({formatOptions:{attributes:i},formatValue:g});V(r),e(i,t)}})},h=function(t){var e,n,i,l,a=t.blockName,s=t.isCaptionToolbar,d=void 0!==s&&s,f=t["dc-status"],h=void 0!==f&&f,g=t.linkSettings;if(v.HP){var x=(0,r.useContext)(v.HP);l=null!=x&&x.formatValue?null==x?void 0:x.formatValue:{}}else l={};var y=!(0,m.isEmpty)(l)&&!(0,m.isEmpty)(null===(e=l)||void 0===e?void 0:e.formats)&&(null===(n=l)||void 0===n||null===(i=n.formats)||void 0===i?void 0:i.some((function(t){return t.some((function(t){var e;return!(0,m.isEmpty)(null==t||null===(e=t.attributes)||void 0===e?void 0:e.url)}))})));return"maxi-blocks/text-maxi"===a||d?h?(0,r.createElement)(p.default,Object.assign({},t)):(0,r.createElement)(c.default,{icon:b._qv,tooltip:(0,o.__)("Link","maxi-blocks"),className:!(0,m.isNil)(g)&&!(0,m.isEmpty)(g.url)||y?"toolbar-item__link--active toolbar-item__text-link":"toolbar-item__text-link"},(0,r.createElement)(u.Z.Consumer,null,(function(e){var n=e.isOpen,i=e.onClose;return n?(0,r.createElement)(k,Object.assign({isOpen:n,onClose:i},t)):null}))):null}},13035:function(t,e,n){n.r(e);var i=n(15671),r=n(43144),o=n(97326),l=n(60136),a=n(82963),s=n(61120),u=n(4942),c=n(69307),m=(n(99196),n(65736)),d=n(55609),f=n(9818),v=n(94184),p=n.n(v),b=n(92819),k=n(40684),h=n(88442),g=n(19848),x=n(19693);var y=(0,k.ZP)((function(){return Promise.resolve().then(n.bind(n,87570))})),_=(0,k.ZP)((function(){return Promise.resolve().then(n.bind(n,46006))})),E=(0,k.ZP)((function(){return Promise.resolve().then(n.bind(n,39909))})),C=function(t){(0,l.Z)(k,t);var e,n,v=(e=k,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=(0,s.Z)(e);if(n){var r=(0,s.Z)(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return(0,a.Z)(this,t)});function k(){var t;(0,i.Z)(this,k);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t=v.call.apply(v,[this].concat(n)),(0,u.Z)((0,o.Z)(t),"state",{isOpen:!1,onClose:function(){t.setState({isOpen:!1})}}),t.ref=(0,c.createRef)(),t}return(0,r.Z)(k,[{key:"componentDidMount",value:function(){this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"onClickOutside",value:function(t){var e,n,i=t.path||t.composedPath&&t.composedPath();this.mounted&&((null===(e=this.ref.current)||void 0===e?void 0:e.ownerDocument.querySelectorAll(".toolbar-item__popover").length)>=2||i&&!i.includes(null===(n=this.ref.current)||void 0===n?void 0:n.ownerDocument.querySelector(".toolbar-item__popover"))&&!i.includes(this.ref.current))&&this.state.onClose()}},{key:"onToggle",value:function(){var t=this.state.isOpen,e=this.ref.current.ownerDocument.defaultView;t?e.removeEventListener("click",this.onClickOutside.bind(this),!1):e.addEventListener("click",this.onClickOutside.bind(this),!1),this.setState({isOpen:!t})}},{key:"render",value:function(){var t,e,n=this,i=this.props,r=i.text,o=i.className,l=i.tooltip,a=i.icon,s=i.children,u=i.advancedOptions,v=void 0!==u&&u,k=i.tab,C=void 0===k?0:k,O=i.position,V=void 0===O?"top center":O,Z=i.disabled,w=void 0!==Z&&Z,N=this.state,L=N.isOpen,j=N.onClose,P=p()("toolbar-item","toolbar-item__button",o),A=(0,(0,f.select)("maxiBlocks").receiveMaxiSettings)().hide_tooltips,S=!(0,b.isEmpty)(A)&&A,F=function(){return(0,c.createElement)(y,{className:P,onClick:function(){return n.onToggle()},"aria-expanded":L,action:"popup",disabled:w},(0,c.createElement)(_,{className:"toolbar-item__icon",icon:a}),(0,m.__)(r,"maxi-blocks"))};return(0,c.createElement)("div",{ref:this.ref},(0,c.createElement)(x.Z.Provider,{value:this.state},!S&&(0,c.createElement)(d.Tooltip,{text:l,placement:"top"},F()),S&&F(),L&&s&&(0,c.createElement)(E,{anchor:null===(t=this.ref)||void 0===t||null===(e=t.current)||void 0===e?void 0:e.closest(".toolbar-wrapper"),className:"toolbar-item__popover",onClose:j,position:V,useAnimationFrame:!0,useFlip:!0,useShift:!0,shiftPadding:!!v&&{right:20},shiftLimit:{mainAxis:!1},isAlternate:!0,noArrow:!0},(0,c.createElement)("div",null,s),!!v&&(0,c.createElement)(y,{className:"toolbar-item__popover__advanced-button",icon:g.vV$,onClick:function(){(0,h.RB)(C,v)}}))))}}]),k}(c.Component);e.default=C},19693:function(t,e,n){var i=(0,n(69307).createContext)();e.Z=i}}]);
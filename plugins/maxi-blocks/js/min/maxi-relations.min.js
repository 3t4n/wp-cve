!function(){class t{constructor(t){this.uniqueID=t?.uniqueID,this.css=t?.css,this.uniqueID&&0!==this.css.length&&(this.trigger=t.trigger,this.triggerEl=document.querySelector(`.${this.trigger}`),this.blockTargetEl=document.querySelector(`#${this.uniqueID}`),this.target=t.target??"",this.fullTarget=`#${t.uniqueID} ${this.target}`,this.targetEl=document.querySelector(this.fullTarget),this.dataTarget=`#${t.uniqueID}[data-maxi-relations="true"]`,this.triggerEl&&this.targetEl&&(this.defaultTransition=window.getComputedStyle(this.targetEl).getPropertyValue("transition"),this.breakpoints=["general","xxl","xl","l","m","s","xs"],this.hasMultipleTargetsArray=this.css.map((t=>Object.keys(t).some((t=>!this.breakpoints.includes(t))))),this.action=t.action,this.sids=t.sid||t.settings,this.effects=t.effects,this.attributes=t.attributes,({stylesObjs:this.stylesObjs,effectsObjs:this.effectsObjs}=this.generateCssResponsiveObj()),this.breakpointsObj=this.generateBreakpointsObj(),this.hoverStatus=this.effects.some((t=>t.hoverStatus)),this.isContained=this.triggerEl.contains(this.targetEl),this.isHoveredContained=this.hoverStatus&&this.isContained,this.transitionTriggers=Array.from(new Set(this.effects.map((t=>!t.disableTransition&&t.transitionTrigger)))).filter(Boolean),this.transitionTriggerEls=this.transitionTriggers.length>0?this.transitionTriggers.map((t=>t?this.blockTargetEl.querySelector(t):this.targetEl)):[this.targetEl],this.transitionTargetsArray=this.effects.map((t=>{if(t.disableTransition)return[""];switch(typeof t.transitionTarget){case"string":return[t.transitionTarget];case"object":return t.transitionTarget?.length>0?t.transitionTarget:[""];default:return[""]}})),this.isBorderArray=this.attributes.map((t=>Object.keys(t).some((t=>t.startsWith("border"))))),this.isIconArray=this.sids.map((t=>"ic"===t||"bi"===t||"Icon colour"===t||"Button icon"===t)),this.isSVG=this.fullTarget.includes("svg-icon-maxi"),this.avoidHoverArray=[],this.getAvoidHover(),this.inTransitionString="",this.outTransitionString="",this.generateTransitions(),this.stylesString="",this.generateStyles(),this.stylesEl=null,this.inTransitionEl=null,this.outTransitionEl=null,this.generateStylesEls(),this.transitionTimeout=null,this.contentTimeout=null,this.init()))}generateStylesEls(){this.stylesEl=document.createElement("style"),this.stylesEl.id=`relations--${this.uniqueID}-styles`,this.stylesEl.setAttribute("data-type",this.action),this.stylesEl.setAttribute("data-sids",this.sids),this.stylesEl.innerText=this.stylesString,this.inTransitionString.length>0&&(this.inTransitionEl=document.createElement("style"),this.inTransitionEl.id=`relations--${this.uniqueID}-in-transitions`,this.inTransitionEl.setAttribute("data-type",this.action),this.inTransitionEl.setAttribute("data-sids",this.sids),this.inTransitionEl.innerText=this.inTransitionString),this.outTransitionString.length>0&&(this.outTransitionEl=document.createElement("style"),this.outTransitionEl.id=`relations--${this.uniqueID}-out-transitions`,this.outTransitionEl.setAttribute("data-type",this.action),this.outTransitionEl.setAttribute("data-sids",this.sids),this.outTransitionEl.innerText=this.outTransitionString)}addStyleEl(t){if(!t)return;this.inlineStylesEl||(this.inlineStylesEl=document.querySelector("style[id*=maxi-blocks]"));const e=document.querySelector(`#${t.id}`);if(e){const i=e.getAttribute("data-sids").split(",").map((t=>t.trim()));e.getAttribute("data-type")===this.action&&JSON.stringify(i)===JSON.stringify(this.sids)?e.replaceWith(t):e.insertAdjacentElement("afterend",t)}else this.inlineStylesEl.parentNode.insertBefore(t,this.inlineStylesEl.nextSibling)}getCurrentBreakpoint(){const t=window.innerWidth;let e="general";return Object.entries(this.breakpointsObj).forEach((([i,s])=>{if(!["general","xxl"].includes(i)){if("general"===i)return;t<=this.breakpointsObj.xl&&(e=i)}t<=s&&(e=i)})),e}getLastUsableBreakpoint(t,e){return[...this.breakpoints].splice(0,this.breakpoints.indexOf(t)+1).reverse().find((t=>e(t)))}getTransitionTimeout(){const t=this.getCurrentBreakpoint(),e=(e,i)=>e[`transition-${i}-${this.getLastUsableBreakpoint(t,(t=>Object.prototype.hasOwnProperty.call(e,`transition-${i}-${t}`)))}`];return this.effects.reduce(((t,i)=>{if(i.disableTransition)return t;let s=0;return[i,i?.out].forEach((t=>{if(!t)return;const i=1e3*(e(t,"duration")+e(t,"delay"));s=Math.max(s,i)})),Math.max(t,s)}),0)}generateCssResponsiveObj(){const t=(t,e)=>{const i={},s={},r=(t,i,s=!1)=>{const r=s?e.out:e,n=this.getLastUsableBreakpoint(i,(e=>Object.prototype.hasOwnProperty.call(r,`${t}-${e}`)));return{[t]:r[`${t}-${n??"general"}`]}};return this.breakpoints.forEach((n=>{if(Object.prototype.hasOwnProperty.call(t,n)&&(i[n]={...t[n].styles}),e.disableTransition)return;const a=(t=!1)=>["split","transition-status","transition-duration","transition-delay","easing"].reduce(((e,i)=>({...e,...r(i,n,t)})),{});s[n]=a(),s[n].split&&(s[n].out=a(!0))})),{stylesObj:i,effectsObj:s}},e=t=>{const e={...t};return Object.entries(e).forEach((([t,i])=>{[...this.breakpoints].reverse().reduce(((s,r)=>{if(!Object.prototype.hasOwnProperty.call(i,s))return r;const n=0===Object.keys(i[s]).length,a=JSON.stringify(i[r])===JSON.stringify(i[s]);return(n||a)&&delete e[t][s],r}))})),e},i=[],s=[],r=t=>{Object.entries(t).forEach((([t,e])=>{("stylesObj"===t?i:s).push((t=>0===Object.keys(t).length)(e)?null:e)}))};return this.css.forEach(((i,s)=>{if(this.hasMultipleTargetsArray[s]){const n={};let a={};Object.keys(i).forEach((r=>{const{stylesObj:o,effectsObj:l}=e(t(i[r],this.effects[s]));n[r]=o,a=l})),r({stylesObj:n,effectsObj:a})}else r(e(t(i,this.effects[s])))})),{stylesObjs:i,effectsObjs:s}}generateBreakpointsObj(){const t={},e=e=>{this.breakpoints.forEach((i=>{if(Object.prototype.hasOwnProperty.call(e,i)&&(e[i].styles.isArray?e[i].styles.length>0:Object.keys(e[i].styles).length>0)){let{breakpoint:s}=e[i];s="general"===i?"":s,t[i]=s}}))};return this.css.forEach(((t,i)=>{this.hasMultipleTargetsArray[i]?Object.keys(t).forEach((i=>{e(t[i])})):e(t)})),t}escapeRegExp(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}getAvoidHover(){this.hoverStatus&&this.targetEl&&this.transitionTargetsArray.forEach((t=>this.avoidHoverArray.push(t.some((t=>Array.from(document.querySelectorAll(`${this.fullTarget} ${this.fullTarget.includes(t)?"":t}`)).some((t=>this.targetEl.closest(".maxi-block").contains(t)&&this.targetEl.contains(t))))))))}setDataAttrToBlock(t){if("false"===t){const e=this.blockTargetEl.getAttribute("data-maxi-relations-trigger");e!==this.trigger&&e||this.blockTargetEl.setAttribute("data-maxi-relations",t)}else this.blockTargetEl.setAttribute("data-maxi-relations",t);this.blockTargetEl.setAttribute("data-maxi-relations-trigger",this.trigger)}addDataAttrToBlock(){this.setDataAttrToBlock("true")}removeAddAttrToBlock(){this.setDataAttrToBlock("false")}getTargetForLine(t,e=this.dataTarget){return t?e.includes(t)?e:`${e} ${t}`:`${e} ${this.target}`}getMediaLines(t,e){let i="",s="";return"general"===t||(i=`@media screen and (${"xxl"===t?"min-width":"max-width"}: ${"xxl"===t?e+1:e}px) {`,s="}"),{prevLine:i,postLine:s}}generateStyles(){const t=(t,e,i)=>{const s=e.includes("maxi-background-displayer");Object.entries(this.breakpointsObj).forEach((([r,n])=>{if(t[r]){const a=this.avoidHoverArray[i]?":not(:hover)":"",{prevLine:o,postLine:l}=this.getMediaLines(r,n);let h;h=e.includes(".maxi-background-displayer")?e.replace(/(\s*)> .maxi-background-displayer/,(t=>`${a}${t}`)).trim():e.includes(".maxi-button-block__button")?e.replace("maxi-button-block__button",(t=>`${t}${a}`)):this.isSVG?e.replace("maxi-svg-icon-block__icon",(t=>`${t}${a}`)):`${e.trim()}${a}`,h.includes("maxi-button-block__content")&&!h.includes("maxi-button-block__button")&&(h=h.replace(a,"").replace(".maxi-button-block__content",`.maxi-button-block__button${a} .maxi-button-block__content`));const c=`${o} body.maxi-blocks--active ${h} {`.replace(/\s{2,}/g," ");if(Object.entries(t[r]).forEach((([t,e])=>{const i=new RegExp(`(${this.escapeRegExp(c)})`);this.stylesString.match(i)||(this.stylesString+=`${c}}${l}`),this.stylesString=this.stylesString.replace(i,`$1 ${t}: ${e};`)})),this.isBorderArray[i]&&s){const t=t=>this.attributes[`border-${t}-width-${r}`],e=t("top"),i=t("right"),s=t("bottom"),n=t("left"),a=this.attributes[`border-unit-${r}`]||"px",o=t=>Math.round(100*t)/100,h=new RegExp(`(${this.escapeRegExp(c)})`);this.stylesString.match(h)||(this.stylesString+=`${c}}${l}`),(e||0===e)&&(this.stylesString=this.stylesString.replace(h,`$1 top: -${o(e)}${a};`)),(s||0===s)&&(this.stylesString=this.stylesString.replace(h,`$1 bottom: -${o(s)}${a};`)),(n||0===n)&&(this.stylesString=this.stylesString.replace(h,`$1 left: -${o(n)}${a};`)),(i||0===i)&&(this.stylesString=this.stylesString.replace(h,`$1 right: -${o(i)}${a};`))}}}))},e="click"===this.action?`#${this.uniqueID}[data-maxi-relations="true"]`:this.dataTarget;this.stylesObjs.forEach(((i,s)=>{this.hasMultipleTargetsArray[s]?Object.entries(i).forEach((([i,r])=>Object.keys(r).length&&t(r,`${e} ${i}`,s))):this.transitionTargetsArray[s].forEach((e=>t(i,this.getTargetForLine(e,"click"===this.action?`#${this.uniqueID}[data-maxi-relations="true"]`:this.dataTarget),s)))}))}addStyles(){this.addStyleEl(this.stylesEl)}removeStyles(){this.stylesEl.remove()}generateTransitions(){let t="",e="";const i=(i,s,r)=>{const n=s.includes("maxi-background-displayer");Object.entries(this.breakpointsObj).forEach((([a,o])=>{let l=!!this.effectsObjs[r][a],h=a;if(!l){const t=this.breakpoints.indexOf(a),e=this.breakpoints.slice(0,t).filter((t=>this.effectsObjs[r][t])),i=e[0],s=!this.stylesObjs.some((t=>i in t));e.length&&s&&(l=!0),h=i}if(l){let l=[...this.breakpoints].splice(0,this.breakpoints.indexOf(a)+1).reduce(((t,e)=>({...t,...i[this.getLastUsableBreakpoint(e,(t=>i?.[t]&&Object.keys(i?.[t]).length))]})),{});if(this.isBorder&&n&&(l={...l,top:null,left:null}),Object.keys(l).length){const i=(t,e,i)=>{let s=i;const{prevLine:n,postLine:l}=this.getMediaLines(a,o),h=`${n}body.maxi-blocks--active ${e} {`.replace(/\s{2,}/g," "),c=new RegExp(`(${this.escapeRegExp(h)})`);s.match(c)||(s+=`${h}}${l}`);const u=new RegExp(`(${this.escapeRegExp(h)}[^{]*transition:)`);return t?(s.match(u)?this.isIconArray[r]||(s=s.replace(u,`$1 ${t}`)):s=s.replace(c,`$1 transition: ${t.replace(/, $/,"")};`),s):""},n=this.effectsObjs[r][h],{split:c}=n;if(c){const a=this.getTransitionString(l,n,this.isIconArray[r]);t=i(a,s,t);const o=this.getTransitionString(l,n.out,this.isIconArray[r]);e=i(o,s,e)}else{const a=this.getTransitionString(l,n,this.isIconArray[r]);t=i(a,s,t),e=i(a,s,e)}}}}))};this.stylesObjs.forEach(((t,e)=>{this.effects[e].disableTransition||(this.hasMultipleTargetsArray[e]?this.isSVG?this.transitionTargetsArray[e].forEach((s=>{const r=`${this.dataTarget} ${this.avoidHoverArray[e]?s.replace("maxi-svg-icon-block__icon",(t=>`${t}:not(:hover)`)):s}`;Object.keys(t).forEach((s=>i(t[s],r,e)))})):Object.keys(t).forEach((s=>{i(t[s],`${this.dataTarget} ${s}`,e)})):this.transitionTargetsArray[e].forEach((s=>i(t,this.getTargetForLine(s),e))))})),this.inTransitionString=t,this.outTransitionString=e}addTransition(t){this.addStyleEl(t)}removeTransition(t){t?.remove()}getTransitionString(t,e,i){const{"transition-status":s,"transition-duration":r,"transition-delay":n,easing:a}=e,o=(s?`${r}s ${a} ${n}s`:"0s 0s")+", ",l=i?`all ${o}`:Object.keys(t).reduce(((t,e)=>`${t}${e} ${o}`),"");return"none 0s ease 0s"===this.defaultTransition||l.includes(this.defaultTransition)?l:`${this.defaultTransition}, ${l}`}addRelationSubscriber(){const t=new MutationObserver((t=>{t.forEach((t=>{"attributes"===t.type&&"data-maxi-relations"===t.attributeName&&"true"!==t.target.dataset.maxiRelations&&(t.target.dataset.maxiRelations="true")}))}));t.observe(this.blockTargetEl,{attributes:!0,attributeFilter:["data-maxi-relations"]}),this.observer=t}removeRelationSubscriber(){this.observer.disconnect()}init(){"hover"===this.action?this.addHoverEvents():this.addClickEvents()}addHoverEvents(){this.triggerEl.addEventListener("mouseenter",this.onMouseEnter.bind(this)),this.triggerEl.addEventListener("mouseleave",this.onMouseLeave.bind(this)),this.isHoveredContained&&this.transitionTriggerEls?.forEach((t=>{t.addEventListener("mouseenter",(()=>{this.removeTransition(this.inTransitionEl),clearTimeout(this.contentTimeout)})),t.addEventListener("mouseleave",(()=>{const t=Array.from(new Set(this.transitionTargetsArray.flat())).filter(Boolean).reduce(((t,e)=>{const i=document.querySelector(`${this.dataTarget} ${e??""}`),s=i?1e3*["transition-duration","transition-delay"].reduce(((t,e)=>t+parseFloat(getComputedStyle(i).getPropertyValue(e).replace("s",""))),0):0;return Math.max(t,s)}),0);this.contentTimeout=setTimeout((()=>{this.addTransition(this.inTransitionEl)}),t)}))}))}onMouseEnter(){this.transitionTimeout&&this.removeTransition(this.outTransitionEl),clearTimeout(this.transitionTimeout),this.addRelationSubscriber(),this.addDataAttrToBlock(),this.addTransition(this.inTransitionEl),this.addStyles()}onMouseLeave(){if(this.removeTransition(this.inTransitionEl),this.addTransition(this.outTransitionEl),this.removeStyles(),this.targetEl.matches(":hover")&&"none 0s ease 0s"!==this.defaultTransition)this.removeTransition(this.outTransitionEl),this.removeAddAttrToBlock();else{const t=this.getTransitionTimeout(),e=()=>{this.removeTransition(this.outTransitionEl),this.removeAddAttrToBlock(),this.removeRelationSubscriber()};0===t?e():this.transitionTimeout=setTimeout(e,t)}}addClickEvents(){this.triggerEl.addEventListener("click",this.onMouseClick.bind(this))}onMouseClick(){this.addDataAttrToBlock(),this.addTransition(this.inTransitionEl),this.addStyles(),this.transitionTimeout=setTimeout((()=>{this.removeTransition(this.inTransitionEl)}),this.getTransitionTimeout())}}window.addEventListener("DOMContentLoaded",(()=>{let e;if("string"==typeof maxiRelations?.[0])try{e=JSON.parse(maxiRelations?.[0])}catch(t){console.error("Invalid JSON string",t),e=null}else e="object"==typeof maxiRelations?.[0]&&null!==maxiRelations?.[0]?maxiRelations?.[0]:null;e&&e.reduce(((t,{action:i,trigger:s,uniqueID:r,target:n})=>{const a=t=>t.action===i&&t.trigger===s&&t.uniqueID===r&&t.target===n;if(!t.find((t=>a(t)))){const i=e.filter((t=>a(t))).reduce(((t,e)=>(Object.keys(e).forEach((i=>{"action"!==i&&"trigger"!==i&&"uniqueID"!==i&&"target"!==i?(t[i]||(t[i]=[]),t[i].push(e[i])):t[i]=e[i]})),t)),{});t.push(i)}return t}),[]).forEach((e=>new t(e)))}))}();
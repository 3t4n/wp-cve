"use strict";var iti,ajax_url=cwginstock.ajax_url,security_error=cwginstock.security_error,userid=cwginstock.user_id,emptyname=cwginstock.empty_name,emptyemail=cwginstock.empty_email,emptyquantity=cwginstock.empty_quantity,invalidemail=cwginstock.invalid_email,recaptcha_enabled=cwginstock.enable_recaptcha,recaptcha_site_key=cwginstock.recaptcha_site_key,recaptcha_verify_enabled=cwginstock.enable_recaptcha_verify,recaptcha_secret_present=cwginstock.recaptcha_secret_present,is_iagree=cwginstock.is_iagree_enable,iagree_error=cwginstock.iagree_error,is_v3_recaptcha=cwginstock.is_v3_recaptcha,is_popup=cwginstock.is_popup,googlerecaptcha_widget_id=null,gtoken="",phone_field=cwginstock.phone_field,subscriber_phone="",phone_meta_data="",phone_error=cwginstock.phone_field_error,is_phone_field_optional=cwginstock.is_phone_field_optional,is_quantity_field_optional=cwginstock.is_quantity_field_optional,hide_country_placeholder=cwginstock.hide_country_placeholder,default_country_code=cwginstock.default_country_code;function cwginstock_recaptcha_callback(e){document.getElementsByClassName("cwgstock_button")[0].disabled=!1,"1"==recaptcha_verify_enabled&&"yes"==recaptcha_secret_present&&(document.getElementsByClassName("cwg-security")[0].value=e)}var instock_notifier={init:function(){"no"==is_popup&&instock_notifier.generate_v3_response(),jQuery(document).on("click",".cwgstock_button",this.submit_form),jQuery(".single_variation_wrap").on("show_variation",this.perform_upon_show_variation),"1"==phone_field&&instock_notifier.initialize_phone()},initialize_phone:function(){var e=document.querySelector(".cwgstock_phone");e&&(iti=window.intlTelInput(e,{allowDropdown:!0,formatOnDisplay:!0,autoHideDialCode:!1,separateDialCode:!0,utilsScript:cwginstock.phone_utils_js,initialCountry:default_country_code,customPlaceholder:function(e,c){return(default_country_code=default_country_code.toLowerCase())==c.iso2&&"2"==cwginstock.hide_country_placeholder?""!=cwginstock.custom_country_placeholder?cwginstock.custom_country_placeholder:e:""}}))},perform_upon_show_variation:function(e,c){var t=c.variation_id;jQuery(".cwginstock-subscribe-form").hide(),jQuery(".cwginstock-subscribe-form-"+t).show(),"1"==recaptcha_enabled&&instock_notifier.onloadcallback(),"1"==phone_field&&instock_notifier.initialize_phone()},generate_v3_response:function(){"1"==recaptcha_enabled&&"yes"==is_v3_recaptcha&&grecaptcha.ready((function(){grecaptcha.execute(recaptcha_site_key,{action:"subscribe_form"}).then((function(e){document.getElementsByClassName("cwg-security").length>0&&(document.getElementsByClassName("cwg-security")[0].value=e,document.getElementsByClassName("cwgstock_button")[0].disabled=!1,gtoken=e)}))}))},is_email:function(e){return/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e)},submit_form:function(e){e.preventDefault();var c=jQuery(this),t=jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_name").val(),o=jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_email").val(),s=jQuery(this).closest(".cwginstock-subscribe-form").find(".add_quantity_field").val();if((""===s||s<=0)&&"2"==is_quantity_field_optional)return jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn(),jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+emptyquantity+"</div>"),!1;if("1"==phone_field){var i=iti.getNumber();if(phone_meta_data=iti.getSelectedCountryData(),!iti.isValidNumber()){var r=iti.getValidationError(),n=phone_error[r];if(-99==r&&(n=phone_error[0]),-99!=r&&"1"==is_phone_field_optional||"2"==is_phone_field_optional)return jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn(),jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+n+"</div>"),!1}}var a=jQuery(this).closest(".cwginstock-subscribe-form").find(".cwg-product-id").val(),l=jQuery(this).closest(".cwginstock-subscribe-form").find(".cwg-variation-id").val();if(""==t)return jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn(),jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+emptyname+"</div>"),!1;if(""==o)return jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn(),jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+emptyemail+"</div>"),!1;if(!instock_notifier.is_email(o))return jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn(),jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+invalidemail+"</div>"),!1;if("1"==is_iagree&&!jQuery(this).closest(".cwginstock-subscribe-form").find(".cwg_iagree_checkbox_input").is(":checked"))return jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn(),jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+iagree_error+"</div>"),!1;var u=jQuery(this).closest(".cwginstock-subscribe-form").find(".cwg-security").val(),_={action:"cwginstock_product_subscribe",product_id:a,variation_id:l,subscriber_name:t,subscriber_phone:i,subscriber_phone_meta:phone_meta_data,user_email:o,user_id:userid,security:u,dataobj:cwginstock,custom_quantity:s};jQuery.fn.block?c.closest(".cwginstock-subscribe-form").block({message:null}):jQuery('<div id="cwg-bis-overlay"> </div>').appendTo(c.closest(".cwginstock-subscribe-form")),instock_notifier.perform_ajax(_,c)},recaptcha_callback:function(e){document.getElementsByClassName("cwg-security").length>0&&(document.getElementsByClassName("cwgstock_button")[0].disabled=!1,"1"==recaptcha_verify_enabled&&"yes"==recaptcha_secret_present&&(document.getElementsByClassName("cwg-security")[0].value=e))},onloadcallback:function(){"1"==recaptcha_enabled&&("no"==is_v3_recaptcha?jQuery("#cwg-google-recaptcha").length&&(null===googlerecaptcha_widget_id?googlerecaptcha_widget_id=grecaptcha.render("cwg-google-recaptcha",{sitekey:recaptcha_site_key,callback:this.recaptcha_callback}):(grecaptcha.reset(googlerecaptcha_widget_id),this.recaptcha_callback(),googlerecaptcha_widget_id=null,instock_notifier.onloadcallback())):instock_notifier.generate_v3_response())},resetcallback:function(){"1"==recaptcha_enabled&&("no"==is_v3_recaptcha?(grecaptcha.reset(),document.getElementsByClassName("cwgstock_button")[0].disabled=!0):instock_notifier.generate_v3_response())},perform_ajax:function(e,c){jQuery.ajax({type:"post",url:ajax_url,data:e,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",cwginstock.security)},success:function(t){t=t.msg,c.closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn(2e3),c.closest(".cwginstock-subscribe-form").find(".cwgstock_output").html(t),jQuery.fn.block?c.closest(".cwginstock-subscribe-form").unblock():c.closest(".cwginstock-subscribe-form").find("#cwg-bis-overlay").fadeOut(400,(function(){c.closest(".cwginstock-subscribe-form").find("#cwg-bis-overlay").remove()})),instock_notifier.resetcallback(),jQuery(document).trigger("cwginstock_success_ajax",e)},error:function(t,o,s){void 0!==t.responseJSON&&t.responseJSON.hasOwnProperty("code")&&void 0!==t.responseJSON.code&&("rest_cookie_invalid_nonce"!=t.responseJSON.code&&"cwg_nonce_verify_failed"!=t.responseJSON.code||(t.responseText=-1)),"-1"!==t.responseText&&-1!==t.responseText||(c.closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn(2e3),c.closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+security_error+"</div>")),jQuery.fn.block?c.closest(".cwginstock-subscribe-form").unblock():c.closest(".cwginstock-subscribe-form").find("#cwg-bis-overlay").fadeOut(400,(function(){c.closest(".cwginstock-subscribe-form").find("#cwg-bis-overlay").remove()})),instock_notifier.resetcallback(),jQuery(document).trigger("cwginstock_error_ajax",e)}})}};instock_notifier.init();
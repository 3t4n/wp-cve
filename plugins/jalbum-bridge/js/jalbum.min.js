var VER='2.0.14',DEBUG=false; 
window.console=window.console||{log:function(t){}},String.prototype.hasOwnProperty("trim")||(String.wsp=[],String.wsp[9]=!0,String.wsp[10]=!0,String.wsp[11]=!0,String.wsp[12]=!0,String.wsp[13]=!0,String.wsp[32]=!0,String.wsp[133]=!0,String.wsp[160]=!0,String.wsp[5760]=!0,String.wsp[6158]=!0,String.wsp[8192]=!0,String.wsp[8193]=!0,String.wsp[8194]=!0,String.wsp[8195]=!0,String.wsp[8196]=!0,String.wsp[8197]=!0,String.wsp[8198]=!0,String.wsp[8199]=!0,String.wsp[8200]=!0,String.wsp[8201]=!0,String.wsp[8202]=!0,String.wsp[8203]=!0,String.wsp[8232]=!0,String.wsp[8233]=!0,String.wsp[8239]=!0,String.wsp[8287]=!0,String.wsp[12288]=!0,String.prototype.trim=function(){var t=this+"",e=t.length;if(e){var n=String.wsp,r=0;for(--e;e>=0&&n[t.charCodeAt(e)];)--e;for(++e;r<e&&n[t.charCodeAt(r)];)++r;t=t.substring(r,e)}return t}),String.prototype.hasOwnProperty("trunc")||(String.prototype.trunc=function(t){var e=this+"";if(e.length<=t)return e.toString();var n=e.substring(0,t-1),r=n.lastIndexOf(" ");return(r>6&&n.length-r<20?n.substring(0,r):n)+"..."}),String.prototype.hasOwnProperty("startsWith")||(String.prototype.startsWith=function(t){return 0===(this+"").indexOf(t)}),String.prototype.hasOwnProperty("endsWith")||(String.prototype.endsWith=function(t){return(this+"").substring(this.length-t.length)===t}),String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.unCamelCase=function(){return this.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},String.prototype.getExt=function(){var t=this+"",e=t.lastIndexOf(".");return e<=0||e>=t.length-1?"":t.substring(e+1)},String.prototype.stripExt=function(){var t=this+"",e=t.lastIndexOf(".");return e<=0||e>t.length-1?t:t.substring(0,e)},String.prototype.hasExt=function(t){var e=this+"",n=e.lastIndexOf(".");return n>=0&&(e=e.substring(n+1).toLowerCase(),(t+",").indexOf(e+",")>=0)},String.prototype.replaceExt=function(t){var e=this+"",n=e.lastIndexOf(".");return n<=0?e:e.substring(0,n+1)+t},String.prototype.fixExtension=function(){return(this+"").replace(/.gif$/gi,".png").replace(/.tif+$/gi,".jpg")},String.prototype.getDir=function(){var t=(this+"").split("#")[0];return t.substring(0,t.lastIndexOf("/")+1)},String.prototype.getFile=function(){var t=(this+"").split("#")[0];return t.substring(t.lastIndexOf("/")+1)},String.prototype.getRelpath=function(t){var e=this+"",n=e.lastIndexOf("#");for(-1===n?n=e.length-1:n--;n>=0&&("/"!==e[n]||0!=t--);n--);return e.substring(n+1)},String.prototype.fixUrl=function(){for(var t,e,n=this+"";(t=n.indexOf("../"))>0;){if(1===t||-1===(e=n.lastIndexOf("/",t-2)))return n.substring(t+3);n=n.substring(0,e)+n.substring(t+2)}return n},String.prototype.fullUrl=function(){var t=this+"";return t.match(/^(http|ftp|file)/)||(t=window.location.href.getDir()+t),t.fixUrl()},String.prototype.cleanupHTML=function(){for(var t=[[/<(b|h)r\/?>/gi,"\n"],[/\&amp;/g,"&"],[/\&nbsp;/g," "],[/\&lt;/g,"<"],[/\&gt;/g,">"],[/\&(m|n)dash;/g,"-"],[/\&apos;/g,"'"],[/\&quot;/g,'"']],e=this+"",n=t.length-1;n>=0;n--)e=e.replace(t[n][0],t[n][1]);return e.replace},String.prototype.stripHTML=function(t){var e=this+"";return t&&(e=e.cleanupHTML()),e.replace(/<\/?[^>]+>/g," ")},String.prototype.stripQuote=function(){return(this+"").replace(/\"/gi,"&quot;")},String.prototype.appendSep=function(t,e){return(this.length?this+(e||" &middot; "):"")+t},String.prototype.rgb2hex=function(){var t=this+"";if("#"===t.charAt(0)||"transparent"===t)return t;var e,n=t.match(/\d+/g),r="";if(n){for(var i=0;i<n.length&&i<3;++i)r+=((e=parseInt(n[i],10).toString(16)).length<2?"0":"")+e;return"#"+r}return"transparent"},String.prototype.template=function(t){if(void 0===t||!this)return this;!isNaN(parseFloat(t))&&isFinite(t)&&(t+="");var e=this+"";if(t.constructor===Array)for(var n=0;n<t.length;++n)e=e.replace(new RegExp("\\{"+n+"\\}","gi"),t[n]);else e=e.replace(/\{0\}/gi,t);return e},String.prototype.getSearchTerms=function(){var t=this+"";if(-1===t.indexOf('"'))return t.split(" ");var e,n=[];do{if((e=t.indexOf('"'))>0&&n.push.apply(n,t.substring(0,e).split(" ")),t=t.substring(e+1),(e=t.indexOf('"'))<0){n.push(t);break}n.push(t.substring(0,e)),t=t.substring(e+1)}while(t.length);return n},String.prototype.shorten=function(t,e){if(!this||!this.length)return this;var n,r=this+"",t=t||160;return e&&(r=stripHTML(r)),r.length>t?r.indexOf("<")>=0&&(r=r.stripHTML()).length<=t?r:((n=r.lastIndexOf(" ",t))<t/2&&(n=t),r.substring(0,n)+"&hellip;"):r},String.prototype.hashCode=function(){for(var t=0,e=0,n=this.length;e<n;++e)t=(t<<5)-t+this.charCodeAt(e),t&=t;return t},Math.minMax=function(t,e,n){return(e=isNaN(e)?parseFloat(e):e)<t?t:e>n?n:e},Math.getRange=function(t,e){if(e.constructor!==Array)return t>=e?1:0;if(1===e.length)return t>=e[0]?1:0;if(t<e[0])return 0;for(var n=1;n<e.length&&!(t>=e[n-1]&&t<e[n]);n++);return n};var encodeJ=[];encodeJ[33]="%21",encodeJ[35]="%23",encodeJ[36]="%24",encodeJ[38]="%26",encodeJ[39]="%27",encodeJ[40]="%28",encodeJ[41]="%29",encodeJ[43]="%2B",encodeJ[44]="%2C",encodeJ[59]="%3B",encodeJ[60]="%3C",encodeJ[61]="%3D",encodeJ[62]="%3E",encodeJ[63]="%3F",encodeJ[64]="%40",encodeJ[123]="%7B",encodeJ[124]="%7C",encodeJ[125]="%7D",transCodeJ=[],transCodeJ[33]="%21",transCodeJ[39]="%27",transCodeJ[40]="%28",transCodeJ[41]="%29";var UNDEF="undefined",LOCAL="file:"===document.location.protocol,ONEDAY_S=86400,ONEDAY_MS=864e5,STARS='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="80" height="16" viewBox="0 0 80 16" xml:space="preserve"><path d="M12,10.094l0.938,5.5L8,13l-4.938,2.594L4,10.094L0,6.219l5.531-0.813l2.469-5l2.469,5L16,6.219L12,10.094z"/><path d="M28,10.094l0.938,5.5L24,13l-4.938,2.594l0.938-5.5l-4-3.875l5.531-0.813l2.469-5l2.469,5L32,6.219L28,10.094z"/><path d="M44,10.094l0.938,5.5L40,13l-4.938,2.594l0.938-5.5l-4-3.875l5.531-0.813l2.469-5l2.469,5L48,6.219L44,10.094z"/><path d="M60,10.094l0.938,5.5L56,13l-4.938,2.594l0.938-5.5l-4-3.875l5.531-0.813l2.469-5l2.469,5L64,6.219L60,10.094z"/><path d="M76,10.094l0.938,5.5L72,13l-4.938,2.594l0.938-5.5l-4-3.875l5.531-0.813l2.469-5l2.469,5L80,6.219L76,10.094z"/></svg>';DIR_PATH=function(){var t=window.location.pathname,e=document.getElementsByTagName("html")[0].getAttribute("data-level")||0;do{t=t.substring(0,t.lastIndexOf("/"))}while(e--);return t+"/"}(),translate=function(t,e){if(t=t.trim(),"undefined"!=typeof Texts&&Texts.hasOwnProperty(t))return Texts[t];if(void 0!==e)return DEBUG&&console&&console.log("Using default translation: "+t+"="+e),e;DEBUG&&console&&console.log("Missing translation: "+t);var n=t.replace(/([A-Z])/g," $1").toLowerCase();return n[0]=n.charAt(0).toUpperCase(),n},getKeys=function(t,e){var n,r={},i=t.split(","),o=i.length;for(n=0;n<o;n++)r[i[n]]=translate(i[n],e[i]);return r},getTranslations=function(t){var e,n={};for(e in t)"object"==typeof t[e]?n[e]=getTranslations(t[e]):n[e]=translate(e,t[e]);return n},isEmpty=function(t){return null==t||0===Object.getOwnPropertyNames(t).length},stringVal=function(t){switch(typeof t){case"string":return t;case"number":return t+"";case"array":return t.toString();case"object":return JSON.stringify(t)}return""},extend=function(){if(arguments.length<2)return arguments[0]||{};for(var t=arguments[0],e=1;e<arguments.length;e++)for(var n in arguments[e])arguments[e].hasOwnProperty(n)&&(t[n]=arguments[e][n]);return t},pushAll=function(t,e){if(t instanceof Array)if(e instanceof Array)for(var n=0,r=e.length;n<r;n++)t.push(e[n]);else t.push(e)},pushNew=function(t,e){if(t instanceof Array)if(e instanceof Array)for(var n=0,r=e.length;n<r;n++)t.includes(e[n])||t.push(e[n]);else t.includes(e)||t.push(e)},getStyle=function(t,n){if(t instanceof Element){if(document.defaultView&&document.defaultView.getComputedStyle)return document.defaultView.getComputedStyle(t,"").getPropertyValue(n.unCamelCase());if(t.currentStyle)return e.currentStyle[n]}return null},scrollbarWidth=function(){var t=document.createElement("div"),e=0;return t.style.cssText="width:100px;height:100px;overflow:scroll !important;position:absolute;top:-9999px",document.body&&(document.body.appendChild(t),e=t.offsetWidth-t.clientWidth,document.body.removeChild(t)),e},isTouchEnabled=function(){return/Trident/.test(navigator.userAgent)?void 0!==navigator.maxTouchPoints&&navigator.maxTouchPoints:/Edge/.test(navigator.userAgent)?0==scrollbarWidth():/(Chrome|CriOS)/.test(navigator.userAgent)?/Mobile/.test(navigator.userAgent)||"ontouchstart"in window:"ontouchstart"in window},getTouch=function(){return/Trident|Edge/.test(navigator.userAgent)?window.navigator.pointerEnabled?{START:"pointerdown",MOVE:"pointermove",END:"pointerup",CANCEL:"pointercancel"}:{START:"MSPointerDown",MOVE:"MSPointerMove",END:"MSPointerUp",CANCEL:"MSPointerCancel"}:{START:"touchstart",MOVE:"touchmove",END:"touchend",CANCEL:"touchcancel"}},hasLocalStorage=function(){try{return localStorage.setItem("_t","undefined"),localStorage.removeItem("_t"),!0}catch(t){return!1}},hasHistory=function(){var t=navigator.userAgent;return(-1===t.indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexOf("Chrome")||-1!==t.indexOf("Windows Phone"))&&(window.history&&"pushState"in window.history)},hasPDFViewer=function(){return navigator.mimeTypes["application/pdf"]||function(){var t=function(t){try{return new ActiveXObject(t)}catch(t){}};return t("AcroPDF.PDF")||t("PDF.PdfCtrl")}()||/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},addClass=function(t,e){t.classList?t.classList.add(e):t.className+=" "+e},getVendor=function(){var t=navigator.userAgent;return t.indexOf("Trident")>0||t.indexOf("Edge")>0?"ms":t.indexOf("AppleWebKit")>0?"webkit":t.indexOf("Gecko")>0?"moz":t.indexOf("Presto")>0?"o":t.indexOf("Blink")>0?"webkit":""},NOLINK="javascript:void(0)",LOCALSTORAGE=hasLocalStorage(),HISTORY=hasHistory(),VEND=getVendor(),BACKFACEBUG=navigator.userAgent.indexOf("Edge")>0&&parseInt(navigator.userAgent.match(/Edge\/(\d+\.\d+)/)[1])<=16,FITCONTENT=/Trident/.test(navigator.userAgent)||/Edge/.test(navigator.userAgent)?(document.getElementsByTagName("html")[0].classList.add("no-fitcontent"),!1):(document.getElementsByTagName("html")[0].classList.add("fitcontent"),!0),ISIOSDEVICE=navigator.userAgent.match(/ipad|iphone|ipod/i),TOUCH=getTouch(),TOUCHENABLED=isTouchEnabled(),HIDPI=matchMedia("(-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2), (min-resolution: 192dpi)").matches,HASPDFVIEWER=hasPDFViewer(),LANGUAGE=navigator.hasOwnProperty("languages")?navigator.languages[0]:navigator.language,DEBUG="undefined"!=typeof DEBUG&&DEBUG,addClass(document.getElementsByTagName("html")[0],(TOUCHENABLED?"":"no-")+"touch"),addClass(document.getElementsByTagName("html")[0],(HIDPI?"":"no-")+"hidpi"),function(t,e){"use strict";void 0===t.when.all&&(t.when.all=function(e){var n=new t.Deferred;return t.when.apply(t,e).then(function(){n.resolve(Array.prototype.slice.call(arguments))},function(){n.fail(Array.prototype.slice.call(arguments))}),n}),t.fn.getRotate=function(t){if(t&&t.length){var e,n=window.getComputedStyle(t[0],null),r=n.getPropertyValue("transform")||n.getPropertyValue("-ms-transform")||n.getPropertyValue("-webkit-transform");if(r&&(e=r.match(/matrix3d\(([^\)]+)\)/)))return e=e.split(/\s*,/),Math.round(Math.atan2(e[1],e[0])*(180/Math.PI))}return 0},t.fn.waitAllImg=function(e,n,r){if(this.length){var i=t(this),o=[];return function(e){return e.filter('img[src!=""]').each(function(){o.push(function(e){var n=new t.Deferred,r=new Image;return r.onload=function(){n.resolve(e)},r.onerror=function(){n.reject(new Error("Image not found: "+e.src))},r.src=e.src,n}(this))}),e.filter('video[src!=""]').each(function(){o.push(function(e){var n=new t.Deferred,r=document.createElement("VIDEO");return r.addEventListener("loadedmetadata",function(){n.resolve(e)}),r.addEventListener("error",function(){n.reject(new Error("Video not found: "+e.src))}),r.src=e.src,n}(this))}),t.when.all(o)}(i).then(function(r){t.isFunction(n)&&n!==e&&n.call(r)},function(e){t.isFunction(r)&&r.call(e)}).then(function(){t.isFunction(e)&&e.call(i)}),this}e.call(i)};var n=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement};t.fn.fullScreen=function(t){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)&&(void 0===t?n():void(t?function(t){n()||(t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen&&document.body.msRequestFullscreen())}(this[0]):n()&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen())))}}(jQuery);
var J={ALBUM:"album",FOLDERS:"folders",NAME:"name",PATH:"path",THUMB:"thumb",IMAGE:"image",WIDTH:"width",HEIGHT:"height",ORIGINAL:"original",OBJECTS:"objects",FILEDATE:"fileDate",COMMENT:"comment",TITLE:"title",COUNTERS:"counters",DEEPCOUNTERS:"deepCounters",FILESIZE:"fileSize",CATEGORY:"category",KEYWORDS:"keywords",RATING:"rating",CAMERA:"camera",VIDEO:"video",DURATION:"duration",FPS:"fps",LEVEL:"level",PATHREF:"pathRef",PARENTREF:"parentRef",RELPATH:"relPath",FOLDERTITLE:"folderTitle",IMAGECAPTION:"imageCaption",THUMBCAPTION:"thumbCaption",PHOTODATA:"photodata",LOCATION:"location",REGIONS:"regions",SHOP:"shop",EXTERNAL:"external",PROJECTIONTYPE:"projectionType",DATES:"dates",ADDED:"added",TAKENDATE:"takenDate",MODIFIEDDATE:"modifiedDate",DATERANGE:"dateRange",MOSTPHOTOS:"mostphotos",FOTOMOTOCOLLECTION:"fotomotoCollection",SOUNDCLIP:"soundClip",PANORAMA:"panorama",FILTERS:"filters",SORT:"sort",VISITORRATING:"visitorRating",OBJ:"obj",LOADCOUNTER:"loadcounter",TOTAL:"total",FOLDERINDEX:"folderindex"},JCAMERA=["aperture","exposureTime","originalDate","cameraModel","location","focusDistance","focalLength35mm","cameraMake","resolution","isoEquivalent","flash","focalLength"],Album=function(e,t){var r,n,o,a,l,s={treeFile:"tree.json",dataFile:"data1.json",deepDataFile:"deep-data.json",indexName:"index.html",folderImageFile:"folderimage.jpg",folderImageDims:[1200,800],folderThumbFile:"folderthumb.jpg",folderThumbDims:[600,420],thumbDims:[240,180],thumbsDir:"thumbs",slidesDir:"slides",hiresDir:"hi-res",audioPoster:"audio.poster.png",videoPoster:"video.poster.png",rootPath:"",relPath:"",loadDeep:!1,lazy:!0,possibleTypes:["folder","webPage","webLocation","image","video","audio","other"]},E=getTranslations({and:"and",from:"From {0}"}),u=null,O="",f={},c=[],h=[],p=function(e){console&&e&&DEBUG&&(e.match(/^Error\:/i)?console.error("jalbum-album.js "+e):e.match(/^Warning\:/i)?console.warn("jalbum-album.js "+e):e.match(/^Info\:/i)?console.info("jalbum-album.js "+e):console.log("jalbum-album.js "+e))},T=e=>decodeURIComponent(e.slice(e.lastIndexOf("/")+1)),A=e=>!e.hasOwnProperty(J.FOLDERINDEX)&&e.hasOwnProperty(J.CATEGORY)&&-1!=="image.video.audio.other".indexOf(e[J.CATEGORY]),D=function(){if(arguments.length){for(var e=arguments[0],t=1;t<arguments.length;t++)arguments[t]&&("/"===arguments[t]?e="/":"/"===arguments[t][0]?e+="/"===e.slice(-1)?arguments[t].slice(1):arguments[t]:e+="/"===e.slice(-1)?arguments[t]:"/"+arguments[t]);return e}return""},P=function(e){if(typeof e===UNDEF||!e)return 0;"/"!==e.slice(-1)&&(e+="/");var t=c.indexOf(e);return t>=0?t+1:c.push(e)},y=e=>e.hasOwnProperty(J.PATHREF)&&e[J.PATHREF]?u?D(u,c[e[J.PATHREF]-1]):c[e[J.RELPATH]-1]:u||"",g=function(e){var t=y(e),r=e[J.CATEGORY]||"folder";return"folder"===r?t:"video"===r?t+e[J.VIDEO][J.PATH]:"audio"===r||"other"===r||e.hasOwnProperty(J.ORIGINAL)?t+e[J.ORIGINAL][J.PATH]:"image"===r?t+e[J.IMAGE][J.PATH]:"webPage"===r?t+e[J.NAME]:e[J.PATH]},R=function(e){if(typeof e===UNDEF)return null;if(!e.length)return f;var t,r=f,n=e.split("/");for(t=0;t<n.length;t++)if(!r.hasOwnProperty(J.FOLDERS)||!(r=r[J.FOLDERS].find(function(e){return e[J.PATH]===n[t]})))return null;return t===n.length?r:null},m=function(e){if(typeof e===UNDEF&&(e=o),e===f)return null;var t=function(e){return"number"!=typeof e||e<=0?f:--e>c.length?(p("Error: out of bounds path reference ("+e+")!"),null):R(c[e])}(e[J.PARENTREF]||e[J.PATHREF]);return t===e?null:t},L=e=>"video"===e[J.CATEGORY]?T(e[J.VIDEO][J.PATH]):e.hasOwnProperty(J.ORIGINAL)?T(e[J.ORIGINAL][J.PATH]):e[J.NAME],F=e=>(e=e||o).hasOwnProperty(J.LEVEL)?e[J.LEVEL]:F(m(e)),I=e=>(e||o)[J.TITLE]||"",w=e=>(e||o)[J.NAME]||"",S=e=>((e||o)[J.NAME]||"").replace(/\.\w+$/,"").replace(/_/g," "),C=function(e){var t=0;if((e=typeof e===UNDEF?o:e).hasOwnProperty(J.FOLDERS))if(e.hasOwnProperty(J.DEEPCOUNTERS)&&e[J.DEEPCOUNTERS].hasOwnProperty(J.FOLDERS))t=e[J.DEEPCOUNTERS][J.FOLDERS];else{for(var r=0,n=e[J.FOLDERS].length;r<n;r++)t+=C(e[J.FOLDERS][r]);e.hasOwnProperty(J.DEEPCOUNTERS)||(e[J.DEEPCOUNTERS]={}),e[J.DEEPCOUNTERS][J.FOLDERS]=t}return t+1},N=e=>f.hasOwnProperty(e)?f[e]:null,v=function(t,r){var n={};do{t.hasOwnProperty(r)&&(n=e.extend(!0,{},t[r],n))}while(t=m(t));return Object.getOwnPropertyNames(n).length?n:null},x=function(t,r){if(r.indexOf(".")>=0){if("album"===(r=r.split("."))[0])return N(r[1]);do{if(t.hasOwnProperty(r[0]))return e.extend(!0,{},t[r[0]][r[1]])}while(t=m(t));return null}do{if(t.hasOwnProperty(r))return e.extend(!0,{},t[r])}while(t=m(t));return null},b=function(e,t){if(t)for(var r in e)r===J.OBJECTS||r===J.ALBUM||t.hasOwnProperty(r)||(t[r]=e[r])},M=function(e,t,r){if(e.hasOwnProperty(J.OBJECTS)){t[J.OBJECTS]=[];for(var n,o=0,a=0,i=e[J.OBJECTS].length;o<i;o++)n=e[J.OBJECTS][o],f[J.LOADCOUNTER][n[J.CATEGORY]]++,f[J.LOADCOUNTER][J.TOTAL]++,"folder"===n[J.CATEGORY]?(t[J.FOLDERS]||(t[J.FOLDERS]=[]),b(n,t[J.FOLDERS][a]),r&&M(n,t[J.FOLDERS][a],!0),(n={})[J.FOLDERINDEX]=a,a++):(n[J.PATHREF]=t[J.PATHREF],n[J.RELPATH]=t[J.RELPATH]),t[J.OBJECTS].push(n)}},H=function(t,r){if(t){if(t.hasOwnProperty(J.OBJECTS))return e.isFunction(r)&&r.call(this,t),!0;var n=D(y(t),s.dataFile)+O;h||(h=[]),h.push(e.getJSON(n).done(function(n){b(n,t),M(n,t),e.isFunction(r)&&r.call(this,t)}).fail(function(o,a,i){p('Error loading folder data for "'+n+'": '+a+", "+i),e.isFunction(r)&&r.call(this,t)}))}},U=function(e,t){if(H(e),t&&e.hasOwnProperty(J.FOLDERS))for(var r=0,n=e[J.FOLDERS].length;r<n;r++)U(e[J.FOLDERS][r])},B=function(t,r){var n=new Date,o=D(u||rootPath,s.deepDataFile)+O;return e.getJSON(o).done(function(r){DEBUG&&(p("Deep data loaded: "+(new Date-n)+"ms total: "+f[J.LOADCOUNTER][J.TOTAL]+" objects"),n=new Date),M(r,f,!0),DEBUG&&p("Deep data objects are ready: "+(new Date-n)+"ms total: "+f[J.LOADCOUNTER][J.TOTAL]+" objects"),l=!0,e.isFunction(s.deepReady)&&(s.deepReady.call(this),s.deepReady=null),e.isFunction(t)&&t.call(this)}).fail(function(){l=!1,DEBUG&&p('Error loading deep data: "'+o+'".'),e.isFunction(s.deepReady)&&(s.deepReady.call(this),s.deepReady=null),e.isFunction(r)&&r.call(this)})};return t&&(p("new Album("+JSON.stringify(t)+");"),function(t){if(r)return r;r=new Date,typeof t!==UNDEF&&e.extend(s,t),a=l=!1,s.hasOwnProperty("albumPath")?"/"!==(u=s.albumPath).slice(-1)&&(u+="/"):u="."===s.rootPath?"":s.rootPath,n=function(e){if(typeof e===UNDEF)return window.location.href.substring(0,window.location.href.lastIndexOf("/"));if(e.match(/^https?\:\/\//i))return e;if("/"===e[0])return window.location.origin+e;var t=window.location.href;for(t=t.substring(0,t.lastIndexOf("/"));e.startsWith("../");)t=t.substring(0,t.lastIndexOf("/",t.length-2)),e=e.slice(3);return t+e}(u),s.hasOwnProperty("makeDate")&&(O="?"+s.makeDate);(function(t){var r=D(u||relPath,s.treeFile)+O;e.getJSON(r).done(function(r){(f=r)[J.LOADCOUNTER]={},f[J.LOADCOUNTER][J.TOTAL]=0;for(var n=0;n<s.possibleTypes.length;n++)f[J.LOADCOUNTER][s.possibleTypes[n]]=0;null===(o=R(s.relPath))&&e.isFunction(s.fatalError)&&s.fatalError.call(this,"noSuchFolder",s.relPath),function(){var e=function(t,r,n,a){var i=r?D(n,t[J.PATH]):"",l=r?P(i):0;if(t[J.LEVEL]=r,t.hasOwnProperty(J.CATEGORY)||(t[J.CATEGORY]="folder"),r&&(t[J.PARENTREF]=a),t[J.PATHREF]=l,u||(r?t!==o&&(0===(i+"/").indexOf(n)?t[J.RELPATH]=P(i.substring(n.length+1)):t[J.RELPATH]=P(s.rootPath+i)):t[J.RELPATH]=l),t[J.THUMB][J.PATH].startsWith(t[J.PATH]+"/"+s.thumbsDir)&&(t[J.THUMB][J.PATH]=t[J.THUMB][J.PATH].slice(t[J.PATH].length+1)),t.hasOwnProperty(J.FOLDERS))for(var E=0,O=t[J.FOLDERS].length;E<O;E++)e(t[J.FOLDERS][E],r+1,i,l)};e(f,0,"",0)}(),e.isFunction(t)&&t.call(this)}).fail(function(n,o,a){e.isFunction(s.fatalError)&&s.fatalError.call(this,"databaseAccessDenied",r),e.isFunction(t)&&t.call(this)})})(function(){h=[],U(s.lazy?o:f,!s.lazy),e.when.apply(e,h).done(function(){var t=new Date;DEBUG&&p(h.length+" folder(s) loaded: "+(t-r)+"ms"),a=!0,h=null,e.isFunction(s.ready)&&(s.ready.call(this),s.ready=null),s.loadDeep&&f.hasOwnProperty(J.FOLDERS)?B():e.isFunction(s.deepReady)&&(s.deepReady.call(this),s.deepReady=null)})})}(t)),{isReady:()=>a,isDeepReady:()=>l,getTree:()=>f,getPaths:()=>c,isImage:e=>e.hasOwnProperty(J.CATEGORY)&&"image"===e[J.CATEGORY],isAudio:e=>e.hasOwnProperty(J.CATEGORY)&&"audio"===e[J.CATEGORY],isVideo:e=>e.hasOwnProperty(J.CATEGORY)&&"video"===e[J.CATEGORY],isLightboxable:A,isCurrentFolder:e=>e===o,getAlbumPath:function(){if(u)return u;var e=window.location.pathname,t=o[J.LEVEL];do{e=e.substring(0,e.lastIndexOf("/")),t-=1}while(t>=0);return e},getPath:y,getItemPath:g,getLink:function(e){if(typeof e!==UNDEF){switch(e[J.CATEGORY]){case"folder":return y(e);case"webLocation":return e[J.PATH];case"webPage":return D(y(e),e[J.PATH])}return D(y(e),"#img="+e[J.PATH])}return""},getRootPath:e=>y(e)+e[J.NAME],getFolder:R,getParent:m,getItem:function(e,t){if("function"==typeof t){var r=function(e,t,r){if(e.hasOwnProperty(J.OBJECTS)){var n=e[J.OBJECTS].find(function(e){return e[J.NAME]===t});r.call(n)}};if(e)if(e.endsWith("/"))t.call(R(e));else{var n=e.lastIndexOf("/"),o=R(e.substring(0,n)),a=e.substring(n+1);o&&(o.hasOwnProperty(J.OBJECTS)?r(o,a,t):H(o,function(e){r(e,a,t)}))}else t.call(f);return null}},getCurrentFolder:()=>o,getObjects:()=>o.hasOwnProperty(J.OBJECTS)?o[J.OBJECTS]:[],getImages:function(){var e=[];return o&&o.hasOwnProperty(J.OBJECTS)&&o[J.OBJECTS].forEach(t=>{A(t)&&e.push(t)}),e},getFolders:function(){if(o){if(o.hasOwnProperty(J.FOLDERINDEX)){var e=[];return o[J.FOLDERINDEX].forEach(t=>{e.push(o[J.OBJECTS][t])}),e}if(o.hasOwnProperty(J.FOLDERS))return o[J.FOLDERS]}return[]},getMakeDate:()=>new Date(f[J.FILEDATE]),getAlbumTitle:()=>f[J.TITLE]||f[J.NAME],getItemName:L,getExtension:e=>{var t=L(e).match(/\.(\w+)$/);return t?t[1]:""},getLevel:F,getTitle:I,getName:w,getLabel:S,getAlt:e=>I(e)||w(e),getComment:e=>(e||o)[J.COMMENT]||"",getThumbPath:function(e){var t=e[J.THUMB][J.PATH];return(e=>e.hasOwnProperty(J.LEVEL))(e)&&(t=t.replace(e[J.PATH]+"/","")),D(y(e),t)},getImagePath:e=>D(y(e),e.hasOwnProperty(J.LEVEL)?e[J.THUMB][J.PATH].replace(s.thumbsDir+"/",s.slidesDir+"/"):e[J.IMAGE][J.PATH]),getThemeImagePath:e=>D(y(e),s.folderImageFile),getOriginalPath:e=>e.hasOwnProperty(J.ORIGINAL)?D(y(e),e[J.ORIGINAL][J.PATH]):null,getPosterPath:function(e){var t=e[J.CATEGORY],r=e[J.IMAGE][J.PATH];return"audio"!==t&&"video"!==t||r.startsWith(s.slidesDir+"/")?D(y(e),e[J.IMAGE][J.PATH]):D(rootPath,"res",s[t+"Poster"])},getOptimalImage:function(e,t){var r=y(e[J.RELPATH]);return"folder"===(e[J.CATEGORY]||"folder")?D(r,t[0]>s.folderThumbDims[0]||t[1]>s.folderThumbDims[1]?s.folderImageFile:s.folderThumbFile):D(r,t[0]>s.thumbDims[0]||t[1]>s.thumbDims[1]?e[J.IMAGE][J.PATH]:e[J.THUMB][J.PATH])},getSourcePath:e=>D(y(e),e.hasOwnProperty(J.ORIGINAL)?e[J.ORIGINAL][J.PATH]:e[J.IMAGE][J.PATH]),getAbsoluteItemPath:e=>D(n,g(e)),getVideoDuration:function(e){var t,r=e[J.VIDEO];return r&&r.hasOwnProperty(J.DURATION)&&(t=r[J.DURATION].match(/(\d{2})\:(\d{2})\:(\d{2})\.(\d+)/))?parseInt(t[4])+1e3*parseInt(t[3])+6e4*parseInt(t[2])+36e5*parseInt(t[1]):null},hasShop:e=>{var t=v(e||f,J.SHOP);return t&&(t.usePrice||"-"!==t.options)},hasLocation:e=>e.hasOwnProperty(J.LOCATION)||e.hasOwnProperty(J.CAMERA)&&e[J.CAMERA].hasOwnProperty(J.LOCATION),getLocation:e=>e.hasOwnProperty(J.LOCATION)?e[J.LOCATION]:e.hasOwnProperty(J.CAMERA)&&e[J.CAMERA].hasOwnProperty(J.LOCATION)?e[J.CAMERA][J.LOCATION].lat+","+e[J.CAMERA][J.LOCATION].long:null,getPriceRange:function(e){var t=v(e||f,J.SHOP);if(t&&"-"!==t.options&&t.showPriceRange){var r=t.options.split("::"),n=Number.MAX_VALUE,o=Number.MIN_VALUE;if(r.length>1){for(a=0;a<r.length;a++)n=Math.min(parseFloat(r[a].split("=")[1].split("+")[0]),n);if("minmax"===t.showPriceRange){for(var a=0;a<r.length;a++)o=Math.max(parseFloat(r[a].split("=")[1].split("+")[0]),o);return toCurrency(n,t.currency)+"&ndash;"+toCurrency(o,t.currency)}return E.from.template(toCurrency(n,t.currency))}return toCurrency(r[0].split("=")[1].split("+")[0],t.currency)}return""},getCurrency:()=>N(J.SHOP).currency||"EUR",getDeepFolderCount:C,getRootProperty:N,getInheritedPropertyObject:v,getInheritedProperty:x,getProperty:function(t,r,n){var o;return n?o=x(t,r):r.indexOf(".")>0?(r=r.split("."),o=t.hasOwnProperty(r[0])?t[r[0]][r[1]]:null):t.hasOwnProperty(r)&&(o=t[r]),e.extend(!0,{},o)},getPropertyObject:(t,r,n)=>n?v(t,r):t.hasOwnProperty(r)?e.etxend(!0,{},t[r]):null,getNextFoldersFirstImage:function(e){var t=function(e){typeof e===UNDEF&&(e=o);var t=m(e);if(t){var r;if(t.hasOwnProperty(J.FOLDERINDEX)){if(r=t[J.FOLDERINDEX].findIndex(function(r){return t[J.OBJECTS][r]===e}),i<t[J.FOLDERINDEX].length)return t[J.OBJECTS][t[J.FOLDERINDEX][r+1]]}else if(t.hasOwnProperty(J.FOLDERS)&&(r=t[J.FOLDERS].findIndex(function(t){return t===e}))<t[J.FOLDERS].length)return t[J.FOLDERS][r+1]}return null}();return t&&(t.hasOwnProperty(J.OBJECTS)?e.call(getFirstImage()):H(t,function(){e.call(function(e){if(e.hasOwnProperty(J.OBJECTS))for(var t=e[J.OBJECTS],r=0,n=t.length;r<n;r++)if(A(t[r]))return t[r]}())})),null},getPreviousFoldersLastImage:function(e){var t=function(e){typeof e===UNDEF&&(e=o);var t=m(e);if(t){var r;if(t.hasOwnProperty(J.FOLDERINDEX)){if((r=t[J.FOLDERINDEX].findIndex(function(r){return t[J.OBJECTS][r]===e}))>0)return t[J.OBJECTS][t[J.FOLDERINDEX][r+1]]}else if(t.hasOwnProperty(J.FOLDERS)&&(r=t[J.FOLDERS].findIndex(function(t){return t===e}))>0)return t[J.FOLDERS][r+1]}return null}();return t&&(t.hasOwnProperty(J.OBJECTS)?e.call(getFirstImage()):H(t,function(){e.call(function(e){if(e.hasOwnProperty(J.OBJECTS))for(var t=e[J.OBJECTS],r=t.length-1;r>=0;r--)if(A(t[r]))return t[r]}())})),null},collectNItem:function(t){if(typeof t!==UNDEF&&t.hasOwnProperty("ready")){var t=e.extend({folder:"",levels:0,include:"images",max:0,sortBy:"original",sortOrder:0},t),r=[],n=[],o=R(t.folder),a=t.levels?function(e,t){var r=e[J.LEVEL]+(t||0),n=function(e){var t=0;if(e.hasOwnProperty(J.FOLDERS)&&e[J.LEVEL]<=r)for(var o=0,a=e[J.FOLDERS].length;o<a;o++)t+=n(e[J.FOLDERS][o]);return t+1};return n(e)}(o,t.levels):1,i=0,E=!o&&t.levels>1&&f.hasOwnProperty(J.FOLDERS),u=-1!==t.include.indexOf("images"),O=-1!==t.include.indexOf("folders"),c=function(e){e&&e.hasOwnProperty(J.OBJECTS)&&e[J.OBJECTS].forEach(e=>{A(e)&&r.push(e)})},d=function(e){O&&n.push(e),u&&H(e,c),e[J.LEVEL]<=maxLevel&&e.hasOwnProperty(J.FOLDERS)&&e[J.FOLDERS].forEach(e=>d(e)),i++},p=function(){d(o),setTimeout(D,20)},T=function(){h=[],d(o),setTimeout(function(){h.length?e.when.apply(e,h).done(D):D()},20)},D=function(){t.max&&t.quick&&r.length+n.length>=t.max||i>=a?(P(),e.isFunction(t.ready)&&t.ready.call(r,t)):setTimeout(D,50)},P=function(){switch(t.sortBy){case"original":-1===t.sortOrder?(O&&n.sort(()=>.5-Math.random()),u&&r.sort(()=>.5-Math.random())):1===t.sortOrder&&(O&&n.reverse(),u&&r.reverse());break;case J.FILEDATE:case J.ADDED:case J.TAKENDATE:case J.MODIFIEDDATE:t.sortOrder?(O&&n.sort((e,t)=>t[J.FILEDATE]-e[J.FILEDATE]),u&&r.sort((e,r)=>(r.hasOwnProperty(J.DATES)?r[J.DATES][t.sortBy]:r[J.FILEDATE])-e.hasOwnProperty(J.DATES)?e[J.DATES][t.sortBy]:e[J.FILEDATE])):(O&&n.sort((e,t)=>e[J.FILEDATE]-t[J.FILEDATE]),u&&r.sort((e,r)=>(e.hasOwnProperty(J.DATES)?e[J.DATES][t.sortBy]:e[J.FILEDATE])-r.hasOwnProperty(J.DATES)?r[J.DATES][t.sortBy]:r[J.FILEDATE]));break;case J.NAME:t.sortOrder?(O&&n.sort((e,t)=>(""+t[J.NAME]).localeCompare(""+e[J.NAME])),u&&r.sort((e,t)=>(""+t[J.NAME]).localeCompare(""+e[J.NAME]))):(O&&n.sort((e,t)=>(""+e[J.NAME]).localeCompare(""+t[J.NAME])),u&&r.sort((e,t)=>(""+e[J.NAME]).localeCompare(""+t[J.NAME])));break;case J.FILESIZE:t.sortOrder?u&&r.sort((e,t)=>t[J.FILESIZE]-e[J.FILESIZE]):u&&r.sort((e,t)=>e[J.FILESIZE]-t[J.FILESIZE])}O&&(r=u?"folders,images"===t.include?n.concat(r):r.concat(n):n),t.max&&t.max<r.length&&(r=r.slice(0,t.max))};t.hasOwnProperty("quick")||(t.quick=t.max&&"original"!==t.sortBy),maxLevel=o[J.LEVEL]+t.levels,random=-1===t.sortOrder,random&&(s.sortBy="original"),E&&!l?B(p,T):T()}},collectByDate:function(t){if(typeof t!==UNDEF&&t.hasOwnProperty("range")&&t.hasOwnProperty("ready")){var r,n,a=[],i="current"===(t=e.extend({sort:!0,reverse:!1,reference:"dateTaken",depth:"current"},t)).depth?1:C("tree"===t.depth?f:o),s=0,E="tree"===t.depth&&f.hasOwnProperty(J.FOLDERS)||"subfolders"===t.depth&&o.hasOwnProperty(J.FOLDERS)&&o[J.LEVEL]<3,u=function(e){e&&e.hasOwnProperty(J.OBJECTS)&&(e[J.OBJECTS].forEach(e=>{A(e)&&(d=e[J.DATES])&&(d=d[t.reference])&&d>=r&&d<=n&&a.push(e)}),s++)},O=function(e){var r=typeof e===UNDEF?f:e;H(r,u),"current"!==t.depth&&r.hasOwnProperty(J.FOLDERS)&&r[J.FOLDERS].forEach(e=>O(e))},c=function(){O("tree"===t.depth?f:o),setTimeout(T,20)},p=function(){h=[],O("tree"===t.depth?f:o),setTimeout(function(){h.length?e.when.apply(e,h).done(T):T()},20)},T=function(){i>s?setTimeout(T,20):(D(),e.isFunction(t.ready)&&t.ready.call(a,t))},D=function(){t.sort&&(t.reverse?a.sort((e,r)=>r[J.DATES][t.reference]-e[J.DATES][t.reference]):a.sort((e,r)=>e[J.DATES][t.reference]-r[J.DATES][t.reference])),t.max&&t.max<a.length&&(a=a.slice(0,t.max))};t.hasOwnProperty("end")&&(n=t.end*ONEDAY_S),t.hasOwnProperty("start")&&(r=t.start*ONEDAY_S),t.hasOwnProperty("range")&&(null!==r?n=r+t.range*ONEDAY_S:null!==n?r=n-t.range*ONEDAY_S:(n=Math.round(new Date/1e3),r=n-t.range*ONEDAY_S)),null===r&&(r=0),null===n&&Math.round(new Date/1e3),E&&!l?B(c,p):p()}},collectItems:function(t){if(typeof t!==UNDEF&&t.hasOwnProperty("terms")){var r,n,a=[],i=(t=e.extend({fields:"creator,keywords,title,comment,name",types:"all",depth:"current",exact:!1},t)).fields.split(/,\s?/),u=i.length,O=new Array(u),c=!1,d="all"===t.types,p={},T="current"===t.depth?1:C("tree"===t.depth?f:o),A=0,D="tree"===t.depth&&f.hasOwnProperty(J.FOLDERS)||"subfolders"===t.depth&&o.hasOwnProperty(J.FOLDERS)&&o[J.LEVEL]<3,P=function(t,o){for(var l,s,E=0,f=0;f<u;f++){if(i[f].length>1){if(i[f][0]!==o)continue;l=i[f][1]}else l=i[f][0];JCAMERA.indexOf(l)&&t.hasOwnProperty(J.CAMERA)?typeof(s=t[J.CAMERA][l])===UNDEF&&(s=t[l]):s=t[l],typeof s!==UNDEF&&null!=s&&(e.isArray(s)?s=s.join(" "):s+="",("comment"===l||l.endsWith("Caption"))&&(s=s.stripHTML()),s.searchTerm(r,O[l],c)&&E++)}(c&&E===n||E)&&a.push(t)},y=function(e){if(e){if(e!==f&&(d||p.folder)&&P(e,"folder"),e.hasOwnProperty(J.OBJECTS)){var t;e[J.OBJECTS].forEach(e=>{t=e[J.CATEGORY],(d||p[t])&&P(e,t)})}A++}},g=function(e){var r=typeof e===UNDEF?f:e;H(r,y),"current"!==t.depth&&r.hasOwnProperty(J.FOLDERS)&&r[J.FOLDERS].forEach(e=>g(e))},R=function(){g("tree"===t.depth?f:o),setTimeout(L,20)},m=function(){h=[],g("tree"===t.depth?f:o),setTimeout(function(){h.length?e.when.apply(e,h).done(L):L()},20)},L=function(){T>A?setTimeout(L,20):(F(),e.isFunction(t.ready)&&t.ready.call(a,t))},F=function(){t.max&&t.max<a.length&&(a=a.slice(0,t.max))};'"'===t.terms[0]&&'"'===t.terms[t.terms.length-1]?(r=t.terms.substring(1,t.terms.length-1),!1===t.exact&&(t.exact=!0)):!1===t.exact?~(r=t.terms.replace(/\s+/g,",")).indexOf(","+E.and+",")&&(r=r.replace(new RegExp(","+E.and+",","gi"),","),c=!0):r=t.terms.trim(),r=t.exact?[r]:removeEmpty(r.split(/,\s?/)),n=r.length;for(var I,w=0;w<u;w++)i[w]=i[w].split(":"),I=i[w][1]||i[w][0],O[I]="string"==typeof t.exact?t.exact.indexOf(I)>=0:t.exact;d||("-"===s.types.charAt(0)?s.possibleTypes.forEach(e=>{-1===s.types.indexOf(e)&&(p[e]=!0)}):s.types.split(/,\s?/).forEach(e=>{p[e]=!0})),D&&!l?B(R,m):m()}},collectTags:function(t){var t=e.extend({fields:"creator,keywords,folder:title,webLocation:title",types:"all",depth:"current",exact:"creator,keywords,name"},t),r=[],n=e.isArray(t.fields)?t.fields:t.fields.split(/,\s?/),a=n.length,i="name"===t.sort,l="all"===t.types,E={},u={},O=function(e){for(var t=0,n=!1,o=(e=e.split("^")).length;t<o;t++)if(!(e[t].length<3)){tag=e[t].toUpperCase(),n=!1;for(var a=0,i=r.length;a<i;a++)if(tag===r[a][2]){r[a][1]++,n=!0;break}n||r.push([e[t],1,tag])}},c=function(t,r){for(var o,i,l="^",s="^",E=function(e,t){if(e){var r,n;u[t]?n=[e.toString()]:(("comment"===t||t.endsWith("Caption"))&&(e=e.stripHTML()),n=e.split(/[\s,_\.\?\!\-\(\)\[\]]/),n=removeEmpty(n));for(var o=0,a=n.length;o<a;o++)(r=n[o].trim()).length<=2||-1===s.indexOf("^"+r.toUpperCase()+"^")&&(l+=r+"^",s+=r.toUpperCase()+"^")}},f=0;f<a;f++){if(n[f].length>1){if(n[f][0]!==r)continue;o=n[f][1]}else o=n[f][0];if(JCAMERA.indexOf(o)&&t.hasOwnProperty(J.CAMERA)?typeof(i=t[J.CAMERA][o])===UNDEF&&(i=t[o]):i=t[o],typeof i!==UNDEF&&null!=i)if(e.isArray(i))for(var c=0;c<i.length;c++)E(i[c],o);else E(i,o)}l.length>1&&O(l)},d=function(e){if(e&&(e!==f&&(l||E.folder)&&c(e,"folder"),e.hasOwnProperty(J.OBJECTS)))for(var t,r=0,n=e[J.OBJECTS];r<n.length;r++)n[r].hasOwnProperty(J.CATEGORY)&&(t=n[r][J.CATEGORY],(l||E[t])&&c(n[r],t))},p=function(e){if(H(e,d),"current"!==t.depth&&e.hasOwnProperty(J.FOLDERS))for(var r=0,n=e[J.FOLDERS].length;r<n;r++)p(e[J.FOLDERS][r])},T=function(){t.sort&&r.sort(function(e,t){return i?(""+e[2]).localeCompare(""+t[2]):t[1]-e[1]}),t.max&&t.max<r.length&&(r=r.slice(0,t.max))};h=[];for(var A,D=0;D<a;D++)n[D]=n[D].split(":"),A=n[D][1]||n[D][0],u[A]="string"==typeof t.exact?t.exact.indexOf(A)>=0:t.exact;if(!l)for(var D=0,P=s.types.split(/,\s?/);D<P.length;D++)E[P[D]]=!0;p("tree"===t.depth?f:o),e.isFunction(t.ready)&&(h.length?e.when.apply(e,h).done(function(){T(),t.ready.call(r,t)}):(T(),t.ready.call(r,t)))},processTemplate:function(e,t,r){var n,a,i,l,s=typeof r!==UNDEF&&r,t=t||o,E=e=>"label"===e?S(t):stringVal(t[e]);if(e&&e.indexOf("${")>0)for(;i=e.match(/\$\{([\w\.|]+)\}/);){if(i[1].indexOf("|")>0)for(var u=0,O=i[1].split("|");u<O.length&&!(l=E(O[u]));u++);else l=E(i[1]);e=null===l&&s&&(n=i.index-1,a=n+i[0].length,n>0&&">"===e[n]&&a<sb.length-1&&"<"===e[a]&&(n=e.lastIndexOf("<",n),a=e.indexOf(">",a),n>=0&&a>=0))?e.slice(0,n)+e.slice(a):e.slice(0,i.index)+(l||"")+e.slice(i.index+i[0].length)}return e}}};
!function(t,e,n,a,s){"use strict";var i="jalbum-projector.js",r=function(t){console&&t&&DEBUG&&(t.match(/^Error\:/i)?console.error(i+" "+t):t.match(/^Warning\:/i)?console.warn(i+" "+t):t.match(/^Info\:/i)?console.info(i+" "+t):console.log(i+" "+t))},o=function(t){return t*(1-2*Math.random())};t.fn.jalbum=function(n){n=t.extend({},t.fn.jalbum.defaults,n);var s={projector:"projector",prev:"jprev",next:"jnext",jalbum:"jalbum",cards:"jcards",card:"jcard",caption:"jcaption",title:"jtitle",hasCaption:"jhascaption",imageReady:"jimageready",prevPage:"jprevpg",nextPage:"jnextpg",currPage:"jcurrpg",paging:"jpaging",shade:"jshade",threedee:"threedee",error:"jerror"};return t(this).each(function(){var i,l,c,d,p,m,u,f,h,g,w,y=t(this),v=y.parents(".jalbum-preview").length,b=y.attr("data-jalbum")?t.extend({},n,JSON.parse(y.attr("data-jalbum"))):n,T=y.attr("data-jalbum-texts")?t.extend({},t.fn.jalbum.text,JSON.parse(y.attr("data-jalbum-texts"))):t.fn.jalbum.text,A=y.data("jalbum-ns"),x=t(),M=(t(),t()),E=[],I=[],F=-1,j=0,k=(t(),null),q=null,H=!1,P=function(t){b.opennew?p?(p.location=t,p.focus()):p=window.open(t,"_blank"):window.location.href=t},C=function(){var t=y.css("paddingBottom");l=y.outerWidth(),c=y.outerHeight()||.75*l,t.endsWith("%")&&(c+=l*parseInt(t)/100),y.removeClass("landscape portrait").addClass(l>c?"landscape":"portrait")},D=function(){var t;if(clearTimeout(w),!(j<2)){if("random"===m)do{t=Math.floor(Math.random()*E.length)}while(t===F);else t=(F+1)%j;"coverflow"===b.transition?z(t,1):z(t),w=setTimeout(D,b.slideshowdelay+b.transitionspeed)}},O=function(){var e=0;clearTimeout(q),M.find("."+s.card).each(function(n){var a=t(this);if(a.data("fitted"))return e++,!0;var s=a.children("img");if(!s.length)return!0;var i,r=a.outerWidth()||M.outerWidth(),o=a.outerHeight()||M.outerHeight(),l=s[0].naturalWidth||s.width(),c=s[0].naturalHeight||s.height();if(!(l&&c&&r&&o))return!0;r/l>o/c!=("fit"===b.fit)?(i=r/l,s.css({left:0,top:(o-c*i)/2,width:"100%"})):(i=o/c,s.css({top:0,left:(r-l*i)/2,height:"100%"})),a.data("fitted",!0),e++}),M.find("."+s.card).length>e&&(q=setTimeout(O,100))},W=function(e){var n=e?(e instanceof jQuery?e:t(e.target)).closest("."+s.card):M.find("#c"+F),a=function(){return[n.outerWidth()||M.outerWidth(),n.outerHeight()||M.outerHeight()]},i=function(t){if(t&&t.length){var e=t.children("img");window.getComputedStyle(t[0],null),e.length&&window.getComputedStyle(e[0],null)}};if(n.addClass(s.imageReady),O(),h){var r=n.prevAll(),l=null,c=function(e){clearTimeout(l);var a=new Date,i=e?t(this).closest("."+s.card):n.prevAll(),r=i.data("ts")||i.children("."+s.card).data("ts");i.length&&(isNaN(r)||a-r<.9*b.transitionspeed||(i.parent().hasClass(s.prevPage)?i.parent().remove():"coverflow"===b.transition?i.not(n.prev()).remove():i.remove()))};switch(M.removeClass("bwd").addClass("fwd"),"carousel"!==b.transition&&("coverflow"===b.transition?n.prev().prev().prevAll().remove():n.prev().prevAll().remove(),r=n.prevAll()),r.data("ts",new Date),i(n),b.transition){case"crossfade":if(r.length){var d=function(){n.css({opacity:0,transition:"none"}),window.requestAnimationFrame(p)},p=function(){n.css({opacity:1,transition:"opacity "+b.transitionspeed+"ms ease-in-out"}),r.one("transitionend",c).css({opacity:0}),l=setTimeout(c,b.transitionspeed+20)};window.requestAnimationFrame(d)}else window.requestAnimationFrame(function(){n.show().css({opacity:1,transition:"opacity "+b.transitionspeed+"ms ease-in-out"})});break;case"zoom":if(r.length){var d=function(){n.show().css({opacity:0,transform:"scale(0.9)",transition:"none"}),window.requestAnimationFrame(p)},p=function(){n.css({opacity:1,transform:"scale(1)",transition:"transform "+b.transitionspeed+"ms ease-out, opacity "+b.transitionspeed+"ms ease-in-out"}),r.one("transitionend",c).css({opacity:0,transform:"scale(1.11)",transition:"transform "+b.transitionspeed+"ms ease-out, opacity "+b.transitionspeed+"ms ease-in-out"}),l=setTimeout(c,b.transitionspeed+20)};window.requestAnimationFrame(d)}else window.requestAnimationFrame(function(){n.show().css({transform:"scale(1)",opacity:1})});break;case"stack":if(r.length){var m=a(),u=((v=o(60))+90)/180*Math.PI,f=Math.min(m[0],m[1])/4,d=function(){n.css({opacity:0,transform:"scale(0.92)",transition:"none"}),window.requestAnimationFrame(p)},p=function(){n.css({opacity:1,transform:"scale(1)",transition:"transform "+b.transitionspeed+"ms ease-out, opacity "+b.transitionspeed/2+"ms linear"}),r.one("transitionend",c).css({opacity:0,transform:"rotate("+(0-v/10)+"deg) translate("+Math.round(f*Math.cos(u))+"px,"+1*Math.round(0-f*Math.sin(u))+"px)",transition:"transform "+b.transitionspeed+"ms ease-out, opacity "+b.transitionspeed/2+"ms linear"}),l=setTimeout(c,b.transitionspeed+20)};window.requestAnimationFrame(d)}else window.requestAnimationFrame(function(){n.show().css({opacity:1,transform:"scale(1)",transition:"opacity "+Math.min(b.transitionspeed/2,500)+"ms linear"})});break;case"kenburns":var m=a(),g=n.children("img").eq(0),y=1.14+o(.2),v=o(1)*Math.PI,f=(Math.random()+.2)*Math.min(m[0],m[1])*.08,T=Math.round(f*Math.cos(v)),A=Math.round(f*Math.sin(v)),d=function(){n.data({sc:y>1.14?y-.2:y+.2,dx:-T,dy:-A}),g.css({transform:"translate("+T+"px,"+A+"px) scale("+y+")",transition:"none"}).show(),window.requestAnimationFrame(p)},p=function(){n.css({opacity:1,transition:"opacity "+b.transitionspeed+"ms linear"}),g.css({transform:"scale("+(y>1.14?y-.1:y+.1)+") translate(0,0)",transition:"transform "+b.transitionspeed+"ms linear"}),r.length&&(g=r.children("img").eq(0),r.css({opacity:0,transition:"opacity "+b.transitionspeed+"ms linear"}),g.one("transitionend",c).css({transform:"scale("+r.data("sc")+") translate("+r.data("dx")+"px,"+r.data("dy")+"px)"}),l=setTimeout(c,b.transitionspeed+20))};window.requestAnimationFrame(d);break;case"slide":if(r.length){var x=function(t){if(t.length>0){for(var e=[],n=0;n<t.length;n++)switch(t[n].toLowerCase()){case"e":e.push([1,0]);break;case"s":e.push([0,1]);break;case"w":e.push([-1,0]);break;case"n":e.push([0,-1])}return 1===e.length?e[0]:e.length>1?e[Math.floor(Math.random()*e.length)]||[1,0]:[1,0]}return Math.random()>=.5?[Math.random()>=.5?1:-1,0]:[0,Math.random()>=.5?1:-1]}(b.direction||""),m=a(),d=function(){n.show().css({opacity:.7,transform:"translate("+x[0]*m[0]+"px,"+x[1]*m[1]+"px)",transition:"none"}),r.css({transition:"none"}),window.requestAnimationFrame(p)},p=function(){n.css({opacity:1,transform:"translate(0,0)",transition:"transform "+b.transitionspeed+"ms ease-in-out, opacity "+b.transitionspeed+"ms ease-out"}),r.one("transitionend",c).css({opacity:.7,transform:"translate("+(0-x[0]*m[0])+"px,"+(0-x[1]*m[1])+"px)",transition:"transform "+b.transitionspeed+"ms ease-in-out, opacity "+b.transitionspeed+"ms ease-out"}),l=setTimeout(c,b.transitionspeed+20)};window.requestAnimationFrame(d)}else window.requestAnimationFrame(function(){n.show().css({opacity:1,transition:"opacity "+Math.min(b.transitionspeed,1e3)+"ms ease-out"})});break;case"swap":if(r.length){var m=a(),d=function(){n.css({zIndex:0,opacity:0,transform:"scale(0.7) translate(0,-40px)",transition:"none"}).show(),r.css({zIndex:1,opacity:1,transition:"none"}),window.requestAnimationFrame(p)},p=function(){n.css({opacity:1,transform:"scale(0.85) translate("+m[0]/2+"px,-40px)",transition:"transform "+b.transitionspeed/2+"ms ease-in-out, opacity "+b.transitionspeed/2+"ms linear"}).one("transitionend",function(){window.requestAnimationFrame(E)}),r.css({transform:"scale(0.7) translate("+(0-.55*m[0])+"px,20px)",transition:"transform "+b.transitionspeed/2+"ms ease-in-out, opacity "+b.transitionspeed/2+"ms linear"}),l=setTimeout(c,b.transitionspeed+30)},E=function(){n.css({zIndex:1,transform:"scale(1) translate(0,0)"}),r.css({zIndex:0,opacity:0,transform:"scale(0.49) translate(0,40px)"}).one("transitionend",c)};window.requestAnimationFrame(d)}else window.requestAnimationFrame(function(){n.css({zIndex:1,opacity:0,transform:"scale(0.85)",transition:"none"}).show(),window.requestAnimationFrame(function(){n.css({opacity:1,transform:"scale(1)",transition:"transform "+Math.min(b.transitionspeed/2,500)+"ms ease-in-out, opacity "+Math.min(b.transitionspeed/2,500)+"ms linear"})})});break;case"carousel":var m=a(),I=M.children().index(n),f=Math.round(m[0]/(2*Math.tan(Math.PI/j))),u=Math.round(m[0]/(2*Math.sin(Math.PI/j))),v=360/j;if(M.data("initialized")){p=function(){I=Math.floor((M.data("num")||0)/j)*j+(I||j),M.data("num",I).css({transform:"translateZ(-"+u+"px) rotateY(-"+I*v+"deg)",transition:"transform "+b.transitionspeed+"ms"}).children().css({opacity:BACKFACEBUG?.9:.6}),n.css({opacity:1})};window.requestAnimationFrame(p)}else{d=function(){M.css({transform:"translateZ(-"+u+"px) rotateY(0)",transition:"none"}),M.children().each(function(e){t(this).css({backfaceVisibility:"visible",opacity:e===I?1:BACKFACEBUG?.9:.6,transform:"rotateY("+e*v+"deg) translateZ("+f+"px)",transition:"none"}).show()}),M.data({num:0,initialized:!0}),window.requestAnimationFrame(function(){M.css({transition:"transform "+b.transitionspeed+"ms"}),M.children().css({backfaceVisibility:"hidden",transition:"opacity "+b.transitionspeed+"ms ease-out"})})};window.requestAnimationFrame(d)}break;case"flip":if(r.length){var d=function(){n.css({opacity:0}).show().css({transition:"opacity "+b.transitionspeed+"ms"}),window.requestAnimationFrame(p)},p=function(){r.css({opacity:0}),n.css({opacity:1}),M.css({transform:"rotateY(-180deg)",transition:"transform "+b.transitionspeed+"ms"}).on("transitionend",function(t){window.requestAnimationFrame(k)}),l=setTimeout(k,b.transitionspeed+20)},k=function(){c(),M.css({transition:"none",transform:"rotateY(0)"})};window.requestAnimationFrame(d)}else window.requestAnimationFrame(function(){n.show().css({opacity:1,transition:"opacity "+Math.min(b.transitionspeed,1e3)+"ms"})});break;case"book":M.children("."+s.paging).remove();var J,q,H,P,C,W,z,N=M.width(),B=N/2,d=function(){M.children("."+s.prevPage).length&&M.find("."+s.prevPage+" ."+s.card).unwrap(),r.css({width:N,left:0}).wrap(J=t("<div>",{class:s.prevPage})),n.css({opacity:1,width:N,left:-B}).wrap(q=t("<div>",{class:s.nextPage})).show(),H=t("<div>",{class:s.paging}).appendTo(M),P=r.clone().css({left:"-100%"}).appendTo(H),C=n.show().clone().css({opacity:1}).appendTo(H),W=t("<div>",{class:s.shade}).appendTo(P),z=t("<div>",{class:s.shade}).hide().appendTo(C),H.show().css({transition:"transform "+b.transitionspeed/2+"ms linear"}).data("ts",new Date),window.requestAnimationFrame(p)},p=function(){W.css({transition:"opacity "+b.transitionspeed/2+"ms ease-in",opacity:.75}),H.one("transitionend",function(){window.requestAnimationFrame(E)}).css({transform:"rotateY(-90deg)"}),l=setTimeout(k,b.transitionspeed+30)},E=function(){P.hide(),C.css("backface-visibility","visible").show(),H.one("transitionend",function(t){window.requestAnimationFrame(k)}).css({transform:"rotateY(-180deg)"}),z.show().css({transition:"opacity "+b.transitionspeed/2+"ms ease-out",opacity:0})},k=function(){H&&H.remove(),n.parent().hasClass(s.nextPage)&&n.unwrap("."+s.nextPage).css("left",0),c()};r.length?window.requestAnimationFrame(d):window.requestAnimationFrame(function(){n.show().css({opacity:1,transition:"opacity "+Math.min(b.transitionspeed,500)+"ms"})});break;case"cube":var m=a(),f=Math.round(m[1]/2),d=function(){n.css({opacity:1,zIndex:9999,backgroundColor:"#666"}).show(),window.requestAnimationFrame(p)},p=function(){n.css({transform:"rotateX(270deg) translateZ("+f+"px)"}),M.css({transform:"translateZ("+f+"px) rotateX(0)"}).on("transitionend",function(t){window.requestAnimationFrame(k)}).css({transition:"transform "+b.transitionspeed+"ms",transform:"translateZ(-"+f+"px) rotateX(90deg)"}),l=setTimeout(k,b.transitionspeed+30)},k=function(){r.remove(),M.css({transition:"none",transform:"translateZ(-"+f+"px) rotateX(0)"}),n.css({zIndex:0,transform:"rotateX(0) translateZ("+f+"px)"})};window.requestAnimationFrame(d);break;case"coverflow":var U=n.next(),S=n.prev(),Y=S.prev(),f=a()[0]/8,G=null;d=function(){Y.css({zIndex:0}),n.css({zIndex:2}),S.length||n.css({opacity:1,transform:"scale(0.5) translate3d("+f*b.coverflowFactor[0]+"px,0,-"+2*f+"px) rotateY(-86deg)"}).show(),U.css({zIndex:1,opacity:0,transform:"scale(0.4) translate3d("+f*b.coverflowFactor[1]+"px,0,-"+3*f+"px) rotateY(-120deg)"}).show().css({willChange:"transform, opacity"}),n.add(S).css({opacity:1,transition:"transform "+b.transitionspeed+"ms ease-in-out"}),U.add(Y).css({transition:"transform "+b.transitionspeed+"ms ease-in-out, opacity "+b.transitionspeed+"ms linear"}),window.requestAnimationFrame(p)},p=function(){S.on("transitionend",function(){Y.remove()}).css({transform:"scale(0.5) translate3d(-"+f*b.coverflowFactor[0]+"px,0,-"+2*f+"px) rotateY(86deg)"}),U.css({opacity:1,transform:"scale(0.5) translate3d("+f*b.coverflowFactor[0]+"px,0,-"+2*f+"px) rotateY(-86deg)"}),n.css({opacity:1,transform:"scale(0.75) translate3d(0,0,0) rotateY(0)"}),Y.css({opacity:0,transform:"scale(0.4) translate3d(-"+f*b.coverflowFactor[1]+"px,0,-"+3*f+"px) rotateY(120deg)"}),G=setTimeout(function(){clearTimeout(G),window.requestAnimationFrame(E)},.5*b.transitionspeed)},E=function(){n.css({zIndex:3}),S.css({zIndex:1})},window.requestAnimationFrame(d)}w=setTimeout(D,b.slideshowdelay+b.transitionspeed)}else i(n),n.css({opacity:0,transform:"translateY(-20px) scale(1.2)"}).show().css({transition:"transform 300ms cubic-bezier(0.175, 0.885, 0.32, 1.275), opacity 300ms linear"}).css({opacity:1,transform:"translateY(0) scale(1)"})},z=function(e,n){"random"===m?F=e:(F=e%j,n=n?Math.min(n,j-F):0);var r=function(e,n){if(e>=E.length)return t();var a,r,o=t("<div>",{id:"c"+e,class:s.card+" "+(E[e][J.CATEGORY]||"folder")+" "+(h?b.transition:"")}).appendTo(M),l=t("<img>").appendTo(o);if("masonry"===b.type&&o.css(I[e]),o.css("opacity",0),a=o.outerWidth()||M.outerWidth(),r=o.outerHeight()||M.outerHeight(),b.captiontemplate){var c=t("<div>",{class:s.caption+" "+b.captionplacement+" "+b.captionstyle,html:i.processTemplate(b.captiontemplate,E[e],b.removeEmptyTags)}).appendTo(o);c.is(":empty")||!c.text()?c.remove():b.removeEmptyTags?c.children(":empty").remove():o.addClass(s.hasCaption)}return o.on("click."+A,function(e){var n=parseInt(t(this).attr("id").substring(1));if(f||isNaN(n)||F===n){if(!b.disablelinks){if("A"===e.target.nodeName&&t(e.target).parents("."+s.caption).length)return!0;P(b.linktoindex?d:i.getLink(E[n]))}}else z(n)}),t.isFunction(n)&&l.one("load",n),l.attr("src",a>E[e][J.THUMB][J.WIDTH]||r>E[e][J.THUMB][J.HEIGHT]?i.getImagePath(E[e]):i.getThumbPath(E[e])),l},o=function(e){if(E&&E.length>e){t("<img>").appendTo(a).hide().attr("src",E[e][J.IMAGE]&&(M.outerWidth()>E[e][J.THUMB][J.WIDTH]||M.outerHeight()>E[e][J.THUMB][J.HEIGHT])?i.getImagePath(E[e]):i.getThumbPath(E[e])).one("load",function(){t(this).remove()})}};if(w=clearTimeout(w),n){for(var l=0;l<=n;l++)M.children("#c"+(e+l)).length||r((e+l)%j);M.waitAllImg(null,W),o((e+l)%j)}else{var c=M.children("#c"+e);if(c.length){var p=c.find("img");p.length&&0!==p[0].naturalWidth&&p[0].complete?W(p):p.one("load",W)}else r(e,W);f||o((e+1)%j)}},N=function(){if(b.hasOwnProperty("layout")){if("grid"===b.type){if((e=b.layout.match(/grid-(\d)-(\d)/))&&e.length>2)return parseInt(e[1])*parseInt(e[2])}else if("mosaic"===b.type){var e=b.layout.match(/mos-(\d)-(\d)(-(\d))?/);if(e&&e.length>2)return parseInt(e[1])+parseInt(e[2])+(e[4]?parseInt(e[4]):0)}return parseInt(b.layout)||t.fn.jalbum.defaults.numberofcards[b.type]}return t.fn.jalbum.defaults.numberofcards[b.type]},B=function(){if(!(j<2)){for(var t,e=l/c,n=[],a=function(t){var e=E[t];return e?e.hasOwnProperty(J.IMAGE)?e[J.IMAGE][J.WIDTH]/e[J.IMAGE][J.HEIGHT]:e[J.THUMB][J.WIDTH]/e[J.THUMB][J.HEIGHT]:(r("Item "+t+" is missing! (max "+E.length+")"),1)},s=0,i=0;s<j;s++)i+=n[s]=a(s);if(i>1.5*e){var o=Math.ceil(1/Math.sqrt(e/i));t=new Array(o);for(var s=0,d=0;s<j;s++)void 0===t[m=Math.floor(o*(d+n[s]/2)/i)]&&(t[m]=new Array),t[m].push(s),d+=n[s];for(m=0;m<o;m++)t[m]||(t.splice(m,1),o--);for(var p,m=0;m<o;m++){for(u=0,h=t[m].length,s=0;s<h;s++)u+=n[t[m][s]];for(s=0;s<h;s++)p=t[m][s],I[p]={width:100*n[p]/u+"%",height:c/o/u}}for(var u=0,m=0;m<o;m++)u+=I[t[m][0]].height;u=c/u;for(var f,m=0;m<o;m++){f=Math.round(I[t[m][0]].height*u);for(var s=0,h=t[m].length;s<h;s++)I[t[m][s]].height=f}}else{u=e/i;for(s=0;s<j;s++)E[s].targetWidth=100*n[s]*u+"%",E[s].targetHeight=c}}},U=function(){"masonry"===b.type&&(B(),M.find("."+s.card).each(function(e){var n=t(this);n.css(I[e]);var a=n.outerWidth(),s=n.outerHeight();n.find("img").eq(0).attr("src",a>E[e][J.THUMB][J.WIDTH]||s>E[e][J.THUMB][J.HEIGHT]?i.getImagePath(E[e]):i.getThumbPath(E[e]))}))},S=function(){H||(function(t){var n=e.scrollTop(),a=t.offset().top;return!(a>=n+e.height()||a+t.outerHeight()<=a)}(y)?function(){var t=null,e=function(n){clearTimeout(t),z(n),n<j-1&&(t=setTimeout(e,100,n+1))};E.length<j&&(j=E.length),M.addClass("max-"+j),f?("masonry"===b.type&&B(),e(0)):"carousel"===b.transition?z(0,j):"coverflow"===b.transition?z(0,1):z(0),H=!0}():setTimeout(S,200))},Y=function(t,e){var n=Math.min(t.length,e);if(b.skipduplicates){for(var a,s=[],i=[],r=0;r<t.length;r++)if((a=t[r][J.THUMB][J.PATH].getFile())&&-1===i.indexOf(a)){if(s.push(t[r]),s.length>=n)return s;i.push(a)}return s}return t.splice(0,n)},G=function(t,e){switch(m){case"name":return(e[J.TITLE]||e[J.NAME]||"").localeCompare(t[J.TITLE]||t[J.NAME]||"");case"date-reverse":return(e.hasOwnProperty(J.DATES)?e[J.DATES][J.TAKENDATE]:e[J.FILEDATE])||0-(t.hasOwnProperty(J.DATES)?t[J.DATES][J.TAKENDATE]:t[J.FILEDATE])||0;case"date":return(t.hasOwnProperty(J.DATES)?t[J.DATES][J.TAKENDATE]:t[J.FILEDATE])||0-(e.hasOwnProperty(J.DATES)?e[J.DATES][J.TAKENDATE]:e[J.FILEDATE])||0}},L=function(){(E="random"===n.ordering?function(t,e){var n=[],a=Math.min(t.length,e);if(b.skipduplicates)for(var s,i,r="",o=0;o<a;o++){if(n.length>=a||!t.length)return n;for(i=0;i<t.length;i++)if(l=Math.floor(Math.random()*t.length*.999),(s=t[l][J.THUMB][J.PATH].getFile())&&-1===r.indexOf(":"+s+":")){n.push(t.splice(l,1)[0]),r+=":"+s+":";break}}else for(var l,o=0;o<a;o++)l=Math.floor(Math.random()*t.length*.999),n.push(t.splice(l,1)[0]);return n}(this,j):"original"!==n.ordering?function(t,e){var n=Math.min(t.length,e);return t.length<2?t:(t.sort(G),Y(t,n))}(this,j):Y(this,j)).length&&S(),b.titletemplate&&(x=t("<div>",{class:s.title+" "+b.titleplacement+" "+b.titlestyle+(b.disablelinks?"":" linked"),html:i.processTemplate(b.titletemplate,void 0,b.removeEmptyTags)}).appendTo(y),b.removeEmptyCaption&&x.children(":empty").remove(),b.disablelinks||x.find("h1,h2,h3,h4,h5,h6").on("click",function(){P(d)})),e.on("resize."+A+" orientationchange."+A,function(){clearTimeout(k),C(),k=setTimeout(U,100)}),h&&(w=setTimeout(D,b.slideshowdelay+b.transitionspeed))},Z=function(){!b.folder||i.getFolder(b.folder)?E=i.collectNItem({folder:b.folder,levels:b.depth,include:b.include,max:j,sortBy:m,sortOrder:u,ready:L}):r('Invlaid folder: "'+b.folder+'"')},K=function(e,n){var a=t("<div>").css({position:"absolute",width:"80%",maxWidth:"600px",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",padding:".5rem 1rem",backgroundColor:"#900",color:"#eee"}).append(t("<h4>",{text:T.error})).append(t("<p>",{html:(T[e||"unknownError"]||T.unknownError).template(n||"?")})).appendTo(y.empty());v||setTimeout(function(){a.fadeOut(function(){a.remove()})},6e3)};if(typeof Album===UNDEF)return K("missingLibrary","jalbum-album.js"),void r("Critical Error: Missing jalbum-album.js library!");b.hasOwnProperty("albumurl")?(typeof A!==UNDEF&&(y.off("."+A),y.empty(),y.removeClass()),function(){j=N(),f="masonry.grid.mosaic.strip".indexOf(b.type)>=0,h="slideshow.slider".indexOf(b.type)>=0,g=!f&&"carousel.flip.book.cube.coverflow".indexOf(b.transition)>=0,v&&(b.disablelinks=!0),C();var e=[s.jalbum,b.type];if(f?(e.push("grid-like"),b.gap&&e.push("gap-"+b.gap)):(e.push("slider-like"),e.push(b.transition)),g&&e.push(s.threedee),A="jalbum-"+Math.floor(1e4*Math.random()),y.data("jalbum-ns",A).attr("id",A).addClass(e.join(" ")),M=t("<div>").appendTo(y),e=[s.cards],h&&e.push(b.transition),"grid"!==b.type&&"mosaic"!==b.type||!b.hasOwnProperty("layout")||e.push(b.layout),M.addClass(e.join(" ")),b.hasOwnProperty("slideshowdelay")?"number"!=typeof b.slideshowdelay&&(b.slideshowdelay=parseInt(b.slideshowdelay)):b.slideshowdelay=t.fn.jalbum.defaults.timings[b.transition||"slide"][0],b.hasOwnProperty("transitionspeed")?"number"!=typeof b.transitionspeed&&(b.transitionspeed=parseInt(b.transitionspeed)):b.transitionspeed=t.fn.jalbum.defaults.timings[b.transition||"slide"][1],b.hasOwnProperty("layout")?"grid"!==b.type&&"mosaic"!==b.type&&"number"!=typeof b.layout&&(b.layout=parseInt(b.layout)):b.layout=t.fn.jalbum.defaults.layouts[b.type||"grid"],"number"!=typeof b.depth&&(b.depth=parseInt(b.depth)||2),b.hasOwnProperty("skipduplicates")&&(b.skipduplicates="false"!==b.skipduplicates||1==b.skipduplicates),b.hasOwnProperty("ordering")){var n=b.ordering.split("-");u="reverse"===n[1]?1:0,"date"===n[0]?m=J.TAKENDATE:"name"===n[0]?m=J.NAME:"size"===n[0]?m=J.FILESIZE:u="random"===b.ordering?-1:0}b.albumurl=b.albumurl.replace(/\\\//g,"/").replace(/\/$/,""),b.albumurl.endsWith("/")||(b.albumurl+="/"),"https:"===location.protocol&&b.albumurl.startsWith("http:")&&(b.albumurl=b.albumurl.replace(/^http/,"https")),b.hasOwnProperty("folder")?(b.folder=b.folder+"",b.folder.startsWith("/")&&(b.folder=b.folder.substring(1)),b.depth+=b.folder.split("/").length):b.folder="",d=b.albumurl+b.folder,i=new Album(t,{albumPath:b.albumurl,relPath:b.folder,ready:Z,fatalError:K})}()):r("Error: no album URL provided!")})},t.fn.jalbum.defaults={type:"slideshow",transition:"slide",folder:"",depth:2,quickdiscovery:!1,include:"images",exclude:"webPage,webLocation",skipduplicates:!0,disablelinks:!1,linktoindex:!1,fit:"cover",maxzoom:1.25,autoplay:!0,numberofcards:{slideshow:12,slider:3,masonry:17,grid:12,mosaic:4,strip:6},timings:{crossfade:[1e3,2e3],zoom:[1e3,2e3],kenburns:[0,4e3],stack:[1500,1500],slide:[1500,1500],swap:[2e3,1e3],carousel:[2e3,1e3],flip:[2e3,1e3],book:[2e3,1e3],cube:[2e3,1e3],coverflow:[2e3,1e3]},layouts:{slideshow:12,grid:"grid-4-3",masonry:17,mosaic:"mos-1-3",strip:6},coverflowFactor:[6.4,12.4],gap:"",selecteditems:!1,ordering:"original",showDots:!1,titletemplate:"",titleplacement:"center top",titlestyle:"white",captiontemplate:"",captionplacement:"center bottom",captionstyle:"dark",removeEmptyTags:!0},t.fn.jalbum.text={error:"Error",databaseAccessDenied:'The album\'s database file "{0}" is missing or access is denied. If the album comes from an external site ensure Cross Origin Resource Sharing (CORS) is enabled!',noSuchFolder:'The given folder "{0}" does not exists, or its database file is missing!',missingLibrary:'Missing "{0}" library!',unknownError:"Unknown error: {0}"},n.ready(function(){t("[data-jalbum]").jalbum()})}(jQuery,jQuery(window),jQuery(document),jQuery("body"));
"use strict";!function(r){var n={init:function(a){return this.each(function(){n.destroy.call(this),this.opt=r.extend(!0,{},r.fn.raty.defaults,a);var t=r(this);n._callback.call(this,["number","readOnly","score","scoreName"]),this.opt.precision&&n._adjustPrecision.call(this),this.opt.number=n._between(this.opt.number,0,this.opt.numberMax),this.stars=n._createStars.call(this),this.score=n._createScore.call(this),n._apply.call(this,this.opt.score),this.opt.cancel&&(this.cancel=n._createCancel.call(this)),this.opt.width&&t.css("width",this.opt.width),this.opt.readOnly?n._lock.call(this):(t.css("cursor","pointer"),n._binds.call(this)),n._target.call(this,this.opt.score),t.data({settings:this.opt,raty:!0})})},_adjustPrecision:function(){this.opt.targetType="score",this.opt.half=!0},_apply:function(t){void 0!==t&&0<=t&&(t=n._between(t,0,this.opt.number),this.score.val(t)),n._fill.call(this,t),t&&n._roundStars.call(this,t)},_between:function(t,a,e){return Math.min(Math.max(parseFloat(t),a),e)},_binds:function(){this.cancel&&n._bindCancel.call(this),n._bindClick.call(this),n._bindOut.call(this),n._bindOver.call(this)},_bindCancel:function(){n._bindClickCancel.call(this),n._bindOutCancel.call(this),n._bindOverCancel.call(this)},_bindClick:function(){var a=this,e=r(a);a.stars.on("click.raty",function(t){a.score.val((a.opt.half||a.opt.precision?e:r(this)).data("score")),a.opt.click&&a.opt.click.call(a,parseFloat(a.score.val()),t)})},_bindClickCancel:function(){var a=this;a.cancel.on("click.raty",function(t){a.score.removeAttr("value"),a.opt.click&&a.opt.click.call(a,null,t)})},_bindOut:function(){var e=this;r(this).on("mouseleave.raty",function(t){var a=parseFloat(e.score.val())||void 0;n._apply.call(e,a),n._target.call(e,a,t),e.opt.mouseout&&e.opt.mouseout.call(e,a,t)})},_bindOutCancel:function(){var a=this;a.cancel.on("mouseleave.raty",function(t){r(this).attr("class",a.opt.cancelOff),a.opt.mouseout&&a.opt.mouseout.call(a,a.score.val()||null,t)})},_bindOverCancel:function(){var a=this;a.cancel.on("mouseover.raty",function(t){r(this).attr("class",a.opt.cancelOn),a.stars.attr("class",a.opt.starOff),n._target.call(a,null,t),a.opt.mouseover&&a.opt.mouseover.call(a,null)})},_bindOver:function(){var i=this,o=r(i),t=i.opt.half?"mousemove.raty":"mouseover.raty";i.stars.on(t,function(t){var a,e,s=parseInt(r(this).data("score"),10);i.opt.half?(s=s-1+(e=.5<(a=parseFloat((t.pageX-r(this).offset().left)/(i.opt.size||parseInt(o.css("font-size")))))?1:.5),n._fill.call(i,s),i.opt.precision&&(s=s-e+a),n._roundStars.call(i,s),o.data("score",s)):n._fill.call(i,s),n._target.call(i,s,t),i.opt.mouseover&&i.opt.mouseover.call(i,s,t)})},_callback:function(t){for(var a in t)"function"==typeof this.opt[t[a]]&&(this.opt[t[a]]=this.opt[t[a]].call(this))},_createCancel:function(){var t=r(this),a=this.opt.cancelOff,a=r("<i />",{class:a,title:this.opt.cancelHint});return"left"==this.opt.cancelPlace?t.prepend("&#160;").prepend(a):t.append("&#160;").append(a),a},_createScore:function(){return r("<input />",{type:"hidden",name:this.opt.scoreName}).appendTo(this)},_createStars:function(){for(var t=r(this),a=1;a<=this.opt.number;a++){var e=n._getHint.call(this,a),s=this.opt.score&&this.opt.score>=a?"starOn":"starOff",i=this.opt.score&&this.opt.score>=a?"styleOn":"styleOff",s=this.opt[s],i=this.opt[i];r("<i />",{class:s,title:e,"data-score":a,style:i}).appendTo(this),this.opt.space&&t.append(a<this.opt.number?"&#160;":"")}return t.children("i")},_error:function(t){r(this).html(t),r.error(t)},_fill:function(t){for(var a=this,e=0,s=1;s<=a.stars.length;s++){var i,o,r,n=a.stars.eq(s-1),c=a.opt.single?s==t:s<=t;a.opt.iconRange&&a.opt.iconRange.length>e?(o=(i=a.opt.iconRange[e]).on||a.opt.starOn,r=i.off||a.opt.starOff,r=c?o:r,s<=i.range&&n.attr("class",r),s==i.range&&e++):(r=c?"starOn":"starOff",c=c?"styleOn":"styleOff",n.attr("class",this.opt[r]),n.attr("style","color:"+this.opt[c]+";font-size:"+this.opt.size+"px;"))}},_getHint:function(t){var a=this.opt.hints[t-1];return""===a?"":a||t},_lock:function(){var t=parseInt(this.score.val(),10),t=t?n._getHint.call(this,t):this.opt.noRatedMsg;r(this).data("readonly",!0).css("cursor","").attr("title",t),this.score.attr("readonly","readonly"),this.stars.attr("title",t),this.cancel&&this.cancel.hide()},_roundStars:function(t){var a,e,s=(t-Math.floor(t)).toFixed(2);s>this.opt.round.down&&(a="starOn",e="styleOn",this.opt.halfShow&&s<this.opt.round.up?(a="starHalf",e="styleHalf"):s<this.opt.round.full&&(a="starOff",e="styleOff"),this.stars.eq(Math.ceil(t)-1).attr("class",this.opt[a]),this.stars.eq(Math.ceil(t)-1).attr("style","color:"+this.opt[e]+";font-size:"+this.opt.size+"px;"))},_target:function(t,a){var e;this.opt.target&&(0===(e=r(this.opt.target)).length&&n._error.call(this,"Target selector invalid or missing!"),this.opt.targetFormat.indexOf("{score}")<0&&n._error.call(this,'Template "{score}" missing!'),a=a&&"mouseover"==a.type,void 0===t?t=this.opt.targetText:null===t?t=a?this.opt.cancelHint:this.opt.targetText:("hint"==this.opt.targetType?t=n._getHint.call(this,Math.ceil(t)):this.opt.precision&&(t=parseFloat(t).toFixed(1)),a||this.opt.targetKeep||(t=this.opt.targetText)),t=t&&this.opt.targetFormat.toString().replace("{score}",t),e.is(":input")?e.val(t):e.html(t))},_unlock:function(){r(this).data("readonly",!1).css("cursor","pointer").removeAttr("title"),this.score.removeAttr("readonly","readonly");for(var t=0;t<this.opt.number;t++)this.stars.eq(t).attr("title",n._getHint.call(this,t+1));this.cancel&&this.cancel.css("display","")},cancel:function(t){return this.each(function(){!0!==r(this).data("readonly")&&(n[t?"click":"score"].call(this,null),this.score.removeAttr("value"))})},click:function(t){return r(this).each(function(){!0!==r(this).data("readonly")&&(n._apply.call(this,t),this.opt.click||n._error.call(this,'You must add the "click: function(score, evt) { }" callback.'),this.opt.click.call(this,t,r.Event("click")),n._target.call(this,t))})},destroy:function(){return r(this).each(function(){var t=r(this),a=t.data("raw");a?t.off(".raty").empty().css({cursor:a.style.cursor,width:a.style.width}).removeData("readonly"):t.data("raw",t.clone()[0])})},getScore:function(){var t,a=[];return r(this).each(function(){t=this.score.val(),a.push(t?parseFloat(t):void 0)}),1<a.length?a:a[0]},readOnly:function(a){return this.each(function(){var t=r(this);t.data("readonly")!==a&&(a?(t.off(".raty").children("i").off(".raty"),n._lock.call(this)):(n._binds.call(this),n._unlock.call(this)),t.data("readonly",a))})},reload:function(){return n.set.call(this,{})},score:function(){return arguments.length?n.setScore.apply(this,arguments):n.getScore.call(this)},set:function(e){return this.each(function(){var t=r(this),a=t.data("settings"),a=r.extend({},a,e);t.raty(a)})},setScore:function(t){return r(this).each(function(){!0!==r(this).data("readonly")&&(n._apply.call(this,t),n._target.call(this,t))})}};r.fn.raty=function(t){return n[t]?n[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void r.error("Method "+t+" does not exist!"):n.init.apply(this,arguments)},r.fn.raty.defaults={cancel:!1,cancelHint:"Cancel this rating!",cancelOff:"fa fa-fw fa-minus-square",cancelOn:"fa fa-fw fa-check-square",cancelPlace:"right",click:void 0,half:!1,halfShow:!0,hints:["1","2","3","4","5"],iconRange:void 0,mouseout:void 0,mouseover:void 0,noRatedMsg:"Not rated yet!",number:5,numberMax:20,precision:!1,readOnly:!1,round:{down:.25,full:.6,up:.76},score:void 0,scoreName:"score",single:!1,size:25,space:!0,starHalf:"fa fa-fw fa-star-half",starOff:"fa fa-fw fa-star-o",starOn:"fa fa-fw fa-star",styleOn:"#ec971f",styleOff:"#bbb",styleHalf:"#ec971f",target:void 0,targetFormat:"{score}",targetKeep:!1,targetText:"",targetType:"hint",width:!1}}(jQuery);
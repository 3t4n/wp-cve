(()=>{"use strict";const e=()=>{var e,a=null;(e=jQuery)(".btn-afterpay_express").length&&Square?.Marketplace&&(e(".btn-afterpay_express").prop("disabled",!1),Square.Marketplace.initializeForPopup({countryCode:afterpay_express_js_config.country_code,target:".btn-afterpay_express",buyNow:!0,pickup:!1,onCommenceCheckout:function(r){if(e(".btn-afterpay_express").prop("disabled",!0),e(".buy-backdrop").length){var t=e(".buy-backdrop").clone();t.find(':contains("Afterpay")').remove(),a||(a={overlay:t,css:e('style:contains("buy-backdrop")').clone()})}e.ajax({url:afterpay_express_js_config.ajaxurl,method:"POST",data:{action:"afterpay_express_start",nonce:afterpay_express_js_config.ec_start_nonce},success:function(e){e.success?r.resolve(e.token):(e.message?r.reject(e.message):r.reject(Square.Marketplace.CONSTANTS.BAD_RESPONSE),e.redirectUrl&&(window.location.href=e.redirectUrl))},error:function(e,a,t){r.reject(Square.Marketplace.CONSTANTS.BAD_RESPONSE),alert("Something went wrong. Please try again later.")}})},onShippingAddressChange:function(a,r){e.ajax({url:afterpay_express_js_config.ajaxurl,method:"POST",data:{action:"afterpay_express_change",nonce:afterpay_express_js_config.ec_change_nonce,address:a},success:function(e){e.hasOwnProperty("error")?r.reject(Square.Marketplace.CONSTANTS.SERVICE_UNAVAILABLE,e.message):r.resolve(e)},error:function(e,a,t){r.reject(Square.Marketplace.CONSTANTS.BAD_RESPONSE)}})},onShippingOptionChange:function(a){e.ajax({url:afterpay_express_js_config.ajaxurl,method:"POST",data:{action:"afterpay_express_shipping_change",shipping:a.id,nonce:afterpay_express_js_config.ec_change_shipping_nonce}})},onComplete:function(r){r.data&&(r.data.status&&"SUCCESS"==r.data.status?(a&&(a.overlay.appendTo("body"),a.css.appendTo("head")),e.ajax({url:afterpay_express_js_config.ajaxurl,method:"POST",data:{action:"afterpay_express_complete",nonce:afterpay_express_js_config.ec_complete_nonce,token:r.data.orderToken},success:function(r){e(".btn-afterpay_express").prop("disabled",!1),r.redirectUrl?window.location.href=r.redirectUrl:(a.overlay.remove(),a.css.remove())},error:function(r,t,n){console.error(t),console.error(n),e(".btn-afterpay_express").prop("disabled",!1),alert("Something went wrong. Please try again later."),a.overlay.remove(),a.css.remove()}})):e(".btn-afterpay_express").prop("disabled",!1))}}))};var a;(a=jQuery)((function(){e(),a(document.body).on("updated_cart_totals",e)}))})();
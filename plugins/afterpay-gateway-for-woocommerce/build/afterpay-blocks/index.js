(()=>{"use strict";var e={433:(e,a,t)=>{t.d(a,{I:()=>r});const r=()=>{var e,a=null;(e=jQuery)(".btn-afterpay_express").length&&Square?.Marketplace&&(e(".btn-afterpay_express").prop("disabled",!1),Square.Marketplace.initializeForPopup({countryCode:afterpay_express_js_config.country_code,target:".btn-afterpay_express",buyNow:!0,pickup:!1,onCommenceCheckout:function(t){if(e(".btn-afterpay_express").prop("disabled",!0),e(".buy-backdrop").length){var r=e(".buy-backdrop").clone();r.find(':contains("Afterpay")').remove(),a||(a={overlay:r,css:e('style:contains("buy-backdrop")').clone()})}e.ajax({url:afterpay_express_js_config.ajaxurl,method:"POST",data:{action:"afterpay_express_start",nonce:afterpay_express_js_config.ec_start_nonce},success:function(e){e.success?t.resolve(e.token):(e.message?t.reject(e.message):t.reject(Square.Marketplace.CONSTANTS.BAD_RESPONSE),e.redirectUrl&&(window.location.href=e.redirectUrl))},error:function(e,a,r){t.reject(Square.Marketplace.CONSTANTS.BAD_RESPONSE),alert("Something went wrong. Please try again later.")}})},onShippingAddressChange:function(a,t){e.ajax({url:afterpay_express_js_config.ajaxurl,method:"POST",data:{action:"afterpay_express_change",nonce:afterpay_express_js_config.ec_change_nonce,address:a},success:function(e){e.hasOwnProperty("error")?t.reject(Square.Marketplace.CONSTANTS.SERVICE_UNAVAILABLE,e.message):t.resolve(e)},error:function(e,a,r){t.reject(Square.Marketplace.CONSTANTS.BAD_RESPONSE)}})},onShippingOptionChange:function(a){e.ajax({url:afterpay_express_js_config.ajaxurl,method:"POST",data:{action:"afterpay_express_shipping_change",shipping:a.id,nonce:afterpay_express_js_config.ec_change_shipping_nonce}})},onComplete:function(t){t.data&&(t.data.status&&"SUCCESS"==t.data.status?(a&&(a.overlay.appendTo("body"),a.css.appendTo("head")),e.ajax({url:afterpay_express_js_config.ajaxurl,method:"POST",data:{action:"afterpay_express_complete",nonce:afterpay_express_js_config.ec_complete_nonce,token:t.data.orderToken},success:function(t){e(".btn-afterpay_express").prop("disabled",!1),t.redirectUrl?window.location.href=t.redirectUrl:(a.overlay.remove(),a.css.remove())},error:function(t,r,n){console.error(r),console.error(n),e(".btn-afterpay_express").prop("disabled",!1),alert("Something went wrong. Please try again later."),a.overlay.remove(),a.css.remove()}})):e(".btn-afterpay_express").prop("disabled",!1))}}))};var n;(n=jQuery)((function(){r(),n(document.body).on("updated_cart_totals",r)}))}},a={};function t(r){var n=a[r];if(void 0!==n)return n.exports;var o=a[r]={exports:{}};return e[r](o,o.exports,t),o.exports}t.d=(e,a)=>{for(var r in a)t.o(a,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:a[r]})},t.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a),(()=>{const e=window.React,a=window.wp.i18n,r=window.wp.element,n=window.wc.wcBlocksRegistry,o="afterpay",s=window.wc.wcSettings,c=()=>{const e=(0,s.getSetting)("afterpay_data",null);return e||console.log("Afterpay initialization data is not available"),e};var p,l,i=t(433);const d=e=>{const{cartTotal:a,currency:t}=e;return a.value/Math.pow(10,t.minorUnit)},u=a=>{return(0,r.useEffect)((()=>{const e=document.querySelector("square-placement[data-type=logo]");e?.setAttribute("data-amount",d(a.billing))})),(0,e.createElement)("div",null,(t=c()?.testmode,"production"!=t?(0,e.createElement)("p",{className:"afterpay-test-mode-warning-text"},"TEST MODE ENABLED"):null),(0,e.createElement)("square-placement",{"data-type":"payment-schedule","data-mpid":c()?.mpid,"data-page-type":"checkout","data-platform":"WooCommerce/Blocks","data-locale":c()?.locale,"data-amount":d(a.billing),"data-currency":c()?.currency}));var t};(0,n.registerPaymentMethod)({name:o,label:(0,e.createElement)("square-placement",{"data-mpid":c()?.mpid,"data-currency":c()?.currency,"data-page-type":"checkout","data-type":"logo","data-logo-type":"compact-badge","data-platform":"WooCommerce/Blocks"}),ariaLabel:(0,a.__)("Afterpay payment method","woo_afterpay"),canMakePayment:({cartTotals:e})=>{const a=Math.max("1.00",parseFloat(c()?.min)),t=parseFloat(c()?.max),r=parseFloat(e.total_price)/Math.pow(10,e.currency_minor_unit);return r>=a&&r<=t},content:(0,e.createElement)(u,null),edit:(0,e.createElement)(u,null),supports:{features:null!==(p=c()?.supports)&&void 0!==p?p:[]}});const _=()=>{const{ec_button:a}=c();return(0,r.useEffect)((()=>{(0,i.I)()}),[]),(0,e.createElement)("div",{dangerouslySetInnerHTML:{__html:a}})};(0,n.registerExpressPaymentMethod)({name:"express_"+o,paymentMethodId:o,content:(0,e.createElement)(_,null),edit:(0,e.createElement)(_,null),canMakePayment:({cart:{cartItems:e,cartNeedsShipping:a,cartTotals:t}})=>{const{frontend_is_ready:r,ec_enabled:n,min:o,max:s}=c()||{},p=r&&n&&a&&(e=>!Array.isArray(e)||!e.some((e=>0==e.extensions?.woo_afterpay?.eligible)))(e);if(p){const{total_price:e,currency_minor_unit:a}=t,r=parseFloat(e)/Math.pow(10,a),n=Math.max("1.00",parseFloat(o)),c=parseFloat(s);return r>=n&&r<=c}return!1},supports:{features:null!==(l=c()?.supports)&&void 0!==l?l:[]}})})()})();
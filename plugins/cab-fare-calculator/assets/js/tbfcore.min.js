var TBFCoreSettings=new function(){this.DatePickerFormat=null,this.TimePckerFormat=null,this.Is12HoursTimeFormat=null,this.SelectedOres4ServiceType=null,this.CurrencySymbol="",this.CalculatedDistance=0,this.CalculatedReturnDistance=0,this.MaxStopCount=23,this.RoutingType={PickUp:"Pickup",DropOff:"Dropoff",Stop:"Stop"},this.DistanceUnits={Miles:"Miles",Kilometers:"Kilometers"}},TBFEngine=new function(){this.OnReady=function(){this.ApplyDatePicker(jQuery("#pickupDateHolderStep1"),"pickupDateStep1");var e=new Date;e.setTime(e.getTime()+864e5),this.ApplyDatePicker(jQuery("#dropoffDateHolderStep1"),"dropoffDateStep1",e),this.ApplyHrMinPicker();for(var t=0;t<selectedAreaVerticesArr.length;t++)triangleCoords.push(new google.maps.LatLng(selectedAreaVerticesArr[t][0],selectedAreaVerticesArr[t][1]));if(1==TBFSettings.checkPickupAreaOperation||1==TBFSettings.checkDropoffAreaOperation||1==TBFSettings.checkPickupDropoffAreaOperation){var i={zoom:8,center:new google.maps.LatLng(selectedAreaVerticesArr[0][0],selectedAreaVerticesArr[0][1]),mapTypeId:google.maps.MapTypeId.ROADMAP},a=new google.maps.Map(document.getElementById("map-canvas-operation"),i);(areaOfOperation=new google.maps.Polygon({paths:triangleCoords,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,draggable:!1,editable:!1})).setMap(a);for(var o=new google.maps.LatLngBounds,t=0;t<selectedAreaVerticesArr.length;t++)o.extend(new google.maps.LatLng(selectedAreaVerticesArr[t][0],selectedAreaVerticesArr[t][1]));google.maps.event.addListenerOnce(a,"idle",function(){a.fitBounds(o)})}setTimeout(function(){""!=jQuery("#address_from").val()&&""!=jQuery("#address_to").val()&&0!=jQuery("#passengers").val()&&""!=jQuery("#pickupDateStep1").val()&&""!=jQuery("#pickupTimeStep1").val()&&(jQuery("#booking_type").val(),TBFEngine.getMaps(!1))},1e3)},this.showViewMapBtn=function(){TBFSettings.showMapInPopupOnly?jQuery(".viewMapBtn").show():jQuery(".viewMapBtn").hide()},this.clearStopPoints=function(){jQuery("#stops_modal_trigger").hide(),jQuery("#stops_data_wrapper").html(""),jQuery(".stops-wrapper").hide()},this.clearAjaxLoading=function(){jQuery(".autocomplete-loading,.autocomplete-loading-list").remove()},this.unsetPoiAddress=function(){jQuery("input#address_from,input#address_from_lat,input#address_from_lng").val(""),jQuery("input#address_to,input#address_to_lat,input#address_to_lng").val(""),jQuery("#estimatedDistance").text(""),GoogleGeoCore.DirectionRenderer1.setMap(null),TBFSettings.showMapOnDesktop&&GoogleGeoCore.ClearPushpins(),""!=TBFSettings.defaultMapLat&&""!=TBFSettings.defaultMapLng&&GoogleGeoCore.MapStep1.setCenter({lat:TBFSettings.defaultMapLat,lng:TBFSettings.defaultMapLng})},this.makeFirstStepActive=function(){TBFEngine.removePopovers(),jQuery("#bottomFloatingBar").hide(),jQuery("#limobooking-step3-wrapper").hide(),jQuery("#limobooking-step2-wrapper").hide(),jQuery("#limobooking-step1-wrapper").show(),jQuery("#limobooking-steps-area .step-number-wrap.third").removeClass("active"),jQuery("#limobooking-steps-area .step-number-wrap.second").removeClass("active"),jQuery("#limobooking-steps-area .step-number-wrap.first").addClass("active"),jQuery("#data_source").val("component"),jQuery("body, html",window.document).animate({scrollTop:jQuery("#limobooking-steps-area").offset().top},"fast"),TBFSettings.showMapOnDesktop&&GoogleGeoCore.RenderDirections(),TBFSettings.fixedFareBookingEnabled&&TBFSettings.routeSwappingEnabled&&1==jQuery("#route_swapped").val()&&(jQuery("#route_from_fld,#route_to_fld").attr("readonly",!0),jQuery("div#tabs_offers div.list_trigger").hide(),1==TBFSettings.showPOICategories&&jQuery("#route_category_fld,#route_category_dropoff_fld").attr("readonly",!0))},this.makeSecondStepActive=function(){TBFEngine.removePopovers(),jQuery("#bottomFloatingBar").hide(),jQuery("#limobooking-step3-wrapper").hide(),jQuery("#limobooking-step2-wrapper").show(),jQuery("#limobooking-step1-wrapper").hide(),jQuery("#limobooking-step2-wrapper div.tripSummary").show(),jQuery("#limobooking-steps-area .step-number-wrap.third").removeClass("active"),jQuery("#limobooking-steps-area .step-number-wrap.second").addClass("active"),jQuery("#limobooking-steps-area .step-number-wrap.first").removeClass("active"),jQuery("body, html",window.document).animate({scrollTop:jQuery("#limobooking-steps-area").offset().top},"fast")},this.makeThirdStepActive=function(){TBFEngine.removePopovers(),jQuery("#bottomFloatingBar").show(),jQuery("#limobooking-step3-wrapper").show(),jQuery("#limobooking-step2-wrapper").hide(),jQuery("#limobooking-step1-wrapper").hide(),jQuery("#limobooking-steps-area .step-number-wrap.third").addClass("active"),jQuery("#limobooking-steps-area .step-number-wrap.second").removeClass("active"),jQuery("#limobooking-steps-area .step-number-wrap.first").removeClass("active"),jQuery("body, html",window.document).animate({scrollTop:jQuery("#limobooking-steps-area").offset().top},"fast")},this.removePopovers=function(){jQuery(document).find(".popover").length>0&&jQuery(document).find(".popover").remove()},this.showAreaOperationPopup=function(){TBFEngine.clearAjaxLoading(),jQuery("#areaOperationModal").modal("show")},this.checkAreaOperation=function(e){var t=jQuery("#address_from_lat").val(),i=jQuery("#address_from_lng").val(),a=jQuery("#address_to_lat").val(),o=jQuery("#address_to_lng").val();if(areaOfOperation=new google.maps.Polygon({paths:triangleCoords}),1==TBFSettings.checkPickupDropoffAreaOperation){if("address_from"==e){if(!google.maps.geometry.poly.containsLocation(new google.maps.LatLng(t,i),areaOfOperation))return jQuery("#address_from").val(""),jQuery("#address_from_lat").val(""),jQuery("#address_from_lng").val(""),TBFEngine.showAreaOperationPopup(),!1}else if("address_to"==e&&!google.maps.geometry.poly.containsLocation(new google.maps.LatLng(a,o),areaOfOperation))return jQuery("#address_to").val(""),jQuery("#address_to_lat").val(""),jQuery("#address_to_lng").val(""),TBFEngine.showAreaOperationPopup(),!1}else if(1==TBFSettings.checkPickupAreaOperation&&1==TBFSettings.checkDropoffAreaOperation){if(""!=t&&""!=i&&""!=a&&""!=o&&!google.maps.geometry.poly.containsLocation(new google.maps.LatLng(t,i),areaOfOperation)&&!google.maps.geometry.poly.containsLocation(new google.maps.LatLng(a,o),areaOfOperation))return"address_from"==e?(jQuery("#address_from").val(""),jQuery("#address_from_lat").val(""),jQuery("#address_from_lng").val("")):"address_to"==e&&(jQuery("#address_to").val(""),jQuery("#address_to_lat").val(""),jQuery("#address_to_lng").val("")),TBFEngine.showAreaOperationPopup(),!1}else if(1==TBFSettings.checkPickupAreaOperation&&0==TBFSettings.checkDropoffAreaOperation){if("address_from"==e&&!google.maps.geometry.poly.containsLocation(new google.maps.LatLng(t,i),areaOfOperation))return jQuery("#address_from").val(""),jQuery("#address_from_lat").val(""),jQuery("#address_from_lng").val(""),TBFEngine.showAreaOperationPopup(),!1}else if(0==TBFSettings.checkPickupAreaOperation&&1==TBFSettings.checkDropoffAreaOperation&&"address_to"==e&&!google.maps.geometry.poly.containsLocation(new google.maps.LatLng(a,o),areaOfOperation))return jQuery("#address_to").val(""),jQuery("#address_to_lat").val(""),jQuery("#address_to_lng").val(""),TBFEngine.showAreaOperationPopup(),!1;return!0},this.getMaps=function(e){null!=tbxhr&&(tbxhr.abort(),tbxhr=null),jQuery("#booking_type").val();var t=jQuery("#price_form").serialize()+"&action=getPrice&nonce="+tblightAjax.nonce;tbxhr=jQuery.ajax({type:"POST",url:tblightAjax.ajaxurl,data:t,dataType:"json",beforeSend:function(){jQuery("div#loadingProgressContainer").show()},complete:function(){},success:function(t){if(jQuery("div#loadingProgressContainer").hide(),1==t.error){if(0!=t.company_id)return jQuery("div#step1Error").show().html(t.msg),!1;window.location.reload()}else jQuery("#limobooking-step2-wrapper .location-form").html(t.msg.begin),jQuery("#limobooking-step2-wrapper .location-to").html(t.msg.end),jQuery("#limobooking-step2-wrapper .distance").html(" "+t.msg.distance),jQuery("#limobooking-step2-wrapper .duration").html(" "+t.msg.duration),TBFEngine.getCars(e)}})},this.getCars=function(e){null!=tbxhr&&(tbxhr.abort(),tbxhr=null),jQuery("#selected_car").val(0);var t=jQuery("#booking_type").val(),i=jQuery("#price_form").serialize()+"&action=getVehicles&nonce="+tblightAjax.nonce;TBFEngine.removePopovers(),tbxhr=jQuery.ajax({type:"POST",url:tblightAjax.ajaxurl,data:i,dataType:"json",beforeSend:function(){jQuery("div#loadingProgressContainer").show(),jQuery("#limobooking-step2-wrapper #warning_msg, #limobooking-step2-wrapper div.msg_board").html("").hide()},complete:function(){},success:function(i){jQuery("div#loadingProgressContainer").hide(),TBFEngine.makeSecondStepActive(),jQuery("#limobooking-step2-wrapper .date-time").html(i.pickup_datetime),jQuery("#limobooking-step3-wrapper .date-time").html(i.pickup_datetime),1==i.show_stops&&jQuery("#limobooking-step2-wrapper .list-address-point").show().html(i.stops_html),""==i.additional_seats_html?(jQuery("#limobooking-step2-wrapper .additional_seats_wrapper").hide(),jQuery("#limobooking-step2-wrapper #additional-seats").html("")):(jQuery("#limobooking-step2-wrapper .additional_seats_wrapper").show(),jQuery("#limobooking-step2-wrapper #additional-seats").html(i.additional_seats_html)),1==i.error?0==i.company_id?window.location.reload():(jQuery("div.trip_status").show(),1==i.call_next_available&&("address"==t||"offers"==t||"hourly"==t||"tours"==t)?TBFEngine.getNextAvailableCar():(jQuery("#limobooking-step2-wrapper #vehicle_wrapper").show().html(""),jQuery("#limobooking-step2-wrapper #warning_msg").show().html(i.msg))):(jQuery("#limobooking-step2-wrapper #vehicle_wrapper").show().html(i.msg),jQuery(".car_desc").tooltip(),jQuery("div.trip_status").show(),jQuery("a.price_popup").tooltip({html:!0,title:function(){var e=jQuery(this).data("target-selector");return jQuery("."+e).html()}}),jQuery("a.rate_details").length>0&&jQuery("a.rate_details").popover({placement:"bottom",container:"body",html:!0,title:function(){return jQuery(this).data("title")+'&nbsp;<span class="close">&times;</span>'},content:function(){var e=jQuery(this).data("target-selector");return jQuery("."+e).html()}}).on("shown.bs.popover",function(e){var t=jQuery(this);jQuery(document).on("click",".popover .close",function(){t.popover("hide")})}),"list"==TBFSettings.carsDefaultDisplay?(jQuery("div.vehicles-list .grid").removeClass("active"),jQuery("div.vehicles-list .list").addClass("active"),jQuery("div.vehicles-list div.list-view").show(),jQuery("div.vehicles-list div.grid-view").hide()):(jQuery("div.vehicles-list .grid").addClass("active"),jQuery("div.vehicles-list .list").removeClass("active"),jQuery("div.vehicles-list div.list-view").hide(),jQuery("div.vehicles-list div.grid-view").show()),865>=jQuery("#limobooking-step2-wrapper").width()&&jQuery(window).width()>=979?jQuery("#limobooking-step2-wrapper .vehicles-list").addClass("small-style"):jQuery("#limobooking-step2-wrapper .vehicles-list").removeClass("small-style"),e)}})},this.getNextAvailableCar=function(){var e=jQuery("#price_form").serialize();jQuery("#booking_type").val(),jQuery.ajax({type:"POST",url:TBF_BASE_URL+"index.php?option=com_tblight&task=onepage.getNextAvailableCar&ajax=1",data:e,dataType:"json",beforeSend:function(){jQuery("div#loadingProgressContainer").show(),jQuery("#limobooking-step2-wrapper #vehicle_wrapper").html("")},complete:function(){},success:function(e){jQuery("div#loadingProgressContainer").hide(),1==e.error?0==e.company_id?window.location.reload():jQuery("#limobooking-step2-wrapper #warning_msg").show().html(e.msg):(jQuery("#limobooking-step2-wrapper .date-time").html(e.pickup_datetime),jQuery("#limobooking-step3-wrapper .date-time").html(e.pickup_datetime),jQuery("#limobooking-step2-wrapper .list-address-point").show().html(e.stops_html),""==e.additional_seats_html?(jQuery("#limobooking-step2-wrapper .additional_seats_wrapper").hide(),jQuery("#limobooking-step2-wrapper #additional-seats").html("")):(jQuery("#limobooking-step2-wrapper .additional_seats_wrapper").show(),jQuery("#limobooking-step2-wrapper #additional-seats").html(e.additional_seats_html)),jQuery("#limobooking-step2-wrapper #warning_msg").show().html(e.next_available_msg),jQuery("#limobooking-step2-wrapper #vehicle_wrapper").html(e.msg),jQuery(".car_desc").tooltip(),jQuery("#limobooking-step2-wrapper #vehicle_wrapper").hide(),jQuery("#show_next_available_yes").click(function(){jQuery("#limobooking-step2-wrapper #vehicle_wrapper").show()}),jQuery("#show_next_available_no").click(function(){TBFEngine.makeFirstStepActive()}),jQuery("a.rate_details").length>0&&jQuery("a.rate_details").popover({placement:"bottom",container:"body",html:!0,title:function(){return jQuery(this).data("title")+'&nbsp;<span class="close">&times;</span>'},content:function(){var e=jQuery(this).data("target-selector");return jQuery("."+e).html()}}).on("shown.bs.popover",function(e){var t=jQuery(this);jQuery(document).on("click",".popover .close",function(){t.popover("hide")})}),"list"==TBFSettings.carsDefaultDisplay?(jQuery("div.vehicles-list .grid").removeClass("active"),jQuery("div.vehicles-list .list").addClass("active"),jQuery("div.vehicles-list div.list-view").show(),jQuery("div.vehicles-list div.grid-view").hide()):(jQuery("div.vehicles-list .grid").addClass("active"),jQuery("div.vehicles-list .list").removeClass("active"),jQuery("div.vehicles-list div.list-view").hide(),jQuery("div.vehicles-list div.grid-view").show()))}})},this.isCarAlreadySelected=function(){var e=jQuery("#price_form").serialize();jQuery("#booking_type").val(),jQuery.ajax({type:"POST",url:TBF_BASE_URL+"index.php?option=com_tblight&task=onepage.getAlreadySelectedCar&ajax=1",data:e,dataType:"json",beforeSend:function(){},complete:function(){},success:function(e){0!=e.car_is_set&&jQuery("#limobooking-step2-wrapper #vehicle_wrapper .vehicles-body.grid-view a.car_booking").each(function(){jQuery(this).data("carid")==e.car_is_set&&jQuery(this).trigger("click")})}})},this.calculateGrandTotal=function(){jQuery("#booking_type").val(),jQuery.ajax({type:"POST",url:tblightAjax.ajaxurl,data:jQuery("#price_form").serialize()+"&action=calculateTotal&nonce="+tblightAjax.nonce,dataType:"json",beforeSend:function(){jQuery("div#loadingProgressContainer").show()},complete:function(){},success:function(e){jQuery("div#loadingProgressContainer").hide(),1==e.error?0==e.company_id?window.location.reload():alert(e.msg):1==e.msg.show_price?(jQuery(".sub_total_wrap,.grand_total_wrap").show(),jQuery(".sub_total").html(e.msg.sub_total),jQuery("#bottomFloatingBar .grand_total").html(e.msg.grand_total),1==e.msg.show_flat_cost?(jQuery(".flat_cost_wrap").show(),jQuery(".flat_cost").html(e.msg.flat_cost)):(jQuery(".flat_cost").html(""),jQuery(".flat_cost_wrap").hide()),1==e.msg.show_percentage_cost?(jQuery(".percentage_cost_wrap").show(),jQuery(".percentage_cost").html(e.msg.percentage_cost)):(jQuery(".percentage_cost").html(""),jQuery(".percentage_cost_wrap").hide()),""!=e.msg.payment_labels?(jQuery("#bottomFloatingBar .payment_label_wrap").remove(),jQuery("#bottomFloatingBar .user_group_discount_wrap").after(e.msg.payment_labels)):jQuery("#bottomFloatingBar .payment_label_wrap").remove()):(jQuery(".sub_total,#bottomFloatingBar .grand_total,.flat_cost,.percentage_cost").html(""),jQuery(".sub_total_wrap,.flat_cost_wrap,.percentage_cost_wrap,.grand_total_wrap").hide())}})},this.ValidatePickUpDateTime=function(e){var t=!0,i=!0,a=!1,o=$("#pickupDate"+e).val(),r=$("#pickupTime"+e).val(),s=parseDate(o,Ores4Settings.DatePickerFormat),n=tryParseTime(r);if(""==o?($("#pickupDateErrorDiv"+e).text("Date is required"),t=!1):isValidDate(s)||($("#pickupDateErrorDiv"+e).text("Date is incorrect"),t=!1),""==r?(i=!1,$("#pickupTimeErrorDiv"+e).text("Time is required")):null==n&&(i=!1,$("#pickupTimeErrorDiv"+e).text("Time is incorrect")),t&&i){var p=Ores4Engine.ValidatePuDateTimeRestriction(o,n);p.length>0&&("Date in past"===p?($("#pickupDateErrorDiv"+e).text("Date in past"),t=!1):p.length>0&&$("#pickupDateTimeErrorDiv"+e).text(p),a=!0)}return t?($("#pickupDateHolder"+e).removeClass("has-error"),$("#pickupDateErrorDiv"+e).hide()):($("#pickupDateHolder"+e).addClass("has-error"),$("#pickupDateErrorDiv"+e).show()),i?($("#pickupTimeHolder"+e).removeClass("has-error"),$("#pickupTimeErrorDiv"+e).hide()):($("#pickupTimeHolder"+e).addClass("has-error"),$("#pickupTimeErrorDiv"+e).show()),a?($("#pickupTimeHolder"+e).addClass("has-error"),$("#pickupDateHolder"+e).addClass("has-error"),$("#pickupDateTimeErrorDiv"+e).show()):(i&&$("#pickupTimeHolder"+e).removeClass("has-error"),t&&$("#pickupDateHolder"+e).removeClass("has-error"),$("#pickupDateTimeErrorDiv"+e).hide()),t&&i&&!a},this.ValidatePickUpDate=function(e){var t=!0,i=$("#pickupDate"+e).val(),a=parseDate(i,Ores4Settings.DatePickerFormat);return""===i?($("#pickupDateErrorDiv"+e).text("Date is required"),t=!1):isValidDate(a)||($("#pickupDateErrorDiv"+e).text("Date is incorrect"),t=!1),t?($("#pickupDateHolder"+e).removeClass("has-error"),$("#pickupDateErrorDiv"+e).hide()):($("#pickupDateHolder"+e).addClass("has-error"),$("#pickupDateErrorDiv"+e).show()),t},this.ValidatePickUpTime=function(e){var t=!0,i=$("#pickupTime"+e).val(),a=tryParseTime(i);return""===i?(t=!1,$("#pickupTimeErrorDiv"+e).text("Time is required")):null==a&&(t=!1,$("#pickupTimeErrorDiv"+e).text("Time is incorrect")),t?($("#pickupTimeHolder"+e).removeClass("has-error"),$("#pickupTimeErrorDiv"+e).hide()):($("#pickupTimeHolder"+e).addClass("has-error"),$("#pickupTimeErrorDiv"+e).show()),t},this.ValidatePuDateTimeRestriction=function(){var e="",t=null==TBFSettings.orderCreationHoursLimit?0:TBFSettings.orderCreationHoursLimit;if("jquery"==TBFSettings.datePickerType){var i=jQuery("#pickupDateStep1").val();if("DD-MM-YYYY"==TBFSettings.DatePickerFormat)var a=i.substring(0,2),o=i.substring(3,5);else var o=i.substring(0,2),a=i.substring(3,5);var r=i.substring(6,10),s=jQuery("input#selPtHr1").val(),n=jQuery("input#selPtMn1").val();if(TBFSettings.Is12HoursTimeFormat){var p=jQuery("#seltimeformat1").val(),l=s+":"+n+" "+p,c=TBFEngine.ConvertTimeformat(l);s=c[0],n=c[1]}}else if("inline"==TBFSettings.datePickerType){var a=jQuery("#pickup_day").val(),o=jQuery("#pickup_month").val(),r=jQuery("#pickup_year").val(),s=jQuery("#selPtHr1").val(),n=jQuery("#selPtMn1").val();if(TBFSettings.Is12HoursTimeFormat){var p=jQuery("#seltimeformat1").val(),l=s+":"+n+" "+p,c=TBFEngine.ConvertTimeformat(l);s=c[0],n=c[1]}}var d=new Date(r,parseInt(o)-1,a,s,n),m=new Date,u=new Date(m.getTime()+(60*TBFSettings.TimeZoneUtcOffset+m.getTimezoneOffset())*6e4);return(Math.abs(d-u)/36e5<t||d<u)&&(e=0===t?TBTranslations.ERR_MESSAGE_DATETIME_IN_PAST:TBTranslations.ERR_MESSAGE_INSUFFICIENT_BOOKING_TIME),e},this.ConvertTimeformat=function(e){var t=Number(e.match(/^(\d+)/)[1]),i=Number(e.match(/:(\d+)/)[1]),a=e.match(/\s(.*)$/)[1];"PM"==a&&t<12&&(t+=12),"AM"==a&&12==t&&(t-=12);var o=t.toString(),r=i.toString();t<10&&(o="0"+o),i<10&&(r="0"+r);var s=[,,];return s[0]=o,s[1]=r,s},this.ValidateEmail=function(e){return/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e)},this.ValidatePhone=function(e){return/^(NA|[0-9+-]+)$/.test(e)},this.ApplyDatePicker=function(e,t,i){var a=new Date,o=new Date;o.setFullYear(a.getFullYear()+2),i||(i=a),e.datetimepicker({defaultDate:a,minDate:i,maxDate:o,format:TBFSettings.DatePickerFormat,viewMode:"days",icons:{time:"icon-clock",date:"icon-calendar",up:"tb tb-chevron-up",down:"tb tb-chevron-down"}}).on("dp.show",function(e){}).on("dp.change",function(e){"pickupDateStep1"==t&&jQuery("#booking_type").val()}),e.find("input").focus(function(e){jQuery(this).parent().data("DateTimePicker").show(e)}),e.find("input").focusout(function(){jQuery(this).parent().data("DateTimePicker").hide()})},this.ApplyHrMinPicker=function(){jQuery("input#selPtHr1").click(function(){!0==jQuery(this).next(".timepicker-hours").is(":visible")?jQuery(this).next(".timepicker-hours").hide():jQuery(this).next(".timepicker-hours").show()}),jQuery(".pickup-hours").on("click","td.hour",function(e){jQuery("input#selPtHr1").val(jQuery(this).html()),jQuery(".pickup-hours").hide()}),jQuery("input#selPtMn1").click(function(){!0==jQuery(this).next(".timepicker-minutes").is(":visible")?jQuery(this).next(".timepicker-minutes").hide():jQuery(this).next(".timepicker-minutes").show()}),jQuery(".pickup-minutes").on("click","td.minute",function(e){jQuery("input#selPtMn1").val(jQuery(this).html()),jQuery(".pickup-minutes").hide()}),jQuery("input#dropoff_selPtHr").click(function(){!0==jQuery(this).next(".timepicker-hours").is(":visible")?jQuery(this).next(".timepicker-hours").hide():jQuery(this).next(".timepicker-hours").show()}),jQuery(".dropoff-hours").on("click","td.hour",function(e){jQuery("input#dropoff_selPtHr").val(jQuery(this).html()),jQuery(".dropoff-hours").hide()}),jQuery("input#dropoff_selPtMn").click(function(){!0==jQuery(this).next(".timepicker-minutes").is(":visible")?jQuery(this).next(".timepicker-minutes").hide():jQuery(this).next(".timepicker-minutes").show()}),jQuery(".dropoff-minutes").on("click","td.minute",function(e){jQuery("input#dropoff_selPtMn").val(jQuery(this).html()),jQuery(".dropoff-minutes").hide()})},this.ApplyTimePicker=function(e){var t=new Date;new Date().setFullYear(t.getFullYear()+2),e.datetimepicker({format:!0==TBFSettings.Is12HoursTimeFormat?null:TBFSettings.TimePickerFormat,pickDate:!1,minutesToAddForDefaultDateTime:60*TBFSettings.orderCreationHoursLimit+5,icons:{time:"icon-clock",date:"icon-calendar",up:"tb tb-chevron-up",down:"tb tb-chevron-down"},minuteStepping:5}).on("dp.show",function(e){}),e.find("input").focus(function(e){jQuery(this).parent().data("DateTimePicker").show(e)}),e.find("input").focusout(function(){jQuery(this).parent().data("DateTimePicker").hide()})},this.comparePickupReturnDates=function(){var e=jQuery("#pickupDateStep1").val(),t=jQuery("#returnTripPickupDate").val();if("DD-MM-YYYY"==TBFSettings.DatePickerFormat)var i=e.substring(0,2),a=e.substring(3,5),o=t.substring(0,2),r=t.substring(3,5);else var a=e.substring(0,2),i=e.substring(3,5),r=t.substring(0,2),o=t.substring(3,5);var s=e.substring(6,10),n=t.substring(6,10),p=new Date(s,parseInt(a)-1,i);return new Date(n,parseInt(r)-1,o)>p},this.setPickupDate=function(){var e=jQuery("#pickup_year").val(),t=jQuery("#pickup_month").val();jQuery("#pickup_day").val();var i=new Date,a=i.getDate(),o=i.getMonth(),r=i.getFullYear();jQuery("#pickup_month").chosen("destroy"),jQuery("#pickup_day").chosen("destroy"),e>r?(jQuery("#pickup_month option").each(function(){jQuery(this).attr("disabled",!1)}),jQuery("#pickup_day option").each(function(){jQuery(this).attr("disabled",!1)})):(jQuery("#pickup_month option").each(function(){jQuery(this).val()<parseInt(o)+1?jQuery(this).attr("disabled",!0):jQuery(this).attr("disabled",!1)}),t>parseInt(o)+1?jQuery("#pickup_day option").each(function(){jQuery(this).attr("disabled",!1)}):jQuery("#pickup_day option").each(function(){jQuery(this).val()<a?jQuery(this).attr("disabled",!0):jQuery(this).attr("disabled",!1)})),jQuery("#pickup_month").chosen(),jQuery("#pickup_day").chosen()},this.hidePastDates=function(){var e=new Date,t=e.getDate(),i=e.getMonth();parseInt(jQuery("#pickup_day").val()),parseInt(jQuery("#pickup_month").val()),parseInt(jQuery("#pickup_year").val()),jQuery("#pickup_month").chosen("destroy"),jQuery("#pickup_day").chosen("destroy"),jQuery("#pickup_day option").each(function(){jQuery(this).val()<parseInt(t)?jQuery(this).attr("disabled",!0):jQuery(this).attr("disabled",!1)}),jQuery("#pickup_month option").each(function(){jQuery(this).val()<parseInt(i)+1?jQuery(this).attr("disabled",!0):jQuery(this).attr("disabled",!1)}),jQuery("#pickup_month").chosen(),jQuery("#pickup_day").chosen()}};
var isTouchSupported="ontouchstart"in window,isTouchSupportedIE10=null!=navigator.userAgent.match(/Touch/i);jQuery(document).ready(function(){var deviceWidth=jQuery(window).width();jQuery(function(){jQuery("select.styler_list").chosen({disable_search_threshold:10}),jQuery("#childSeatsModal label").css({display:"block"}),jQuery("#childSeatsModal .jq-selectbox").css({width:"100%"}),jQuery("#stopsModal label").css({display:"block"})}),jQuery(".floatingButton").click(function(){jQuery(this).siblings("div.floatingPopup").addClass("active")}),jQuery(".floating-close").click(function(){jQuery(this).parent(".floatingPopup").removeClass("active")}),GoogleGeoCore.Init(),TBFEngine.OnReady(),!TBFSettings.showMapOnMobile&&deviceWidth<768&&jQuery(".limobooking-step1-right-area").hide(),0==TBFSettings.showMapOnDesktop&&deviceWidth>768&&jQuery(".limobooking-step1-left-area").addClass("div-center-aligned"),jQuery(".list_trigger").click(function(){1==jQuery(this).prev(".list_wrapper").is(":visible")?jQuery(this).prev(".list_wrapper").hide():jQuery(this).prev(".list_wrapper").show()});var mouseOverList=mouseOverPickupHr=mouseOverPickupMin=mouseOverDropoffHr=mouseOverDropoffMin=!1;jQuery(".list_trigger").mouseenter(function(){mouseOverList=!0}).mouseleave(function(){mouseOverList=!1}),jQuery("input#selPtHr1").mouseenter(function(){mouseOverPickupHr=!0}).mouseleave(function(){mouseOverPickupHr=!1}),jQuery("input#selPtMn1").mouseenter(function(){mouseOverPickupMin=!0}).mouseleave(function(){mouseOverPickupMin=!1}),jQuery("input#dropoff_selPtHr").mouseenter(function(){mouseOverDropoffHr=!0}).mouseleave(function(){mouseOverDropoffHr=!1}),jQuery("input#dropoff_selPtMn").mouseenter(function(){mouseOverDropoffMin=!0}).mouseleave(function(){mouseOverDropoffMin=!1}),jQuery("html").click(function(){mouseOverList||jQuery(".list_trigger").prev(".list_wrapper").hide(),mouseOverPickupHr||jQuery("input#selPtHr1").next(".timepicker-hours").hide(),mouseOverPickupMin||jQuery("input#selPtMn1").next(".timepicker-minutes").hide(),mouseOverDropoffHr||jQuery("input#dropoff_selPtHr").next(".timepicker-hours").hide(),mouseOverDropoffMin||jQuery("input#dropoff_selPtMn").next(".timepicker-minutes").hide()}),jQuery("#limobooking-steps-area .step-number-wrap.second").click(function(){jQuery("#limobooking-steps-area .step-number-wrap.third").hasClass("active")&&TBFEngine.makeSecondStepActive()}),jQuery("#limobooking-steps-area .step-number-wrap.first").click(function(){(jQuery("#limobooking-steps-area .step-number-wrap.third").hasClass("active")||jQuery("#limobooking-steps-area .step-number-wrap.second").hasClass("active"))&&TBFEngine.makeFirstStepActive()});var changeCount=0;jQuery(".service_type").change(function(){var e=jQuery(this).val();jQuery(".service-type-elems-wrapper").hide(),jQuery("#tabs_"+e).show(),jQuery("div#step1Error").hide(),jQuery(".pickup-date-time-label").show();jQuery(".non-shared-rides").show(),jQuery(".non-shuttle").show(),"address"==e?jQuery("#stops_modal_trigger").show():TBFEngine.clearStopPoints()}),jQuery("#address_from").change(function(){jQuery("#address_from_lat,#address_from_lng").val("")}),jQuery("#address_to").change(function(){jQuery("#address_to_lat,#address_to_lng").val("")}),jQuery("a.pickup_direction").click(function(){GoogleGeoCore.getUserLocation("address_from")}),jQuery("a.dropoff_direction").click(function(){GoogleGeoCore.getUserLocation("address_to")}),jQuery(".viewMapTrigger").click(function(){GoogleGeoCore.RenderDirections(),jQuery("#mapOff").css({visibility:"visible",width:"auto",height:"auto",display:"block"}),jQuery("#mapOuter").addClass("popped-up").css({visibility:"visible"}),jQuery(".estimatedDistanceInfo").show()}),jQuery("#map-close").click(function(){jQuery("#mapOff").css({visibility:"hidden",width:"0px",height:"0px",display:"none"}),jQuery("#mapOuter").removeClass("popped-up").css({visibility:"hidden"}),jQuery(".estimatedDistanceInfo").hide(),jQuery("#estimatedDistance,#estimatedDuration").html("")}),jQuery("#add_child_seats_btn").click(function(){var e=jQuery("#chseats").val();e>0&&jQuery(".childSeatsButtons-list").show(),e>0?(jQuery("#ChildSeatsLabel #chSeatsLabel").show(),jQuery("#ChildSeatsLabel #chSeatsCount").html(e)):(jQuery("#ChildSeatsLabel #chSeatsCount").html(0),jQuery("#ChildSeatsLabel #chSeatsLabel").hide()),jQuery("#childSeatsModal").modal("hide")}),jQuery("#edit_child_seats_btn").click(function(){jQuery("#childSeatsModal").modal("show")}),jQuery(".see_price").click(function(){var e=jQuery("#booking_type").val(),r=0;if("address"==e){if("jquery"==TBFSettings.datePickerType)""==jQuery("#pickupDateStep1").val()?(r++,jQuery("#pickupDateStep1").closest("div.step1-sm-inputWrap").addClass("has-error")):jQuery("#pickupDateStep1").closest("div.step1-sm-inputWrap").removeClass("has-error"),""==(s=jQuery("#selPtHr1").val())?(r++,jQuery("#selPtHr1").closest("div.step1-sm-inputWrap").addClass("has-error")):jQuery("#selPtHr1").closest("div.step1-sm-inputWrap").removeClass("has-error"),""==(t=jQuery("#selPtMn1").val())?(r++,jQuery("#selPtMn1").closest("div.step1-sm-inputWrap").addClass("has-error")):jQuery("#selPtMn1").closest("div.step1-sm-inputWrap").removeClass("has-error");else if("inline"==TBFSettings.datePickerType){var s,t;""==(s=jQuery("#selPtHr1").val())?(r++,jQuery("div#selPtHr1-styler").addClass("has-error")):jQuery("div#selPtHr1-styler").removeClass("has-error"),""==(t=jQuery("#selPtMn1").val())?(r++,jQuery("div#selPtMn1-styler").addClass("has-error")):jQuery("div#selPtMn1-styler").removeClass("has-error")}if(""!=s&&""!=t){var i=TBFEngine.ValidatePuDateTimeRestriction();"jquery"==TBFSettings.datePickerType?""!=i?(r++,jQuery(".pickupTime .time-date-wrapper").find("span.error").remove(),jQuery("#selPtHr1").closest("div.step1-sm-inputWrap").addClass("has-error"),jQuery(".pickupTime .time-date-wrapper").append('<span class="error text-danger">'+i+"</span>")):(jQuery(".pickupTime .time-date-wrapper").find("span.error").remove(),jQuery("#selPtHr1").closest("div.step1-sm-inputWrap").removeClass("has-error")):"inline"==TBFSettings.datePickerType&&(""!=i?(r++,jQuery("#pickup_day").closest("div.pickupDate").find("span.error").remove(),jQuery("#pickup_day").closest("div.pickupDate").addClass("has-error"),jQuery("#pickup_day").closest("div.pickupDate").append('<span class="error text-danger">'+i+"</span>")):(jQuery("#pickup_day").closest("div.pickupDate").find("span.error").remove(),jQuery("#pickup_day").closest("div.pickupDate").removeClass("has-error")))}}if(jQuery("#address_from").closest("div.step1-inputWrap").removeClass("has-error"),jQuery("#address_to").closest("div.step1-inputWrap").removeClass("has-error"),"address"==e){var a=jQuery("#address_from_lat").val(),o=jQuery("#address_from_lng").val();""!=a&&""!=o||(r++,jQuery("#address_from").closest("div.step1-inputWrap").addClass("has-error"));var n=jQuery("#address_to_lat").val(),u=jQuery("#address_to_lng").val();""!=n&&""!=u||(r++,jQuery("#address_to").closest("div.step1-inputWrap").addClass("has-error"))}0==jQuery("#passengers").val()?(r++,jQuery("#passengers").closest("div.step1-inputWrap-sm").addClass("has-error")):jQuery("#passengers").closest("div.step1-inputWrap-sm").removeClass("has-error"),r>0?jQuery("div#step1Error").show().html(TBTranslations.BOOKING_FORM_FIRST_STEP_ERROR_MESSAGE):(jQuery("div#step1Error").hide(),jQuery("#page").val(1),TBFEngine.getMaps(!0))}),jQuery(document).on("click","#show_all_cars",function(e){jQuery("#cartype").chosen("destroy").val(0).chosen(),TBFEngine.getMaps(!0)}),jQuery("div.vehicles-list").on("click",".list",function(e){jQuery(".grid").removeClass("active"),jQuery(".list").addClass("active"),jQuery("div.list-view").show(),jQuery("div.grid-view").hide(),TBFEngine.removePopovers()}),jQuery("div.vehicles-list").on("click",".grid",function(e){jQuery(".grid").addClass("active"),jQuery(".list").removeClass("active"),jQuery("div.list-view").hide(),jQuery("div.grid-view").show(),TBFEngine.removePopovers()}),jQuery("div#vehicle_wrapper").on("click","a#load_more_trigger",function(e){var r=jQuery("#page").val();jQuery("#page").val(parseInt(r)+1),TBFEngine.getCars()}),jQuery(document).on("click","a.car_booking",function(e){TBFEngine.removePopovers();var vehicle_id=jQuery(this).data("carid"),booking_btn=jQuery(this);null!=tbxhr&&(tbxhr.abort(),tbxhr=null),jQuery("#selected_car").val(vehicle_id),jQuery("div#loadingProgressContainer").show();var passingData="vehicle_id="+vehicle_id+"&action=bookNow&nonce="+tblightAjax.nonce;tbxhr=jQuery.ajax({type:"POST",url:tblightAjax.ajaxurl,data:passingData,dataType:"json",beforeSend:function(){},complete:function(){setTimeout(function(){TBFEngine.calculateGrandTotal()},500)},success:function(response){if(1==response.error){if(0!=response.company_id)return alert(response.msg),!1;window.location.reload()}else TBFEngine.makeThirdStepActive(),jQuery("#country_id").val(jQuery("#country_calling_code option:selected").data("countryid")),jQuery("#limobooking-step3-wrapper .date-time").html(response.msg.pickup_datetime),jQuery("#limobooking-step3-wrapper .car-details .vehicle-type-label").html(response.msg.car.title),jQuery("#limobooking-step3-wrapper .car-details .vehicle-type-pass-capacity").html(response.msg.car.passenger_no),jQuery("#limobooking-step3-wrapper .car-details .vehicle-type-luggage-capacity").html(response.msg.car.suitcase_no),jQuery("#limobooking-step3-wrapper .car-details .vehicle-type-img").prop("src",response.msg.car.image),jQuery("#limobooking-step3-wrapper .pass-number").html(response.msg.adultseats_html),1==response.msg.show_additional_seats?(jQuery("#limobooking-step3-wrapper .child-seats").closest("li").show(),jQuery("#limobooking-step3-wrapper .total-passenger").closest("li").show(),jQuery("#limobooking-step3-wrapper .child-seats").html(response.msg.childseats),jQuery("#limobooking-step3-wrapper .total-passenger").html(response.msg.totalpassengers)):(jQuery("#limobooking-step3-wrapper .child-seats").closest("li").hide(),jQuery("#limobooking-step3-wrapper .total-passenger").closest("li").hide()),response.msg.suitcases>0?(jQuery("#limobooking-step3-wrapper .suitcases").closest("li").show(),jQuery("#limobooking-step3-wrapper .suitcases").html(response.msg.suitcases)):(jQuery("#limobooking-step3-wrapper .suitcases").closest("li").hide(),jQuery("#limobooking-step3-wrapper .suitcases").html(0)),jQuery("#limobooking-step3-wrapper .trip-details.address").show(),jQuery("#limobooking-step3-wrapper .pickup").html(response.msg.begin),jQuery("#limobooking-step3-wrapper .dropoff").html(response.msg.end),jQuery(".label_tooltip").tooltip(),response.msg.found_payment_method>0?(jQuery("div#payment_selectors").html(response.msg.payment_html),1==jQuery("div#payment_selectors").find("input.tb_paymentmethods").length&&jQuery("div#payment_selectors").find("input.tb_paymentmethods").attr("checked",!0),jQuery(".payment_desc").tooltip()):jQuery("div#payment_selectors").html(""),jQuery("div#payment_selectors").find("script").each(function(i){eval(jQuery(this).text())}),jQuery("div#loadingProgressContainer").hide()}})}),jQuery(document).on("change","#limobooking-step3-wrapper .extra",function(e){TBFEngine.calculateGrandTotal()}),jQuery(document).on("click","input.tb_paymentmethods",function(e){jQuery("input.tb_paymentmethods:checked").hasClass("stripe"),TBFEngine.calculateGrandTotal()}),jQuery("#make_booking").click(function(){var e=0;jQuery('[name="cbox"]').length>0&&(jQuery('[name="cbox"]').is(":checked")?jQuery("#termsError").hide():(e++,jQuery("#termsError").show())),jQuery("#limobooking-step3-container-area .required").each(function(){jQuery(this).next("span.error").remove(),0==jQuery(this).val().length?(e++,jQuery(this).parent().addClass("has-error"),jQuery(this).after('<span class="error text-danger">'+TBTranslations.ERR_MESSAGE_FIELD_REQUIRED+"</span>")):"/"==jQuery(this).val()?(e++,jQuery(this).parent().addClass("has-error"),jQuery(this).after('<span class="error text-danger">'+TBTranslations.ERR_MESSAGE_FIELD_SLASH_NOT_ALLOWED+"</span>")):jQuery(this).hasClass("email")&&!TBFEngine.ValidateEmail(jQuery(this).val())?(e++,jQuery(this).parent().addClass("has-error"),jQuery(this).after('<span class="error text-danger">'+TBTranslations.ERR_MESSAGE_VALID_EMAIL+"</span>")):jQuery(this).hasClass("phone")&&!TBFEngine.ValidatePhone(jQuery(this).val())?(e++,jQuery(this).parent().addClass("has-error"),jQuery(this).after('<span class="error text-danger">'+TBTranslations.ERR_MESSAGE_VALID_PHONE+"</span>")):jQuery(this).hasClass("numeric")&&!jQuery.isNumeric(jQuery(this).val())?(e++,jQuery(this).parent().addClass("has-error"),jQuery(this).after('<span class="error text-danger">'+TBTranslations.ERR_MESSAGE_VALID_NUMERIC+"</span>")):(jQuery(this).parent().removeClass("has-error"),jQuery(this).next("span.error").remove())}),jQuery("div#payment_selectors").find('input[type="radio"][name="tb_paymentmethod_id"]').is(":checked")?jQuery("div#payment_selectors").next("span.error").hide():(e++,jQuery("div#payment_selectors").next("span.error").show()),TBFSettings.captchaEnabled&&(""==jQuery("#booking-g-recaptcha-response").val()?(e++,jQuery(".g-recaptcha-response-error").show()):jQuery(".g-recaptcha-response-error").hide()),e>0?jQuery("#step3Error").show():(jQuery("#step3Error").hide(),jQuery("#make_booking").attr("disabled",!0),jQuery("div#loadingProgressContainer").show(),jQuery.ajax({type:"POST",url:tblightAjax.ajaxurl,data:jQuery("#price_form").serialize()+"&action=submitOrder&nonce="+tblightAjax.nonce,dataType:"json",beforeSend:function(){},complete:function(){},success:function(e){0==e.error?window.location=e.redirect_url:(jQuery("div#loadingProgressContainer").hide(),jQuery("#make_booking").attr("disabled",!1))}}))}),jQuery(document).on("click",".back_first",function(e){TBFEngine.makeFirstStepActive()}),jQuery(document).on("click",".back_second",function(e){TBFEngine.makeSecondStepActive()}),jQuery("a.reset-booking-form").click(function(){null!=tbxhr&&(tbxhr.abort(),tbxhr=null),jQuery("div#loadingProgressContainer").show(),tbxhr=jQuery.ajax({type:"POST",url:tblightAjax.ajaxurl,data:"action=resetBookingForm&nonce="+tblightAjax.nonce,dataType:"json",beforeSend:function(){},complete:function(){},success:function(e){window.location.reload()}})}),"inline"==TBFSettings.datePickerType&&(jQuery("#pickup_year").change(function(){TBFEngine.setPickupDate();var e=parseInt(jQuery("#pickup_year").val()),r=new Date,s=r.getDate(),t=r.getMonth(),i=r.getFullYear();jQuery("#pickup_month").chosen("destroy"),jQuery("#pickup_day").chosen("destroy"),e>i?(jQuery("#pickup_day").val(1),jQuery("#pickup_month").val(1)):(jQuery("#pickup_day").val(s),jQuery("#pickup_month").val(t+1)),jQuery("#pickup_month").chosen(),jQuery("#pickup_day").chosen()}),jQuery("#pickup_month").change(function(){parseInt(jQuery("#pickup_year").val());TBFEngine.setPickupDate()}),jQuery("#pickup_day").change(function(){parseInt(jQuery("#pickup_month").val());TBFEngine.setPickupDate()}),TBFEngine.hidePastDates())});
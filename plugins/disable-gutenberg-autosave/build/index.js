(()=>{"use strict";var e,t={312:(e,t,a)=>{const s=window.wp.element,r=window.wp.i18n,i=window.wp.editPost,n=window.wp.components,l=window.wp.compose,o=window.wp.data,u=window.wp.plugins,v=window.wp.apiFetch;var d=a.n(v);const b=[{label:(0,r.__)("10 seconds","disable-gutenberg-autosave"),value:10},{label:(0,r.__)("30 seconds","disable-gutenberg-autosave"),value:30},{label:(0,r.__)("1 minute","disable-gutenberg-autosave")+" ("+(0,r.__)("default","disable-gutenberg-autosave")+")",value:60},{label:(0,r.__)("5 minutes","disable-gutenberg-autosave"),value:300},{label:(0,r.__)("10 minutes","disable-gutenberg-autosave"),value:600},{label:(0,r.__)("30 minutes","disable-gutenberg-autosave"),value:1800},{label:(0,r.__)("Disabled","disable-gutenberg-autosave"),value:99999}];class g extends s.Component{constructor(e){super(e),this.state={interval:0,error:!1},this.apiGetInterval=this.apiGetInterval.bind(this),this.apiSetInterval=this.apiSetInterval.bind(this),this.editorUpdateInterval=this.editorUpdateInterval.bind(this)}apiGetInterval(){d()({path:"/disable-gutenberg-autosave/v1/interval"}).then((e=>{this.setState({interval:e,error:!1})}),(e=>{this.setState({interval:99999,error:e.message})}))}apiSetInterval(){this.state.error||d()({path:"/disable-gutenberg-autosave/v1/interval",method:"POST",data:{interval:parseInt(this.state.interval)}})}editorUpdateInterval(){this.props.updateEditorSettings({...this.props.editorSettings,autosaveInterval:parseInt(this.state.interval)})}componentDidMount(){this.apiGetInterval()}componentDidUpdate(e,t){this.state.interval&&(t.interval&&0!==t.interval&&t.interval!==this.state.interval&&this.apiSetInterval(),this.props.editorSettings.autosaveInterval&&this.props.editorSettings.autosaveInterval!==this.state.interval&&this.editorUpdateInterval())}render(){return(0,s.createElement)(s.Fragment,null,(0,s.createElement)(i.PluginSidebarMoreMenuItem,{target:"disable-gutenberg-autosave-sidebar"},(0,r.__)("Disable Gutenberg Autosave","disable-gutenberg-autosave")),(0,s.createElement)(i.PluginSidebar,{name:"disable-gutenberg-autosave-sidebar",title:(0,r.__)("Autosave settings","disable-gutenberg-autosave")},(0,s.createElement)(n.PanelBody,{className:"disable-gutenberg-autosave-settings"},!this.state.interval&&(0,s.createElement)("p",null,(0,r.__)("Loading...","disable-gutenberg-autosave")),!!this.state.interval&&this.state.error&&(0,s.createElement)(s.Fragment,null,(0,s.createElement)("h2",{className:"disable-gutenberg-autosave-header"},(0,r.__)("API error:","disable-gutenberg-autosave")),(0,s.createElement)("p",{className:"disable-gutenberg-autosave-error"},this.state.error),(0,s.createElement)("p",null,(0,r.__)("Autosave is disabled anyway, but you cannot set custom intervals.","disable-gutenberg-autosave")),(0,s.createElement)(n.Button,{className:"button button-primary",onClick:()=>{this.setState({interval:0,error:!1}),this.apiGetInterval()}},(0,r.__)("Try again","disable-gutenberg-autosave"))),!!this.state.interval&&!this.state.error&&(0,s.createElement)(n.RadioControl,{label:(0,r.__)("Autosave interval","disable-gutenberg-autosave"),options:b,selected:parseInt(this.state.interval),onChange:e=>this.setState({interval:parseInt(e)})}),(0,s.createElement)("br",null),(0,s.createElement)("strong",null,(0,r.__)("Editor status","disable-gutenberg-autosave")),(0,s.createElement)("ul",{style:{marginTop:4}},(0,s.createElement)("li",null,`${(0,r.__)("Is edited post dirty","disable-gutenberg-autosave")}: ${this.props.isDirty}`),(0,s.createElement)("li",null,`${(0,r.__)("Is edited post autosaveable","disable-gutenberg-autosave")}: ${this.props.isAutosaveable}`),(0,s.createElement)("li",null,`${(0,r.__)("Is autosaving","disable-gutenberg-autosave")}: ${this.props.isAutosaving}`),(0,s.createElement)("li",null,`${(0,r.__)("Autosave interval","disable-gutenberg-autosave")}: ${this.props.interval}`),(0,s.createElement)("li",null,`${(0,r.__)("Local autosave interval","disable-gutenberg-autosave")}: ${this.props.localInterval}`)),(0,s.createElement)(n.Button,{isPrimary:!0,text:(0,r.__)("Autosave now","disable-gutenberg-autosave"),disabled:this.props.isAutosaving,isBusy:this.props.isAutosaving,onClick:()=>{this.props.autosave()}}))))}}const p=(0,l.compose)([(0,o.withSelect)((e=>{const{isEditedPostDirty:t,isEditedPostAutosaveable:a,isAutosavingPost:s,getEditorSettings:r}=e("core/editor"),i=r();return{editorSettings:i,isDirty:t(),isAutosaveable:a(),isAutosaving:s(),interval:i.autosaveInterval,localInterval:i.__experimentalLocalAutosaveInterval||i.localAutosaveInterval}})),(0,o.withDispatch)((e=>({updateEditorSettings:e("core/editor").updateEditorSettings,autosave:e("core/editor").autosave})))])(g);(0,u.registerPlugin)("wsd-disable-gutenberg-autosave",{icon:"backup",render:p})}},a={};function s(e){var r=a[e];if(void 0!==r)return r.exports;var i=a[e]={exports:{}};return t[e](i,i.exports,s),i.exports}s.m=t,e=[],s.O=(t,a,r,i)=>{if(!a){var n=1/0;for(v=0;v<e.length;v++){for(var[a,r,i]=e[v],l=!0,o=0;o<a.length;o++)(!1&i||n>=i)&&Object.keys(s.O).every((e=>s.O[e](a[o])))?a.splice(o--,1):(l=!1,i<n&&(n=i));if(l){e.splice(v--,1);var u=r();void 0!==u&&(t=u)}}return t}i=i||0;for(var v=e.length;v>0&&e[v-1][2]>i;v--)e[v]=e[v-1];e[v]=[a,r,i]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={826:0,431:0};s.O.j=t=>0===e[t];var t=(t,a)=>{var r,i,[n,l,o]=a,u=0;if(n.some((t=>0!==e[t]))){for(r in l)s.o(l,r)&&(s.m[r]=l[r]);if(o)var v=o(s)}for(t&&t(a);u<n.length;u++)i=n[u],s.o(e,i)&&e[i]&&e[i][0](),e[n[u]]=0;return s.O(v)},a=globalThis.webpackChunkdisable_gutenberg_autosave=globalThis.webpackChunkdisable_gutenberg_autosave||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var r=s.O(void 0,[431],(()=>s(312)));r=s.O(r)})();
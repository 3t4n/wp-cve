!function(r,n,i){n.wp=n.wp||{},n.wp.dev4press=n.wp.dev4press||{},n.wp.dev4press.admin={scroll_offset:40,active_element:null,toggles:{on:"d4p-ui-toggle-on",off:"d4p-ui-toggle-off"},init:function(){wp.dev4press.admin.components.scroller.run(),wp.dev4press.admin.components.interface.run(),wp.dev4press.admin.components.notices.run(),"settings"!==d4plib_admin_data.page.panel&&"tools"!==d4plib_admin_data.page.panel||wp.dev4press.admin.panels.settings.run(),"features"===d4plib_admin_data.page.panel&&(wp.dev4press.admin.panels.settings.run(),wp.dev4press.admin.panels.features.run()),r(n).on("load resize orientationchange",function(){wp.dev4press.admin.components.scroller.resize()})},panels:{features:{run:function(){r(i).on("click",".d4p-features-filter-buttons button",function(e){e.preventDefault();e=r(this);r(".d4p-features-filter-buttons button").removeClass("is-selected"),e.addClass("is-selected"),wp.dev4press.admin.panels.features.filter()}),r(i).on("change",".d4p-feature-box ._activation input",function(){var e=r(this).is(":checked"),t=r(this).closest(".d4p-feature-box"),s=r(this).data("feature");e?t.addClass("_is-active"):t.removeClass("_is-active"),wp.dev4press.admin.panels.features.ajax([s],e),wp.dev4press.admin.panels.features.filter(),wp.dev4press.admin.panels.features.counters()}),r(i).on("click",".d4p-features-bulk-ctrl-options button",function(e){e.preventDefault();var n=r(this).data("action"),a=[];r(".d4p-feature-box ._activation input").each(function(){var e=r(this).is(":checked"),t=r(this).closest(".d4p-feature-box"),s=r(this).data("feature");"enable"===n?e||(r(this).prop("checked",!0),t.addClass("_is-active"),a.push(s)):e&&(r(this).prop("checked",!1),t.removeClass("_is-active"),a.push(s))}),r(".d4p-features-bulk-ctrl").trigger("click"),wp.dev4press.admin.panels.features.ajax(a,"enable"===n),wp.dev4press.admin.panels.features.filter(),wp.dev4press.admin.panels.features.counters()}),r(i).on("click",".d4p-features-bulk-ctrl",function(e){e.preventDefault(),r(this).hasClass("button-secondary")?(r(this).removeClass("button-secondary").addClass("button-primary"),r(this).next().hide()):(r(this).removeClass("button-primary").addClass("button-secondary"),r(this).next().show())}),r(i).on("click",".d4p-feature-more-ctrl",function(e){e.preventDefault(),r(this).hasClass("_is-open")?(r(this).removeClass("_is-open"),r(this).next().hide(),r(this).next().next().show()):(r(this).addClass("_is-open"),r(this).next().show(),r(this).next().next().hide())}),r(".d4p-features-filter-search input").on("keyup",function(e){var t=r(this).val(),s=r(this).parent();0<t.length?s.addClass("is-active"):s.removeClass("is-active"),wp.dev4press.admin.panels.features.filter()}),r(i).on("click",".d4p-features-filter-search i",function(e){r(".d4p-features-filter-search input").val("").trigger("keyup"),r(".d4p-features-filter-search").removeClass("is-active")}),wp.dev4press.admin.panels.features.counters()},filter:function(){var e=r(".d4p-features-filter-buttons button.is-selected"),t=r(".d4p-features-wrapper"),e=e.data("selector"),n=r(".d4p-features-filter-search input").val().toLowerCase();n.length<2&&(n=""),t.find("._is-feature").addClass("hide-feature").removeClass("search-result search-result-title search-result-description"),t.find(e).removeClass("hide-feature"),1<n.length&&r("._is-feature:not(.hide-feature)",t).each(function(){var e=r(this).find("._title").html().toLowerCase(),t=r(this).find("._description").html().toLowerCase(),e=e.includes(n),t=t.includes(n),s="search-result";e||t?(e&&(s+=" search-result-title"),t&&(s+=" search-result-description"),r(this).addClass(s)):r(this).addClass("hide-feature")})},ajax:function(e,t){var s="?action="+d4plib_admin_data.plugin.prefix+"_feature_activation&_ajax_nonce="+d4plib_admin_data.content.nonce,s={url:ajaxurl+s,type:"post",dataType:"json",data:{feature:e,scope:d4plib_admin_data.wp.is_network?"network":"blog",status:t?"on":"off"}};r.ajax(s)},counters:function(){var t=r(".d4p-features-wrapper");r(".d4p-panel-features-counts div").each(function(){var e=r(this).data("selector"),e=t.find(e).length;r(this).find("span").html(e)})}},settings:{run:function(){wp.dev4press.admin.settings.init(),r("#"+d4plib_admin_data.plugin.prefix+"-form-settings").confirmsubmit(),1===r("#d4p-settings-mark").length&&wp.dev4press.admin.panels.settings.mark(),r(i).on("click",".d4p-toggle-control-wrapper button",function(e){e.preventDefault();var e=r(this).next(),t=e.prop("checked"),s=wp.dev4press.admin.toggles,n=t?"off":"on",a=t?"on":"off",i=r(this).closest(".d4p-group");e.prop("checked",!t),i.removeClass("d4p-group-toggle-"+a).addClass("d4p-group-toggle-"+n),r(this).find("i").removeClass(s[a]).addClass(s[n]),r(this).attr("aria-pressed",t?"false":"true")})},mark:function(){r(i).on("click",".d4p-panel-mark button",function(){r("#d4p-settings-mark").val("").trigger("input")});var t=r(".d4p-group"),s=r(".d4p-group > h3"),n=r(".d4p-settings-section > h4"),a=r(".d4p-settings-table > tbody > tr");r("#d4p-settings-mark").on("input",function(){var e=r(this).val();t.show(),s.unmark(),n.show().unmark(),a.show().unmark(),e&&(a.mark(e,{done:function(){a.not(":has(mark)").hide()}}),n.mark(e,{done:function(){n.each(function(e,t){0<r(t).find("mark").length?r(t).parent().find(".d4p-settings-table > tbody > tr").show():r(t).hide()})}}),s.mark(e,{done:function(){s.each(function(e,t){0<r(t).find("mark").length&&r(t).parent().find(".d4p-settings-table > tbody > tr").show()})}}),s.each(function(e,t){var t=r(t).parent(),s=0;r(".d4p-settings-section",t).each(function(e,t){0<r(t).height()&&(s+=r(t).height())}),0===s&&t.hide()}))})}}},components:{scroller:{run:function(){var e,t=r(".d4p-panel-scroller"),s=r(n);0<t.length&&(e=t.offset(),s.scroll(function(){s.scrollTop()>e.top&&t.hasClass("d4p-scroll-active")?t.stop().animate({marginTop:s.scrollTop()-e.top+wp.dev4press.admin.scroll_offset}):t.stop().animate({marginTop:0})}))},resize:function(){i.body.clientWidth<800?wp.dev4press.admin.scroll_offset=60:wp.dev4press.admin.scroll_offset=40,i.body.clientWidth<640?r(".d4p-panel-scroller").removeClass("d4p-scroll-active").stop().css("margin-top",0):r(".d4p-panel-scroller").addClass("d4p-scroll-active")}},interface:{run:function(){r(i).on("click",".d4p-nav-button > a",function(e){e.preventDefault(),r(this).next().slideToggle("fast")}),0<r(".d4p-wrap .d4p-message .notice").length&&setTimeout(function(){r(".d4p-wrap .d4p-message .notice").slideUp("slow")},1e4)}},notices:{run:function(){r("#wpbody-content > div.notice").detach().prependTo(".d4p-wrap")}}},settings:{init:function(){wp.dev4press.admin.settings.more_toggle.run(),wp.dev4press.admin.settings.color_picker.run(),wp.dev4press.admin.settings.expandables.run(),wp.dev4press.admin.settings.check_uncheck.run(),wp.dev4press.admin.settings.switch.run(),wp.dev4press.admin.settings.code_editor.run()},more_toggle:{run:function(){r(i).on("click",".d4p-more-wrapper .d4p-more-title i, .d4p-more-wrapper .d4p-more-title button",function(e){e.preventDefault();e=r(this).parent().parent();e.hasClass("__is-open")?e.removeClass("__is-open"):e.addClass("__is-open")})}},color_picker:{run:function(){var e=r(".d4p-color-picker");0<e.length&&e.wpColorPicker()}},check_uncheck:{run:function(){r(i).on("click",".d4p-check-uncheck a",function(e){e.preventDefault();e="checkall"===r(this).attr("href").substring(1);r(this).parent().parent().find("input[type=checkbox]").prop("checked",e)})}},expandables:{run:function(){r(i).on("click",".d4p-setting-expandable_pairs .button-secondary",function(e){e.preventDefault();var t=r(this).parent();t.fadeOut(200,function(){t.remove()})}),r(i).on("click",".d4p-setting-expandable_text .button-secondary",function(e){wp.dev4press.admin.settings.expandables.remove(this,e),wp.dev4press.admin.settings.expandables.remove(this,e)}),r(i).on("click",".d4p-setting-expandable_raw .button-secondary",function(e){wp.dev4press.admin.settings.expandables.remove(this,e)}),r(i).on("click",".d4p-setting-expandable_pairs a.button-primary",function(e){e.preventDefault();var e=r(this).closest(".d4p-setting-expandable_pairs"),t=r(".d4p-next-id",e),s=t.val(),e=r(".pair-element-0",e).clone();r("input",e).each(function(){var e=r(this).attr("id").replace("_0_","_"+s+"_"),t=r(this).attr("name").replace("[0]","["+s+"]");r(this).attr("id",e).attr("name",t)}),e.attr("class","pair-element-"+s).fadeIn(),r(this).before(e),s++,t.val(s)}),r(i).on("click",".d4p-setting-expandable_text a.button-primary",function(e){wp.dev4press.admin.settings.expandables.add(this,e,".d4p-setting-expandable_text")}),r(i).on("click",".d4p-setting-expandable_raw a.button-primary",function(e){wp.dev4press.admin.settings.expandables.add(this,e,".d4p-setting-expandable_raw")})},add:function(e,t,s){t.preventDefault();var t=r(e).closest(s),e=r(".d4p-next-id",t),n=e.val(),s=r(".exp-text-element-0",t).clone();r("input",s).each(function(){var e=r(this).attr("id").replace("_0_","_"+n+"_"),t=r(this).attr("name").replace("[0]","["+n+"]");r(this).attr("id",e).attr("name",t)}),s.attr("class","exp-text-element exp-text-element-"+n).fadeIn(),r("ol",t).append(s),n++,e.val(n)},remove:function(e,t){t.preventDefault();var s=r(e).parent();s.fadeOut(200,function(){s.remove()})}},switch:{run:function(){r(".d4p-switch-control-option select").change(function(){var e,t,s=r(this).val(),n=r(this).closest("tr").data("switch"),a=r(this).closest("tr").data("switch-type");"option"===a?(t=".d4p-switch-option-value-"+s,r(e=".d4p-switch-value-"+n).addClass("d4p-switch-option-is-hidden"),r(e+t).removeClass("d4p-switch-option-is-hidden")):"section"===a&&(t=".d4p-switch-section-value-"+s,r(e=".d4p-switch-section-"+n).addClass("d4p-switch-section-is-hidden"),r(e+t).removeClass("d4p-switch-section-is-hidden"))})}},code_editor:{run:function(){r("textarea.d4p-code-editor-element").each(function(){var e=wp.codeEditor.defaultSettings?_.clone(wp.codeEditor.defaultSettings):{};e.codemirror=_.extend({},e.codemirror,{indentWithTabs:!1,indentUnit:2,tabSize:2,mode:r(this).data("mode")}),wp.codeEditor.initialize(r(this),e)})}}}},n.wp.dev4press.dialogs={storage:{url:""},classes:function(e,t){var s="wp-dialog d4p-dialog d4p-dialog-modal";return""!==e&&(s+=" "+e),void 0!==t&&t&&(s+=" d4p-dialog-hidex"),s},default_button:function(e,t,s){return{id:"d4p-dialog-button-id-"+e,class:"d4p-dialog-button-"+e+(t?" button-has-focus":""),text:void 0!==s?s:d4plib_admin_data.ui.buttons[e],data:{icon:e}}},default_dialog:function(){return{width:480,height:"auto",minHeight:24,autoOpen:!1,resizable:!1,modal:!0,closeOnEscape:!1,zIndex:3e5,open:function(){r(".button-has-focus").focus()}}},icons:function(e,t){r(e).next().find(".ui-dialog-buttonset button").each(function(){var e;0===r(this).find("span.ui-button-text").length&&r(this).html("<span class='ui-button-text'>"+r(this).html()+"</span>"),void 0===t?""!==(e=r(this).data("icon"))&&r(this).find("span.ui-button-text").prepend(d4plib_admin_data.ui.icons[e]):r(this).find("span.ui-button-text").prepend(t)})}},n.wp.dev4press.ajaxtask={prefix:"",button:"",handler:"",nonce:"",progres:{active:!1,stop:!1,done:0,total:0},init:function(e,t,s,n){this.prefix=e,this.button=t,this.handler=s,this.nonce=n,r(i).on("click",this.button,function(){wp.dev4press.ajaxtask.progres.active?wp.dev4press.ajaxtask.stop():wp.dev4press.ajaxtask.start()})},start:function(){this.progres.active=!0,r(this.button).val(d4plib_admin_data.ui.buttons.stop),r("#"+this.prefix+"-process").slideDown(),r("#"+this.prefix+"-progress pre").html(""),this._call({operation:"start"},this._callback.start)},stop:function(){this.progres.stop=!0,r(this.button).attr("disabled",!0)},run:function(){this._call({operation:"run"},this._callback.process)},_call:function(e,t){e={url:ajaxurl+"?action="+this.handler+"&_ajax_nonce="+this.nonce,type:"post",dataType:"json",data:e,success:t};r.ajax(e)},_write:function(e){r("#"+this.prefix+"-progress pre").append(e+"\r\n")},_callback:{start:function(e){var t=wp.dev4press.ajaxtask.progres;t.current=0,t.total=e.total,wp.dev4press.ajaxtask._write(e.message),wp.dev4press.ajaxtask.run()},stop:function(e){wp.dev4press.ajaxtask.progres.active=!1,wp.dev4press.ajaxtask._write(e.message)},process:function(e){wp.dev4press.ajaxtask.progres.stop?wp.dev4press.ajaxtask._call({operation:"break"},wp.dev4press.ajaxtask._callback.stop):(wp.dev4press.ajaxtask.progres.done=e.done,wp.dev4press.ajaxtask._write(e.message),wp.dev4press.ajaxtask.progres.done<wp.dev4press.ajaxtask.progres.total?wp.dev4press.ajaxtask.run():(wp.dev4press.ajaxtask.stop(),wp.dev4press.ajaxtask._call({operation:"stop"},wp.dev4press.ajaxtask._callback.stop)))}}},r(i).ready(function(){wp.dev4press.admin.init()})}(jQuery,window,document);
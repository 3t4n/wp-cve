"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}function _typeof(e){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e){e.fn.xlAjaxChosen=function(t,a,s){var l,o,n,d;return null==t&&(t={}),null==s&&(s={}),o={minTermLength:3,afterTypeDelay:500,jsonTermKey:"term",keepTypingMsg:"Keep typing...",lookingForMsg:"Looking for"},d=this,l=null,n=e.extend({},o,e(d).data(),t),this.xlChosen(s||{}),this.each(function(){return e(this).next(".chosen-container").find(".search-field > input, .chosen-search > input").bind("keyup",function(){var s,o,r,c;if(cmb2_select_last_interact=e(this).parents(".chosen-container").prev("select"),r=e(this).val(),o=(c=e.trim(e(this).val())).length<n.minTermLength?n.keepTypingMsg:n.lookingForMsg+" '"+c+"'",d.next(".chosen-container").find(".no-results").text(o),0!==c.length)return c!==e(this).data("prevVal")&&(e(this).data("prevVal",c),this.timer&&clearTimeout(this.timer),!(c.length<n.minTermLength)&&(s=e(this),null==n.data&&(n.data={}),n.data[n.jsonTermKey]=c,null!=n.dataCallback&&(n.data=n.dataCallback(n.data)),n.success,n.success=function(i){var l,o,n;if(d=cmb2_select_last_interact,null!=i)return n=[],d.find("option").each(function(){return e(this).is(":selected")?n.push(e(this).val()+"-"+e(this).text()):e(this).remove()}),d.find("optgroup:empty").each(function(){return e(this).remove()}),l=null!=a?a(i,s):i,o=0,e.each(l,function(t,a){var i,s,l;return o++,a.group?((i=d.find("optgroup[label='"+a.text+"']")).size()||(i=e("<optgroup />")),i.attr("label",a.text).appendTo(d),e.each(a.items,function(t,a){var s,l;if(s="string"==typeof a?(l=t,a):(l=a.value,a.text),-1===e.inArray(l+"-"+s,n))return e("<option />").attr("value",l).html(s).appendTo(i)})):(s="string"==typeof a?(l=t,a):(l=a.value,a.text),-1===e.inArray(l+"-"+s,n)?e("<option />").attr("value",l).html(s).appendTo(d):void 0)}),o?d.trigger("chosen:updated"):(d.data().chosen.no_results_clear(),d.data().chosen.no_results(s.val())),null!=t.success&&t.success(i),s.val(r)},this.timer=setTimeout(function(){return l&&l.abort(),l=e.ajax(n)},n.afterTypeDelay)));selected_values_pre=[],d.find("option").each(function(){return e(this).is(":selected")?selected_values_pre.push(e(this).val()+"-"+e(this).text()):e(this).remove()});var _=[];return void 0!==d.attr("data-pre-data")&&(_=JSON.parse(d.attr("data-pre-data"))),e.each(_,function(t,a){if(text="string"==typeof a?(value=i,a):(value=a.value,a.text),-1===e.inArray(value+"-"+text,selected_values_pre))return e("<option />").attr("value",value).html(text).appendTo(d)}),d.trigger("chosen:updated"),!1})})}}(jQuery),window.wfacp=function(e){return{ajax:function(t,a,i){var s=this,l=null,o={},n="wfacp_";function d(t,a,i,l,o,n){a.length>0&&a.prop("disabled",!1),i.remove(),e(".bwf_ajax_btn_bottom_container").removeClass("ajax_loader_show"),!0===s.hasOwnProperty(t)&&"function"==typeof s[t]&&s[t](l,a,i,o,n)}return this.action=null,this.data=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e},this.before_send=function(e){},this.async=function(e){return e},this.method=function(e){return e},this.success=function(e,t,a,i,s){},this.complete=function(e,t,a,i,s){},this.error=function(e,t,a,i,s){wfacp_localization.error.hasOwnProperty(e.status)&&wfacp.swal(wfacp_localization.error[e.status]),wfacp.hide_spinner()},this.action=function(e){return e},this.ajax=function(t,a){"object"===_typeof(a)?a.action=t:a={action:t},a.action=n+t,s.before_send(document.body,t),a.wfacp_nonce=wfacp_secure.nonce;var i={url:ajaxurl,async:s.async(!0),method:s.method("POST"),data:a,success:function(e,a,i){"object"===_typeof(e)&&e.hasOwnProperty("nonce")&&(wfacp_secure.nonce=e.nonce,delete e.nonce),s.success(e,a,i,t)},complete:function(e,a,i){s.complete(e,a,i,t)},error:function(e,a,i){s.error(e,a,i,t)}};o.hasOwnProperty(t)?clearTimeout(o[t]):o[t]=null,o[t]=setTimeout(function(t){e.ajax(t)},200,i)},!0===a?(function(t){e(t).length>0&&(e(t).on("submit",function(t){t.preventDefault();var a=e(this).data("bwf-action");"undefined"!==a&&(a=(a=n+a).trim(),l=this,s.action=a,function(t){var a=l,i=null,n=new FormData(a);n.append("action",t),n.append("wfacp_nonce",wfacp_secure.nonce),e(a).attr("method"),0===e(a).find("."+t+"_ajax_loader").length?(e(a).find(".bwf_form_submit").prepend("<span class='"+t+"_ajax_loader spinner'></span>"),i=e(a).find("."+t+"_ajax_loader")):i=e(a).find("."+t+"_ajax_loader");var r=e(".bwf_ajax_btn_bottom_container");i.addClass("ajax_loader_show"),r.addClass("ajax_loader_show");var c=e(a).find("fieldset");c.length>0&&c.prop("disabled",!0),s.before_send(a,t);var _=s.data(n,a),p={url:ajaxurl,async:s.async(!0),method:s.method("POST"),data:_,processData:!1,contentType:!1,success:function(e,a,l){"object"===_typeof(e)&&e.hasOwnProperty("nonce")&&(wfacp_secure.nonce=e.nonce,delete e.nonce),d(t+"_ajax_success",c,i,e,a,l),s.success(e,a,l,c,i)},complete:function(e,a,l){d(t+"_ajax_complete",c,i,e,a,l),s.complete(e,a,l,c,i)},error:function(e,a,l){d(t+"_ajax_error",c,i,e,a,l),s.error(e,a,l,c,i)}};o.hasOwnProperty(t)?clearTimeout(o[t]):o[t]=null,o[t]=setTimeout(function(t){e.ajax(t)},200,p)}(a))}),"function"==typeof i&&i(s))}(t),this):!1===a?(function(t){e(t).length>0&&(e(t).on("click",function(t){t.preventDefault();var a=e(this).data("bwf-action");"undefined"!==a&&(a=(a=n+a).trim(),l=this,s.action=a,function(t){var a=l,i=s.data({},a);"object"===_typeof(i)?i.action=t:i={action:t},s.before_send(a,t),i.wfacp_nonce=wfacp_secure.nonce;var n={url:ajaxurl,async:s.async(!0),method:s.method("POST"),data:i,success:function(e,t,a){"object"===_typeof(e)&&e.hasOwnProperty("nonce")&&(wfacp_secure.nonce=e.nonce,delete e.nonce),s.success(e,t,a,l)},complete:function(e,t,a){s.complete(e,t,a,l)},error:function(e,t,a){s.error(e,t,a,l)}};o.hasOwnProperty(t)?clearTimeout(o[t]):o[t]=null,o[t]=setTimeout(function(t){e.ajax(t)},200,n)}(a))}),"function"==typeof i&&i(s))}(t),this):this},hooks:{hooks:{action:{},filter:{}},addAction:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this.addHook("action",e,t,a,i)},addFilter:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this.addHook("filter",e,t,a,i)},doAction:function(e){this.doHook("action",e,arguments)},applyFilters:function(e){return this.doHook("filter",e,arguments)},removeAction:function(e,t){this.removeHook("action",e,t)},removeFilter:function(e,t,a){this.removeHook("filter",e,t,a)},addHook:function(e,t,a,i,s){void 0==this.hooks[e][t]&&(this.hooks[e][t]=[]);var l=this.hooks[e][t];void 0==s&&(s=t+"_"+l.length),void 0==i&&(i=10),this.hooks[e][t].push({tag:s,callable:a,priority:i})},doHook:function(e,t,a){if(a=Array.prototype.slice.call(a,1),void 0!=this.hooks[e][t]){var i,s=this.hooks[e][t];s.sort(function(e,t){return e.priority-t.priority});for(var l=0;l<s.length;l++)"function"!=typeof(i=s[l].callable)&&(i=window[i]),"action"==e?i.apply(null,a):a[0]=i.apply(null,a)}if("filter"==e)return a[0]},removeHook:function(e,t,a,i){if(void 0!=this.hooks[e][t])for(var s=this.hooks[e][t],l=s.length-1;l>=0;l--)void 0!=i&&i!=s[l].tag||void 0!=a&&a!=s[l].priority||s.splice(l,1)}},tools:{ol:function(e){var t=0;return null!=e&&"object"===_typeof(e)&&(t=Object.keys(e).length),t},isEmpty:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},hp:function(e,t){var a=!1;return"object"===_typeof(e)&&void 0!==t&&(a=e.hasOwnProperty(t)),a},jsp:function(e){if("object"===_typeof(e)){var t=JSON.stringify(e);return t=JSON.parse(t)}return e},kys:function(e){return"object"===_typeof(e)&&null!=e&&this.ol(e)>0?Object.keys(e):[]},ucfirst:function(e){return e.replace(/^\w/,function(e){return e.toUpperCase()})},stripHTML:function(t){return e("<div>"+t+"</div>").text()},string_to_bool:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return""!==e&&"false"!=e&&("boolean"==typeof e?e:"yes"===e||1===e||"true"===e||"1"===e)},is_object:function(e){return null!=e&&"object"===_typeof(e)},is_bool:function(e){return"boolean"==typeof(e=wfacp.tools.string_to_bool(e))},timestamp:function(){return(new Date).getTime()}},swal:function(t){return wfacp_swal(e.extend({title:"",text:"",type:"error",showCancelButton:!0,confirmButtonColor:"#0073aa",cancelButtonColor:"#e33b3b",confirmButtonText:""},t))},model:{add_product:function(){var t=e("#modal-add-product");t.length>0&&t.iziModal({title:"Add Product",headerColor:"#6dbe45",background:"#efefef",borderBottom:!1,width:600,radius:6,overlayColor:"rgba(0, 0, 0, 0.35)",transitionIn:"fadeInDown",transitionOut:"fadeOutDown",navigateArrows:"false"})}},sortable:function(t,a,i,s){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:".wfacp_item_drag",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:".ui-state-disabled",n=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},r=e(t);if(0!==r.length){r.off("sortable");var c={connectWith:t,start:function(e,t){a(e,t)},stop:function(e,t){i(e,t)},over:function(e,t){s("in",e,t)},out:function(e,t){s("out",e,t)},cursor:"move"};if(wfacp.tools.ol(d)>0)for(var _ in d)c[_]=d[_];var p=".wfacp_item_drag";""!==l&&(p=l),""!==o&&(p+=":not("+o+")"),c.items=p,""!==n&&(c.placeholder=n),r.sortable(c),r.disableSelection()}},addClass:function(t,a){e(t).addClass(a)},removeClass:function(t,a){e(t).removeClass(a)},show_spinner:function(){var t=e(".wfacp_spinner.spinner");t.length>0&&t.css("visibility","visible")},hide_spinner:function(){var t=e(".wfacp_spinner.spinner");t.length>0&&t.css("visibility","hidden")},show_data_save_model:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";""!==e&&(wfacp.show_saved_model.iziModal("setTitle",e),wfacp.show_saved_model.iziModal("open"))},show_data_error_model:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";""!==e&&(wfacp.show_saved_model.iziModal("setTitle",e),wfacp.show_saved_model.iziModal("open"))},is_global_checkout:function(){return wfacp.tools.hp(wfacp_data,"global_settings")&&wfacp.tools.hp(wfacp_data.global_settings,"override_checkout_page_id")&&wfacp_data.global_settings.override_checkout_page_id==wfacp_data.id},editorConfig:{tinymce:{theme:"modern",skin:"lightgray",language:"en",formats:{alignleft:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"left"}},{selector:"img,table,dl.wp-caption",classes:"alignleft"}],aligncenter:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"center"}},{selector:"img,table,dl.wp-caption",classes:"aligncenter"}],alignright:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"right"}},{selector:"img,table,dl.wp-caption",classes:"alignright"}],strikethrough:{inline:"del"}},relative_urls:!1,remove_script_host:!1,convert_urls:!1,browser_spellcheck:!0,fix_list_elements:!0,entities:"38,amp,60,lt,62,gt",entity_encoding:"raw",keep_styles:!1,cache_suffix:"wp-mce-4800-20180716",resize:"vertical",menubar:!1,branding:!1,preview_styles:"font-family font-size font-weight font-style text-decoration text-transform",end_container_on_empty_block:!0,wpeditimage_html5_captions:!0,wp_lang_attr:"en-US",wp_keep_scroll_position:!1,wp_shortcut_labels:{"Heading 1":"access1","Heading 2":"access2","Heading 3":"access3","Heading 4":"access4","Heading 5":"access5","Heading 6":"access6",Paragraph:"access7",Blockquote:"accessQ",Underline:"metaU",Strikethrough:"accessD",Bold:"metaB",Italic:"metaI",Code:"accessX","Align center":"accessC","Align right":"accessR","Align left":"accessL",Justify:"accessJ",Cut:"metaX",Copy:"metaC",Paste:"metaV","Select all":"metaA",Undo:"metaZ",Redo:"metaY","Bullet list":"accessU","Numbered list":"accessO","Insert/edit image":"accessM","Remove link":"accessS","Toolbar Toggle":"accessZ","Insert Read More tag":"accessT","Insert Page Break tag":"accessP","Distraction-free writing mode":"accessW","Add Media":"accessM","Keyboard Shortcuts":"accessH"},toolbar1:"bold,italic,bullist,numlist,link",wpautop:!1,indent:!0,elementpath:!1,plugins:"charmap,colorpicker,hr,lists,paste,tabfocus,textcolor,fullscreen,wordpress,wpautoresize,wpeditimage,wpemoji,wpgallery,wplink,wptextpattern"},quicktags:{buttons:"strong,em,link,ul,ol,li,code"}},show_pro_message:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=wfacp_localization.global.pro_feature_message_heading,s=wfacp_localization.global.pro_feature_message_subheading,l="";if("custom_heading"===t)l=a;else if(""!==a&&"product_settings"!==t)l=e(a).parent("span").text();else if("add_custom_field"===t)l=e(".template_field_selecter").find(".wfacp_input_fields_btn button").text();else if("add_new_step"===t)l=e(".wfacp_modal_open.wfacp_step_add_step_btn").find("span").text();else if(""!==a&&"product_settings"===t){var o=e("."+a).find("label").text().split("(");l=o.length>0?o[0]:o}if(i=i.replace("{feature_name}",l.trim()),s=s.replace("{feature_name}",l.trim()),!_.isEmpty(l)){var n=wfacp_localization.global.get_pro_link;if(-1==n.indexOf("utm_content"))-1!=n.indexOf("?")?Vue.set(wfacp_localization.global,"get_pro_link",n+"&utm_content="+l.trim()):Vue.set(wfacp_localization.global,"get_pro_link",n+"?utm_content="+l.trim());else{var d=new URL(n),r=d.searchParams;r.delete("utm_content"),r.append("utm_content",l.trim()),d.search=r.toString();var c=d.toString();Vue.set(wfacp_localization.global,"get_pro_link",c)}}var p=wfacp.swal({text:s,title:i,type:"",confirmButtonText:wfacp_localization.global.upgrade_button_text,showCancelButton:!0,showCloseButton:!0,customClass:"swal-pro-modal swal-upgrade-pro",reverseButtons:!0});p.then(function(e){e.value&&window.open(wfacp_localization.global.get_pro_link)}),p.catch(function(){})}}}(jQuery),function(e){var t=function(){function t(e){_classCallCheck(this,t),null!==document.getElementById("wfacp_product_container")&&this.init(e)}return _createClass(t,[{key:"init",value:function(e){this.search_timeout=null,this.search_model_open=null,this.show_saved_model=null,this.id=e.id,this.name=e.name,this.wfacp_id=e.id,this.currency=e.currency,this.products=e.products,this.add_to_cart_setting=e.products_settings.add_to_cart_setting,this.last_active_product="",this.addProductModel(),this.main()}},{key:"main",value:function(){var t=this;return this.product_vue=new Vue({el:"#wfacp_product_container",created:function(){wfacp.hooks.doAction("wfacp_product_ui_created",this),this.sortable()},methods:{sortable:function(){var t=this;setTimeout(function(){e(".wfacp_product_table_sortable").sortable({items:"tr",cursor:"move",axis:"y",handle:"td.wfacp_product_drag_handle .wfacp_drag_handle",scrollSensitivity:40,stop:function(e,a){t.StopSortable(e,a)}})},800)},StopSortable:function(e,t){},isEmpty:function(){return 0===wfacp.tools.ol(this.products)},addProduct:function(t,a){var i=this;e(".wfacp-preview").show(),e(".wfacp_s_menu_rules").removeClass("wfacp_stop_navigation"),null===this.products&&(this.products={}),Vue.set(this.products,t,a),setTimeout(function(){i.save_products()},600)},removeProduct:function(a){wfacp.swal({html:'<div class="wf_delete_modal_content">'.concat(wfacp_localization.global.remove_product.text,"</div>"),type:"error",confirmButtonText:wfacp_localization.global.remove_product.confirmButtonText,reverseButtons:!0,showCloseButton:!0,onOpen:function(){document.querySelector(".swal2-header").insertAdjacentHTML("beforebegin",'<div class="wffn-swal-modal-title">'+wfacp_localization.global.remove_product.modal_title+"</div>")},preConfirm:function(){return e("button.swal2-cancel.swal2-styled").removeAttr("disabled"),new Promise(function(e){t.removeProduct(a,function(a){t.formHasChanges=!0,e(a)})})}}).catch(function(e){console.log("Remove product error",e)})},set_product_data:function(e,a,i){if(null!=i.target){t.formHasChanges=!0;var s=i.target.value?i.target.value:"";if(this.last_active_product=e,"discount_amount"===a){var l=this.products[e].discount_type;"percent_discount_sale"!==l&&"percent_discount_reg"!==l||s>100&&(s=100)}else if("discount_type"===a){var o=this.products[e].discount_amount;"percent_discount_sale"!==s&&"percent_discount_reg"!==s||(o=0,Vue.set(this.products[e],"discount_amount",o))}Vue.set(this.products[e],a,s)}},remove_non_required_keys:function(e){if(wfacp.tools.ol(e)>0)for(var t in e=wfacp.tools.jsp(e))delete e[t].price,delete e[t].regular_price,delete e[t].sale_price,delete e[t].image;return e},save_products:function(){var a=this,i=new wfacp.ajax,s=this.remove_non_required_keys(this.products),l={},o=e(".wfacp-product-row");0===o.length?l=s:o.each(function(){var t=e(this).attr("id");l[t]=s[t]});var n={products:l,wfacp_id:t.id,settings:{add_to_cart_setting:this.add_to_cart_setting},last_active_product:this.last_active_product};i.ajax("save_products",n),e(".wfacp_save_btn_style").addClass("is_busy"),i.success=function(t){e(".wfacp_save_btn_style").removeClass("is_busy"),wfacp.show_data_save_model(t.msg),a.sortable()}}},data:{have_variable:!1,name:this.name,currency:this.currency,products:this.products,add_to_cart_setting:this.add_to_cart_setting,last_active_product:this.last_active_product}}),this.product_vue}},{key:"addProducts",value:function(e){if(wfacp.tools.hp(e,"products")&&wfacp.tools.ol(e.products)>0){var t=e.products;for(var a in t)this.product_vue.addProduct(a,t[a])}}},{key:"removeProduct",value:function(t,a){var i=this,s=e("#"+t);s.length>0&&s.find(".wfacp_overlay_active").removeClass("wfacp_overlay_none_here");var l=new wfacp.ajax;l.ajax("remove_product",{product_key:t,wfacp_id:this.id}),l.complete=function(s){wfacp.tools.ol(s)>0&&(Vue.delete(i.product_vue.products,t),0===wfacp.tools.ol(i.product_vue.products)?(e(".wfacp-preview").hide(),e(".wfacp_s_menu_rules").addClass("wfacp_stop_navigation")):e(".wfacp_overlay_active").addClass("wfacp_overlay_none_here")),"function"==typeof a&&a(s)}}},{key:"addProductVue",value:function(t){if(!0!==this.search_model_open){this.search_model_open=!0;var a=this;return this.add_product_vue=new Vue({el:"#modal-add-product-form",components:{Multiselect:window.VueMultiselect.default},data:{modal:t,isLoading:!1,products:[],is_single:"",include_variations:!1,selectedProducts:[]},methods:{onSubmit:function(){var t=new wfacp.ajax,i=this;if(a.add_product_vue.$el){var s=a.add_product_vue.$el.querySelector(".wfacp_btn.wfacp_btn_primary");e(s).addClass("is_busy")}var l=[],o=this.selectedProducts;if(wfacp.tools.ol(this.selectedProducts)>0)for(var n in o)l.push(o[n].id);var d={products:l,wfacp_id:a.id};t.ajax("add_product",d),t.success=function(t){wfacp.tools.ol(t)>0&&a.addProducts(t),e("#modal-add-product").iziModal("close")},t.complete=function(){if(i.clearAll(),a.add_product_vue.$el){var t=a.add_product_vue.$el.querySelector(".wfacp_btn.wfacp_btn_primary");e(t).removeClass("is_busy")}}},asyncFind:function(e){var t=this;this.isLoading=!0,""!==e?(clearTimeout(a.search_timeout),a.search_timeout=setTimeout(function(e){var a=new wfacp.ajax,i={term:e,variations:t.include_variations};a.ajax("product_search",i),a.success=function(e){t.products=e,t.isLoading=!1},a.complete=function(){t.isLoading=!1}},1e3,e)):this.isLoading=!1},clearAll:function(){this.products=[],this.selectedProducts=[],this.isLoading=!1}}}),this.add_product_vue}}},{key:"addProductModel",value:function(){var t=this,a=e("#modal-add-product");a.length>0&&a.iziModal({title:wfacp_localization.global.add_product_popup,headerColor:"#6dbe45",background:"#efefef",borderBottom:!1,width:600,radius:6,overlayColor:"rgba(0, 0, 0, 0.35)",transitionIn:"fadeInUp",transitionOut:"fadeOut",navigateArrows:"false",onOpening:function(e){t.addProductVue(e)}})}}]),t}(),a=function(){function t(e){var a=this;_classCallCheck(this,t),this.add_field_model_open=!1,this.add_section_model_open=!1,this.edit_field_model_open=!1,this.step_name="single_step",this.current_edit_field={},this.field_index=null,null!=document.getElementById("wfacp_layout_container")&&(this.builder=e,this.id=e.id,this.steps=e.layout.steps,this.input_fields=e.layout.input_fields,this.available_fields=e.layout.available_fields,this.fieldsets=e.layout.fieldsets,this.available_steps=["single_step","two_step","third_step"],this.model(),this.main(),this.editFieldVue(),wfacp.hooks.addFilter("wfacp_field_data_merge_with_model",function(e,t){return a.field_data_merge_with_model(e,t)}),wfacp.hooks.addFilter("wfacp_before_field_save",function(e,t){return a.wfacp_before_field_save(e,t)}))}return _createClass(t,[{key:"main",value:function(){var t=this;return this.layout_vue=new Vue({el:"#wfacp_layout_container",created:function(){this.enableSortable(),wfacp.hooks.doAction("wfacp_layout_created",this),this.enableTabs(),this.validateDependency()},methods:{enableTabs:function(){var t=this;setTimeout(function(){e(document).on("click",".wfacp_template_tabs",function(){if(!e(this).hasClass("wfacp_active_tabs")){var a=e(this).data("slug");t.show_template_frame(a)}})},1500)},set_template:function(e){Vue.set(this,"current_step",e),this.enableSortable(),this.show_template_frame(e)},show_template_frame:function(t){setTimeout(function(){var a=e(".single_step_template[data-slug='"+t+"']"),i=e(".wfacp_template_tabs[data-slug='"+t+"']");a.length>0&&(e(".wfacp_template_tabs").removeClass("wfacp_active_tabs"),e(".single_step_template").hide(),i.addClass("wfacp_active_tabs"),a.show())},0,t)},enableSortable:function(){var e=this;setTimeout(function(){wfacp.sortable(".template_field_container",e.StartSortable,e.StopSortable,e.hoverDrag,"","","wfacp_save_btn_style ui-sortable-placeholder ui-state-highlight"),wfacp.sortable(".wfacp_sections_holder.single_step",e.StartSectionSortable,e.StopSectionSortable,function(){},".wfacp_field_container","","",{axis:"y"})},300)},StartSectionSortable:function(t,a){e(t.toElement).parents(".wfacp_field_container").addClass("highlight_field_container")},StopSectionSortable:function(t,a){e(t.toElement).parents(".wfacp_field_container").removeClass("highlight_field_container")},hoverDrag:function(t,a,i){var s=e(a.target).find(".template_field_placeholder_tbl");"in"===t?e(a.toElement).parents(".wfacp_field_container")[0]!==e(a.target).parents(".wfacp_field_container")[0]&&(e(a.target).parents(".wfacp_field_container").addClass("highlight_field_container"),s.length>0&&s.hide()):(s.length>0&&s.show(),e(a.target).parents(".wfacp_field_container").removeClass("highlight_field_container"))},StartSortable:function(t,a){var i=e(".wfacp_save_btn_style.ui-sortable-placeholder.ui-state-highlight");e(a.item[0]).length>0&&i.length>0&&(i.width(e(a.item[0]).width()),i.html("<span class='wfacp_placeholder_text_here'>placeholder</span>")),wfacp.addClass(".wfacp_field_container","activate_dragging_field")},StopSortable:function(t,a){e(".wfacp_field_container").removeClass("activate_dragging_field highlight_field_container");var i,s=e(t.toElement).parents(".wfacp_field_container"),l=e(t.target),o=e(t.toElement);"span"===t.toElement.localName&&(o=e(t.toElement).parent("div")),i=o.attr("data-id");var n=s.attr("step-name"),d=l.attr("step-name"),r=s.attr("field-index"),c=l.attr("field-index");n!==d?(o.remove(),this.parentSwitching(d,n,c,r,i)):r!==c&&(o.remove(),this.updateInput(n,c,r,i))},elementSorting:function(e,t){},dragStart:function(e){t.dragStart(e)},allowDrop:function(e){t.allowDrop(e)},dragEnd:function(e){t.dragEnd(e)},dragEnter:function(e){t.dragEnter(e)},dragLeave:function(e){t.dragLeave(e)},drop:function(e,a,i){var s=t.drop(e);if(!1===s)return null;var l=s[0],o=s[1];if(""===o)return null;this.addInput(a,i,l,o)},addInput:function(t,a,i,s){var l,o=!0,n=e(".single_step").find(".wfacp_field_container[field-index="+a+"]");(n.length>0&&n.find(".wfacp_item_drag[data-id="+i+"]").length>0&&(o=!1),o)&&((l=wfacp.tools.jsp(this.input_fields[s][i])).id=i,l.field_type=s,this.pushFieldInStep(t,a,l),Vue.delete(this.input_fields[s],i),this.validateDependency(),e(".wfacp_field_container").removeClass("highlight_field_container"),e(".wfacp_field_container").removeClass("highlight_field_container activate_dragging_field"))},getFieldFromSection:function(e,t,a){var i=this.findFieldIndex(e,t,a);if(null==i)return null;var s=wfacp.tools.jsp(this.fieldsets[e][t].fields[i]);return wfacp.tools.hp(this.fieldsets[e][t],"fields")||Vue.set(this.fieldsets[e][t],"fields",[]),s},pushFieldInStep:function(e,t,a){wfacp.tools.hp(this.fieldsets[e][t],"fields")||Vue.set(this.fieldsets[e][t],"fields",[]);var i=wfacp.tools.jsp(this.fieldsets[e][t].fields);i.push(a),Vue.set(this.fieldsets[e][t],"fields",i),this.hideFieldContainerPlaceholder(e,t)},parentSwitching:function(e,t,a,i,s){var l=this.getFieldFromSection(e,a,s);if(null!==l){this.pushFieldInStep(t,i,l);var o=wfacp.tools.jsp(this.fieldsets[e][a].fields);Vue.set(this.fieldsets[e][a],"fields",o)}},updateInput:function(e,t,a,i){var s=this.getFieldFromSection(e,t,i);null!=s&&this.pushFieldInStep(e,a,s)},moveStepField:function(e){wfacp.hooks.doAction("manage_step_field",wfacp.tools.jsp(e),this);var t=wfacp.tools.jsp(this.fieldsets[e]);if(void 0!==t&&0!==wfacp.tools.ol(t))for(var a in t)if(0!==wfacp.tools.ol(t[a].fields)){for(var i=t[a].fields,s=0;s<i.length;s++){var l=i[s].id,o=i[s].field_type;Vue.set(this.input_fields[o],l,i[s])}Vue.set(this.fieldsets[e][a],"fields",[])}},removeField:function(e,t,a,i,s){s.stopPropagation();var l=this.findFieldIndex(e,i,t);if(null==l)return null;var o=wfacp.tools.jsp(this.fieldsets[e][i].fields),n=o[l];return o.splice(l,1),Vue.set(this.fieldsets[e][i],"fields",o),wfacp.tools.ol(n)>0&&Vue.set(this.input_fields[a],t,n),this.showFieldContainerPlaceholder(e,i),this.validateDependency(),!0},findFieldIndex:function(e,t,a){if(!wfacp.tools.hp(this.fieldsets[e][t],"fields"))return this.fieldsets[e][t].fields=[],null;var i=wfacp.tools.jsp(this.fieldsets[e][t].fields);if(0===i.length)return null;for(var s=0;s<i.length;s++)if(i[s].id===a)return s;return null},prepareErrorMsg:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=[];for(var i in e)a.push(e[i]);return a.join(t)},getRequiredField:function(){return wfacp.tools.jsp(wfacp_localization.fields.input_field_error)},getEmptySteps:function(){return wfacp.tools.jsp(wfacp_localization.fields.steps_error_msgs)},getSortedElement:function(){var t=this,a=this.getRequiredField(),i=this.getEmptySteps(),s={},l=!1,o=!1,n=0,d=1,r=!1,c=!1,_=e(".single_step_template"),p={single_step:[],two_step:[],third_step:[]},f=["order_summary","order_coupon","product_switching","shipping_calculator"];if(_.length>0){var u=1;_.each(function(){var _=0,h=e(this).attr("data-slug");if(0!==e(this).find(".wfacp_item_drag").length)if(wfacp.tools.hp(t.fieldsets,h)){var w=wfacp.tools.jsp(t.fieldsets[h]);if(0!==w.length){var m=e(this).find(".wfacp_field_container");m.length>0&&m.each(function(i,s){var m=e(this),g=m.attr("field-index"),v=m[0].querySelectorAll(".wfacp_item_drag");if(!1===wfacp.tools.hp(p,h)&&(p[h]=wfacp.tools.jsp(w)),0!==v.length){p[h][_]=wfacp.tools.jsp(w[g]),p[h][_].fields=[],p[h][_].html_fields={};var b=wfacp.tools.jsp(w[g].fields);v.forEach(function(e,i){var s=e.getAttribute("data-id");"address"===s&&(l=!0,n=u),"shipping-address"===s&&(o=!0,d=u),"shipping_calculator"===s&&(c=!0),"order_coupon"===s&&(r=!0),f.indexOf(s)>-1&&(p[h][_].html_fields[s]=!0),wfacp.tools.hp(a,s)&&delete a[s];var w=t.findFieldIndex(h,g,s);if(null!==w){var m=b[w];p[h][_].fields.push(m)}u++}),_++}})}else s[h]=i[h]}else s[h]=i[h];else s[h]=i[h]})}return{fieldsets:p,required:a,empty_steps:s,have_billing_address:l,have_shipping_address:o,have_billing_address_index:n,have_shipping_address_index:d,enabled_product_switching:"no",have_shipping_method:c,have_coupon_field:r}},showStepsError:function(e){var t=e;wfacp_localization.global.confirm_button_text;0!==Object.keys(t).length&&t.hasOwnProperty("third_step")&&(delete t.third_step,wfacp_localization.global.confirm_button_text_ok);var a=this.prepareErrorMsg(t," and ");return a+=" "+wfacp_localization.fields.empty_step_error,wfacp.swal({text:a,title:wfacp_localization.fields.validation_error,type:"error",confirmButtonText:wfacp_localization.importer.close_prompt_text,showCloseButton:!0,showCancelButton:!1,actions:"bwf-swal-single-cta"}),!1},save_template:function(){var a=this.getSortedElement(),i=a.empty_steps,s=wfacp.tools.ol(i);if(s>0){if(1!==s)return this.showStepsError(i),!1;var l=e(".wfacp_step_heading .wfacp_template_tabs:last").data("slug");if(!wfacp.tools.hp(i,l))return this.showStepsError(i),!1}var o=a.required;if(wfacp.tools.ol(o)>0){var n=this.prepareErrorMsg(o);return wfacp.swal({text:n,title:"Validation Error",type:"error",confirmButtonText:wfacp_localization.global.confirm_button_text,showCancelButton:!1,actions:"bwf-swal-single-cta"}),!1}var d=t.editFieldVue(),r=new wfacp.ajax,c={steps:wfacp.tools.jsp(this.steps),fieldsets:a.fieldsets,address_order:d.addressOrder,wfacp_id:t.id,have_billing_address:a.have_billing_address,have_shipping_address:a.have_shipping_address,have_billing_address_index:a.have_billing_address_index,have_shipping_address_index:a.have_shipping_address_index,have_shipping_method:a.have_shipping_method,have_coupon_field:a.have_coupon_field,current_step:this.current_step};r.ajax("save_layout",c),e("#wfacp_save_form_layout").addClass("is_busy"),r.success=function(t){wfacp.show_data_save_model(t.msg),e("#wfacp_save_form_layout").removeClass("is_busy")}},addField:function(){t.modal_add_field.iziModal("open")},editField:function(a,i,s,l){var o=t.editFieldVue(),n=wfacp.tools.jsp(this.fieldsets[a][i].fields[s]);o.current_field_id=n.id,t.current_edit_field={step_name:a,index:s,section:i,field:n};if(e.inArray(n.id,["address","shipping-address","product_switching","shipping-address","wysiwyg_editor"])>-1||e.inArray(n.type,[])>-1)o.model_sub_title="",o.edit_model_field_label="",o.model_field_type="";else{"advanced"===n.field_type&&" | "+wfacp_localization.fields.field_types_label+" : "+n.type,o.edit_model_field_label=n.data_label,"wfacp_wysiwyg"!=n.type?o.model_sub_title=wfacp_localization.fields.field_id_slug+" : "+n.id:o.model_sub_title=wfacp_localization.fields.field_types_label+" : "+n.type}o.setData()},deleteCustomFieldAjax:function(a,i,s,l,o){if(!s)return!1;Vue.delete(l.input_fields[a],i),Vue.delete(l.available_fields[a],i);var n=new wfacp.ajax,d={section:a,index:i,wfacp_id:t.id};n.ajax("delete_custom_field",d),e(".swal2-confirm.swal2-styled").addClass("is_busy"),n.success=function(a){e(".swal2-confirm.swal2-styled").addClass("is_busy"),!0===a.status&&(t.addField(a.data),wfacp.show_data_save_model(a.msg)),"function"==typeof o&&o(a)}},deleteCustomField:function(t,a,i){var s=wfacp_localization.fields.delete_c_field_sub_heading.replace("{{field_name}}","<strong>".concat(i,"</strong>")),l=this;wfacp.swal({html:'<div class="wf_delete_modal_content">'.concat(s,"</div>"),type:"",confirmButtonText:wfacp_localization.fields.yes_delete_the_field,cancelButtonText:wfacp_localization.global.cancel_button_text,showCancelButton:!0,reverseButtons:!0,showCloseButton:!0,onOpen:function(){document.querySelector(".swal2-header").insertAdjacentHTML("beforebegin",'<div class="wffn-swal-modal-title">'+wfacp_localization.fields.delete_modal+"</div>")},preConfirm:function(i){return e("button.swal2-cancel.swal2-styled").removeAttr("disabled"),new Promise(function(e){l.deleteCustomFieldAjax(t,a,i,l,function(t){e(t)})})}}).catch(function(e){console.log("Delete Custom Field Error:",e)})},addSection:function(e){t.step_name=e,t.field_index=null,t.modal_add_section.iziModal("setTitle","Add Section"),t.modal_add_section.iziModal("open")},editSection:function(e,a){t.step_name=e,t.field_index=a,t.modal_add_section.iziModal("setTitle","Edit Section"),t.modal_add_section.iziModal("open")},deleteSection:function(e,t){var a=this,i=wfacp.tools.jsp(this.fieldsets[e][t]),s=i.name,l=wfacp_localization.fields.section.delete.replace("{{section_name}}","<strong>".concat(s,"</strong>")),o=wfacp.swal({type:"error",html:'<div class="wf_delete_modal_content">'.concat(l,"</div>"),confirmButtonText:wfacp_localization.global.confirm_button_text,reverseButtons:!0,showCloseButton:!0,onOpen:function(){document.querySelector(".swal2-header").insertAdjacentHTML("beforebegin",'<div class="wffn-swal-modal-title">'+wfacp_localization.fields.section.modal_title+"</div>")}});o.then(function(s){if(!wfacp.tools.hp(s,"value"))return!1;if(wfacp.tools.hp(i,"fields")&&wfacp.tools.ol(i.fields)>0)for(var l=i.fields,o=0;o<l.length;o++){var n=l[o],d=n.id,r=n.field_type;Vue.set(a.input_fields[r],d,n)}Vue.delete(a.fieldsets[e],t),a.validateDependency()}),o.catch(function(e){})},showFieldContainerPlaceholder:function(t,a){var i=e(".template_field_container."+t+"[field-index="+a+"]");i.length>0&&(0===i.find(".wfacp_item_drag").length&&i.find(".template_field_placeholder_tbl").show())},hideFieldContainerPlaceholder:function(t,a){var i=e(".template_field_container."+t+"[field-index="+a+"]");i.length>0&&i.find(".template_field_placeholder_tbl").hide()},showHideGlobalDependency:function(e){var t=this.global_dependency_messages;if(wfacp.tools.ol(t)>0)for(var a in t){var i=t[a];if(wfacp.tools.hp(i,"id"))wfacp.tools.hp(e,i.id)?t[a].show="no":t[a].show="yes";else if(wfacp.tools.hp(i,"ids")){for(var s=i.ids,l=[],o=0;o<s.length;o++)wfacp.tools.hp(e,s[o])&&l.push(s[o]);0===l.length?t[a].show="yes":t[a].show="no"}}wfacp.hooks.doAction("show_hide_global_dependency",t)},remove_dependency_messages:function(e){var a=this,i=new wfacp.ajax,s=this.global_dependency_messages[e],l="self";wfacp.tools.hp(s,"is_global")&&wfacp.tools.string_to_bool(s.is_global)&&(l="global");var o={index:e,wfacp_id:t.id,message_type:l};i.ajax("hide_notification",o),i.success=function(t){Vue.delete(a.global_dependency_messages,e)}},validateDependency:function(){var e=this;setTimeout(function(){var t=wfacp.tools.jsp(e.fieldsets),a={};for(var i in t){var s=t[i];if(0!==s.length)for(var l in s){var o=s[l].fields;if(0!==o.length)for(var n=0;n<o.length;n++){a[o[n].id]=1}}}e.showHideGlobalDependency(a)})}},data:{current_step:this.builder.layout.current_step,steps:this.steps,fieldsets:this.fieldsets,input_fields:this.input_fields,available_fields:this.available_fields,required_fields:wfacp_localization.fields.input_field_error,error:[],noofstep:1,error_msg:{},global_dependency_messages:this.builder.global_dependency_messages}}),this.layout_vue}},{key:"defaultStepObj",value:function(e){return{name:"Step",slug:"step_"+e,friendly_name:"Step "+e,active:"yes"}}},{key:"dragStart",value:function(e){wfacp.addClass(".wfacp_field_container","activate_dragging_field"),e.dataTransfer.setData("unique_id",e.target.id),e.dataTransfer.setData("section_name",e.target.getAttribute("data-input-section"))}},{key:"dragEnd",value:function(e){wfacp.removeClass(".wfacp_field_container","activate_dragging_field"),wfacp.removeClass(".wfacp_field_container","highlight_field_container")}},{key:"drop",value:function(e){e.preventDefault();var t=e.dataTransfer.getData("unique_id");if(t===e.target.id)return!1;var a=e.dataTransfer.getData("section_name");return this.layout_vue.enableSortable(),[t,a]}},{key:"allowDrop",value:function(e){e.preventDefault()}},{key:"dragEnter",value:function(t){e(t.target).parents(".wfacp_field_container").removeClass(t.target,"activate_dragging_field"),e(t.target).parents(".wfacp_field_container").addClass("highlight_field_container")}},{key:"dragLeave",value:function(t){e(t.target).parents(".wfacp_field_container").addClass(t.target,"activate_dragging_field"),e(t.target).parents(".wfacp_field_container").removeClass("highlight_field_container")}},{key:"getSection",value:function(e,t){return wfacp.tools.hp(this.layout_vue.fieldsets,e)&&wfacp.tools.hp(this.layout_vue.fieldsets[e],t)?wfacp.tools.jsp(this.layout_vue.fieldsets[e][t]):null}},{key:"addSection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===wfacp.tools.ol(t))return!1;!1===wfacp.tools.hp(this.layout_vue.fieldsets,this.step_name)&&Vue.set(this.layout_vue.fieldsets,this.step_name,[]);var a=wfacp.tools.jsp(this.layout_vue.fieldsets[this.step_name]);a.push({name:t.name,class:t.class,sub_heading:t.sub_heading,fields:[]}),Vue.set(this.layout_vue.fieldsets,this.step_name,a),this.layout_vue.enableSortable()}},{key:"updateSection",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(0===wfacp.tools.ol(a))return!1;if(wfacp.tools.hp(this.layout_vue.fieldsets,e)&&wfacp.tools.hp(this.layout_vue.fieldsets[e],t)){var i=wfacp.tools.jsp(this.layout_vue.fieldsets[e][t]);return i.name=a.name,i.class=a.class,i.sub_heading=a.sub_heading,Vue.set(this.layout_vue.fieldsets[e],t,i),!0}return!1}},{key:"addField",value:function(e){if(wfacp.tools.ol(e)>0){var t=e.unique_id,a=e.field_type;Vue.set(this.layout_vue.input_fields[a],t,e),Vue.set(this.layout_vue.available_fields[a],t,e)}}},{key:"getAddressFields",value:function(){var e=[{type:"label",label:wfacp_localization.fields.show_field_label1,styleClasses:"wfacp_show_field_lable",visible:function(e){return!0===e.is_address}},{type:"label",label:wfacp_localization.fields.show_field_label2,styleClasses:"wfacp_show_field_lable",visible:function(e){return!0===e.is_address}},{type:"label",label:wfacp_localization.fields.show_field_label3,styleClasses:"wfacp_show_field_lable",visible:function(e){return!0===e.is_address}},{type:"switch",label:wfacp_localization.fields.address.first_name,model:"first_name",hint:"",textOn:wfacp_localization.global.active,textOff:wfacp_localization.global.inactive,styleClasses:["wfacp_first_name"],visible:function(e){return!0===e.is_address}},{type:"input",inputType:"text",label:wfacp_localization.fields.address.label,model:"first_name_label",hint:wfacp_localization.fields.address.billing_address_last_name_hint,placeholder:wfacp_localization.fields.first_name_label,visible:function(e){return!0===e.is_address&&"address"===e.id},validator:VueFormGenerator.validators.string},{type:"input",inputType:"text",label:wfacp_localization.fields.address.label,model:"first_name_label",placeholder:wfacp_localization.fields.first_name_label,visible:function(e){return!0===e.is_address&&"shipping-address"===e.id},validator:VueFormGenerator.validators.string},{type:"input",inputType:"text",label:wfacp_localization.fields.placeholder_field_label,model:"first_name_placeholder",placeholder:"First Name",visible:function(e){return!0===e.is_address},validator:VueFormGenerator.validators.string},{type:"switch",label:wfacp_localization.fields.address.last_name,model:"last_name",hint:"",textOn:wfacp_localization.global.active,textOff:wfacp_localization.global.inactive,styleClasses:["wfacp_last_name"],visible:function(e){return!0===e.is_address}},{type:"input",inputType:"text",label:wfacp_localization.fields.address.label,model:"last_name_label",hint:wfacp_localization.fields.address.billing_address_last_name_hint,placeholder:"",visible:function(e){return!0===e.is_address&&"address"===e.id},validator:VueFormGenerator.validators.string},{type:"input",inputType:"text",label:wfacp_localization.fields.address.label,model:"last_name_label",placeholder:"",visible:function(e){return!0===e.is_address&&"shipping-address"===e.id},validator:VueFormGenerator.validators.string},{type:"input",inputType:"text",label:wfacp_localization.fields.address.placeholder,model:"last_name_placeholder",placeholder:"",visible:function(e){return!0===e.is_address},validator:VueFormGenerator.validators.string},{type:"switch",label:wfacp_localization.fields.address.company,model:"company",hint:"",styleClasses:["wfacp_company"],textOn:wfacp_localization.global.active,textOff:wfacp_localization.global.inactive,visible:function(e){return!0===e.is_address}},{type:"input",inputType:"text",label:wfacp_localization.fields.address.label,model:"company_label",placeholder:"",visible:function(e){return!0===e.is_address},validator:VueFormGenerator.validators.string},{type:"input",inputType:"text",label:wfacp_localization.fields.address.placeholder,model:"company_placeholder",placeholder:"",visible:function(e){return!0===e.is_address},validator:VueFormGenerator.validators.string},{type:"switch",label:wfacp_localization.fields.address.street_address1,model:"street_address1",hint:"",styleClasses:["wfacp_address_1"],textOn:wfacp_localization.global.active,textOff:wfacp_localization.global.inactive,visible:function(e){return!0===e.is_address}},{type:"input",inputType:"text",label:wfacp_localization.fields.address.label,model:"street_address_1_label",placeholder:"",visible:function(e){return!0===e.is_address},validator:VueFormGenerator.validators.string},{type:"input",inputType:"text",label:wfacp_localization.fields.address.placeholder,model:"street_address_1_placeholder",placeholder:"",visible:function(e){return!0===e.is_address},validator:VueFormGenerator.validators.string},{type:"switch",label:wfacp_localization.fields.address.street_address2,model:"street_address2",hint:"",styleClasses:["wfacp_address_2"],textOn:wfacp_localization.global.active,textOff:wfacp_localization.global.inactive,visible:function(e){return!0===e.is_address}},{type:"input",inputType:"text",label:wfacp_localization.fields.address.label,model:"street_address_2_label",placeholder:"",visible:function(e){return!0===e.is_address},validator:VueFormGenerator.validators.string},{type:"input",inputType:"text",label:wfacp_localization.fields.address.placeholder,model:"street_address_2_placeholder",placeholder:"",visible:function(e){return!0===e.is_address},validator:VueFormGenerator.validators.string},{type:"switch",label:wfacp_localization.fields.address.city,hint:"",model:"address_city",styleClasses:["wfacp_city"],textOn:wfacp_localization.global.active,textOff:wfacp_localization.global.inactive,visible:function(e){return!0===e.is_address}},{type:"input",inputType:"text",label:wfacp_localization.fields.address.label,model:"address_city_label",placeholder:"City",visible:function(e){return!0===e.is_address},validator:VueFormGenerator.validators.string},{type:"input",inputType:"text",label:wfacp_localization.fields.address.placeholder,model:"address_city_placeholder",placeholder:"City",visible:function(e){return!0===e.is_address},validator:VueFormGenerator.validators.string},{type:"switch",label:wfacp_localization.fields.address.state,model:"address_state",styleClasses:["wfacp_state"],hint:"",textOn:wfacp_localization.global.active,textOff:wfacp_localization.global.inactive,visible:function(e){return!0===e.is_address}},{type:"input",inputType:"text",label:wfacp_localization.fields.address.label,model:"address_state_label",placeholder:"State",visible:function(e){return!0===e.is_address},validator:VueFormGenerator.validators.string},{type:"input",inputType:"text",label:wfacp_localization.fields.address.placeholder,model:"address_state_placeholder",placeholder:"State",visible:function(e){return!0===e.is_address},validator:VueFormGenerator.validators.string},{type:"switch",label:wfacp_localization.fields.address.zip,model:"address_postcode",hint:"",styleClasses:["wfacp_postcode"],textOn:wfacp_localization.global.active,textOff:wfacp_localization.global.inactive,visible:function(e){return!0===e.is_address}},{type:"input",inputType:"text",label:wfacp_localization.fields.address.label,model:"address_postcode_label",placeholder:"Postcode",visible:function(e){return!0===e.is_address},validator:VueFormGenerator.validators.string},{type:"input",inputType:"text",label:wfacp_localization.fields.address.placeholder,model:"address_postcode_placeholder",placeholder:"Postcode",visible:function(e){return!0===e.is_address},validator:VueFormGenerator.validators.string},{type:"switch",label:wfacp_localization.fields.address.country,model:"address_country",hint:"",styleClasses:["wfacp_country"],textOn:wfacp_localization.global.active,textOff:wfacp_localization.global.inactive,visible:function(e){return!0===e.is_address}},{type:"input",inputType:"text",label:wfacp_localization.fields.address.lable,model:"address_country_label",placeholder:"USA",visible:function(e){return!0===e.is_address},validator:VueFormGenerator.validators.string},{type:"input",inputType:"text",label:wfacp_localization.fields.address.placeholder,model:"address_country_placeholder",placeholder:"USA",visible:function(e){return!0===e.is_address},validator:VueFormGenerator.validators.string},{type:"switch",label:wfacp_localization.fields.same_as_billing,model:"same_as_billing",textOn:wfacp_localization.global.active,textOff:wfacp_localization.global.inactive,styleClasses:"wfacp_full_width_fields",visible:function(e){return!0===e.is_address&&"shipping-address"===e.id}},{type:"input",inputType:"text",label:wfacp_localization.fields.address.lable,model:"same_as_billing_label",hint:wfacp_localization.fields.same_as_billing_label_hint,styleClasses:"wfacp_full_width_input",placeholder:"USA",visible:function(e){return!0===e.is_address&&"shipping-address"===e.id},validator:VueFormGenerator.validators.string},{type:"switch",label:wfacp_localization.fields.same_as_shipping,model:"same_as_shipping",textOn:wfacp_localization.global.active,textOff:wfacp_localization.global.inactive,styleClasses:"wfacp_full_width_fields",visible:function(e){return!0===e.is_address&&"address"===e.id}},{type:"input",inputType:"text",label:wfacp_localization.fields.address.lable,model:"same_as_shipping_label",hint:wfacp_localization.fields.same_as_shipping_label_hint,styleClasses:"wfacp_full_width_input",placeholder:"USA",visible:function(e){return!0===e.is_address&&"address"===e.id},validator:VueFormGenerator.validators.string}];return wfacp.hooks.applyFilters("wfacp_address_fields",e)}},{key:"getEditableFields",value:function(){var t=[{type:"input",inputType:"text",label:wfacp_localization.fields.label_field_label,model:"label",required:!1,validator:VueFormGenerator.validators.string},{type:"checkbox",label:wfacp_localization.fields.order_summary_allow_delete,model:"allow_delete",hint:wfacp_localization.fields.order_summary_allow_delete_hint,styleClasses:"",visible:function(e){return"order_summary"===e.id}},{type:"input",inputType:"text",label:wfacp_localization.fields.options_field_label,model:"options",required:!0,validator:VueFormGenerator.validators.string,visible:function(t){return e.inArray(t.field_type,["select","wfacp_radio","multiselect","select2"])>-1}},{type:"input",inputType:"text",label:wfacp_localization.fields.multiselect_maximum_selection,model:"multiselect_maximum",validator:VueFormGenerator.validators.string,visible:function(e){return"multiselect"===e.field_type}},{type:"input",inputType:"text",label:wfacp_localization.fields.multiselect_maximum_error_field_label,model:"multiselect_maximum_error",validator:VueFormGenerator.validators.string,visible:function(e){return"multiselect"===e.field_type}},{type:"input",inputType:"text",label:wfacp_localization.fields.placeholder_field_label,model:"placeholder",validator:VueFormGenerator.validators.string,visible:function(t){return!(e.inArray(t.field_type,["select","wfacp_radio","checkbox","hidden","date","address","product","wfacp_html","multiselect","wfacp_dob"])>-1||!0===t.is_address)}},{type:"input",inputType:"text",label:wfacp_localization.fields.default_field_label,model:"default",validator:VueFormGenerator.validators.string,visible:function(e){return e.is_wfacp_field}},{type:"select",inputType:"select",label:wfacp_localization.fields.default_field_label,model:"default",selectOptions:{hideNoneSelectedText:!0},values:function(){return wfacp.tools.jsp(wfacp_localization.fields.default_field_checkbox_options)},visible:function(e){return"checkbox"===e.field_type}},{type:"checkbox",label:wfacp_localization.fields.show_on_thankyou,model:"show_custom_field_at_thankyou",styleClasses:"wfacp_required_cls",visible:function(e){return e.is_wfacp_field}},{type:"checkbox",label:wfacp_localization.fields.show_in_email,model:"show_custom_field_at_email",styleClasses:"wfacp_required_cls",visible:function(e){return e.is_wfacp_field}},{type:"input",inputType:"text",label:wfacp_localization.settings.coupon.success_message_heading,model:"coupon_success_message_heading",hint:wfacp_localization.settings.coupon.success_message_heading_hint,validator:VueFormGenerator.validators.string,visible:function(e){return"order_coupon"===e.id}},{type:"checkbox",label:wfacp_localization.settings.coupon.style_heading,model:"coupon_style",styleClasses:"wfacp_required_cls",visible:function(e){return"order_coupon"===e.id}}];t=wfacp.hooks.applyFilters("wfacp_editable_fields",t);var a={type:"checkbox",label:wfacp_localization.fields.required_field_label,model:"required",styleClasses:"wfacp_required_cls",default:!0,visible:function(t){return t.hasOwnProperty("show_required_field")&&t.show_required_field||"hidden"!==t.field_type&&!0!==t.is_address&&e.inArray(t.field_type,["product","wfacp_html"])<0}};t.push(a);return t.push({type:"checkbox",label:"wfacp_initiator_field",model:"temp_required",styleClasses:"wfacp_initiator_field",default:!0}),t}},{key:"updateField",value:function(e){if(0===wfacp.tools.ol(e))return!1;if(wfacp.tools.hp(this.layout_vue.fieldsets,e.step_name)&&wfacp.tools.hp(this.layout_vue.fieldsets[e.step_name][e.section],"fields")){var t={},a=wfacp.tools.jsp(e.field.options);if(wfacp.tools.ol(a)>0){for(var i in a){var s=a[i];t[s=s.trim()]=s}e.field.options=t}Vue.set(this.layout_vue.fieldsets[e.step_name][e.section].fields,e.index,e.field)}}},{key:"editFieldVue",value:function(){if(!0===this.edit_field_model_open)return this.edit_field_vue;this.edit_field_model_open=!0;var t=this;return this.edit_field_vue=new Vue({el:"#edit-field-form",components:{"vue-form-generator":VueFormGenerator.component},methods:{defaultModel:function(){return{field_type:"text",section_type:"billing",label:"",placeholder:"",cssready:"",options:"",is_address:!1,id:"",default:"",allow_delete:!1,is_wfacp_field:!1,show_required_field:!1,required:!0}},enableAddressSortable:function(){var t=this;setTimeout(function(){e(".wfacp_address_sortable_area").sortable({items:"div.wfacp_sortable_address_field",cursor:"move",axis:"y",handle:".wfacp_drag_address_icon",scrollSensitivity:40,stop:function(e,a){t.AddressSortableStop(e,a)}}),e(document.body).off("click",".wfacp_drag_address_field_enable"),e(document.body).on("click",".wfacp_drag_address_field_enable",function(){e(this).hasClass("dashicons-visibility")?(e(this).removeClass("dashicons-visibility"),e(this).addClass("dashicons-hidden")):(e(this).removeClass("dashicons-hidden"),e(this).addClass("dashicons-visibility"))}),e(document.body).off("click",".wfacp_address_open_accordion"),e(document.body).on("click",".wfacp_address_open_accordion",function(){var t=e(this).parents(".wfacp_address_field").children(".wfacp_billing_accordion_content");e(this).hasClass("dashicons-arrow-up")?(t.slideUp(),e(this).removeClass("dashicons-arrow-up")):(t.slideDown(),e(this).addClass("dashicons-arrow-up"))}),e(document.body).on("change",".wfacp_address_type",function(){var t=e(this).parents(".wfacp_billing_accordion_content");e(this).is(":checked")?"radio"===e(this).val()?t.find(".wfacp_address_type_radio_container").addClass("wfacp_address_radio_container_show"):t.find(".wfacp_address_type_radio_container").removeClass("wfacp_address_radio_container_show"):t.find(".wfacp_address_type_radio_container").removeClass("wfacp_address_radio_container_show")})},800)},AddressSortableStop:function(e,t){},setData:function(){var e=this,a=t.current_edit_field;if(0===wfacp.tools.ol(a))return!0;this.model.label=a.field.label,this.model.placeholder=void 0!==a.field.placeholder?a.field.placeholder:"",wfacp.tools.hp(a.field,"cssready")?this.model.cssready=a.field.cssready.join(","):this.model.cssready="",this.model.section_type=a.field.field_type,this.model.field_type=a.field.type,"multiselect"==this.model.field_type&&(this.model.multiselect_maximum=a.field.multiselect_maximum,this.model.multiselect_maximum_error=a.field.multiselect_maximum_error),this.model.is_wfacp_field=!!wfacp.tools.hp(a.field,"is_wfacp_field"),wfacp.tools.ol(a.field.options)>0?this.model.options=wfacp.tools.kys(a.field.options).join("|"):this.model.options="",this.model.default=a.field.default,this.model.required=wfacp.tools.string_to_bool(a.field.required),this.model.id=a.field.id,"order_summary"==this.model.id&&(this.model.allow_delete=!!wfacp.tools.hp(a.field,"allow_delete")&&wfacp.tools.string_to_bool(a.field.allow_delete)),"wfacp_wysiwyg"===this.model.field_type&&(this.model.required=!1),a.field.hasOwnProperty("show_required_field")&&(this.model.show_required_field=wfacp.tools.string_to_bool(a.field.show_required_field)),this.model=wfacp.hooks.applyFilters("wfacp_field_data_merge_with_model",this.model,a);var i=document.getElementById("wfacp-initiator-field");null!==i&&i.click(),setTimeout(function(){t.modal_edit_field.WoofunnelModal("open"),e.setAddressOrder()},100)},setAddressOrder:function(){if(wfacp.tools.hp(wfacp_data.address_order,this.model.id)){var t=wfacp_data.address_order[this.model.id],a=this.address_order_html[this.model.id];""!==a&&e("#wfacp_address_field_"+this.model.id).html(a),setTimeout(function(t){for(var a=0;a<t.length;a++){var i=t[a].key,s=t[a].status,l=t[a].label,o=e('.wfacp_address_field[data-key="'+i+'"]');if(o.length>0){var n=o.find(".wfacp_drag_address_field_enable");1==s||"true"==s?(n.removeClass("dashicons-hidden"),n.addClass('dashicons-visibility"')):(n.removeClass("dashicons-visibility"),n.addClass("dashicons-hidden")),o.find(".wfacp_label").val(l);var d=o.find(".wfacp_placeholder");d.length>0&&d.val(t[a].placeholder);var r=o.find(".wfacp_required");r.length>0&&(1==t[a].required||"true"==t[a].required?r.prop("checked",!0):r.prop("checked",!1))}}},200,t)}},saveAddressOrder:function(t){var a=this;return new Promise(function(i){if("address"===t.field.id||"shipping-address"===t.field.id){var s=e("#wfacp_address_field_"+t.field.id);if(s.length>0){var l=[],o=s.find(".wfacp_address_field"),n=a;o.each(function(){var a={key:e(this).data("key"),status:!1,label:e(this).find(".wfacp_label").val()},i=e(this).find(".wfacp_address_type:checked").val();n.addressOrder["display_type_"+t.field.id]=i;var s=e(this).find(".wfacp_label_2");s.length>0&&"radio"==i&&(a.label_2=s.val()),e(this).find(".wfacp_drag_address_field_enable").hasClass("dashicons-visibility")&&(a.status=!0);var o=e(this).find(".wfacp_placeholder");o.length>0&&(a.placeholder=o.val());var d=e(this).find(".wfacp_required");d.length>0&&(d.is(":checked")?a.required=!0:a.required=!1),l.push(a)}),n.addressOrder[t.field.id]=l,e(".wfacp_address_open_accordion").removeClass("dashicons-arrow-up"),e(".wfacp_billing_accordion_content").hide(),i(l)}}else i({})})},onSubmit:function(){var a=wfacp.tools.jsp(this.model),i=t.current_edit_field;i.field.label=a.label,i.field.placeholder=a.placeholder,i.field.cssready=a.cssready.split(","),i.field.type=a.field_type,i.field.field_type=a.section_type,i.field.options=a.options.split("|"),"multiselect"==i.field.type&&(i.field.multiselect_maximum=a.multiselect_maximum,i.field.multiselect_maximum_error=a.multiselect_maximum_error),"order_summary"==i.field.id&&(i.field.allow_delete=a.allow_delete),i.field.default="",wfacp.tools.hp(a,"default")&&(i.field.default=a.default),i.field.required=a.required,i=wfacp.hooks.applyFilters("wfacp_before_field_save",i,a),i=wfacp.tools.jsp(i),wfacp.tools.hp(i.field,"is_wfacp_field")&&"hidden"==i.field.type&&(i.field.required=!1),t.updateField(i),"address"!==i.field.id&&"shipping-address"!==i.field.id||(this.address_order_html[i.field.id]=e("#wfacp_address_field_"+i.field.id).html()),this.model=this.defaultModel(),this.saveAddressOrder(i).finally(function(){document.getElementById("wfacp_save_form_layout").click(),t.modal_edit_field.WoofunnelModal("close")})}},data:{product_switcher_updated:!1,wfacp_id:t.builder.id,current_field_id:"default",model_title:wfacp_localization.fields.add_field,addressOrder:wfacp_data.address_order,address_order_html:{address:"","shipping-address":""},model_sub_title:"",edit_model_field_label:"",model_field_type:"",model:{field_type:"text",section_type:"billing",options:"",default:"",label:"",placeholder:"",cssready:"",is_address:!1,is_wfacp_field:!1,allow_delete:!1,show_required_field:!1,required:!0},schema:{groups:[{fields:t.getEditableFields()},{fields:t.getAddressFields()}]},formOptions:{validateAfterChanged:!0}}}),this.edit_field_vue}},{key:"addSectionVue",value:function(e){if(!0!==this.add_section_model_open){this.add_section_model_open=!0;var t=this;return this.add_section_vue=new Vue({el:"#add-section-form",components:{"vue-form-generator":VueFormGenerator.component},methods:{defaultModel:function(){return{name:"",classes:wfacp_localization.fields.section.default_classes,sub_heading:""}},clearData:function(){this.model=this.defaultModel()},setData:function(){var e=t.getSection(t.step_name,t.field_index);null!==e?(this.btn_name=wfacp_localization.global.update_btn,this.model.name=e.name,this.model.classes=e.class,this.model.sub_heading=e.sub_heading):this.btn_name=wfacp_localization.fields.add_new_btn},onSubmit:function(){var e=wfacp.tools.jsp(this.model);null==t.field_index?t.addSection(t.step_name,{name:e.name,class:e.classes,sub_heading:e.sub_heading}):t.updateSection(t.step_name,t.field_index,{name:e.name,class:e.classes,sub_heading:e.sub_heading}),this.model=this.defaultModel(),t.modal_add_section.iziModal("close")}},data:{modal:e,isLoading:!1,step_name:"single_step",btn_name:wfacp_localization.fields.section.add_heading,wfacp_id:t.builder.id,model:{name:"",classes:wfacp_localization.fields.section.default_classes,sub_heading:""},schema:{fields:[{type:"input",inputType:"text",label:wfacp_localization.fields.section.fields.heading,model:"name",required:!1,validator:VueFormGenerator.validators.string},{type:"input",inputType:"text",label:wfacp_localization.fields.section.fields.sub_heading,model:"sub_heading",validator:VueFormGenerator.validators.string},{type:"input",inputType:"text",label:wfacp_localization.fields.section.fields.classes,model:"classes"}]},formOptions:{validateAfterChanged:!0}}}),this.add_section_vue}}},{key:"model",value:function(){var t=this;this.modal_edit_field=e("#modal-edit-field"),this.modal_edit_field.length>0&&(this.modal_edit_field.WoofunnelModal(),this.modal_edit_field.on("onopend",function(){var e=t.current_edit_field.field.id;"address"!==e&&"shipping-address"!==e||t.editFieldVue().enableAddressSortable()}),this.modal_edit_field.on("onopend",function(){setTimeout(function(){var a=e("#product_switching");a.length>0&&a.find(".wfacp_tabs .wfacp_tab_link").on("click",function(t){t.preventDefault(),e(".wfacp_tab_link").removeClass("activelink"),e(this).addClass("activelink");var a=e(this).data("tag");e(".wfacp_tab_container").removeClass("wfacp_tab_active").addClass("wfacp_tab_hide"),e(a).addClass("wfacp_tab_active").removeClass("wfacp_tab_hide")});var i=t.editFieldVue();wfacp.tools.ol(i.products)>0&&wfacp.tools.kys(i.products).forEach(function(e,a){var i="whats_included_"+e;wp.editor.remove(i);var s=wfacp.tools.jsp(wfacp.editorConfig);s.tinymce.init_instance_callback=function(e){e.on("Change",function(a){var i=e.targetElm.getAttribute("product_id");t.editFieldVue().products[i].whats_included=e.getContent()})},wp.editor.initialize(i,s)})},600),setTimeout(function(){if(e("#wfacp_wysiwyg_editor").length>0){wp.editor.remove("wfacp_wysiwyg_editor");var a=wfacp.tools.jsp(wfacp.editorConfig);a.tinymce.init_instance_callback=function(e){e.on("Change",function(a){var i=t.editFieldVue();Vue.set(i.model,"default",e.getContent())})},wp.editor.initialize("wfacp_wysiwyg_editor",a)}})}),this.modal_edit_field.on("onclosed",function(){var a=t.editFieldVue();if(a.products=a.products_updated,e("#wfacp_wysiwyg_editor").length>0){wp.editor.remove("wfacp_wysiwyg_editor")}})),this.modal_add_section=e("#modal-add-section"),this.modal_add_section.length>0&&this.modal_add_section.iziModal({headerColor:"#6dbe45",background:"#efefef",borderBottom:!1,radius:8,overlayColor:"rgba(0, 0, 0, 0.35)",transitionIn:"fadeInDown",transitionOut:"fadeOutDown",navigateArrows:"false",onOpening:function(e){t.addSectionVue(e),t.add_section_vue.setData()},onClosed:function(e){t.add_section_vue.clearData()}})}},{key:"field_data_merge_with_model",value:function(e,t){return wfacp.tools.hp(e,"id")&&"order_coupon"===e.id&&(e.coupon_success_message_heading=t.field.coupon_success_message_heading,e.coupon_remove_message_heading=t.field.coupon_remove_message_heading,e.coupon_style=wfacp.tools.string_to_bool(t.field.coupon_style)),wfacp.tools.hp(e,"is_wfacp_field")&&1==e.is_wfacp_field&&(e.enable_time=wfacp.tools.string_to_bool(t.field.enable_time),e.preferred_time_format=t.field.preferred_time_format,e.show_custom_field_at_thankyou=wfacp.tools.string_to_bool(t.field.show_custom_field_at_thankyou),e.show_custom_field_at_email=wfacp.tools.string_to_bool(t.field.show_custom_field_at_email)),e}},{key:"wfacp_before_field_save",value:function(e,t){return wfacp.tools.hp(t,"id")&&"order_coupon"===t.id&&(e.field.coupon_success_message_heading=t.coupon_success_message_heading,e.field.coupon_remove_message_heading=t.coupon_remove_message_heading,e.field.coupon_style=wfacp.tools.string_to_bool(t.coupon_style)),wfacp.tools.hp(t,"is_wfacp_field")&&1==t.is_wfacp_field&&(e.field.enable_time=t.enable_time,e.field.preferred_time_format=t.preferred_time_format,e.field.show_custom_field_at_thankyou=t.show_custom_field_at_thankyou,e.field.show_custom_field_at_email=t.show_custom_field_at_email),e}}]),t}(),i=function(){function t(e){_classCallCheck(this,t),null!=document.getElementById("wfacp_design_container")&&(this.id=e.id,this.selected=e.design.selected,this.selected_type=e.design.selected_type,this.designs=e.design.designs,this.design_types=e.design.design_types,this.description="",this.template_active=e.design.template_active,this.selected_template=this.designs[this.selected_type][this.selected],this.main(),this.design_settings(),this.model()),this.jQuery()}return _createClass(t,[{key:"main",value:function(){var t=this;return wfacp.tools.hp(this.designs,this.selected_type)&&wfacp.tools.hp(this.designs[this.selected_type],this.selected)||(this.selected_type="pre_built",this.selected="shopcheckout"),this.main=new Vue({el:"#wfacp_design_container",methods:{get_page_title:function(){return wfacp_data.name},get_edit_link:function(){var a=wfacp_data.template_edit_url[this.selected_type].url;if("oxy"===this.selected_type&&"oxy_1"===this.selected){var i={url:a,id:t.id},s=new wfacp.ajax;s.ajax("update_edit_url",i),s.success=function(t){"string"==typeof t&&(t=JSON.parse(t)),!0===t.status&&e("a.wfacp_funnel_btn_temp_alter.wfacp_funnel_btn_white_temp").attr("href",t.url)}}return a},get_button_text:function(){return wfacp_data.template_edit_url[this.selected_type].button_text},get_customizer_form_link:function(){return wfacp_data.template_edit_url.embed_forms.url},get_customizer_form_button_text:function(){return wfacp_data.template_edit_url.embed_forms.button_text},setTemplateType:function(e){Vue.set(this,"current_template_type",e),this.hide_tempate_dropdown()},show_template_dropdown:function(e){var t=e.target.closest(".wfacp_field_select_dropdown");t.classList.toggle("active"),t.querySelector(".wfacp_field_dropdown").classList.toggle("wfacp-hide")},hide_tempate_dropdown:function(){var e=document.querySelector(".wfacp_template_editor");null!=e&&(e.querySelector(".wfacp_field_select_dropdown").classList.remove("active"),e.querySelector(".wfacp_field_dropdown").classList.add("wfacp-hide"))},setTemplate:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return Vue.set(this,"selected",e),Vue.set(this,"selected_type",t),wfacp.hooks.doAction("wfacp_set_template",e,t),this.template_active="yes",this.save("yes",a)},removeDesign:function(e){var a=new wfacp.ajax,i={wfacp_id:t.id};a.ajax("remove_design",i),wfacp.show_spinner(),a.success=function(t){wfacp_data.layout.current_step="single_step","function"==typeof e&&e(t)},a.error=function(e){}},showFailedImport:function(e){wfacp.swal({html:e,title:wfacp_localization.importer.failed_import,type:"error",allowEscapeKey:!0,showCloseButton:!0,showCancelButton:!1,confirmButtonText:wfacp_localization.importer.close_prompt_text,actions:"bwf-swal-single-cta"})},importTemplate:function(a,i,s){var l=this,o=new wfacp.ajax,n={builder:i,template:a.slug,wfacp_id:t.id,is_multi:"yes"===a.multistep?"yes":"no"};o.ajax("import_template",n),wfacp.show_spinner(),this.swalLoadingText(builder.wfacp_i18n.importing),o.success=function(t){!0===t.status?""!==a.thumbnail?(l.setTemplate(a.slug,i),setTimeout(function(){var l=e(".wfacp_template_preview_container");l.find(".wfacp_template_importing_loader").show();var o=new Image;o.src=a.thumbnail,"embed_forms"===i&&window.location.reload(!0),o.onload=function(){setTimeout(function(e){l.find(".wfacp_template_importing_loader").hide()},1e3,t)};e(".wfacp_templates_inner.wfacp_selected_designed");s(t)},300)):s(t):(setTimeout(function(e){l.showFailedImport(e)},200,t.msg),s(t))}},get_remove_template:function(){var t=this;wfacp.swal({allowEscapeKey:!1,confirmButtonText:wfacp_localization.importer.remove_template.button_text,html:'<div class="wf_delete_modal_content">'.concat(wfacp_localization.importer.remove_template.sub_heading,"</div>"),showLoaderOnConfirm:!1,reverseButtons:!0,showCloseButton:!0,preConfirm:function(){return e("button.swal2-cancel.swal2-styled").removeAttr("disabled"),new Promise(function(e){t.removeDesign(function(a){t.template_active="no",e(a)})})},onOpen:function(){document.querySelector(".swal2-header").insertAdjacentHTML("beforebegin",'<div class="wffn-swal-modal-title">'+wfacp_localization.importer.remove_template.modal_title+"</div>")}})},maybeInstallPlugin:function(t,a,i){var s=this;this.cb=i,this.selected_template=t;var l=builder.pageBuildersOptions[this.current_template_type].plugins,o=0;e.each(l,function(e,t){"install"===t.status&&(s.swalLoadingText(builder.wfacp_i18n.plugin_install),o++,window.wp.updates.queue.push({action:"install-plugin",data:{slug:t.slug}}))}),window.wp.updates.queueChecker(),0===o&&e.each(l,function(e,t){"activate"===t.status&&s.activatePlugin(t.init)})},afterInstall:function(t,a){var i=this,s=builder.pageBuildersOptions[this.current_template_type].plugins;e.each(s,function(e,t){"install"===t.status&&a.slug===t.slug&&i.activatePlugin(t.init)})},swalLoadingText:function(t){0===e(".swal2-actions.swal2-loading .loading-text").length&&e(".swal2-actions.swal2-loading").append("<div class='loading-text'></div>"),e(".swal2-actions.swal2-loading .loading-text").text(t)},activatePlugin:function(t){var a=new wfacp.ajax,i=this,s={plugin_init:t};a.ajax("activate_plugin",s),wfacp.show_spinner(),a.success=function(t){i.importTemplate(i.selected_template,i.current_template_type,i.cb);var a=builder.pageBuildersOptions[i.current_template_type].plugins;e.each(a,function(e,a){a.init===t.init&&("install"!==a.status&&"activate"!==a.status||(builder.pageBuildersOptions[i.current_template_type].plugins[e].status=null))})},a.error=function(e){}},triggerPreview:function(t,a,i){this.is_previewing={slug:a,type:i},e("body").addClass("hide_bscroll"),setTimeout(function(){e(".wfacp_global_loader").hide()},600),setTimeout(function(){e(".wfacp_template_preview_sidebar .wfacp_template_page_options").removeClass("active_preview"),e(".wfacp_template_preview_sidebar .wfacp_template_page_options[ pre_slug="+a+"]").addClass("active_preview");var t=e(".wfacp_template_page_options.active_preview"),i=e(".wfacp_template_preview_sidebar"),s=t.offset().top-i.offset().top+i.scrollTop();i.animate({scrollTop:s})},100)},previewClosed:function(){this.is_previewing=!1,e("body").removeClass("hide_bscroll")},setViewport:function(t,a){var i=e(a.currentTarget);e(".wfacp_template_viewport .wfacp_viewport_icons").removeClass("active"),e(i).addClass("active"),e(".wfacp_template_preview_wrap .wfacp_template_preview_frame").removeClass("desktop tablet mobile"),e(".wfacp_template_preview_wrap .wfacp_template_preview_frame").addClass(t)},ShouldPreview:function(e,t){return!1!==this.is_previewing&&(this.is_previewing.slug===e&&this.is_previewing.type===t)},getPreviewUrl:function(e,t){return"oxy"===t&&(t="oxygen"),("customizer"===t||"embed_forms"===t||"pre_built"===t||"wc_checkout"===t&&"wp_editor"===t)&&(t="elementor"),"https://templates-"+t+".funnelswp.com/checkouts/"+e+"/"},triggerImport:function(t,a,i,s){var l=this;wfacp_localization.importer.activate_template.heading,wfacp_localization.importer.activate_template.sub_heading,wfacp_localization.importer.activate_template.button_text;"yes"===t.show_import_popup&&(wfacp_localization.importer.add_template.heading,wfacp_localization.importer.add_template.sub_heading,wfacp_localization.importer.add_template.button_text);var o=!0,n=e(s.target),d=e(s.currentTarget),r=n.closest(".wfacp_template_sec"),c=function(t){r.removeClass("wfacp_template_importing"),d.removeClass("is_busy"),e(".wfacp_steps_btn_green").show()};if("gutenberg"!==i||"gutenberg_1"!==a){if(!_.isUndefined(builder.pageBuildersOptions[this.current_template_type])){var p=builder.pageBuildersOptions[this.current_template_type].plugins;e.each(p,function(e,t){o&&("install"!==t.status&&"activate"!==t.status||(o=!1))}),"gutenberg"===this.current_template_type&&wfacp.tools.hp(this.selected_template,"build_from_scratch")&&(o=!0)}if(!1===o){var f=!0;return"no"===builder.pageBuildersTexts[this.current_template_type].show_cancel_btn&&(f=!1),void wfacp.swal({allowEscapeKey:!1,showConfirmButton:f,confirmButtonText:builder.pageBuildersTexts[this.current_template_type].ButtonText,showCancelButton:f,cancelButtonText:builder.pageBuildersTexts[this.current_template_type].close_btn,allowOutsideClick:!1,cancelButtonColor:"#e33b3b",reverseButtons:!0,showCloseButton:!0,html:'<div class="wf_delete_modal_content">'.concat(builder.pageBuildersTexts[this.current_template_type].text,"</div>"),onOpen:function(e){e.closest(".swal2-container")&&e.closest(".swal2-container").classList.add("bwf-modal-zindex"),document.querySelector(".swal2-header").insertAdjacentHTML("beforebegin",'<div class="wffn-swal-modal-title">'+builder.pageBuildersTexts[l.current_template_type].title+"</div>")},preConfirm:function(){if("no"===builder.pageBuildersTexts[l.current_template_type].noInstall)return e("button.swal2-cancel.swal2-styled").css({display:"none"}),new Promise(function(e){l.maybeInstallPlugin(t,i,e)});"yes"===builder.pageBuildersTexts[l.current_template_type].noInstall&&"install"===builder.pageBuildersTexts[l.current_template_type].plugin_status&&window.open(builder.pageBuildersTexts[l.current_template_type].builder_link,"_blank")},onClose:function(){r.removeClass("wfacp_template_importing"),e(".wfacp_steps_btn_green").show()}})}if(e(".wfacp_steps_btn_green").hide(),n.closest(".wfacp_temp_middle_align, .wfacp-preview-overlay").find(".wfacp_import_template").show(),n.closest(".wfacp_template_sec").hasClass("wfacp_template_importing"))return this.previewClosed(),void console.log("Importer already running");r.addClass("wfacp_template_importing"),d.addClass("is_busy"),"yes"===t.multistep||"yes"===t.import?this.importTemplate(t,i,c):t.hasOwnProperty("build_from_scratch")&&!0===t.build_from_scratch?this.setTemplate(a,i,c):this.importTemplate(t,i,c)}else this.setTemplate(a,i,c)},save:function(){var a=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"yes",s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",l=new wfacp.ajax,o={selected_type:this.current_template_type,selected:this.selected,wfacp_id:t.id,template_active:i};l.ajax("save_design",o),wfacp.show_spinner(),l.success=function(t){var i=a;wfacp.show_data_save_model(t.msg),a.selected_type=a.current_template_type,a.selected_template=a.designs[a.selected_type][a.selected],e("#wfacp_control > .wfacp_p20_noside").show(),i.previewClosed(),"function"==typeof s&&s(t),e(".wfacp_design_accordion").attr("status","close")},l.error=function(){inst.previewClosed()}}},data:{current_template_type:this.selected_type,selected_type:this.selected_type,designs:this.designs,design_types:this.design_types,selected:this.selected,selected_template:this.selected_template,template_active:this.template_active,temp_template_type:"",temp_template_slug:"",description:this.description,is_previewing:!1}}),this.main}},{key:"design_settings",value:function(){for(var t=this,a={wfacp_form_section_embed_forms_2_name_0:function(e){return"true"==e.wfacp_form_section_embed_forms_2_disable_steps_bar},wfacp_form_section_embed_forms_2_headline_0:function(e){return"true"==e.wfacp_form_section_embed_forms_2_disable_steps_bar},wfacp_form_section_embed_forms_2_step_heading_font_size:function(e){return!wfacp.tools.string_to_bool(e.wfacp_form_section_embed_forms_2_disable_steps_bar)},wfacp_form_section_embed_forms_2_step_sub_heading_font_size:function(e){return!wfacp.tools.string_to_bool(e.wfacp_form_section_embed_forms_2_disable_steps_bar)},wfacp_form_section_embed_forms_2_step_alignment:function(e){return!wfacp.tools.string_to_bool(e.wfacp_form_section_embed_forms_2_disable_steps_bar)},wfacp_form_section_embed_forms_2_active_step_bg_color:function(e){return!wfacp.tools.string_to_bool(e.wfacp_form_section_embed_forms_2_disable_steps_bar)},wfacp_form_section_embed_forms_2_active_step_text_color:function(e){return!wfacp.tools.string_to_bool(e.wfacp_form_section_embed_forms_2_disable_steps_bar)},wfacp_form_section_embed_forms_2_active_step_tab_border_color:function(e){return!wfacp.tools.string_to_bool(e.wfacp_form_section_embed_forms_2_disable_steps_bar)}},i=wfacp_design_settings.schema,s=0;s<i.length;s++)if(wfacp.tools.hp(i[s],"fields"))for(var l=i[s].fields,o=0;o<l.length;o++){var n=l[o];if(wfacp.tools.hp(n,"model")){var d=n.model;wfacp.tools.hp(a,d)&&(wfacp_design_settings.schema[s].fields[o].visible=a[d])}}wfacp_design_settings.model.wfacp_form_section_embed_forms_2_disable_steps_bar=wfacp.tools.string_to_bool(wfacp_design_settings.model.wfacp_form_section_embed_forms_2_disable_steps_bar),this.design_settings=new Vue({el:"#wfacp_design_setting",components:{"vue-form-generator":VueFormGenerator.component},created:function(){this.enable_color_picker(),setTimeout(function(){e(".wfacp_design_accordion").attr("status","close")},200)},data:{model:wfacp_design_settings.model,schema:{groups:wfacp_design_settings.schema}},methods:{onChange:function(){var e=this;setTimeout(function(){e.enable_color_picker()},100)},selected_template_type:function(){return t.main.current_template_type},template_active:function(){return t.main.template_active},enable_color_picker:function(){var t=this;setTimeout(function(){var a=e(".wfacp_color_field .form-control");a.length>0&&(a.wpColorPicker({change:function(e,a){var i=e.target.id;t.model[i]=a.color.toString()}}),a.trigger("change"),e('.wfacp_color_field .wp-picker-container input[type="text"], .button.wp-color-result').on("click",function(){e(".iris-picker").hide(),e(this).parent().parent().parent().addClass("wp-picker-active"),e(this).parent().parent().parent().find(".button.wp-color-result").addClass("wp-picker-open"),e(this).parent().parent().parent().find(".iris-picker.iris-border").css("display","block")}),e(document).on("click",function(){e(".iris-picker:visible").length>0&&e(".iris-picker").hide()}))},1200)},onSubmit:function(){var e=wfacp.tools.jsp(this.model),a=new wfacp.ajax;return a.ajax("save_design_settings",{wfacp_id:t.id,settings:e}),wfacp.show_spinner(),a.success=function(e){wfacp.show_data_save_model(e.msg)},wfacp_data.name}}})}},{key:"model",value:function(){e(document.body).on("click",".wfacp_embed_form_tab",function(){var t=e(this).attr("aria-controls");e(".wfacp_embed_form_tab").removeClass("wfacp-active"),e(this).addClass("wfacp-active"),e(".wfacp_embed_fieldset").hide(),e(".wfacp_embed_fieldset."+t).show()}),e(document.body).on("click",".wfacp_embed_form_design_tab",function(){var t=e(this).data("tab");e(".wfacp_embed_form_design_tab").removeClass("wfacp-active"),e(this).addClass("wfacp-active");var a=e(".wfacp_show_design_style_fields");a.hide(),a.hasClass(t)&&e("."+t).show()}),e(document.body).on("click",".wfacp_design_accordion .wfacp_main_design_heading",function(){var t=e(this).attr("status");e(this).parent(".wfacp_design_accordion").removeClass("wfacp_accordion_open"),"close"==t||void 0==t?(e(this).parent(".wfacp_design_accordion").find(".form-group").slideDown(),e(this).parent(".wfacp_design_accordion").attr("status","open"),e(this).attr("status","open"),e(this).parent(".wfacp_design_accordion").addClass("wfacp_accordion_open")):"open"==t&&(e(this).parent(".wfacp_design_accordion").find(".form-group").not(".wfacp_main_design_heading").slideUp(),e(this).attr("status","close"),e(this).parent(".wfacp_design_accordion").attr("status","close"))})}},{key:"jQuery",value:function(){var t=this;e(document).on("wp-plugin-install-success",function(e,a){t.main.afterInstall(e,a)}),e(document).on("click",".wfacp_filter_container_inner",function(){e(".wfacp_filter_container_inner").removeClass("wfacp_selected_filter");var t=e(this).data("filter-type"),a=e(".wfacp_temp_card");(e(this).addClass("wfacp_selected_filter"),0!=t)?(a.hide(),e(".wfacp_temp_card[data-steps="+t+"]").show()):a.show()})}}]),t}(),s=function(){function t(e){_classCallCheck(this,t),null!=document.getElementById("modal-checkout-page")&&(this.add_new_model_open=!1,this.id=wfacp.tools.hp(e,"id")?e.id:0,this.name=wfacp.tools.hp(e,"name")?e.name:"",this.post_name=wfacp.tools.hp(e,"post_name")?e.post_name:"",this.post_content=wfacp.tools.hp(e,"post_content")?e.post_content:"",this.base_url=wfacp.tools.hp(e,"base_url")?e.base_url:"",this.model())}return _createClass(t,[{key:"main",value:function(t){if(!1===this.add_new_model_open){var a=this;return this.add_new_model_open=!0,this.add_new=new Vue({el:"#add-new-form",components:{"vue-form-generator":VueFormGenerator.component},methods:{defaultModel:function(){return{name:"",post_content:""}},clearData:function(){this.model=this.defaultModel()},onSubmit:function(){var t=this,i=this.model.name,s=new wfacp.ajax,l={wfacp_name:i,wfacp_id:a.id,post_name:this.model.post_name,post_content:this.model.post_content};if(s.ajax("add_checkout_page",l),a.add_new.$el){var o=a.add_new.$el.querySelector(".wfacp_btn.wfacp_btn_primary");e(o).addClass("is_busy")}s.success=function(i){if(!0===i.status&&"#"!==i.redirect_url&&(e("#add-new-form").hide(),e(".wfacp-funnel-create-success-wrap").show(),setTimeout(function(){window.location.href=i.redirect_url},1e3)),a.id>0){if(e("#modal-saved-data-success").iziModal("setTitle",wfacp_localization.global.changes_saved),e("#modal-saved-data-success").iziModal("open"),a.add_new.$el){var s=a.add_new.$el.querySelector(".wfacp_btn.wfacp_btn_primary");e(s).removeClass("is_busy")}a.add_new_page_model.iziModal("close"),wfacp_data.name=t.model.name,e(".wfacp_page_title").text(t.model.name),e(".bwf_breadcrumb > span:last-of-type").text(t.model.name),e(".bwfan_page_header .bwfan_page_title").text(t.model.name),e(".bwf-header-bar .bwf-bar-navigation > span:last-child").html(t.model.name),e(".wfacp-preview").attr("href",i.new_url)}}}},data:{modal:t,btn_name:this.id>0?wfacp_localization.global.update_btn:wfacp_localization.global.add_checkout_btn,model:{id:this.id,name:a.name,post_name:a.post_name,post_url:a.post_url,base_url:a.base_url,post_content:a.post_content},schema:{fields:[{type:"input",inputType:"text",label:wfacp_localization.global.add_checkout.heading,model:"name",required:!0,validator:VueFormGenerator.validators.string},{type:"textArea",label:wfacp_localization.global.add_checkout.post_content,model:"post_content",validator:VueFormGenerator.validators.string},{type:"input",inputType:"text",label:wfacp_localization.global.add_checkout.checkout_url_slug,model:"post_name",required:!0,validator:VueFormGenerator.validators.string,visible:function(e){return e.id>0}}]},formOptions:{validateAfterChanged:!0}}}),this.add_new}}},{key:"model",value:function(){var t,a,i,s=this;t=/([^&=]+)=?([^&]*)/g,a=/\+/g,i=function(e){return decodeURIComponent(e.replace(a," "))},jQuery.parseParams=function(e){for(var a,s={};a=t.exec(e);){var l=i(a[1]),o=i(a[2]);"[]"===l.substring(l.length-2)?(s[l=l.substring(0,l.length-2)]||(s[l]=[])).push(o):s[l]=o}return s},e(".woofunnels_page_wfacp .icl_translations a").on("click",function(t){if(e(this).find(".otgs-ico-add").length>0){var a=e(this).attr("href");if(a=a.replace("post-new.php?",""),t.preventDefault(),"object"==_typeof(a=e.parseParams(a))&&wfacp.tools.ol(a)>0){t.preventDefault();var i=new wfacp.ajax;i.ajax("make_wpml_duplicate",a),i.success=function(e){1==e.status?window.location.href=e.redirect_url:alert(e.msg)}}}}),this.add_new_page_model=e("#modal-checkout-page"),this.add_new_page_model.length>0&&this.add_new_page_model.iziModal({title:this.id>0?wfacp_localization.global.edit_checkout_page:wfacp_localization.global.add_checkout_page,headerColor:"#6dbe45",background:"#efefef",borderBottom:!1,radius:8,overlayColor:"rgba(0, 0, 0, 0.35)",transitionIn:"fadeInUp",transitionOut:"fadeOut",navigateArrows:"false",onOpening:function(e){s.main(e)}})}}]),t}(),l=function(){function t(e){_classCallCheck(this,t),this.id=e.id,this.settings=e.settings,null!=document.getElementById("wfacp_setting_container")&&this.main()}return _createClass(t,[{key:"getFields",value:function(){var e=[{fields:[{type:"label",label:wfacp_localization.settings.analytics.heading,hint:wfacp_localization.settings.analytics.hint,styleClasses:"wfacp_setting_heading"},{type:"radios",inputType:"text",label:wfacp_localization.settings.analytics.override,default:"false",model:"override_global_track_event",disabled:"true",values:function(){return wfacp_localization.settings.radio_fields}}]},{fields:[{type:"label",label:wfacp_localization.settings.scripts.heading,hint:wfacp_localization.settings.scripts.sub_heading,styleClasses:"wfacp_setting_heading"},{type:"textArea",label:wfacp_localization.settings.scripts.header_heading,placeholder:wfacp_localization.settings.scripts.header_script_placeholder,model:"header_script",rows:4,validator:VueFormGenerator.validators.string},{type:"textArea",label:wfacp_localization.settings.scripts.footer_heading,placeholder:wfacp_localization.settings.scripts.footer_script_placeholder,model:"footer_script",rows:4,validator:VueFormGenerator.validators.string}]},{fields:[{type:"label",label:wfacp_localization.settings.style.heading,hint:wfacp_localization.settings.style.sub_heading,styleClasses:"wfacp_setting_heading"},{type:"textArea",label:wfacp_localization.settings.style.header_heading,placeholder:wfacp_localization.settings.style.header_style_placeholder,model:"header_css",rows:4,validator:VueFormGenerator.validators.string}]}];return wfacp.hooks.applyFilters("wfacp_settings_fields",e,this)}},{key:"getModels",value:function(){var e=wfacp.tools.jsp(this.settings);return e=wfacp.hooks.applyFilters("wfacp_settings_data_model",e,this)}},{key:"main",value:function(){var t=this;return this.settings_vue=new Vue({el:"#wfacp_setting_container",components:{"vue-form-generator":VueFormGenerator.component,Multiselect:window.VueMultiselect.default},methods:{changed:function(){setTimeout(function(){e(".wfacp_date_field .form-control").attr("type","date")},100)},save:function(){var a=new wfacp.ajax,i=wfacp.tools.jsp(this.model);""!==i.close_checkout_on&&i.close_checkout_on>0&&(i.close_checkout_on=parseInt(i.close_checkout_on/1e3));var s={wfacp_id:t.id,settings:i};a.ajax("save_settings",s),e(".wfacp_save_btn_style").addClass("is_busy"),a.success=function(t){wfacp.show_data_save_model(t.msg),e(".wfacp_save_btn_style").removeClass("is_busy")}}},data:{search_timeout:!1,isLoading:!1,model:this.getModels(),formOptions:{},schema:{groups:this.getFields()}}}),this.settings_vue}}]),t}(),o=function(){function t(e){_classCallCheck(this,t),null!=document.getElementById("wfacp_optimization_container")&&(this.settings=e.settings,this.id=e.id,this.preview_field(),this.collapsible_optional_field(),this.main())}return _createClass(t,[{key:"collapsible_optional_field",value:function(){if(0!=wfacp.tools.hp(wfacp_data,"optional_checkout_fields")){var e=wfacp_data.optional_checkout_fields;wfacp.hooks.addFilter("wfacp_optimization_collapsible_optional_fields",function(t){var a={type:"label",label:wfacp_localization.optimizations.collapsible_optional_field.heading,hint:wfacp_localization.optimizations.collapsible_optional_field.sub_heading,styleClasses:"wfacp_setting_heading wfacp_collapsible_sec"};for(var i in t.push(a),e){var s="";"true"==e[i].disable&&(s=wfacp_localization.optimizations.collapsible_optional_field.collapsible_optional_field_text_hint),s=wfacp_localization.optimizations.collapsible_optional_field.collapsible_optional_field_text_hint,t.push({type:"checkbox",label:""!==e[i].label?e[i].label:e[i].data_label,model:"collapsible_optional_"+i,id:i,styleClasses:"wfacp_collapsible_fields wfacp_preview_fields",disabled:e[i].disable,hint:s})}if(t.length>1){var l={type:"input",inputType:"text",label:wfacp_localization.optimizations.collapsible_optional_field.collapsable_link_text,model:"collapsible_optional_link_text",styleClasses:"preview_section_heading_wrap wfaco_preview_top_spacing",validator:VueFormGenerator.validators.string,hint:wfacp_localization.optimizations.collapsible_optional_field.collapsable_hint_text};t.push(l)}return t}),wfacp.hooks.addFilter("wfacp_optimizations_data_model",function(t,a){for(var i in e){var s=i,l="collapsible_optional_"+s;wfacp.tools.hp(a.settings.collapsible_optional_fields,s)&&"true"==a.settings.collapsible_optional_fields[s]?t[l]=!0:"collapsible_optional_link_text"!=l&&(t[l]=!1)}return wfacp.tools.hp(a.settings,"collapsible_optional_link_text")?t.collapsible_optional_link_text=a.settings.collapsible_optional_link_text:t.collapsible_optional_link_text=wfacp_localization.optimizations.collapsible_optional_field.collapsible_optional_link_text,t}),wfacp.hooks.addFilter("wfacp_before_optimization_data_saved",function(e,t){var a=wfacp_data.optional_checkout_fields;for(var i in e.settings.collapsible_optional_fields={},a){var s=i,l="collapsible_optional_"+s;e.settings.collapsible_optional_fields[s]=e.settings[l],delete e.settings[l]}return e})}}},{key:"preview_field",value:function(){if(0!=wfacp.tools.hp(wfacp_data,"layout")){var e=wfacp_data.layout,t={single_step:[],two_step:[],third_step:[]},a=["product","wfacp_html","wfacp_end_divider","password","wfacp_start_divider"],i=[];"two_step"===wfacp_data.layout.current_step?i=["single_step"]:"third_step"===wfacp_data.layout.current_step&&(i=["single_step","two_step"]),wfacp.hooks.addFilter("wfacp_optimization_preview_fields",function(t){if(0===i.length){var a={type:"label",label:wfacp_localization.settings.preview_field_admin_heading,hint:wfacp_localization.settings.preview_field_admin_heading_hint,styleClasses:"wfacp_setting_heading wfacp_admin_preview_feilds_wrap"},l={type:"label",hint:wfacp_localization.settings.preview_field_admin_note,styleClasses:"wfacp_setting_heading wfacp_preview_note"};return t.push(a),t.push(l),t}var o={type:"label",label:wfacp_localization.settings.preview_field_admin_heading,hint:wfacp_localization.settings.preview_field_admin_heading_hint,styleClasses:"wfacp_setting_heading preview_heading_wrap"};t.push(o);for(var n=0;n<i.length;n++)for(var d=i[n],r=e.fieldsets[d],c=0;c<r.length>0;c++){var _=r[c].fields;for(var p in _){var f=_[p];s(f)||t.push({type:"checkbox",label:""!==f.label?f.label:f.data_label,model:f.id,styleClasses:"wfacp_preview_fields"})}}if(t.length>1){var u={type:"input",inputType:"text",label:wfacp_localization.settings.preview_section_heading,model:"preview_section_heading",styleClasses:"preview_section_heading_wrap wfaco_preview_top_spacing",validator:VueFormGenerator.validators.string},h={type:"input",inputType:"text",label:wfacp_localization.settings.preview_section_subheading,model:"preview_section_subheading",styleClasses:"preview_section_subheading_wrap",validator:VueFormGenerator.validators.string};t.push(u),t.push(h)}return t}),wfacp.hooks.addFilter("wfacp_optimizations_data_model",function(a,l){if(0===i.length)return a;for(var o=0;o<i.length;o++)for(var n=i[o],d=e.fieldsets[n],r=0;r<d.length>0;r++){var c=d[r].fields;for(var _ in c){var p=c[_];s(p)||(wfacp.tools.hp(l.settings.show_on_next_step[n],p.id)&&"true"==l.settings.show_on_next_step[n][p.id]?a[p.id]=!0:a[p.id]=!1,t[n].push(p.id))}}return wfacp.tools.hp(l.settings,"preview_section_heading")&&(a.preview_section_heading=l.settings.preview_section_heading),wfacp.tools.hp(l.settings,"preview_section_subheading")&&(a.preview_section_subheading=l.settings.preview_section_subheading),a}),wfacp.hooks.addFilter("wfacp_before_optimization_data_saved",function(e,a){for(var i in e.settings.show_on_next_step={},t)if(0!==t[i].length){e.settings.show_on_next_step[i]={};for(var s=t[i],l=0;l<s.length;l++){var o=s[l];wfacp.tools.hp(e.settings,o)&&(e.settings.show_on_next_step[i][o]=e.settings[o],delete e.settings[o])}}return e})}function s(e){return a.indexOf(e.type)>-1&&"shipping_calculator"!==e.id}}},{key:"getFields",value:function(){var e=wfacp.hooks.applyFilters("wfacp_optimization_preview_fields",[],this),t=wfacp.hooks.applyFilters("wfacp_optimization_collapsible_optional_fields",[],this),a=[{fields:[{type:"label",label:wfacp_localization.google_autocomplete.heading,hint:wfacp_localization.google_autocomplete.sub_heading,styleClasses:"wfacp_setting_heading"},{type:"radios",label:wfacp_localization.global.enable,model:"enable_google_autocomplete",disabled:"true",values:function(){return wfacp_localization.settings.radio_fields}}]},{fields:[{type:"label",label:wfacp_localization.settings.coupons.heading,hint:wfacp_localization.settings.coupons.sub_heading,styleClasses:"wfacp_setting_heading"},{type:"radios",label:wfacp_localization.settings.coupons.auto_add_coupon_heading,model:"enable_coupon",disabled:"true",values:function(){return wfacp_localization.settings.radio_fields}},{type:"radios",label:wfacp_localization.settings.coupons.disable_coupon,model:"disable_coupon",values:function(){return wfacp_localization.settings.radio_fields}}]},{fields:[{type:"label",label:wfacp_localization.optimizations.smart_buttons.heading,hint:wfacp_localization.optimizations.smart_buttons.sub_heading,styleClasses:"wfacp_setting_heading"},{type:"radios",label:wfacp_localization.global.enable,model:"enable_smart_buttons",values:function(){return wfacp_localization.settings.radio_fields}},{type:"vueMultiSelect",model:"smart_button_position",label:wfacp_localization.optimizations.smart_buttons.position_heading,required:!0,selectOptions:{selectedValue:"wfacp_before_product_switching_field",multiple:!1,trackBy:"id",label:"name"},values:wfacp_localization.optimizations.smart_buttons.positions,visible:function(e){return"true"==e.enable_smart_buttons}}]},{fields:e},{fields:[{type:"label",label:wfacp_localization.optimizations.preferred_country.heading,hint:wfacp_localization.optimizations.preferred_country.sub_heading,styleClasses:"wfacp_setting_heading"},{type:"radios",label:wfacp_localization.global.enable,model:"preferred_countries_enable",disabled:"true",values:function(){return wfacp_localization.settings.radio_fields}}]},{fields:[{type:"label",label:wfacp_localization.settings.advanced.heading,hint:wfacp_localization.settings.advanced.sub_heading,styleClasses:"wfacp_setting_heading"},{type:"radios",label:wfacp_localization.settings.advanced.close_after,model:"close_after_x_purchase",disabled:"true",values:function(){return wfacp_localization.settings.radio_fields}},{type:"radios",label:wfacp_localization.settings.advanced.close_checkout_after_date,model:"close_checkout_after_date",disabled:"true",values:function(){return wfacp_localization.settings.radio_fields}}]},{fields:[{type:"label",label:wfacp_localization.settings.autopopulate_fields.heading,hint:wfacp_localization.settings.autopopulate_fields.sub_heading,styleClasses:"wfacp_setting_heading"},{type:"radios",label:wfacp_localization.global.enable,model:"enable_autopopulate_fields",disabled:"true",values:function(){return wfacp_localization.settings.radio_fields}}]},{fields:[{type:"label",label:wfacp_localization.settings.autopopulate_state.heading,hint:wfacp_localization.settings.autopopulate_state.sub_heading,styleClasses:"wfacp_setting_heading"},{type:"radios",label:wfacp_localization.global.enable,model:"enable_autopopulate_state",disabled:"true",values:function(){return wfacp_localization.settings.radio_fields}}]},{fields:[{type:"label",label:wfacp_localization.settings.auto_fill_url.heading,hint:wfacp_localization.settings.auto_fill_url.sub_heading,styleClasses:"wfacp_setting_heading"},{type:"input",inputType:"text",label:wfacp_localization.settings.auto_fill_url.product_ids,model:"auto_fill_url_product_ids",disabled:"true",hint:wfacp_localization.settings.auto_fill_url.product_ids_hint},{type:"input",inputType:"text",label:wfacp_localization.settings.auto_fill_url.quantity,model:"auto_fill_url_product_qty",disabled:"true",hint:wfacp_localization.settings.auto_fill_url.quantity_hint},{type:"select",model:"auto_fill_url_autoresponder",disabled:"true",label:wfacp_localization.settings.auto_fill_url.auto_responder_label,default:"activecampaign",selectOptions:{hideNoneSelectedText:!0},values:function(){return Object.values(wfacp_localization.settings.auto_fill_url.auto_responder_options)}},{type:"textArea",label:wfacp_localization.settings.auto_fill_url.perfill_url,model:"auto_fill_url_product_qty_url",disabled:"true",styleClasses:"auto_fill_url_product_qty_url",readonly:!0}]},{fields:[{type:"label",label:wfacp_localization.settings.intl.heading,hint:wfacp_localization.settings.intl.sub_heading,styleClasses:"wfacp_setting_heading"},{type:"radios",label:wfacp_localization.settings.intl.enable_phone_flag,model:"enable_phone_flag",values:function(){return wfacp_localization.settings.radio_fields}},{type:"radios",label:wfacp_localization.settings.intl.enable_phone_validation,hint:wfacp_localization.settings.intl.enable_phone_validation_hint,styleClasses:"wfacp_setting_checkbox_field",model:"enable_phone_validation",values:function(){return wfacp_localization.settings.radio_fields},visible:function(e){return"true"===e.enable_phone_flag}},{type:"radios",label:wfacp_localization.settings.intl.enable_save_phone_number,styleClasses:"wfacp_setting_checkbox_field wfacp_intl_saving_option",model:"save_phone_number_type",values:function(){return wfacp_localization.settings.intl.saving_options},visible:function(e){return"true"===e.enable_phone_flag}},{type:"input",inputType:"text",label:wfacp_localization.settings.intl.phone_helping_text,hint:wfacp_localization.settings.intl.phone_helping_text_hint,model:"phone_helping_text",visible:function(e){return"true"===e.enable_phone_flag}}]},{fields:[{type:"label",label:wfacp_localization.optimizations.live_validation.heading,hint:wfacp_localization.optimizations.live_validation.sub_heading,styleClasses:"wfacp_setting_heading"},{type:"radios",label:wfacp_localization.optimizations.live_validation.enable_live_validation,model:"enable_live_validation",values:function(){return wfacp_localization.settings.radio_fields}}]},{fields:t}];return wfacp.hooks.applyFilters("wfacp_optimization_fields",a,this)}},{key:"getModels",value:function(){var e=wfacp.tools.jsp(this.settings);return e=wfacp.hooks.applyFilters("wfacp_optimizations_data_model",e,this)}},{key:"main",value:function(){var t=this;this.settings_vue=new Vue({el:"#wfacp_optimization_container",components:{"vue-form-generator":VueFormGenerator.component},created:function(){setTimeout(function(){e(".wfacp_date_field .form-control").attr("type","date"),e(".auto_fill_url_product_qty_url  textarea").prop("readonly",!0)},100)},methods:{changed:function(){setTimeout(function(){e(".wfacp_date_field .form-control").attr("type","date")},100)},prefil_url:function(){var a=[],i=t.settings_vue.model,s=i.auto_fill_url_product_ids,l=i.auto_fill_url_product_qty;void 0!==s&&""!==s&&(a.push(wfacp_data.parameters.add_to_checkout+"="+s),void 0!==l&&""!==l&&a.push(wfacp_data.parameters.qty+"="+l));var o=i.auto_fill_url_fields_options,n=wfacp.tools.jsp(wfacp_data.post_url);if(void 0!==i.auto_fill_url_autoresponder){var d=i.auto_fill_url_autoresponder,r=wfacp.tools.jsp(wfacp_localization.settings.auto_fill_url.auto_responder_options[d].merge_tags);if(void 0!==o&&o.length>0&&void 0!==r&&wfacp.tools.ol(r)>0)for(var c in r)o.indexOf(c)>-1&&a.push(c+"="+r[c])}a.length>0&&(n.indexOf("?")>-1?n+="&"+a.join("&"):n+="?"+a.join("&"),t.settings_vue.model.auto_fill_url_product_qty_url=n,e(".auto_fill_url_product_qty_url textarea").val(n))},save:function(){if(!1===this.$refs.update_optimize_ref.validate()){var a=e(".wfacp_optimise_global_setting .vue-form-generator").find(".form-group.error.required > label span").text();return wfacp.show_data_error_model(wfacp_localization.field_validate_error+a+" "),void console.log("Validation Error")}var i=wfacp.tools.jsp(this.model),s=new wfacp.ajax,l={wfacp_id:t.id,settings:i};l=wfacp.hooks.applyFilters("wfacp_before_optimization_data_saved",l,this),s.ajax("save_settings",l),e(".wfacp_save_btn_style").addClass("is_busy"),s.success=function(t){e(".wfacp_save_btn_style").removeClass("is_busy"),wfacp.show_data_save_model(t.msg)}}},data:{model:this.getModels(),formOptions:{},schema:{groups:this.getFields()}}})}}]),t}(),n=function(){function t(e){_classCallCheck(this,t),this.id=e.id,this.schema=e.global_settings.schema,this.model=e.global_settings.model,null!=document.getElementById("wfacp_global_settings")&&this.main()}return _createClass(t,[{key:"main",value:function(){var t=this,a=this;for(var i in this.model)"true"===this.model[i]?this.model[i]=!0:"false"===this.model[i]&&(this.model[i]=!1);return this.settings_vue=new Vue({el:"#wfacp_global_settings",components:{"vue-form-generator":VueFormGenerator.component,Multiselect:window.VueMultiselect.default},created:function(){setTimeout(function(){e(".form-group.field-checkbox").each(function(){var t=e(this).find("label"),a=t.text();t.remove(),e(this).find(".field-wrap").append(a)});for(var a=0;a<t.schema.groups.length;a++)for(var i=t.schema.groups[a].fields,s=0;s<i.length;s++)wfacp.tools.hp(i[s],"hint")&&wfacp.tools.hp(i[s],"styleClasses")&&i[s].styleClasses.indexOf("wfacp_html_hint")>-1&&e("."+i[s].styleClasses.join(".")).find(".hint").html(i[s].hint)},1e3)},methods:{onSubmit:function(){var t=new wfacp.ajax,i={wfacp_id:a.id,settings:this.model};this.model.rewrite_slug!==wfacp_data.checkout_page_slug?(t.ajax("save_global_settings",i),e(".wfacp_save_btn_style").addClass("is_busy"),t.success=function(t){e(".wfacp_save_btn_style").removeClass("is_busy"),wfacp.show_data_save_model(t.msg)}):alert(wfacp_data.checkout_page_slug_error)}},data:{model:this.model,search_timeout:!1,isLoading:!1,schema:this.schema,formOptions:{}}}),this.settings_vue}}]),t}(),d=function(){function d(e){_classCallCheck(this,d),this.el="#wfacp_control",this.setupData(e),this.initializeVue(),this.model()}return _createClass(d,[{key:"setupData",value:function(e){if(wfacp.tools.ol(e)>0)for(var t in e)this[t]=e[t];wfacp.hooks.doAction("after_setup_data",this,e)}},{key:"initializeVue",value:function(){wfacp.products=new t(this),wfacp.fields=new a(this),wfacp.design=new i(this),wfacp.add_new_page=new s(this),wfacp.settings=new l(this),wfacp.optimization=new o(this),wfacp.global_settings=new n(this),this.jQuery_events(),wfacp.hooks.doAction("wfacp_loaded",this)}},{key:"getData",value:function(){return this.data}},{key:"jQuery_events",value:function(){if(e(".wfacp_checkout_page_status").on("change",function(t){var a=!1;e(this).is(":checked")&&(a=!0);var i=e(".wfacp_head_funnel_state_on"),s=e(".wfacp_head_funnel_state_off");a?(i.show(),s.hide()):(i.hide(),s.show());var l=e(this).data("id"),o=new wfacp.ajax;o.ajax("update_page_status",{post_status:a,id:l});var n=this.closest(".wffn-ellipsis-menu");n&&(this.checked?(e(n).find(".bwfan-tag-rounded").removeClass("clr-orange").addClass("clr-green"),e(n).find(".bwfan-funnel-status").text("Published"),e(n).find(".bwfan-status-toggle").text("Draft")):(e(n).find(".bwfan-tag-rounded").removeClass("clr-green").addClass("clr-orange"),e(n).find(".bwfan-funnel-status").text("Draft"),e(n).find(".bwfan-status-toggle").text("Publish"))),o.success=function(){e("#modal-saved-data-success").iziModal("setTitle",wfacp_localization.global.changes_saved),e("#modal-saved-data-success").iziModal("open")}}),e("#the-list .wfacp_funnels .wfacp-preview").on("click",function(){var t=this,a=e(this).attr("data-id"),i=e(this);if(i.addClass("disabled"),a>0){var s=new wfacp.ajax;s.ajax("preview_details",{wfacp_id:a}),s.success=function(a){!0===a.status&&e(t).WCBackboneModal({template:"wfacp-page-popup",variable:a}),i.removeClass("disabled")}}return!1}),e(".wfacp-product-widget-tabs").length>0){var t=e(".wfacp-product-widget-tabs .wfacp-tab-title");t.on("click",function(){var t=e(this).closest(".wfacp-product-widget-tabs"),a=e(this).attr("data-tab");t.find(".wfacp-tab-title").removeClass("wfacp-active"),t.find(".wfacp-tab-title[data-tab="+a+"]").addClass("wfacp-active"),e(t).find(".wfacp-tab-content").removeClass("wfacp-activeTab");var i=e(t).find(".wfacp_forms_global_settings .vue-form-generator fieldset");i.hide(),i.eq(a-1).addClass("wfacp-activeTab"),i.eq(a-1).show();var s=e(t).find(".wfacp_global_setting_inner .vue-form-generator fieldset");s.hide(),s.eq(a-1).addClass("wfacp-activeTab"),s.eq(a-1).show()}),t.eq(0).trigger("click")}e(".wfacp_delete_checkout_page").on("click",function(t){t.preventDefault();var a=e(this).attr("href"),i=wfacp.swal({text:wfacp_localization.global.delete_checkout_page,title:wfacp_localization.global.delete_checkout_page_head,confirmButtonText:wfacp_localization.global.confirm_button_text,cancelButtonText:wfacp_localization.global.cancel_button_text,reverseButtons:!0,onOpen:function(){document.querySelector(".swal2-header").insertAdjacentHTML("beforebegin",'<div class="wffn-swal-modal-title">'+wfacp_localization.global.swal_delete_modal_title+"</div>")}});i.then(function(e){wfacp.tools.hp(e,"value")&&(window.location.href=a)}),i.catch(function(){})}),e(document).on("click",".wfacp_copy_text",function(){var t=e(this).siblings(".wfacp_description");t.length>0&&(t.find("input").select(),document.execCommand("copy"),wfacp.show_data_save_model(wfacp_localization.global.shortcode_copy_message))})}},{key:"model",value:function(){wfacp.show_saved_model=e("#modal-saved-data-success"),0!==wfacp.show_saved_model.length&&wfacp.show_saved_model.iziModal({title:wfacp_localization.global.data_saving,icon:"icon-check",headerColor:"#6dbe45",background:"#6dbe45",borderBottom:!1,width:600,timeout:4e3,timeoutProgressbar:!0,transitionIn:"fadeInUp",transitionOut:"fadeOut",bottom:0,loop:!0,pauseOnHover:!0,overlay:!1,onOpening:function(t){var a=e(".wfacp_spinner.spinner");a.length>0&&a.css("visibility","hidden")},onClosed:function(){wfacp.show_saved_model.iziModal("setTitle",wfacp_localization.global.data_saving);var t=e(".wfacp_spinner.spinner");t.is(":visible")&&t.css("visibility","hidden")}})}}]),d}();e(window).on("load",function(){Vue.component("multiselect",window.VueMultiselect.default),window.dispatchEvent(new Event("wfacp_checkout_admin_event_loaded")),window.builder=new d(wfacp_data),setTimeout(function(){e(".wfacp_loader").hide()},600),e(".wfacp_allow_panel_close .hndle").on("click",function(){e(this).parents(".wfacp_allow_panel_close").toggleClass("closed")});var t=e("a[data-original-link]");t.length>0&&t.each(function(){var t=e(this).data("original-link");e(this).attr("href",t)}),e(document.body).on("click",".wfacp_pro_feature_span",function(){var t=e(this).data("item");wfacp.show_pro_message(t,this)})});var r={init:function(t){var a=this,i=e(this);setTimeout(function(t){t.find(".iziModal-button-close").on("click",function(){e(this).trigger("onclosed"),e("html").removeClass("iziModal-isAttached"),e(".wfacp_overlay").removeClass("wfacp_overlay_active"),t.fadeOut()}),e(a).trigger("oninit")},300,i)},open:function(){var t=this,a=e(this);setTimeout(function(){a.fadeIn(),a.addClass("hasScroll");var i=e(t).find(".iziModal-content").height(),s=e(window).height(),l=0;i>s?(i=s-20,e(t).find(".iziModal-wrap").height(i-75)):(l=a.find(".iziModal-noSubtitle").innerHeight(),a.find(".iziModal-wrap").height(i)),l>0?a.height(i+l):a.height(i),e("html").addClass("iziModal-isAttached"),e(".wfacp_overlay").addClass("wfacp_overlay_active")},150),e(this).trigger("onopend")},close:function(){e(this).trigger("onclosed"),e("html").removeClass("iziModal-isAttached"),e(".wfacp_overlay").removeClass("wfacp_overlay_active"),e(this).fadeOut()},setSubtitle:function(e){}};e.fn.WoofunnelModal=function(t){return r[t]?r[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!==_typeof(t)&&t?void e.error("Method "+t+" does not exist on jQuery.tooltip"):r.init.apply(this,arguments)},e(document).on("click",".bwf-ellipsis-menu.bwf-ellipsis--alter-alter .bwf-ellipsis-menu__toggle",function(){e(this).parents(".bwf-ellipsis--alter-alter").toggleClass("show-menu")}),e(document).on("click",function(t){e(".bwf-ellipsis-menu.bwf-ellipsis--alter-alter").length&&(t.target.matches(".bwf-ellipsis-menu__toggle")||t.target.closest(".bwf-ellipsis-menu__toggle")||e(".bwf-ellipsis-menu.bwf-ellipsis--alter-alter").removeClass("show-menu")),t.target.matches(".wffn-ellipsis-menu")?e(t.target).toggleClass("is-opened"):t.target.closest(".wffn-ellipsis-menu")?t.target.closest(".wffn-ellipsis-menu-dropdown")?e(t.target.closest(".wffn-ellipsis-menu")).removeClass("is-opened"):e(t.target.closest(".wffn-ellipsis-menu")).toggleClass("is-opened"):e(".wffn-ellipsis-menu").length&&e(".wffn-ellipsis-menu").removeClass("is-opened")})}(jQuery);
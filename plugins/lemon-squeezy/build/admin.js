!function(){"use strict";var e=window.React;const t="https://www.lemonsqueezy.com/",{__:__}=wp.i18n,{BaseControl:s,Button:n,PanelBody:a,PanelRow:l,Card:i,CardMedia:o,CardBody:r,Notice:c}=wp.components,{render:u,Component:m,Fragment:g}=wp.element;u((0,e.createElement)(class extends m{constructor(){super(...arguments),this.state={isSettingsLoaded:!1,isAPILoading:!1,isAPISaving:!1,isTestAPISaving:!1,lsqApiKey:"",lsqApiKeyTest:"",showingTestInput:!1,enteredApiKeyTest:"",lsqUser:null,oauth:window.lsq_oauth||{}}}async componentDidMount(){wp.api.loadPromise.then((()=>{this.settings=new wp.api.models.Settings,!1===this.state.isSettingsLoaded&&this.settings.fetch().then((e=>{this.setState({lsqApiKey:e.lsq_api_key,lsqApiKeyTest:e.lsq_api_key_test,isSettingsLoaded:!0}),this.checkApi()}))}))}removeTestKey(){return this.setState({isTestAPISaving:!0}),fetch("/wp-json/lsq/v1/delete_test_key",{method:"DELETE",credentials:"same-origin",headers:new Headers({"Content-Type":"application/json;charset=UTF-8","X-WP-Nonce":Lemonsqueezy.nonce})}).then((e=>e.json())).then((e=>{1==e.success?this.setState({lsqApiKeyTest:"",isTestAPISaving:!1}):(this.setState({isTestAPISaving:!1}),e.error&&alert(e.error))}))}saveTestApiKey(){return this.setState({isTestAPISaving:!0}),fetch("/wp-json/lsq/v1/save_test_key",{method:"POST",credentials:"same-origin",headers:new Headers({"Content-Type":"application/json;charset=UTF-8","X-WP-Nonce":Lemonsqueezy.nonce}),body:JSON.stringify({test_key:this.state.enteredApiKeyTest})}).then((e=>e.json())).then((e=>{1==e.success?this.setState({lsqApiKeyTest:this.state.enteredApiKeyTest,isTestAPISaving:!1}):(this.setState({isTestAPISaving:!1,lsqApiKeyTest:""}),e.error&&alert(e.error))}))}checkApi(){return this.setState({isAPILoading:!0}),fetch("/wp-json/lsq/v1/validate").then((e=>e.json())).then((e=>{1==e.success?this.setState({isAPILoading:!1,lsqUser:e.user}):this.setState({isAPILoading:!1,lsqUser:null})}))}changeOptions(e,t){return this.setState({isAPISaving:!0}),new wp.api.models.Settings({[e]:t}).save().then((t=>{this.setState({[e]:t[e],isAPISaving:!1})}))}oauthAuthorize(){window.location.href=window.Lemonsqueezy.oauth_url}oauthDisconnect(){this.changeOptions("lsq_api_key","").then((()=>{this.setState({lsqUser:null})}))}saveTestKey(){this.saveTestApiKey()}render(){const u=this.state.lsqUser?__("Connected to Lemon Squeezy","lemonsqueezy"):__("Connect to Lemon Squeezy","lemonsqueezy");let m=this.state.isAPILoading?__("Checking...","lemonsqueezy"):__("Connect to Lemon Squeezy","lemonsqueezy");return(0,e.createElement)(g,null,(0,e.createElement)("div",{className:"lsq-header"},(0,e.createElement)("div",{className:"lsq-header__logo"},(0,e.createElement)("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjBweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTI4IDE3NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00My4yODY3IDEwNi43OTVMOTAuMjE1NSAxMjguMzc1Qzk2LjAzMTkgMTMxLjA1MSAxMDAuMTM4IDEzNS41NDIgMTAyLjM1NSAxNDAuNjk0QzEwNy45NjMgMTUzLjczOSAxMDAuMjk4IDE2Ny4wODEgODguMjY1OCAxNzEuODc5Qzc2LjIzMTYgMTc2LjY3NiA2My40MDYxIDE3My41ODkgNTcuNTc0NCAxNjAuMDIzTDM3LjE1MTEgMTEyLjM5NEMzNS41Njg0IDEwOC43MDIgMzkuNTQ0MSAxMDUuMDc0IDQzLjI4NjcgMTA2Ljc5NSIgZmlsbD0iI0ZGQzIzMyIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTQ2LjEwNTQgOTIuODI2NEw5NC41NDggNzQuNjEyNkMxMTAuNjQ4IDY4LjU1OTEgMTI4LjIzNSA4MC4wMTI3IDEyNy45OTggOTYuNjU0N0MxMjcuOTk0IDk2Ljg3MTkgMTI3Ljk5IDk3LjA4OTEgMTI3Ljk4NCA5Ny4zMDgxQzEyNy42MzYgMTEzLjUxNCAxMTAuNTM5IDEyNC40MDYgOTQuNzkyNyAxMTguNjczTDQ2LjE1MTMgMTAwLjk2NUM0Mi4yNzExIDk5LjU1MzUgNDIuMjQyNSA5NC4yNzg2IDQ2LjEwNTQgOTIuODI2NCIgZmlsbD0iI0ZGQzIzMyIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTQzLjM5IDg2LjUxNzVMOTEuMDEwNyA2Ni4zOTE0QzEwNi44MzUgNTkuNzAyOSAxMTAuODUxIDM5LjYyODMgOTguNDU3NSAyOC4wMjk0Qzk4LjI5NTEgMjcuODc2NiA5OC4xMzI2IDI3LjcyNTcgOTcuOTY4MiAyNy41NzQ3Qzg1LjgxNzQgMTYuMzU2NyA2NS43MzA1IDIwLjMwNjUgNTguODEzMSAzNS4wODIyTDM3LjQ0MzYgODAuNzMyOEMzNS43Mzg2IDg0LjM3MzMgMzkuNTkyIDg4LjEyMjUgNDMuMzkgODYuNTE3NSIgZmlsbD0iI0ZGQzIzMyIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTMxLjEzNTYgNzguNTY0Mkw0OC40NDkxIDMxLjM0NTZDNTAuNTk1NiAyNS40OTA5IDUwLjE5OCAxOS41MjAyIDQ3Ljk3ODkgMTQuMzY4NkM0Mi4zNTk0IDEuMzI4NDggMjcuMTQwOCAtMi44ODA4IDE1LjExMDQgMS45MjQ4MUMzLjA4MTkxIDYuNzMyMjYgLTMuNzE1MDQgMTcuNjUwMiAyLjEyODEyIDMxLjIxMTJMMjIuNjg1MyA3OC43ODg4QzI0LjI3OTQgODIuNDc1MyAyOS43NTU2IDgyLjMyOTkgMzEuMTM1NiA3OC41NjQyIiBmaWxsPSIjRkZDMjMzIi8+Cjwvc3ZnPg==",className:"lsq-header__logo-icon"}),__("LemonSqueezy.com","lemonsqueezy")),(0,e.createElement)("div",{className:"lsq-header__cta"},__("Want to make money with digital products?","lemonsqueezy"),(0,e.createElement)("a",{href:t,target:"_blank",rel:"noreferrer",className:"lsq-button lsq-button--secondary"},__("Start selling today","lemonsqueezy")))),(0,e.createElement)("div",{className:"lsq-main"},(0,e.createElement)("div",{className:"lsq-main__column lsq-main__column--left"},(0,e.createElement)("div",{className:"lsq-content lsq-content--intro"},(0,e.createElement)("h1",null,__("Connect your store","lemonsqueezy")),(0,e.createElement)("p",null,__("The Lemon Squeezy plugin connects your Lemon Squeezy stores to your WordPress site to bring your products right into the block editor.","lemonsqueezy"))),(0,e.createElement)("div",{className:"lsq-content lsq-content--step"},(0,e.createElement)("h2",null,__("1. Connect to Lemon Squeezy","lemonsqueezy")),(0,e.createElement)("p",null,__('To get started, use the "Connect to Lemon Squeezy" button on the right. When prompted, click "Authorize" to connect your Lemon Squeezy account with this WordPress site.',"lemonsqueezy"))),(0,e.createElement)("div",{className:"lsq-content lsq-content--step"},(0,e.createElement)("h2",null,__("2. Add the Lemon Squeezy block and start selling!","lemonsqueezy")),(0,e.createElement)("p",null,__("To add products to your posts or pages, simply add the Lemon Squeezy block and select which product you’d like to insert. Use the block settings to select a checkout link or a checkout overlay.","lemonsqueezy")))),(0,e.createElement)("div",{className:"lsq-main__column lsq-main__column--right"},(0,e.createElement)(a,{className:"lsq-panel"},(0,e.createElement)(l,{className:"lsq-panel__row"},(0,e.createElement)(s,{label:u,id:"lsq-options-lsq-api",className:"lsq-panel__control"},this.state.oauth.error&&(0,e.createElement)(c,{status:"error",className:"lsq-notice"},"An error occurred: ",this.state.oauth.error),this.state.lsqUser&&(0,e.createElement)(i,{size:"small",className:"lsq-card"},(0,e.createElement)(o,null,(0,e.createElement)("div",{className:"lsq-avatar"},(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"80px",height:"80px",viewBox:"0 0 80 80",version:"1.1"},(0,e.createElement)("circle",{fill:this.state.lsqUser.attributes.color,width:"80",height:"80",cx:"40",cy:"40",r:"40"}),(0,e.createElement)("text",{x:"50%",y:"50%",alignmentBaseline:"middle",textAnchor:"middle",fontSize:"32",fontWeight:"400",dy:".1em",dominantBaseline:"middle",fill:"#ffffff"},this.state.lsqUser.attributes.name.charAt(0).toUpperCase())),this.state.lsqUser.attributes.avatar_url&&(0,e.createElement)("img",{src:this.state.lsqUser.attributes.avatar_url}))),(0,e.createElement)(r,{className:"lsq-card__body"},(0,e.createElement)("p",null,"Connected as:"),(0,e.createElement)("h3",null,this.state.lsqUser.attributes.name),(0,e.createElement)("div",null,this.state.lsqUser.attributes.email))),(0,e.createElement)("div",{className:"lsq-panel__buttons"},this.state.lsqUser&&(0,e.createElement)(g,null,(0,e.createElement)(n,{isPrimary:!0,isBusy:this.state.isAPISaving,disabled:this.state.isAPISaving,onClick:()=>this.oauthDisconnect(),className:"lsq-button lsq-button--primary"},"Disconnect from Lemon Squeezy"),!this.state.lsqApiKeyTest&&(0,e.createElement)(g,null,!this.state.showingTestInput&&(0,e.createElement)(n,{onClick:()=>this.setState({showingTestInput:!0}),isSmall:!0},"Need to Test? Enter your Test Key"),this.state.showingTestInput&&(0,e.createElement)(g,null,(0,e.createElement)("input",{className:"lsq-input",onChange:e=>{this.setState({enteredApiKeyTest:e.target.value})},type:"text",placeholder:"Enter your Test API Key"}),(0,e.createElement)(n,{isBusy:this.state.isTestAPISaving,isSecondary:!0,onClick:()=>this.saveTestKey()},"Save Test API Key"),(0,e.createElement)(n,{onClick:()=>this.setState({showingTestInput:!1})},"Cancel"),(0,e.createElement)("div",null,(0,e.createElement)("br",null),(0,e.createElement)(n,{isLink:!0,target:"_blank",href:"https://docs.lemonsqueezy.com/help/getting-started/test-mode"},"Read about the test mode.")))),this.state.lsqApiKeyTest&&(0,e.createElement)(g,null,(0,e.createElement)("p",null,"You're on Test Mode."),(0,e.createElement)(n,{isBusy:this.state.isTestAPISaving,isSecondary:!0,onClick:()=>this.removeTestKey()},"Remove Test Mode"))),!this.state.lsqUser&&(0,e.createElement)(n,{isPrimary:!0,isBusy:this.state.isAPILoading||!this.state.isSettingsLoaded,disabled:this.state.isAPILoading||!this.state.isSettingsLoaded,onClick:()=>this.oauthAuthorize(),className:"lsq-button lsq-button--primary"},m)),(0,e.createElement)("div",{className:"lsq-panel__footer"},(0,e.createElement)("p",null,"© ",(new Date).getFullYear()," ","Lemon Squeezy, LLC"," ",(0,e.createElement)("span",{className:"lsq-u-bullet-spacer"},"•")," ",(0,e.createElement)("a",{target:"blank",rel:"noreferrer",href:t},"LemonSqueezy.com")))))))))}},null),document.getElementById("lsq-plugin"))}();
!function (e) { "use strict"; var t = [], i = []; function a() { "undefined" != typeof Storage && ("undefined" != localStorage.successMessages && (localStorage.successMessages = JSON.stringify(t)), "undefined" != localStorage.errorMessages && (localStorage.errorMessages = JSON.stringify(i)), "undefined" != localStorage.path && (localStorage.path = window.location.pathname)) } function n(e) { for (var t = [["amp", "&"], ["apos", "'"], ["#x27", "'"], ["#x2F", "/"], ["#39", "'"], ["#47", "/"], ["lt", "<"], ["gt", ">"], ["nbsp", " "], ["quot", '"']], i = 0, a = t.length; i < a; ++i)e = e.replace(RegExp("&" + t[i][0] + ";", "g"), t[i][1]); return e = (e = e.replace(RegExp("</b>", "g"), "</strong>")).replace(RegExp("<b>", "g"), "<strong>") } e(document).ready(function () { r = window.location.pathname, "undefined" != typeof Storage && "undefined" != localStorage.path && (r == localStorage.path ? (("" != localStorage.successMessages || "undefined" != localStorage.successMessages) && (s = JSON.parse(localStorage.successMessages)).forEach(function (e, t, i) { Toastify({ text: e, duration: 3e3, newWindow: !1, close: !0, gravity: "top", position: "center", backgroundColor: "#00A14B", stopOnFocus: !0 }).showToast(), t === i.length - 1 && localStorage.removeItem("successMessages") }), ("" != localStorage.errorMessages || "undefined" != localStorage.errorMessages) && (s = JSON.parse(localStorage.errorMessages)).forEach(function (e, t, i) { Toastify({ text: e, duration: -1, newWindow: !1, close: !0, gravity: "top", position: "center", backgroundColor: "#EF4136", stopOnFocus: !0 }).showToast(), t === i.length - 1 && localStorage.removeItem("errorMessages") }), localStorage.removeItem("path")) : (localStorage.removeItem("path"), localStorage.removeItem("successMessages"), localStorage.removeItem("errorMessages"))), e("#smrt-order-select").select2(), e("#smartbill-manually-sync-stock").click(function (t) { t.preventDefault(); var n = e("select[name=smartbill_plugin_options_settings\\[used_stock\\]]").find(":selected").val(), s = document.createElement("div"); "" == n || "fara-gestiune" == n ? Toastify({ text: "Este necesara selectarea gestiunii din care vor fi preluate stocurile.", duration: -1, newWindow: !1, close: !0, gravity: "top", position: "center", backgroundColor: "#EF4136", stopOnFocus: !0 }).showToast() : (s.innerHTML = "Stocurile produselor din WooCommerce <strong>vor fi actualizate</strong> cu stocurile produselor din <strong>gestiunea " + n + "</strong>.", swal({ title: "Atentie!", content: s, icon: "warning", buttons: ["Renunta", "Actualizeaza stocuri"] }).then(function (t) { if (!t) return !1; (s = document.createElement("div")).innerHTML = "Va rugam asteptati finalizarea preluarii...", swal({ title: "Se incarca!", content: s, icon: "info", buttons: [!1, !1] }), e.ajax({ url: ajaxurl, type: "post", data: { security: smartbill.security, body: n, action: "smartbill_woocommerce_manually_sync_stock" }, success: function (t) { try { if (t = JSON.parse(t), (s = document.createElement("div")).innerHTML = t.data, void 0 != t.data) swal.close(), swal({ title: "", content: s, icon: t.icon, buttons: ["Am inteles", "Descarca istoric"] }).then(function (t) { if (!t) return !1; swal({ title: "Descarcarea documentului va incepe curand…", content: document.createElement("div"), icon: "info", buttons: [!1, !1] }), e.ajax({ url: ajaxurl, type: "post", data: { security: smartbill.security, action: "smartbill_woocommerce_download_manual_stock_history" }, success: function (e) { e = JSON.parse(e); try { if (void 0 != e.data) swal.close(), location.href = e.data; else throw e.error } catch (t) { i.push(t), a(), location.reload() } }, error: function (e, t, n) { i.push(n), a(), location.reload() } }) }); else throw t.error } catch (n) { i.push(n), a(), location.reload() } }, error: function (e, t, n) { i.push(n), a(), location.reload() } }) })) }), e("#smartbill-download-sync-stock-history").click(function (t) { t.preventDefault(), swal({ title: "Descarcarea documentului va incepe curand…", content: document.createElement("div"), icon: "warning", buttons: [!1, !1] }), e.ajax({ url: ajaxurl, type: "post", data: { security: smartbill.security, action: "smartbill_woocommerce_download_stock_history" }, success: function (e) { e = JSON.parse(e); try { if (void 0 != e.data) swal.close(), location.href = e.data; else throw e.error } catch (t) { i.push(t), a(), location.reload() } }, error: function (e, t, n) { i.push(n), a(), location.reload() } }) }), e("#export-settings").click(function (t) { t.preventDefault(), smartbill_export.setariEmitere.moneda = e('select[name="smartbill_plugin_options_settings[billing_currency]"]').find(":selected").text(); var i = new Date, a = i.getFullYear() + "-" + ("0" + (i.getMonth() + 1)).slice(-2) + "-" + ("0" + i.getDate()).slice(-2) + " " + ("0" + i.getHours()).slice(-2) + "_" + ("0" + i.getMinutes()).slice(-2) + "_" + ("0" + i.getSeconds()).slice(-2); smartbill_export.versiuni.data_export = a; var n = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(smartbill_export)), s = document.createElement("a"); s.setAttribute("href", n), s.setAttribute("download", "smartbill_modul_setari.json"), document.body.appendChild(s), s.click(), s.remove() }), e("#get-smartbill-setting").click(function (n) { n.preventDefault(), swal({ title: "Se preiau informatiile din SmartBill…", content: document.createElement("div"), icon: "warning", buttons: [!1, !1] }), e.ajax({ url: ajaxurl, type: "post", data: { security: smartbill.security, action: "smartbill_woocommerce_sync_settings" }, success: function (e) { "" != (e = JSON.parse(e)).message && t.push(e.message), "" != e.error && t.push(e.error), a(), location.reload() }, error: function (e, t, n) { i.push(n), a(), location.reload() } }) }), e('button[name="save"].save_order.button-primary').click(function (t) { if (t.detail && 1 != t.detail) return !1; if (0 !== smartbill.woocommerce_status.length && (Array.isArray(smartbill.woocommerce_status) || (smartbill.woocommerce_status = [smartbill.woocommerce_status]), smartbill.woocommerce_status.includes(e("#order_status").val()))) { var i; 0 === e("#smartbill-woocommerce-view-document-button").length ? (t.preventDefault(), (i = document.createElement("div")).innerHTML = "Comanda #" + smartbill.post_id + " va fi emisa in SmartBill.", swal({ title: "Modulul SmartBill a detectat modificarea statusului comenzii", content: i, icon: "warning", buttons: ["Mai tarziu", "Emite document"] }).then(async function (i) { if (!i) return e(t.currentTarget.form).submit(), !1; await f({ data: { order_id: smartbill.post_id }, security: smartbill.security, action: "smartbill_woocommerce_issue_document" }, !1, !0).then(function () { e(t.currentTarget.form).submit() }) })) : (t.preventDefault(), i = document.createElement("div"), a(), i.innerHTML = "Te informam ca nu se va emite automat o alta comanda in SmartBill.", swal({ title: "Comanda a fost deja facturata in SmartBill. ", content: i, icon: "warning", buttons: [!1, "Continua"] }).then(function (i) { e(t.currentTarget.form).submit() })) } }); var s, r, o = e("#smartbill_woocommerce_meta_box"); async function l(t) { if (t.preventDefault(), t.detail && 1 != t.detail) return !1; try { var i, a = { data: { order_id: smartbill.post_id }, security: smartbill.security, action: "smartbill_woocommerce_issue_document" }; "order" in e(t.currentTarget).data() && (a.data.order_id = e(t.currentTarget).data().order), e(this).hasClass("reissue") ? ((i = document.createElement("div")).innerHTML = "Comanda a fost deja facturata in SmartBill.<br/>Inainte de reemitere va recomandam sa anulati sau sa stergeti documentul emis anterior.", swal({ title: "Atentie!", content: i, icon: "warning", buttons: ["Renunta", "Reemite in SmartBill"] }).then(async function (e) { if (!e) return !1; await f(a, !1, !0).then(function () { window.location.reload() }) })) : await f(a, !1, !0).then(function () { window.location.reload() }) } catch (n) { swal.close(), (i = document.createElement("div")).innerHTML = n.responseText, swal({ title: "Atentie!", content: i, icon: "error", buttons: [!1, "Ok"] }).then(function (e) { return !e && !1 }) } } async function c(e, t) { for (let i = 0; i < e.length; i++)await t(e[i], i, e) } o.length && o.prependTo(o.parent()), "1" == smartbill.send_mail_with_document && e("<option>").val("smartbill_send_documents_to_client").text("Trimite factura clientului").appendTo("select[name='action'], select[name='action2']"), e("<option>").val("smartbill_generate_documents").text("Emite documente in SmartBill").appendTo("select[name='action'], select[name='action2']"), e("#doaction2").click(function (t) { t.detail && 1 != t.detail || (e("#doaction2").removeAttr("onclick"), e("#doaction2").css("pointer-events", "none")) }), e("#doaction").click(function (t) { if (t.detail && 1 != t.detail) return !1; var i, a = e(this).siblings("select"), n = [], s = [], r = e('input[name="id[]"]:checked'); if (0 === r.length && (r = e('input[name="post[]"]:checked')), r.each(function (t, i) { e(i).parent().siblings(".smartbill_woocommerce_invoice").find("a").length ? s.push(i) : n.push(i) }), n.sort((e, t) => e.value > t.value ? 1 : -1), s.sort((e, t) => e.value > t.value ? 1 : -1), "smartbill_generate_documents" == a.val()) { if (t.preventDefault(), n.length) { if (s.length) (i = document.createElement("div")).innerHTML = "Exista comenzi care au fost deja facturate. <br/> Doar comenzile nefacturate vor fi emise in SmartBill.", 1 == s.length && (i.innerHTML = "Exista o comanda care a fost deja facturata. <br/> Doar comenzile nefacturate vor fi emise in SmartBill."), 1 == n.length && (i.innerHTML = "Exista comenzi care au fost deja facturate. <br/> Doar comanda nefacturata va fi emisa in SmartBill."), 1 == s.length && 1 == n.length && (i.innerHTML = "Exista o comanda care a fost deja facturata. <br/> Doar comanda nefacturata va fi emisa in SmartBill."), swal({ title: "Atentie!", content: i, icon: "warning", buttons: ["Renunta", "Emite in SmartBill"] }).then(function (t) { if (!t) return !1; var i = document.createElement("div"); i.innerHTML = "Va rugam asteptati raspunsul serverului...", swal({ title: "Se incarca!", content: i, icon: "info", buttons: [!1, !1] }); let a = async () => { await c(n, async (t, i) => { var a, n = parseInt(e(t).val()), s = !0; i > 0 && (s = !1); var r = await f({ data: { order_id: n, is_first: s }, security: smartbill.security, action: "smartbill_woocommerce_issue_document" }, !0, !1); if ((r = JSON.parse(r)).hasOwnProperty("headers") && 4 >= parseInt(r.headers["x-ratelimit-remaining"])) { await u(Math.abs(Math.floor(new Date().getTime() / 1e3) - Math.floor(new Date(1e3 * parseInt(r.headers["x-ratelimit-reset"])).getTime() / 1e3)) * (5 - parseInt(r.headers["x-ratelimit-remaining"])) * 1e3) } }) }; a().then(function () { swal.close(), window.location.reload() }) }); else { t.preventDefault(); var o = document.createElement("div"); o.innerHTML = "Va rugam asteptati raspunsul serverului...", swal({ title: "Se incarca!", content: o, icon: "info", buttons: [!1, !1] }); let l = async () => { await c(n, async (t, i) => { var a, n = parseInt(e(t).val()), s = !0; i > 0 && (s = !1); var r = await f({ data: { order_id: n, is_first: s }, security: smartbill.security, action: "smartbill_woocommerce_issue_document" }, !0, !1); if ((r = JSON.parse(r)).hasOwnProperty("headers") && 4 >= parseInt(r.headers["x-ratelimit-remaining"])) { await u(Math.abs(Math.floor(new Date().getTime() / 1e3) - Math.floor(new Date(1e3 * parseInt(r.headers["x-ratelimit-reset"])).getTime() / 1e3)) * (5 - parseInt(r.headers["x-ratelimit-remaining"])) * 1e3) } }) }; l().then(function () { swal.close(), window.location.reload() }) } } else s.length && ((i = document.createElement("div")).innerHTML = "Comenzile selectate sunt deja facturate in SmartBill.", 1 == s.length && (i.innerHTML = "Comanda selectata este deja facturata in SmartBill."), swal({ title: "Atentie!", content: i, icon: "warning", buttons: ["Renunta", "Reemite in SmartBill"] }).then(function (t) { if (!t) return !1; var i = document.createElement("div"); i.innerHTML = "Va rugam asteptati raspunsul serverului...", swal({ title: "Se incarca!", content: i, icon: "info", buttons: [!1, !1] }); let a = async () => { await c(s, async (t, i) => { var a, n = parseInt(e(t).val()), s = !0; i > 0 && (s = !1); var r = await f({ data: { order_id: n, is_first: s }, security: smartbill.security, action: "smartbill_woocommerce_issue_document" }, !0, !1); if ((r = JSON.parse(r)).hasOwnProperty("headers") && 4 >= parseInt(r.headers["x-ratelimit-remaining"])) { await u(Math.abs(Math.floor(new Date().getTime() / 1e3) - Math.floor(new Date(1e3 * parseInt(r.headers["x-ratelimit-reset"])).getTime() / 1e3)) * (5 - parseInt(r.headers["x-ratelimit-remaining"])) * 1e3) } }) }; a().then(function () { swal.close(), window.location.reload() }) })) } else if ("smartbill_send_documents_to_client" == a.val()) { if ("1" == smartbill.send_mail_with_document) { if (t.preventDefault(), s.length) { if (n.length) { i = document.createElement("div"); var m = "Trimite documente clientilor"; i.innerHTML = "Exista comenzi care nu au fost facturate. <br/> Doar comenzile facturate vor fi trimise prin e-mail clientilor.", 1 == s.length && (i.innerHTML = "O comanda nu a fost facturata. <br/> Doar comenzile facturate vor fi trimise prin e-mail clientilor.", m = "Trimite documentul clientului"), swal({ title: "Atentie!", content: i, icon: "warning", buttons: ["Renunta", m] }).then(function (t) { if (!t) return !1; var i = document.createElement("div"); i.innerHTML = "Va rugam asteptati raspunsul serverului...", swal({ title: "Se incarca!", content: i, icon: "info", buttons: [!1, !1] }); let a = async () => { await c(s, async (t, i) => { var a, n = parseInt(e(t).val()), s = !0; i > 0 && (s = !1); var r = await d({ data: { order_id: n, is_first: s }, security: smartbill.security, action: "smartbill_woocommerce_issue_document" }, !0, !1); if ((r = JSON.parse(r)).hasOwnProperty("headers") && 4 >= parseInt(r.headers["x-ratelimit-remaining"])) { await u(Math.abs(Math.floor(new Date().getTime() / 1e3) - Math.floor(new Date(1e3 * parseInt(r.headers["x-ratelimit-reset"])).getTime() / 1e3)) * (5 - parseInt(r.headers["x-ratelimit-remaining"])) * 1e3) } }) }; a().then(function () { swal.close(), window.location.reload() }) }) } else { t.preventDefault(); var o = document.createElement("div"); o.innerHTML = "Va rugam asteptati raspunsul serverului...", swal({ title: "Se incarca!", content: o, icon: "info", buttons: [!1, !1] }); let p = async () => { await c(s, async (t, i) => { var a, n = parseInt(e(t).val()), s = !0; i > 0 && (s = !1); var r = await d({ data: { order_id: n, is_first: s }, security: smartbill.security, action: "smartbill_woocommerce_issue_document" }, !0, !1); if ((r = JSON.parse(r)).hasOwnProperty("headers") && 4 >= parseInt(r.headers["x-ratelimit-remaining"])) { await u(Math.abs(Math.floor(new Date().getTime() / 1e3) - Math.floor(new Date(1e3 * parseInt(r.headers["x-ratelimit-reset"])).getTime() / 1e3)) * (5 - parseInt(r.headers["x-ratelimit-remaining"])) * 1e3) } }) }; p().then(function () { swal.close(), window.location.reload() }) } } else n.length && ((i = document.createElement("div")).innerHTML = "Comenzile selectate nu sunt facturate in SmartBill.", 1 == n.length && (i.innerHTML = "Comanda selectata nu este facturata in SmartBill."), swal({ title: "Atentie!", content: i, icon: "warning", buttons: ["Renunta", "Emite in SmartBill"] }).then(function (t) { if (!t) return !1; var i = document.createElement("div"); i.innerHTML = "Va rugam asteptati raspunsul serverului...", swal({ title: "Se incarca!", content: i, icon: "info", buttons: [!1, !1] }); let a = async () => { await c(n, async (t, i) => { var a, n = parseInt(e(t).val()), s = !0; i > 0 && (s = !1); var r = await f({ data: { order_id: n, is_first: s }, security: smartbill.security, action: "smartbill_woocommerce_issue_document" }, !0, !1); if ((r = JSON.parse(r)).hasOwnProperty("headers") && 4 >= parseInt(r.headers["x-ratelimit-remaining"])) { await u(Math.abs(Math.floor(new Date().getTime() / 1e3) - Math.floor(new Date(1e3 * parseInt(r.headers["x-ratelimit-reset"])).getTime() / 1e3)) * (5 - parseInt(r.headers["x-ratelimit-remaining"])) * 1e3) } }) }; a().then(function () { swal.close(), window.location.reload() }) })) } } else if (-1 !== a.val().indexOf("mark_") && 0 !== smartbill.woocommerce_status.length && (Array.isArray(smartbill.woocommerce_status) || (smartbill.woocommerce_status = [smartbill.woocommerce_status]), smartbill.woocommerce_status.includes(a.val().replace("mark_", "wc-")) && n.length)) { t.preventDefault(), i = document.createElement("div"); var h = "Modulul SmartBill a detectat modificarea statusului comenzilor.", b = [], g = "Emite documente"; n.forEach(function (t, i) { var a = parseInt(e(t).val()); b.push("#" + a) }), n.sort((e, t) => e.value > t.value ? 1 : -1), i.innerHTML = "Comenzile " + b.join(", ") + " vor fi emise in SmartBill.", 1 == n.length && (i.innerHTML = "Comanda " + b.join(", ") + " va fi emisa in SmartBill.", h = "Modulul SmartBill a detectat modificarea statusului unei comenzi.", g = "Emite document"), swal({ title: h, content: i, icon: "warning", buttons: ["Mai tarziu", g] }).then(async function (i) { if (i) { var a = document.createElement("div"); a.innerHTML = "Va rugam asteptati raspunsul serverului...", swal({ title: "Se incarca!", content: a, icon: "info", buttons: [!1, !1] }); let s = async () => { await c(n, async (t, i) => { var a, n = parseInt(e(t).val()), s = !0; i > 0 && (s = !1); var r = await f({ data: { order_id: n, is_first: s }, security: smartbill.security, action: "smartbill_woocommerce_issue_document" }, !0, !1); if ((r = JSON.parse(r)).hasOwnProperty("headers") && 4 >= parseInt(r.headers["x-ratelimit-remaining"])) { await u(Math.abs(Math.floor(new Date().getTime() / 1e3) - Math.floor(new Date(1e3 * parseInt(r.headers["x-ratelimit-reset"])).getTime() / 1e3)) * (5 - parseInt(r.headers["x-ratelimit-remaining"])) * 1e3) } }) }; s().then(function () { swal.close(), e(t.currentTarget.form).submit() }) } else e(t.currentTarget.form).submit() }) } }), "undefined" != typeof hide_toast && (hide_toast[0] ? "no_value" == e("#smartbill_settings_display_um").find("option:selected").val() && Toastify({ text: 'Este necesara selectarea unei unitati de masura. <br/> Configureaza setarea in zona <strong><a style="color:white;" href="' + window.location.href + '#smartbill_settings_display_um">Setari produse</a></strong> si salveaza din nou.', duration: -1, newWindow: !1, close: !0, gravity: "top", position: "center", backgroundColor: "#EF4136", stopOnFocus: !0 }).showToast() : Toastify({ text: "Verifica toate setarile modulului pentru a te asigura ca facturarea comenzilor in SmartBill se va face corect.", duration: -1, newWindow: !1, close: !0, gravity: "top", position: "center", backgroundColor: "#2271b1", stopOnFocus: !0 }).showToast()), e("#smartbill_plugin_options_settings_document_series").click(function () { 0 == e(this).children().size() && e(this).closest("td").find("div").removeClass("hide-element") }), e("#smartbill_settings_display_stock").click(function () { 1 == e(this).children().size() && e(this).closest("td").find("div").removeClass("hide-element") }), e("#smartbill_settings_display_um").click(function () { (0 == e(this).children().size() || 1 == e(this).children().size()) && e(this).closest("td").find("div").removeClass("hide-element") }), e("#url_container_stocks strong").click(function (e) { navigator.clipboard.writeText(this.innerText), Toastify({ text: "URL-ul a fost copiat cu succes!", duration: 3e3, newWindow: !1, close: !0, gravity: "top", position: "center", backgroundColor: "#00A14B", stopOnFocus: !0 }).showToast() }), e(".smartbill_sync_stock").click(function (t) { 1 == e(this).val() ? (e(".token-details").show(), e(".smartbill-show-sync-stock-both-ways").show()) : (e(".token-details").hide(), e(".smartbill-show-sync-stock-both-ways").hide()) }), 1 == e(".smartbill_sync_stock").val() && (e(".token-details").show(), e(".smartbill-show-sync-stock-both-ways").show()), e("#custom-checkout").click(function (t) { 1 == e(this).val() ? e("#custom-checkout-options-table").closest("tr").show() : e("#custom-checkout-options-table").closest("tr").hide() }), 1 == e("#custom-checkout").val() ? e("#custom-checkout-options-table").closest("tr").show() : e("#custom-checkout-options-table").closest("tr").hide(), e(".show_delivery_days").click(function (t) { 1 == e(this).val() ? e(".smartbill-show-if-delivery-days-on").show() : e(".smartbill-show-if-delivery-days-on").hide() }), 1 == e(".show_delivery_days").val() && e(".smartbill-show-if-delivery-days-on").show(), e(".show_shipping_cost").click(function (t) { 1 == e(this).val() ? e(".smartbill-show-if-shipping-cost-is-included").show() : e(".smartbill-show-if-shipping-cost-is-included").hide() }), 0 == e(".show_shipping_cost").val() && e(".smartbill-show-if-shipping-cost-is-included").hide(), e(".smartbill-public-invoice").click(function (t) { 1 == e(this).val() ? e(".public-invoice-name").show() : e(".public-invoice-name").hide() }), 0 == e(".smartbill-public-invoice").val() && e(".public-invoice-name").hide(), e(".smartbill-discount-name").click(function (t) { 1 == e(this).val() ? e(".discount_text").show() : e(".discount_text").hide() }), 0 == e(".smartbill-discount-name").val() && e(".discount_text").hide(), e(".issue_with_due_date").click(function (t) { 1 == e(this).val() ? e(".smartbill-show-if-due-days-on").show() : e(".smartbill-show-if-due-days-on").hide() }), 1 == e(".issue_with_due_date").val() && e(".smartbill-show-if-due-days-on").show(), e(".smartbill-delegate-data").click(function (t) { "1" == e(this).val() ? e(".smartbill-show-if-add-delegate-data-on").show() : e(".smartbill-show-if-add-delegate-data-on").hide() }), "0" == e(".smartbill-delegate-data").val() && e(".smartbill-show-if-add-delegate-data-on").hide(); let u = e => new Promise(t => setTimeout(t, e)); async function m(t) { if (t.preventDefault(), t.detail && 1 != t.detail) return !1; var i = { data: { order_id: smartbill.post_id }, security: smartbill.security, action: "smartbill_woocommerce_send_document_mail" }; "order" in e(t.currentTarget).data() && (i.data.order_id = e(t.currentTarget).data().order), await d(i, !1, !0).then(function () { window.location.reload() }) } async function d(s, r, o) { let l; var c = document.createElement("div"); return c.innerHTML = "Va rugam asteptati raspunsul serverului...", !0 == o && swal({ title: "Se incarca!", content: c, icon: "info", buttons: [!1, !1] }), l = await e.post(ajaxurl, s, function (e) { if ((e = JSON.parse(e)) && e.status) void 0 !== r && r ? (0 != t ? t = ["Documentele au fost trimise cu succes catre clienti."] : t.push(e.message), a()) : (t.push(e.message), a()); else { var s = document.createElement("span"); s.innerHTML = n(e.error), i.push("Eroare! " + s.innerText.replace("Smart Bill", "SmartBill").replace("SmartBill Cloud", "SmartBill")) } return !0 == o && swal.close(), a(), t }) } async function f(s, r, o) { let l; if (e("#smartbill-woocommerce-invoice-button").css("background", '#f3f5f6 url("/wp-admin/images/spinner.gif") no-repeat left center'), e("#smartbill-woocommerce-invoice-button").css("padding-left", "25px"), !0 == o) { var c = document.createElement("div"); c.innerHTML = "Va rugam asteptati raspunsul serverului...", swal({ title: "Se incarca!", content: c, icon: "info", buttons: [!1, !1] }) } return await e.post(ajaxurl, s, function (l) { if (l = JSON.parse(l), e("html,body").animate({ scrollTop: 0 }, "slow"), l && l.status) e("#smartbill-woocommerce-invoice-button").css("background", "none"), e("#smartbill-woocommerce-invoice-button").css("background-color", "#f3f5f6"), e("#smartbill-woocommerce-invoice-button").css("padding-left", "10px"), e("#smartbill-woocommerce-invoice-button").css("border-color", "#007cba"), e("#smartbill-woocommerce-invoice-button").css("box-shadow", "0 0 0 1px #007cba"), e("#smartbill-woocommerce-invoice-button").css("outline", "2px solid transparent"), e("#smartbill-woocommerce-invoice-button").css("outline-offset", "0"), !0 == o && swal.close(), "undefine" != typeof r && r ? (0 != t.length ? t = ["Documentele au fost emise cu succes in SmartBill."] : t.push(l.message), a()) : (t.push(l.message), a()); else { e("#smartbill-woocommerce-invoice-button").css("background-image", "none"), e("#smartbill-woocommerce-invoice-button").css("padding-left", "10px"); var c = document.createElement("span"); c.innerHTML = n(l.message), !0 == o && swal.close(); var u = c.innerText.replace("Smart Bill", "SmartBill").replace("SmartBill Cloud", "SmartBill"); "Verifica setarile modulului SmartBill" == u ? i.push("Factura pentru comanda #" + s.data.order_id + " nu a fost emisa in SmartBill. <br/>" + c.innerText.replace("Smart Bill", "SmartBill").replace("SmartBill Cloud", "SmartBill") + ".") : "" == u ? i.push("A aparut o eroare la contactarea serverului SmartBill. Acceseaza cloud.smartbill.ro, anuleaza factura pentru comanda #" + s.data.order_id + " si incearca din nou facturarea comenzii din magazinul online.") : i.push("Factura pentru comanda #" + s.data.order_id + " nu a fost emisa in SmartBill. <br/> Eroare " + c.innerText.replace("Smart Bill", "SmartBill").replace("SmartBill Cloud", "SmartBill") + "."), a() } return t }) } e("a#smartbill-woocommerce-invoice-button").click(l), e("a.smartbill-woocommerce-invoice-button").click(l), e("a#smartbill-woocommerce-send-document-email-button").click(m), e("a.smartbill-woocommerce-send-document-email-button").click(m), "1" == e("select.smartbill_display_company_info").val() ? e(".smartbill-show-if-company-info").show() : e(".smartbill-show-if-company-info").hide(), e("select.smartbill_display_company_info").on("change", function (t) { "1" === this.value ? e(".smartbill-show-if-company-info").show() : e(".smartbill-show-if-company-info").hide() }), e("#smartbill_settings_display_um").find("option:selected").length && "no_value" == e("#smartbill_settings_display_um").find("option:selected")[0].value && e("#smartbill_settings_display_um").closest("tr").find(".settings-font-size").first().addClass("smartbill-error-highlight"), "1" == e("select.smartbill_display_send_mail_with_document").val() ? e(".smartbill-show-if-send-mail").show() : e(".smartbill-show-if-send-mail").hide(), e("select.smartbill_display_send_mail_with_document").on("change", function (t) { "1" === this.value ? e(".smartbill-show-if-send-mail").show() : e(".smartbill-show-if-send-mail").hide() }), "1" != e("select#smartbill_plugin_options_settings_document_type").val() ? (e(".smartbill-show-if-type-invoice").show(), e('label[for="smartbill-display-payment-url"]').text('Afiseaza buton "Plateste cu cardul" pe factura')) : (e(".smartbill-show-if-type-invoice").hide(), e('label[for="smartbill-display-payment-url"]').text('Afiseaza buton "Plateste cu cardul" pe proforma')), e("select#smartbill_plugin_options_settings_document_type").on("change", function (t) { "1" !== this.value ? (e(".smartbill-show-if-type-invoice").show(), e('label[for="smartbill-display-payment-url"]').text('Afiseaza buton "Plateste cu cardul" pe factura')) : (e(".smartbill-show-if-type-invoice").hide(), e('label[for="smartbill-display-payment-url"]').text('Afiseaza buton "Plateste cu cardul" pe proforma')), function t(i) { e("#smartbill_plugin_options_settings_document_series").find("option").each(function () { -1 != e(this).val() && e(this).remove() }); var a, n, s = "", r = ""; if (0 == i) { for (var o in n = smartbill.selected_invoice_series, smartbill.invoice_series) a = smartbill.invoice_series[o], r = "", o == n && (r = ' selected="selected" '), s = '<option value="' + o + '" ' + r + ">" + a + "</option>", e("#smartbill_plugin_options_settings_document_series").append(s); e("#smartbill_plugin_options_settings_document_series").attr("name", "smartbill_plugin_options_settings[invoice_series]") } else if (1 == i) { for (var o in n = smartbill.selected_estimate_series, smartbill.estimate_series) a = smartbill.estimate_series[o], r = "", o == n && (r = ' selected="selected" '), s = '<option value="' + o + '" ' + r + ">" + a + "</option>", e("#smartbill_plugin_options_settings_document_series").append(s); e("#smartbill_plugin_options_settings_document_series").attr("name", "smartbill_plugin_options_settings[estimate_series]") } }(this.value) }), "1" != e("select.smartbill_display_save_stock_history").val() ? e("#smartbill-download-sync-stock-history").hide() : e("#smartbill-download-sync-stock-history").show(), e("select.smartbill_display_save_stock_history").on("change", function (t) { "1" !== this.value ? e("#smartbill-download-sync-stock-history").hide() : e("#smartbill-download-sync-stock-history").show() }), e(".smartbill_billing_nr_reg_com_field").css({ float: "right", clear: "right" }), e("._billing_company_field").after(e(".smartbill_billing_cif_field").first()), e(".smartbill_billing_cif_field").first().after(e(".smartbill_billing_nr_reg_com_field").first()), e("div.edit_address").first().prepend(e(".smartbill_billing_type_field").first()), e(".smartbill_shipping_nr_reg_com_field").css({ float: "right", clear: "right" }), e("._shipping_company_field").after(e(".smartbill_shipping_cif_field").first()), e(".smartbill_shipping_cif_field").first().after(e(".smartbill_shipping_nr_reg_com_field").first()), e("div.edit_address").last().prev().prepend(e(".smartbill_shipping_type_field").first()) }) }(jQuery);
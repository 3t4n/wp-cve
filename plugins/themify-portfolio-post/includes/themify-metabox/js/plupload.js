function themify_create_pluploader(o){"use strict";var e=o,r=e.attr("id").replace("plupload-upload-ui",""),p=!1,t=!1,i=jQuery,l=JSON.parse(JSON.stringify(global_plupload_init));l.browse_button=r+l.browse_button,l.container=r+l.container,l.drop_element=r+l.drop_element,l.file_data_name=r+l.file_data_name,l.multipart_params.imgid=r,l.multipart_params._ajax_nonce=e.find(".ajaxnonceplu").attr("id").replace("ajaxnonceplu",""),e.hasClass("add-preset")&&(p=!0,l.multipart_params.haspreset="haspreset"),e.hasClass("add-preview")&&(t=!0,l.multipart_params.haspreview="haspreview"),e.hasClass("add-to-media")&&(l.multipart_params.tomedia="tomedia"),e.data("postid")&&(l.multipart_params.topost=e.data("postid")),e.data("fields")&&(l.multipart_params.fields=e.data("fields")),e.data("featured")&&(l.multipart_params.featured=e.data("featured")),e.data("formats")&&(l.filters[0].extensions=e.data("formats")),l.multipart_params.action=e.data("action");const a=new plupload.Uploader(l);a.bind("Init",(o=>{})),a.init(),a.bind("FilesAdded",((o,r)=>{if(e.data("confirm")&&!confirm(e.data("confirm")))return;o.refresh(),o.start(),i(".tb_alert").addClass("busy").fadeIn(800)})),a.bind("Error",((o,e)=>{if(i(".prompt-box .show-login").hide(),i(".prompt-box .show-error").show(),-600==e.code)var r=themify_plupload_lang.filesize_error,p=themify_plupload_lang.filesize_error_fix;i(".prompt-box .show-error").length>0&&(i(".prompt-box .show-error").html('<p class="prompt-error">'+r+"</p>"),p&&i(".prompt-box .show-error").append("<p>"+p+"</p>")),i(".overlay, .prompt-box").fadeIn(500),document.getElementsByClassName("overlay")[0].addEventListener("click",(()=>{i(".overlay, .prompt-box").fadeOut(500)}),{once:!0})})),a.bind("FileUploaded",(function(o,l,a){var s=JSON.parse(a.response),d="";if(d="200"!=a.status||s.error?"error":"done",i(".tb_alert").removeClass("busy").addClass(d).delay(800).fadeOut(800,(function(){i(this).removeClass(d)})),s.error)return i(".prompt-box .show-login").hide(),i(".prompt-box .show-error").show(),i(".prompt-box .show-error").length>0&&(i(".prompt-box .show-error").html('<p class="prompt-error">'+s.error+"</p>"),i(".prompt-box .show-error").append("<p>"+themify_plupload_lang.enable_zip_upload+"</p>")),i(".overlay, .prompt-box").fadeIn(500),void document.getElementsByClassName("overlay")[0].addEventListener("click",(()=>{i(".overlay, .prompt-box").fadeOut(500)}),{once:!0,passive:!0});i("#"+l.id).fadeOut();var n=s.file,c=s.url,m=s.type;if("zip"===m||"rar"===m||"plain"===m?window.location=location.href.replace(location.hash,""):i("#"+r).val(c),void 0!==s.thumb&&(themifyMediaLib.setPreviewIcon(e.closest(".themify_field, .themify_field_row"),s.thumb),i("body").trigger("themify_plupload_selected",[e,s])),p){i("#"+r).closest("fieldset").children(".preset").find("img").removeClass("selected");const o=c.replace(/^.*[\\\/]/,""),e=i('<a href="#" title="'+o+'"><span title="'+n+'"></span><img src="'+c+'" alt="'+c+'" class="backgroundThumb selected" /></a>').css("display","inline-block");i("#"+r).closest("fieldset").children(".preset").append(e)}t&&i("#"+r+"-preview").attr("src",c)}))}!function($){"use strict";const o=function(){const o=$(".plupload-upload-uic");o.length>0&&o.each((function(){themify_create_pluploader($(this))}))};"complete"===document.readyState?o():window.addEventListener("load",o,{once:!0,passive:!0})}(jQuery);
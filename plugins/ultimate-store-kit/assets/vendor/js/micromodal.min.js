(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t():typeof define==="function"&&define.amd?define(t):(e=e||self,e.MicroModal=t())})(this,(function(){"use strict";function e(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function t(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function o(e,o,n){if(o)t(e.prototype,o);if(n)t(e,n);return e}function n(e){return i(e)||r(e)||a(e)||l()}function i(e){if(Array.isArray(e))return s(e)}function r(e){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}function a(e,t){if(!e)return;if(typeof e==="string")return s(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);if(o==="Object"&&e.constructor)o=e.constructor.name;if(o==="Map"||o==="Set")return Array.from(o);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return s(e,t)}function s(e,t){if(t==null||t>e.length)t=e.length;for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c=function(){var t=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'];var i=function(){function i(t){var o=t.targetModal,r=t.triggers,a=r===void 0?[]:r,s=t.onShow,l=s===void 0?function(){}:s,c=t.onClose,d=c===void 0?function(){}:c,f=t.openTrigger,u=f===void 0?"data-micromodal-trigger":f,h=t.closeTrigger,v=h===void 0?"data-micromodal-close":h,m=t.openClass,g=m===void 0?"is-open":m,b=t.disableScroll,y=b===void 0?false:b,p=t.disableFocus,w=p===void 0?false:p,k=t.awaitCloseAnimation,E=k===void 0?false:k,M=t.awaitOpenAnimation,C=M===void 0?false:M,A=t.debugMode,L=A===void 0?false:A;e(this,i);this.modal=document.getElementById(o);this.config={debugMode:L,disableScroll:y,openTrigger:u,closeTrigger:v,openClass:g,onShow:l,onClose:d,awaitCloseAnimation:E,awaitOpenAnimation:C,disableFocus:w};if(a.length>0)this.registerTriggers.apply(this,n(a));this.onClick=this.onClick.bind(this);this.onKeydown=this.onKeydown.bind(this)}o(i,[{key:"registerTriggers",value:function e(){var t=this;for(var o=arguments.length,n=new Array(o),i=0;i<o;i++){n[i]=arguments[i]}n.filter(Boolean).forEach((function(e){e.addEventListener("click",(function(e){return t.showModal(e)}))}))}},{key:"showModal",value:function e(){var t=this;var o=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;this.activeElement=document.activeElement;this.modal.setAttribute("aria-hidden","false");this.modal.classList.add(this.config.openClass);this.scrollBehaviour("disable");this.addEventListeners();if(this.config.awaitOpenAnimation){var n=function e(){t.modal.removeEventListener("animationend",e,false);t.setFocusToFirstNode()};this.modal.addEventListener("animationend",n,false)}else{this.setFocusToFirstNode()}this.config.onShow(this.modal,this.activeElement,o)}},{key:"closeModal",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var o=this.modal;this.modal.setAttribute("aria-hidden","true");this.removeEventListeners();this.scrollBehaviour("enable");if(this.activeElement&&this.activeElement.focus){this.activeElement.focus()}this.config.onClose(this.modal,this.activeElement,t);if(this.config.awaitCloseAnimation){var n=this.config.openClass;this.modal.addEventListener("animationend",(function e(){o.classList.remove(n);o.removeEventListener("animationend",e,false)}),false)}else{o.classList.remove(this.config.openClass)}}},{key:"closeModalById",value:function e(t){this.modal=document.getElementById(t);if(this.modal)this.closeModal()}},{key:"scrollBehaviour",value:function e(t){if(!this.config.disableScroll)return;var o=document.querySelector("body");switch(t){case"enable":Object.assign(o.style,{overflow:""});break;case"disable":Object.assign(o.style,{overflow:"hidden"});break}}},{key:"addEventListeners",value:function e(){this.modal.addEventListener("touchstart",this.onClick);this.modal.addEventListener("click",this.onClick);document.addEventListener("keydown",this.onKeydown)}},{key:"removeEventListeners",value:function e(){this.modal.removeEventListener("touchstart",this.onClick);this.modal.removeEventListener("click",this.onClick);document.removeEventListener("keydown",this.onKeydown)}},{key:"onClick",value:function e(t){if(t.target.hasAttribute(this.config.closeTrigger)){this.closeModal(t)}}},{key:"onKeydown",value:function e(t){if(t.keyCode===27)this.closeModal(t);if(t.keyCode===9)this.retainFocus(t)}},{key:"getFocusableNodes",value:function e(){var o=this.modal.querySelectorAll(t);return Array.apply(void 0,n(o))}},{key:"setFocusToFirstNode",value:function e(){var t=this;if(this.config.disableFocus)return;var o=this.getFocusableNodes();if(o.length===0)return;var n=o.filter((function(e){return!e.hasAttribute(t.config.closeTrigger)}));if(n.length>0)n[0].focus();if(n.length===0)o[0].focus()}},{key:"retainFocus",value:function e(t){var o=this.getFocusableNodes();if(o.length===0)return;o=o.filter((function(e){return e.offsetParent!==null}));if(!this.modal.contains(document.activeElement)){o[0].focus()}else{var n=o.indexOf(document.activeElement);if(t.shiftKey&&n===0){o[o.length-1].focus();t.preventDefault()}if(!t.shiftKey&&o.length>0&&n===o.length-1){o[0].focus();t.preventDefault()}}}}]);return i}();var r=null;var a=function e(t,o){var n=[];t.forEach((function(e){var t=e.attributes[o].value;if(n[t]===undefined)n[t]=[];n[t].push(e)}));return n};var s=function e(t){if(!document.getElementById(t)){console.warn("MicroModal: ❗Seems like you have missed %c'".concat(t,"'"),"background-color: #f8f9fa;color: #50596c;font-weight: bold;","ID somewhere in your code. Refer example below to resolve it.");console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<div class="modal" id="'.concat(t,'"></div>'));return false}};var l=function e(t){if(t.length<=0){console.warn("MicroModal: ❗Please specify at least one %c'micromodal-trigger'","background-color: #f8f9fa;color: #50596c;font-weight: bold;","data attribute.");console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<a href="#" data-micromodal-trigger="my-modal"></a>');return false}};var c=function e(t,o){l(t);if(!o)return true;for(var n in o){s(n)}return true};var d=function e(t){var o=Object.assign({},{openTrigger:"data-micromodal-trigger"},t);var s=n(document.querySelectorAll("[".concat(o.openTrigger,"]")));var l=a(s,o.openTrigger);if(o.debugMode===true&&c(s,l)===false)return;for(var d in l){var f=l[d];o.targetModal=d;o.triggers=n(f);r=new i(o)}};var f=function e(t,o){var n=o||{};n.targetModal=t;if(n.debugMode===true&&s(t)===false)return;if(r)r.removeEventListeners();r=new i(n);r.showModal()};var u=function e(t){t?r.closeModalById(t):r.closeModal()};return{init:d,show:f,close:u}}();window.MicroModal=c;return c}));
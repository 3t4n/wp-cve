(()=>{"use strict";var e={d:(n,r)=>{for(var t in r)e.o(r,t)&&!e.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:r[t]})},o:(e,n)=>Object.prototype.hasOwnProperty.call(e,n),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},n={};e.r(n),e.d(n,{registerBuilderPanel:()=>_,registerBuilderSubPanel:()=>C});var r={};e.r(r),e.d(r,{registerBuilderPanel:()=>f,registerBuilderSubPanel:()=>m,setCurrentPanel:()=>d,setCurrentSubPanel:()=>c});var t={};e.r(t),e.d(t,{getAreaToShow:()=>x,getCurrentPanel:()=>B,getCurrentPanelName:()=>T,getCurrentSubPanel:()=>N,getCurrentSubPanelName:()=>E,getPanelByName:()=>v,getPanels:()=>y,getParentPanels:()=>S,getVisiblePanels:()=>w});const a=window.wp.data,s=window.lodash,o="REGISTER_BUILDER_PANEL",l="REGISTER_BUILDER_SUBPANEL",i="SET_CURRENT_PANEL",u="SET_CURRENT_SUBPANEL",p={panels:[],currentPanel:"",currentSubPanel:void 0,areaToShow:void 0},d=e=>({type:i,panelName:e}),c=e=>({type:u,subPanelName:e}),f=(e,n)=>({type:o,settings:n,name:e}),m=(e,n,r)=>({type:l,settings:n,parent:r,name:e});var b={};function g(e){return[e]}function h(e,n,r){var t;if(e.length!==n.length)return!1;for(t=r;t<e.length;t++)if(e[t]!==n[t])return!1;return!0}function P(e,n){var r,t=n||g;function a(){r=new WeakMap}function s(){var n,a,s,o,l,i=arguments.length;for(o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];for(n=function(e){var n,t,a,s,o,l=r,i=!0;for(n=0;n<e.length;n++){if(!(o=t=e[n])||"object"!=typeof o){i=!1;break}l.has(t)?l=l.get(t):(a=new WeakMap,l.set(t,a),l=a)}return l.has(b)||((s=function(){var e={clear:function(){e.head=null}};return e}()).isUniqueByDependants=i,l.set(b,s)),l.get(b)}(l=t.apply(null,o)),n.isUniqueByDependants||(n.lastDependants&&!h(l,n.lastDependants,0)&&n.clear(),n.lastDependants=l),a=n.head;a;){if(h(a.args,o,1))return a!==n.head&&(a.prev.next=a.next,a.next&&(a.next.prev=a.prev),a.next=n.head,a.prev=null,n.head.prev=a,n.head=a),a.val;a=a.next}return a={val:e.apply(null,o)},o[0]=null,a.args=o,n.head&&(n.head.prev=a,a.next=n.head),n.head=a,a.val}return s.getDependants=t,s.clear=a,a(),s}const y=P((e=>e.panels),(e=>[e.panels.length])),S=P((e=>(0,s.filter)(e.panels,(e=>"parent"===e.mode))),(e=>[e.panels.length])),v=(e,n)=>y(e).find((e=>e.name===n)),w=P((e=>e.panels.filter((e=>!0!==e.isHidden))),(e=>[e.panels.length]));function T(e){return e.currentPanel}const B=P((e=>{const n=T(e);if(n)return(0,s.find)(e?.panels,(e=>e.name===n))}),(e=>[e?.panels.length,e?.currentPanel])),N=P((e=>{const n=B(e);if(e.currentSubPanel&&n)return n?.subPanels?.find((n=>n.name===e.currentSubPanel))}),(e=>[e?.panels.length,e?.currentSubPanel,e?.currentPanel]));function E(e){return e.currentSubPanel}function x(e){return B(e)?.areaToShow}const F=(0,a.createReduxStore)("quillForms/builder-panels",{actions:r,selectors:t,reducer:(e=p,n)=>{switch(n.type){case o:{const r=n.name;if((0,s.some)(e.panels,(e=>e.name===r)))return e;const t=n.settings;return{...e,panels:[...e.panels,{...t,name:r}]}}case l:{const{parent:r}=n,t=(0,s.findIndex)(e.panels,(e=>e.name===r));if(-1===t||"parent"!==e.panels[t].mode)return e;let a=e.panels[t].subPanels;a||(a=[]),a.push({...n.settings,name:n.name});const o=e.panels;return o[t].subPanels=a,{...e,panels:o}}case i:return n.panelName&&!(0,s.some)(e.panels,(e=>e.name===n.panelName))?e:{...e,currentPanel:n.panelName};case u:{if(!e.currentPanel)return e;const r=e.panels.find((n=>n.name===e.currentPanel));return r&&(0,s.some)(r.subPanels,(e=>e.name===n.subPanelName))?{...e,currentSubPanel:n.subPanelName}:e}}return e}});(0,a.register)(F);const R=window.qf.utils,q=window.wp.hooks,_=(e,n)=>{if(n=(0,q.applyFilters)("QuillForms.BuilderPanels.PanelSettings",n,e),"string"!=typeof e)return void console.error('Builder panel "name" must be string.');const r=(0,a.select)("quillForms/builder-panels").getPanels();if((0,s.some)(r,(n=>n.name===e)))console.error(`The panel ${e} is already registered`);else if(n.title)if("string"==typeof n.title)if(n.isHidden&&"boolean"!=typeof n.isHidden)console.error('The "isHidden" property must be boolean');else if(!n.position||"number"==typeof n.position||n.isHidden)if(0===n.position||n.position||(n.position=10),n.areaToShow&&"drop-area"!==n.areaToShow&&"preview-area"!==n.areaToShow&&"no-area"!==n.areaToShow)console.error('The "areaToShow" property must be either of "drop-area" or "preview-area" or undefined.');else if(n.icon=(0,R.normalizeIconObject)(n.icon),(0,R.isValidIcon)(n.icon.src))if("parent"!==n.mode&&(n.mode="single"),"single"!==n.mode||n.render){if(!n.render||(0,s.isFunction)(n.render))return n=(0,s.pick)(n,["icon","title","render","isHidden","mode","areaToShow","position"]),(0,a.dispatch)("quillForms/builder-panels").registerBuilderPanel(e,n),n;console.error("The 'render' property must be a valid function")}else console.error('The "render" property should be defined in case of single panels');else console.error('The "icon" property must be a valid function!');else console.error('The "position" property must be a number');else console.error('Builder panel "title" must be string.');else console.error("The 'title' property must be passed")},C=(e,n)=>{if(n=(0,q.applyFilters)("QuillForms.BuilderPanels.SubPanelSettings",n,e),"string"!=typeof e)return void console.error("Builder subpanel names must be strings.");const r=e.match(/^([a-z][a-z0-9-]*)\/[a-z][a-z0-9-]*$/);if(!r||!r[1])return void console.error("Builder subpanel name must contain the parent namespace prefix. Example: parent-panel/subpanel-panel");const t=r[1],o=(0,a.select)("quillForms/builder-panels").getParentPanels();if((0,s.some)(o,(e=>e.name===t)))if(n.title)if("string"==typeof n.title)if(n.render)if((0,s.isFunction)(n.render)){if(!n.position||"number"==typeof n.position)return 0===n.position||n.position||(n.position=10),n=(0,s.pick)(n,["title","render","position"]),(0,a.dispatch)("quillForms/builder-panels").registerBuilderSubPanel(e,n,t),n;console.error('The "position" property must be a number')}else console.error("The 'render' property must be a valid function");else console.error("The 'render' property is mandatory");else console.error("The 'title' property must be a string");else console.error("The 'title' property must be passed");else console.error(`Builder sub panel parent ${t} isn't registered. Please register it first!`)};(window.qf=window.qf||{}).builderPanels=n})();
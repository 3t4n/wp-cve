if(void 0===viwcuf_atc)var viwcuf_atc=[];if(void 0===viwcuf_remove_cart_item)var viwcuf_remove_cart_item=[];jQuery((function(c){c(document).ready((function(){"use strict";if(!viwcuf_frontend_ob_params)return!1;let i=e;i.wc_ajax_url=viwcuf_frontend_ob_params.wc_ajax_url,i.i18n_unavailable_text=viwcuf_frontend_ob_params.i18n_unavailable_text||"Sorry, this product is unavailable. Please choose a different combination.",i.i18n_make_a_selection_text=viwcuf_frontend_ob_params.i18n_make_a_selection_text||"Please select some product options before adding {product_name} to your cart.",i.$wrap=c(".viwcuf-checkout-ob-container"),i.init()}));var e={wc_ajax_url:"",i18n_unavailable_text:"",i18n_make_a_selection_text:"",$wrap:"",init:function(){let e=this;e.$wrap.find(".vi-wcuf-ob-product-wrap").length&&e.design(),c(document.body).on("updated_checkout",(function(i,t){e.$wrap=c(".viwcuf-checkout-ob-container"),e.$wrap.find(".vi-wcuf-ob-product-wrap").length&&(e.$wrap.off("click"),e.design())}))},init_events:function(){let i=e;i.$wrap.find(".vi-wcuf-ob-checkbox-loading").removeClass("vi-wcuf-ob-checkbox-loading"),i.$wrap.on("click",".vi-wcuf-ob-product-desc-read",(function(){let i=c(this).closest(".vi-wcuf-ob-product-desc");c(this).hasClass("vi-wcuf-ob-product-desc-read-more")?(i.find(".vi-wcuf-ob-product-desc-short").addClass("vi-wcuf-disable"),i.find(".vi-wcuf-ob-product-desc-full").removeClass("vi-wcuf-disable")):(i.find(".vi-wcuf-ob-product-desc-short").removeClass("vi-wcuf-disable"),i.find(".vi-wcuf-ob-product-desc-full").addClass("vi-wcuf-disable")),e.design_form_atc(c(this))})),i.$wrap.on("click",".vi-wcuf-ob-title",(function(){c(this).parent().find(".vi-wcuf-ob-checkbox").trigger("click")})),i.$wrap.on("click",".vi-wcuf-ob-checkbox:not(.vi-wcuf-ob-checkbox-loading)",(function(){let e=c(this),t=e.closest(".vi-wcuf-ob-product-wrap"),a=t.find(".vi-wcuf-ob-cart-form");if(!a.length||!a.find('[name="quantity"]').length&&!a.find(".qty").length)return i.show_message(i.i18n_unavailable_text),!1;if(e.hasClass("vi-wcuf-ob-checkbox-checked"))return e.addClass("vi-wcuf-ob-checkbox-loading"),i.remove_form_cart(e,t),!1;let o=!0;return a.find(".viwcuf-attribute-options").each((function(e,i){if(!c(i).val())return o=!1,!1})),o?e.hasClass("vi-wcuf-ob-checkbox-swatches-disable")?(i.show_message(i.i18n_unavailable_text),!1):(e.addClass("vi-wcuf-ob-checkbox-loading"),void i.add_to_cart(e,a,t)):(i.show_message(i.i18n_make_a_selection_text.replace("{product_name}",a.data("product_name"))),!1)}))},add_to_cart:function(i,t,a){i=c(i),t=c(t),a=c(a),i.addClass("vi-wcuf-ob-checkbox-checked"),t.find(".vi-wcuf-add-to-cart, .vi-wcuf-product_id").val(a.data("product_id")||0);let o=t.find("select, input").serialize();-1===o.search("viwcuf_nonce")&&(o+="&viwcuf_nonce="+viwcuf_frontend_ob_params.nonce),void 0===viwcuf_atc&&(viwcuf_atc=[]),viwcuf_atc.push({type:"post",url:e.wc_ajax_url.toString().replace("%%endpoint%%","viwcuf_add_to_cart"),data:o,beforeSend:function(){a.closest(".viwcuf-checkout-ob-shortcode").find(".vi-wcuf-loading-wrap").removeClass("vi-wcuf-disable")},success:function(t){if(!t||t.error)return t.message&&e.show_message(t.message),viwcuf_atc=[],!1;c(document.body).trigger("added_to_cart",[t.fragments,t.cart_hash,i]),c(document.body).trigger("vi_wcuf_added_to_cart",[t.fragments,t.cart_hash,i]),viwcuf_atc.shift(),viwcuf_atc.length>0?c.ajax(viwcuf_atc[0]):c(document.body).trigger("update_checkout",{update_shipping_method:!1})},complete:function(c){t.find(".vi-wcuf-add-to-cart, .vi-wcuf-product_id").val(""),a.closest(".viwcuf-checkout-ob-shortcode").find(".vi-wcuf-loading-wrap").addClass("vi-wcuf-disable")}}),1===viwcuf_atc.length&&c.ajax(viwcuf_atc[0])},remove_form_cart:function(i,t){i=c(i),t=c(t),i.removeClass("vi-wcuf-ob-checkbox-checked"),viwcuf_remove_cart_item.push({type:"post",url:e.wc_ajax_url.toString().replace("%%endpoint%%","viwcuf_remove_form_cart"),data:{viwcuf_nonce:viwcuf_frontend_ob_params.nonce,product_id:t.data("product_id"),product_type:"viwcuf_ob_product",cart_item_key:t.data("cart_item_key")},beforeSend:function(){t.closest(".viwcuf-checkout-ob-shortcode").find(".vi-wcuf-loading-wrap").removeClass("vi-wcuf-disable")},success:function(t){if(!t||t.error)return t.message&&e.show_message(t.message),viwcuf_remove_cart_item=[],!1;c(document.body).trigger("removed_from_cart",[t.fragments,t.cart_hash,i]),c(document.body).trigger("vi_wcuf_removed_from_cart",[t.fragments,t.cart_hash,i]),viwcuf_remove_cart_item.shift(),viwcuf_remove_cart_item.length>0?c.ajax(viwcuf_remove_cart_item[0]):c(document.body).trigger("update_checkout",{update_shipping_method:!1})},complete:function(){t.closest(".viwcuf-checkout-ob-shortcode").find(".vi-wcuf-loading-wrap").addClass("vi-wcuf-disable")}}),1===viwcuf_remove_cart_item.length&&c.ajax(viwcuf_remove_cart_item[0])},design:function(){e.$wrap.find(".vi-wcuf-ob-product-wrap-checked").each((function(e,i){c(i).find(".vi-wcuf-ob-checkbox").addClass("vi-wcuf-ob-checkbox-checked")})),e.$wrap.outerWidth()<400&&e.$wrap.find("select").addClass("vi-wcuf-ob-full-width"),e.$wrap.find(".vi-wcuf-ob-cart-form").each((function(){c(this).removeClass("vi-wcuf-ob-full-width"),e.design_form_atc(c(this))})),e.$wrap.find(".vi-wcuf-cart-form-swatches:not(.vi-wcuf-cart-form-swatches-init)").each((function(){c(this).addClass("vi-wcuf-cart-form-swatches-init vi_wpvs_variation_form").viwcuf_get_variations({wc_ajax_url:e.wc_ajax_url}),c(this).find(".babystreet-wcs-swatches").length&&c(this).babystreet_wcs_variation_swatches_form()})),setTimeout((function(){c(document.body).trigger("vi_wpvs_variation_form")}),100),e.init_events()},design_form_atc:function(e){let i=c(e).closest(".vi-wcuf-product");if(!i.find(".vi-wcuf-ob-product-image").length)return!1;i.find(".vi-wcuf-ob-product-image").height()<i.find(".vi-wcuf-ob-product-desc").height()?i.find(".vi-wcuf-ob-cart-form").addClass("vi-wcuf-ob-full-width"):i.find(".vi-wcuf-ob-cart-form").removeClass("vi-wcuf-ob-full-width")},show_message:function(e){c(".vi-wcuf-warning-wrap").length?c(".vi-wcuf-warning-wrap").removeClass("vi-wcuf-warning-wrap-close").addClass("vi-wcuf-warning-wrap-open").html(e):c("body").append('<div class="vi-wcuf-warning-wrap vi-wcuf-warning-wrap-open">'+e+"</div>"),setTimeout((function(){c(".vi-wcuf-warning-wrap").addClass("vi-wcuf-warning-wrap-close").removeClass("vi-wcuf-warning-wrap-open")}),3e3)}};window.viwcuf_order_bump=e}));
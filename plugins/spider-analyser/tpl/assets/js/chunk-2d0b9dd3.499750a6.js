(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b9dd3"],{3583:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:!t.isLoaded,expression:"!isLoaded"}],staticClass:"wbs-content-inner",class:{"wb-page-loaded":t.isLoaded}},[a("div",{staticClass:"wbs-main with-mask"},[t.is_pro?t._e():a("div",{staticClass:"getpro-mask"},[a("div",{staticClass:"mask-inner"},[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:t.getPro}},[t._v("获取PRO版本")]),a("p",{staticClass:"tips"},[t._v("* 激活PRO版本即可使用")])],1)]),t.$cnf.is_mobile?a("div",{staticClass:"mb"},[a("label",{staticClass:"mr-s"},[a("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-text":"智能拦截"},on:{change:function(e){return t.setAutoDeny(e)}},model:{value:t.auto_deny,callback:function(e){t.auto_deny=e},expression:"auto_deny"}})],1),a("wbs-tooltip",{staticClass:"on-left",attrs:{"data-msg":t.tooltips.auto_deny}})],1):t._e(),a("wbs-filter-bar",[t.$cnf.is_mobile?t._e():a("div",{staticClass:"fr",staticStyle:{"padding-top":"5px"}},[a("label",{staticClass:"mr-s"},[a("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-text":"智能拦截"},on:{change:function(e){return t.setAutoDeny(e)}},model:{value:t.auto_deny,callback:function(e){t.auto_deny=e},expression:"auto_deny"}})],1),a("wbs-tooltip",{staticClass:"on-left",attrs:{"data-msg":t.tooltips.auto_deny}})],1),a("el-select",{staticClass:"ctrl-item",attrs:{size:"small",clearable:"",placeholder:"拦截方式"},model:{value:t.q.type,callback:function(e){t.$set(t.q,"type",e)},expression:"q.type"}},t._l(["全部","名称","IP","IP段","名称及IP","自定义"],(function(t,e){return a("el-option",{key:e,attrs:{label:t,value:e}})})),1),a("el-select",{staticClass:"ctrl-item",attrs:{size:"small",clearable:"",placeholder:"所有路径"},model:{value:t.q.path,callback:function(e){t.$set(t.q,"path",e)},expression:"q.path"}},t._l({11:"蜘蛛日志",12:"蜘蛛清单",13:"蜘蛛IP段",14:"疑似伪蜘蛛",15:"自定义",16:"智能拦截",17:"记录管理"},(function(t,e){return a("el-option",{key:e,attrs:{label:t,value:e}})})),1),a("el-input",{staticClass:"m-hide ctrl-item wbs-input-short",attrs:{size:"small",placeholder:"输入名称或者IP地址",clearable:""},model:{value:t.q.name,callback:function(e){t.$set(t.q,"name",e)},expression:"q.name"}}),a("el-button",{staticClass:"ctrl-item",attrs:{size:"small",type:"primary",plain:"",name:"search"},on:{click:t.search_log}},[t._v("筛选")])],1),a("div",{staticClass:"log-box mt"},[t.$cnf.is_mobile?a("div",{staticClass:"cell-items"},[t.spider_log.length?t._e():a("div",{staticClass:"empty-data align-center"},[t._v(" --暂无数据-- ")]),t._l(t.spider_log,(function(e,s){return a("div",{key:"item"+s,staticClass:"cell-item with-expand"},[a("div",{staticClass:"cell-hd"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.multipleSelection,expression:"multipleSelection"}],attrs:{type:"checkbox"},domProps:{value:e,checked:Array.isArray(t.multipleSelection)?t._i(t.multipleSelection,e)>-1:t.multipleSelection},on:{change:function(a){var s=t.multipleSelection,i=a.target,l=!!i.checked;if(Array.isArray(s)){var n=e,o=t._i(s,n);i.checked?o<0&&(t.multipleSelection=s.concat([n])):o>-1&&(t.multipleSelection=s.slice(0,o).concat(s.slice(o+1)))}else t.multipleSelection=l}}})]),a("div",{staticClass:"cell-bd primary"},[a("div",{attrs:{"data-label":"拦截名称"}},[a("span",[t._v(t._s(e.name?e.name:"-"))])]),a("div",{attrs:{"data-label":"拦截IP/IP段"}},[a("span",[t._v(t._s(e.ip?e.ip:"-"))])]),a("div",{staticClass:"def-hide"},[a("div",{attrs:{"data-label":"拦截方式"}},[a("span",[t._v(t._s(t._f("stop_type")(e)))])]),a("div",{attrs:{"data-label":"路径"}},[a("span",[t._v(t._s({4:"-",11:"蜘蛛日志",12:"蜘蛛清单",13:"蜘蛛IP段",14:"疑似伪蜘蛛",15:"自定义",16:"智能拦截",17:"记录管理"}[e.status]))])]),a("div",{staticClass:"btns align-right"},[a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(a){return t.remove(s,e)}}},[t._v("移出拦截")])],1)])]),a("div",{staticClass:"cell-ft",on:{click:t.$WB.toggleActive}})])}))],2):a("el-table",{staticClass:"wbs-table table-fixed",staticStyle:{width:"100%"},attrs:{data:t.spider_log},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{staticClass:"w20",attrs:{label:"拦截方式"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{"data-label":"拦截方式"}},[a("span",[t._v(t._s(t._f("stop_type")(e.row)))])])]}}])}),a("el-table-column",{attrs:{label:"拦截名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{"data-label":"拦截名称"}},[a("span",[t._v(t._s(e.row.name?e.row.name:"-"))])])]}}])}),a("el-table-column",{attrs:{label:"拦截IP/IP段"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{"data-label":"拦截IP/IP段"}},[a("span",[t._v(t._s(e.row.ip?e.row.ip:"-"))])])]}}])}),a("el-table-column",{attrs:{label:"路径"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{"data-label":"路径"}},[a("span",[t._v(t._s({4:"-",11:"蜘蛛日志",12:"蜘蛛清单",13:"蜘蛛IP段",14:"疑似伪蜘蛛",15:"自定义",16:"智能拦截",17:"记录管理"}[e.row.status]))])])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(a){return t.remove(e.$index,e.row)}}},[t._v("移出拦截")])]}}])})],1),a("table",{staticClass:"wbs-table table-fixed el-table"},[t.custom_active?a("tr",{class:t.custom_active?"cur-editing":""},[a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.one.name,expression:"one.name"}],staticClass:"wbs-input",attrs:{type:"text",placeholder:"填写拦截蜘蛛名称"},domProps:{value:t.one.name},on:{input:function(e){e.target.composing||t.$set(t.one,"name",e.target.value)}}})]),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.one.ip,expression:"one.ip"}],staticClass:"wbs-input",attrs:{type:"text",placeholder:"填写拦截蜘蛛IP"},domProps:{value:t.one.ip},on:{input:function(e){e.target.composing||t.$set(t.one,"ip",e.target.value)}}})]),a("td",{attrs:{align:"right"}},[a("div",{staticClass:"cell align-right"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.add_one}},[t._v("保存")]),a("a",{staticClass:"button-link-delete ml",attrs:{href:"javascript:;"},on:{click:function(e){t.custom_active=0}}},[t._v("取消")])],1)])]):t._e(),t.custom_active?t._e():a("tr",[a("td",{attrs:{align:"right",colspan:"3"}},[a("div",{staticClass:"cell align-right"},[a("el-button",{attrs:{size:"mini",type:"danger",plain:"",icon:"el-icon-s-open"},on:{click:t.cleanAll}},[t._v("一键清除")]),a("el-button",{staticClass:"ml",attrs:{type:"primary",size:"mini",icon:"el-icon-circle-plus"},on:{click:function(e){t.custom_active=1}}},[t._v("添加")])],1)])])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.spider_log.length>0,expression:"spider_log.length > 0"}],staticClass:"btns-bar with-ctrl-area"},[a("div",{staticClass:"wb-ctrl-area"},[a("el-select",{attrs:{size:"small",placeholder:"批量操作"},model:{value:t.batch_op,callback:function(e){t.batch_op=e},expression:"batch_op"}},[a("el-option",{attrs:{label:"移除",value:"remove"}})],1),a("el-button",{staticClass:"ml-s",attrs:{type:"info",plain:"",size:"small"},on:{click:t.batch_apply}},[t._v(" 应用 ")])],1),a("el-pagination",{attrs:{background:"",small:!!t.$cnf.is_mobile,layout:t.$cnf.is_mobile?"pager, total, prev, next":"total, prev, pager, next, jumper","page-size":20,total:1*t.total,"pager-count":5},on:{"current-change":t.nav_page}})],1)],1),a("wb-prompt",{directives:[{name:"show",rawName:"v-show",value:t.isLoaded,expression:"isLoaded"}],staticClass:"mt"})],1),t.$cnf.is_pro?t._e():a("wbs-more-sources")],1)},i=[],l={name:"ListStop",data(){const t=this;return{isLoaded:!1,is_pro:t.$cnf.is_pro,cnf:{spider:[],code:[]},config:{},spider_log:[],total:0,page:1,num:20,search:{},one:{name:"",ip:""},q:{type:"",path:"",name:""},multipleSelection:[],batch_op:"",custom_active:0,auto_deny:0,tooltips:{auto_deny:"开启智能拦截，会自动将疑似伪蜘蛛添加到蜘蛛拦截清单。请慎重启用该功能！"}}},mounted(){const t=this;t.$verify(t.verify_run),t.auto_deny=wb_spider_auto+"",t.$cnf.is_pro||(t.isLoaded=!0)},methods:{search_log(){const t=this;t.page="",t.loadData()},cleanAll(){const t=this;t.$wbui.confirm("将执行清除所有蜘蛛拦截记录操作？",()=>{const e={_ajax_nonce:_wb_spider_analyser_ajax_nonce,action:t.$cnf.action.act,op:"clean_all"};t.$api.saveData(e).then(e=>{t.$wbui.toast("清除成功"),t.page=1,t.loadData()})})},setAutoDeny(t){const e=this,a="1"==t?"在开启智能拦截前，请确保网站未启用全站CDN（如cloudflare），以免误判拦截。":"确认关闭智能拦截功能？";e.$wbui.open({content:a,btn:["确认","取消"],maskClose:!1,closebtn:!1,yes(){const a={_ajax_nonce:_wb_spider_analyser_ajax_nonce,action:e.$cnf.action.act,op:"update_setting",tab:"auto",auto:t};e.$api.saveData(a).then(a=>{e.$wbui.toast("已"+("1"==t?"开启":"关闭")+"智能拦截")})},no(){e.auto_deny="1"==t?"0":"1"}})},handleSelectionChange(t){this.multipleSelection=t},batch_apply(){const t=this;if(!t.batch_op)return!1;if(t.multipleSelection.length<1)return t.$wbui.toast("未选择项目"),!1;if("remove"==t.batch_op){if(!t.is_pro)return t.$wbui.open({content:"该功能仅Pro版本提供",btn:["激活Pro版"],yes(){t.$router.push({path:"/pro"})}}),!1;let e=[];if(t.multipleSelection.forEach(t=>{e.push([t.name,t.ip])}),e.length<1)return;t.$wbui.confirm("确认将所选移出拦截清单？",()=>{const a=t.$wbui.toast("执行中...",{time:180});t.$api.saveData({_ajax_nonce:_wb_spider_analyser_ajax_nonce,action:t.$cnf.action.act,op:"stop",removes:e}).then(e=>{t.$wbui.close(a),t.$wbui.toast("已将所选项移出拦截清单"),t.page=1,t.loadData()})})}return!1},nav_page(t){this.page=t,this.loadData()},remove(t,e){const a=this;a.$wbui.confirm("确认移出？",()=>{let s={remove:[e.name,e.ip],_ajax_nonce:_wb_spider_analyser_ajax_nonce};Object.assign(s,a.config.param),s.op="stop",a.$api.saveData(s).then(e=>{a.spider_log.splice(t,1),a.$wbui.toast("已移出")})})},add_one(){const t=this;if(!t.one.name&&!t.one.ip)return void t.$wbui.toast("填写拦截蜘蛛名称或IP");const e={new:[t.one.name,t.one.ip],cid:15,_ajax_nonce:_wb_spider_analyser_ajax_nonce};Object.assign(e,this.config.param),e.op="stop",t.$api.saveData(e).then(e=>{t.one.name="",t.one.ip="",t.page=1,t.spider_log=[],t.custom_active=0,t.loadData()})},loadMore2(){const t=this;t.page=t.page+1,t.loadData()},loadData(){const t=this;let e={status:4,page:t.page,num:t.num,_ajax_nonce:_wb_spider_analyser_ajax_nonce};Object.assign(e,t.config.param),e.op="stop",e.kw=t.q.name,e.type=t.q.type,e.path=t.q.path,t.$api.getData(e).then(e=>{t.spider_log=e.data,t.total=e.total,t.num=e.num,t.isLoaded=!0})},getPro(){this.$router.push({path:"/pro"})},verify_run(t,e){t&&this.set_cnf(e)},set_cnf(t){const e=this;e.config=t,e.is_pro=1,e.loadData(),e.$isPrdActive(e.$WB)}},filters:{stop_type(t){let e="";return 15==t.status?"自定义":(t.name&&(e="名称"),t.ip&&(e=e?e+"及":"",e+=t.ip.indexOf("*")>-1?"IP段":"IP"),e)}}},n=l,o=a("2877"),c=Object(o["a"])(n,s,i,!1,null,null,null);e["default"]=c.exports}}]);
"use strict";(self.webpackChunk_izcrmef=self.webpackChunk_izcrmef||[]).push([[571],{4383:function(e,t,a){a.d(t,{FP:function(){return _},P9:function(){return u},P_:function(){return f},T5:function(){return g},WK:function(){return c},mG:function(){return h},wX:function(){return p}});var l=a(7462),n=a(5861),i=a(4687),r=a.n(i),s=a(582),o=a(9492),d=a(5637),u=function(){var e=(0,n.Z)(r().mark((function e(t){var a,l,n,i,u,c,f,m,_,g,p,h,y,F;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=t.flow,t.setFlow,n=t.allIntegURL,i=t.conf,u=t.history,t.index,c=t.edit,f=t.setIsLoading,t.setSnackbar,m="flow/save",f&&f instanceof Function&&f(!0),_=i,"Elementor"===l.triggered_entity&&(_.postId=c?null!=(g=null==l||null==(p=l.flow_details)?void 0:p.postId)?g:null:null!=(h=null==l||null==(y=l.triggerData)?void 0:y.postId)?h:null),F={name:i.name,trigger:l.triggered_entity,triggered_entity_id:null!=l&&null!=(a=l.triggerData)&&a.formID?l.triggerData.formID:l.triggered_entity_id||0,flow_details:_},l.id&&(F.id=l.id),c&&(m="flow/update"),e.prev=8,e.next=11,(0,o.Z)(F,m).then((function(e){var t;!c&&e.success&&u.push(n);var a="",l="success";null!=(t=e.data)&&t.msg?a=e.data.msg:e.success?a=c?(0,d.__)("Integration updated successfully"):(0,d.__)("Integration saved successfully"):(l="error",a=c?(0,d.__)("Failed to update integration"):(0,d.__)("Failed to save integration")),(0,s.ZP)(a,{type:l}),f&&f instanceof Function&&f(!1),c||setTimeout((function(){u.push(n)}),700)}));case 11:e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(8),f&&f instanceof Function&&f(!1),e.abrupt("return",(0,d.__)("Failed to save integration"));case 17:case"end":return e.stop()}}),e,null,[[8,13]])})));return function(t){return e.apply(this,arguments)}}(),c=function(e){var t={},a=window.location.href.replace(window.opener.location.href+"/redirect","").split("&");a&&a.forEach((function(e){var a=e.split("=");a[1]&&(t[a[0]]=a[1])})),localStorage.setItem("__"+e,JSON.stringify(t)),window.close()},f=function(e,t,a,n,i,r,s,o,u,c){if(n.dataCenter&&n.clientId&&n.clientSecret){o(!0);var f="https://accounts.zoho."+n.dataCenter+"/oauth/v2/auth?scope="+a+"&response_type=code&client_id="+n.clientId+"&prompt=Consent&access_type=offline&state="+encodeURIComponent(window.location.href)+"/redirect&redirect_uri="+encodeURIComponent(""+c.api.base)+"/redirect",_=window.open(f,e,"width=400,height=609,toolbar=off"),g=setInterval((function(){if(_.closed){clearInterval(g);var a={},r=!1,f=localStorage.getItem("__"+e);if(f&&(r=!0,a=JSON.parse(f),localStorage.removeItem("__"+e)),a.code&&!a.error&&a&&r){var p=(0,l.Z)({},n);p.accountServer=a["accounts-server"],m(t,a,p,i,s,o,u,c)}else{var h=a.error?"Cause: "+a.error:"";u({show:!0,msg:(0,d.__)("Authorization failed")+" "+h+". "+(0,d.__)("please try again")}),o(!1)}}}),500)}else r({dataCenter:n.dataCenter?"":(0,d.__)("Data center cann't be empty"),clientId:n.clientId?"":(0,d.__)("Client ID cann't be empty"),clientSecret:n.clientSecret?"":(0,d.__)("Secret key cann't be empty")})},m=function(e,t,a,n,i,r,s,u){var c=(0,l.Z)({},t);c.dataCenter=a.dataCenter,c.clientId=a.clientId,c.clientSecret=a.clientSecret,c.redirectURI=u.api.base+"/redirect",(0,o.Z)(c,e+"_generate_token").then((function(e){return e})).then((function(e){if(e&&e.success){var t=(0,l.Z)({},a);t.tokenDetails=e.data,n(t),i(!0),s({show:!0,msg:(0,d.__)("Authorized Successfully")})}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?s({show:!0,msg:""+(0,d.__)("Authorization failed Cause:")+(e.data.data||e.data)+". "+(0,d.__)("please try again")}):s({show:!0,msg:(0,d.__)("Authorization failed. please try again")});r(!1)}))},_=function(e,t,a,n,i){var r=(0,l.Z)({},t);i?n?r.relatedlists[i-1].upload_field_map.splice(e,0,{}):r.relatedlists[i-1].field_map.splice(e,0,{}):n?r.upload_field_map.splice(e,0,{}):r.field_map.splice(e,0,{}),a((0,l.Z)({},r))},g=function(e,t,a,n,i){var r=(0,l.Z)({},t);i?n?r.relatedlists[i-1].upload_field_map.length>1&&r.relatedlists[i-1].upload_field_map.splice(e,1):r.relatedlists[i-1].field_map.length>1&&r.relatedlists[i-1].field_map.splice(e,1):n?r.upload_field_map.length>1&&r.upload_field_map.splice(e,1):r.field_map.length>1&&r.field_map.splice(e,1),a((0,l.Z)({},r))},p=function(e,t,a,n,i,r){var s=(0,l.Z)({},a);r?i?s.relatedlists[r-1].upload_field_map[t][e.target.name]=e.target.value:s.relatedlists[r-1].field_map[t][e.target.name]=e.target.value:i?s.upload_field_map[t][e.target.name]=e.target.value:s.field_map[t][e.target.name]=e.target.value,"custom"===e.target.value&&(r?s.relatedlists[r-1].field_map[t].customValue="":s.field_map[t].customValue=""),n((0,l.Z)({},s))},h=function(e,t,a,n,i){var r=(0,l.Z)({},a);i?r.relatedlists[i-1].field_map[t].customValue=e.target.value:r.field_map[t].customValue=e.target.value,n((0,l.Z)({},r))}},9293:function(e,t,a){a.d(t,{$8:function(){return f},Ck:function(){return s},Pd:function(){return h},Rx:function(){return r},TF:function(){return m},X7:function(){return c},lF:function(){return g},oQ:function(){return _},vF:function(){return u}});var l=a(7462),n=a(5637),i=a(9492),r=function(e,t,a,n,i,r,s,u,c,f){var m=(0,l.Z)({},a);if(0===t){if(u){var _=(0,l.Z)({},c);_[e.target.name]="",f((0,l.Z)({},_))}m[e.target.name]=e.target.value}else m.relatedlists||(m.relatedlists=[]),m.relatedlists[t-1][e.target.name]=e.target.value;switch(e.target.name){case"module":m=o(t,i,m,n,r,s);break;case"layout":m=d(t,i,m,n,r,s)}n((0,l.Z)({},m))},s=function(e,t,a,l,n,i,r){var s,o;e&&((null==(s=l.default)||null==(o=s.relatedlists)||!o[l.module])&&f(a,l,n,i,r));t(e)},o=function(e,t,a,n,i,r){var s,o=(0,l.Z)({},a),u=0===e?o.module:o.relatedlists[e-1].module;if(o.relatedlists[e-1]||(o.relatedlists[e-1]={}),0===e?(o.layout="",o.actions={},o.field_map=[{formField:"",zohoFormField:""}],o.upload_field_map=[{formField:"",zohoFormField:""}],o.relatedlists=[]):(o.relatedlists[e-1].layout="",o.relatedlists[e-1].actions={},o.relatedlists[e-1].field_map=[{formField:"",zohoFormField:""}],o.relatedlists[e-1].upload_field_map=[{formField:"",zohoFormField:""}]),null!=(s=o.default.layouts)&&s[u]){var f,m=Object.keys(null==(f=o.default.layouts)?void 0:f[u]);1===m.length&&(0===e?o.layout=m[0]:o.relatedlists[e-1].layout=m[0],o=d(e,t,o,n,i,r))}else c(e,t,o,n,i,r);return o},d=function(e,t,a,n,i,r){var s,o,d,u,c,f,_,g,h,y,F,v,k,w,D,Z,I,b=(0,l.Z)({},a),z=0===e?b.module:b.relatedlists[e-1].module,C=0===e?b.layout:b.relatedlists[e-1].layout;0===e?(b.actions={},b.field_map=null!=b&&null!=(o=b.default)&&null!=(d=o.layouts)&&null!=(u=d[z])&&null!=(c=u[C])&&c.required?p(e,b):[{formField:"",zohoFormField:""}],b.upload_field_map=null!=b&&null!=(f=b.default)&&null!=(_=f.layouts)&&null!=(g=_[z])&&null!=(h=g[C])&&h.requiredFileUploadFields&&Object.keys(b.default.layouts[z][C].requiredFileUploadFields).length>0?p(e,b,!0):[{formField:"",zohoFormField:""}]):(b.relatedlists[e-1].actions={},b.relatedlists[e-1].field_map=null!=b&&null!=(y=b.default)&&null!=(F=y.layouts)&&null!=(v=F[z])&&null!=(k=v[C])&&k.required?p(e,b):[{formField:"",zohoFormField:""}],b.relatedlists[e-1].upload_field_map=null!=b&&null!=(w=b.default)&&null!=(D=w.layouts)&&null!=(Z=D[z])&&null!=(I=Z[C])&&I.requiredFileUploadFields&&Object.keys(b.default.layouts[z][C].requiredFileUploadFields).length>0?p(e,b,!0):[{formField:"",zohoFormField:""}]);return(null==(s=b.default.tags)||!s[z])&&m(e,t,b,n,i,r),b},u=function(e,t,a,r,s){r(!0);var o={formID:e,id:t.id,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails};(0,i.Z)(o,"zcrm_refresh_modules").then((function(e){if(e&&e.success){var i=(0,l.Z)({},t);i.default||(i.default={}),e.data.modules&&(i.default.modules=e.data.modules),e.data.tokenDetails&&(i.tokenDetails=e.data.tokenDetails),a((0,l.Z)({},i)),s({show:!0,msg:(0,n.__)("Modules refreshed","bit-integrations")})}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?s({show:!0,msg:(0,n.g)((0,n.__)("Modules refresh failed Cause: %s. please try again","bit-integrations"),e.data.data||e.data)}):s({show:!0,msg:(0,n.__)("Modules refresh failed. please try again","bit-integrations")});r(!1)})).catch((function(){return r(!1)}))},c=function(e,t,a,r,s,o){var d=(0,l.Z)({},a),u=0===e?d.module:d.relatedlists[e-1].module;if(u){s(!0);var c={formID:t,module:u,dataCenter:d.dataCenter,clientId:d.clientId,clientSecret:d.clientSecret,tokenDetails:d.tokenDetails};(0,i.Z)(c,"zcrm_refresh_layouts").then((function(a){var i;if(a&&a.success){if(a.data.layouts){d.default.layouts||(d.default.layouts={}),d.default.layouts[u]=a.data.layouts;var c,f=[].concat(Object.keys(a.data.layouts));if(1===f.length)0===e?(d.layout=f[0],d.field_map=p(e,d),Object.keys(a.data.layouts[f].fileUploadFields).length>0&&(d.upload_field_map=p(e,d,!0))):(d.relatedlists[e-1].layout=f[0],d.relatedlists[e-1].field_map=p(e,d),Object.keys(a.data.layouts[f].fileUploadFields).length>0&&(d.relatedlists[e-1].upload_field_map=p(e,d,!0))),null!=(c=d.default.tags)&&c[u]||m(e,t,d,r,s,o)}a.data.tokenDetails&&(d.tokenDetails=a.data.tokenDetails),r((0,l.Z)({},d)),o({show:!0,msg:(0,n.__)("Layouts refreshed","bit-integrations")})}else null!=a&&null!=(i=a.data)&&i.data||!a.success&&"string"===typeof a.data?o({show:!0,msg:(0,n.g)((0,n.__)("Layouts refresh failed Cause: %s. please try again","bit-integrations"),a.data.data||a.data)}):o({show:!0,msg:(0,n.__)("Layouts refresh failed. please try again","bit-integrations")});s(!1)})).catch((function(){return s(!1)}))}},f=function(e,t,a,r,s){if(t.module){r(!0);var o={formID:e,module:t.module,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails};(0,i.Z)(o,"zcrm_get_related_lists").then((function(e){var i;if(e&&e.success){var o=(0,l.Z)({},t);e.data.relatedLists&&(o.default.relatedlists||(o.default.relatedlists={}),o.default.relatedlists[o.module]=(0,l.Z)({},e.data.relatedLists)),e.data.tokenDetails&&(o.tokenDetails=e.data.tokenDetails),a((0,l.Z)({},o)),s({show:!0,msg:(0,n.__)("RelatedLists refreshed","bit-integrations")})}else null!=e&&null!=(i=e.data)&&i.data||!e.success&&"string"===typeof e.data?s({show:!0,msg:""+(0,n.__)("RelatedLists refresh failed Cause:")+(e.data.data||e.data)+". "+(0,n.__)("please try again","bit-integrations")}):s({show:!0,msg:(0,n.__)("RelatedLists refresh failed. please try again","bit-integrations")});r(!1)})).catch((function(){return r(!1)}))}},m=function(e,t,a,r,s,o){var d=0===e?a.module:a.relatedlists[e-1].module;if(d){s(!0);var u={formID:t,module:d,dataCenter:a.dataCenter,clientId:a.clientId,clientSecret:a.clientSecret,tokenDetails:a.tokenDetails};(0,i.Z)(u,"zcrm_get_tags").then((function(e){var t;if(null!=e&&e.success){var i=(0,l.Z)({},a);e.data.tags&&(i.default.tags||(i.default.tags={}),i.default.tags[d]=(0,l.Z)({},e.data.tags)),e.data.tokenDetails&&(i.tokenDetails=e.data.tokenDetails),r((0,l.Z)({},i)),o({show:!0,msg:(0,n.__)("Tags refreshed","bit-integrations")})}else null!=e&&null!=(t=e.data)&&t.data||!e.success&&"string"===typeof e.data?o({show:!0,msg:""+(0,n.__)("Tags refresh failed Cause:","bit-integrations")+(e.data.data||e.data)+". "+(0,n.__)("please try again","bit-integrations")}):o({show:!0,msg:(0,n.__)("Tags refresh failed. please try again","bit-integrations")});s(!1)})).catch((function(){return s(!1)}))}},_=function(e,t,a,r,s){r(!0);var o={formID:e,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails};(0,i.Z)(o,"zcrm_get_users").then((function(e){if(null!=e&&e.success){var i=(0,l.Z)({},t);i.default.crmOwner=e.data.users,e.data.tokenDetails&&(i.tokenDetails=e.data.tokenDetails),a((0,l.Z)({},i)),s({show:!0,msg:(0,n.__)("Owners refreshed","bit-integrations")})}else s({show:!0,msg:(0,n.__)("Owners refresh failed. please try again","bit-integrations")});r(!1)})).catch((function(){return r(!1)}))},g=function(e,t,a,r,s){var o=0===e?t.module:t.relatedlists[e-1].module;if(o){r(!0);var d={module:o,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails};(0,i.Z)(d,"zcrm_get_assignment_rules").then((function(e){if(null!=e&&e.success){var i=(0,l.Z)({},t);i.default.assignmentRules||(i.default.assignmentRules={}),e.data.tokenDetails&&(i.tokenDetails=e.data.tokenDetails),i.default.assignmentRules[o]=(0,l.Z)({},e.data.assignmentRules),a((0,l.Z)({},i)),s({show:!0,msg:(0,n.__)("Assignment Rules refreshed","bit-integrations")})}else s({show:!0,msg:(0,n.__)("Assignment Rules refresh failed. please try again","bit-integrations")});r(!1)})).catch((function(){return r(!1)}))}},p=function(e,t,a){var l=0===e?t.module:t.relatedlists[e-1].module,n=0===e?t.layout:t.relatedlists[e-1].layout;return a?t.default.layouts[l][n].requiredFileUploadFields.length>0?t.default.layouts[l][n].requiredFileUploadFields.map((function(e){return{formField:"",zohoFormField:e}})):[{formField:"",zohoFormField:""}]:t.default.layouts[l][n].required.length>0?t.default.layouts[l][n].required.map((function(e){return{formField:"",zohoFormField:e}})):[{formField:"",zohoFormField:""}]},h=function(e){var t=null!=e&&e.field_map?e.field_map.filter((function(t){var a,l,n,i;return!t.formField&&t.zohoFormField&&-1!==(null==e||null==(a=e.default)||null==(l=a.layouts)||null==(n=l[e.module])||null==(i=n[e.layout])?void 0:i.required.indexOf(t.zohoFormField))})):[],a=null!=e&&e.upload_field_map?e.upload_field_map.filter((function(t){return!t.formField&&t.zohoFormField&&-1!==e.default.layouts[e.module][e.layout].requiredFileUploadFields.indexOf(t.zohoFormField)})):[],l=e.relatedlists.map((function(e){return e.field_map.filter((function(e){return!e.formField&&e.zohoFormField}))})),n=e.relatedlists.map((function(e){return e.upload_field_map.filter((function(e){return!e.formField&&e.zohoFormField}))}));return!(t.length>0||a.length>0||l.some((function(e){return e.length}))||n.some((function(e){return e.length})))}}}]);
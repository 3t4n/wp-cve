'use strict';window.tsfGBC=function(a){function b(a,b=0){let c=0;return()=>(clearTimeout(c),{cb:setTimeout(a,b),cancel:()=>clearTimeout(c)})}function c(a){return j.getEditedPostAttribute(a)}function d(){l.set("title",c("title")).set("link",j.getPermalink()).set("content",c("content")).set("excerpt",c("excerpt")).set("visibility",j.getEditedPostVisibility())}function e(){const a=new Map(l);d(),l.forEach((b,c)=>{b!==a.get(c)&&m(c)})}function f(){n?j.didPostSaveRequestSucceed()?(q(),p().cancel(),g()):p():j.isSavingPost()&&(j.isPreviewingPost()?(n=!0,o="preview"):j.isAutosavingPost()?(n=!0,o="autosave"):(n=!0,o="save"))}function g(){n=!1}function h(){if(j.isPostSavingLocked())3>++r?q():(q()&&q().cancel(),r=0);else{r=0;let a=!j.hasChangedContent();"preview"===o?document.dispatchEvent(new CustomEvent("tsf-gutenberg-onpreview")):"autosave"===o?document.dispatchEvent(new CustomEvent("tsf-gutenberg-onautosave")):"save"===o?a=!0:void 0;a&&document.dispatchEvent(new CustomEvent("tsf-gutenberg-onsave"))&&document.dispatchEvent(new CustomEvent("tsf-gutenberg-onsave-completed")),document.dispatchEvent(new CustomEvent("tsf-gutenberg-saved-document",{detail:{savedType:o}})),o=""}}function i(){k.isEditorSidebarOpened()?!s.opened&&(s.opened=!0,document.dispatchEvent(new CustomEvent("tsf-gutenberg-sidebar-opened"))):s.opened&&(s.opened=!1,document.dispatchEvent(new CustomEvent("tsf-gutenberg-sidebar-closed")))}const j=wp.data.select("core/editor"),k=wp.data.select("core/edit-post"),l=new Map,m=b=>{a(document).trigger(`tsf-updated-gutenberg-${b}`,[l.get(b)??null])};let n=!1,o="";const p=b(g,7e3),q=b(h,500);let r=0,s={opened:!1};const t=()=>{const{subscribe:a}=wp.data;a(b(i,500)),a(b(e,300)),a(f),document.dispatchEvent(new CustomEvent("tsf-subscribed-to-gutenberg"))};return Object.assign({load:()=>{document.body.addEventListener("tsf-onload",t)}},{triggerUpdate:m})}(jQuery),window.tsfGBC.load();

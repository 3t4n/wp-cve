'use strict';window.tsfPTGB=function(){const a="undefined"!=typeof tsfPTL10n&&tsfPTL10n,b=a.taxonomies,{createElement:c,Fragment:d,Component:e,useState:f,useEffect:g}=wp.element,{SelectControl:h}=wp.components,{useSelect:i}=wp.data,j=[],k={per_page:-1,orderby:"id",order:"asc",_fields:"id,name"},l=(a,c)=>b[a]?.i18n[c]||"";let m={};const n=a=>{const c=()=>document.getElementById(`autodescription[_primary_term_${a}]`),d=()=>+c().value,e=a=>+(c().value=+a);return{get:d,set:e,revalidate:a=>{const b=d();return a.includes(b)?b:e(a?.[0]||0)},register:()=>{const c=document.getElementById("tsf-gutenberg-data-holder");return c?(c.insertAdjacentHTML("beforeend",wp.template("tsf-primary-term-selector")({taxonomy:b[a]})),m[a]=!0):m[a]=!1},isRegistered:()=>m[a]||!1}},o=()=>{function a({taxonomySlug:a,_legacySelectedTerms:b}){const d=n(a),[e,m]=f(d.get()),[o,p]=f(!1),[q,r]=f(!1),{selectedTerms:s,loading:t,availableTerms:u,_taxonomy:v}=i(b=>{const{getTaxonomy:c,getEntityRecords:d,isResolving:e}=b("core"),{getEditedPostAttribute:f}=b("core/editor"),g=c(a),h=["taxonomy",a,k];return{selectedTerms:f(g?.rest_base)||j,loading:q||e("getEntityRecords",h),availableTerms:o||d(...h)||j,_taxonomy:g}},[a,q,o]);if(g(()=>{s.includes(+e)&&d.get()===+e||(d.revalidate(s),m(d.get()))},[s]),g(()=>(v?.rest_base&&b?.length&&!q&&(!o?.length||b.filter(a=>!u.map(a=>a.id).includes(a)).length)&&(r(!0),wp.apiFetch({path:wp.url?.addQueryArgs(`/wp/v2/${v.rest_base}`,k)}).then(a=>{p(a)}).finally(()=>{r(!1)})),()=>{r(!1)}),[b]),2>s?.length)return d.set(0),null;const w=a=>{s.includes(+a)&&(d.set(a),m(d.get()),"tsfAys"in window&&tsfAys.registerChange())};return c(h,{label:l(a,"selectPrimary"),value:e,className:"tsf-pt-gb-selector",onChange:w,options:(()=>u.map(a=>s.includes(a?.id)&&{value:a.id,label:tsf.decodeEntities(a?.name)}).filter(Boolean)||"")(),disabled:(()=>!(s.length&&u.length&&!t))()})}if(Object.keys(b).length){for(let a in b)n(a).register();wp.hooks.addFilter("editor.PostTaxonomyType","tsf/pt",b=>class extends e{render(){return n(this.props?.slug).isRegistered()?c(d,null,c(b,{...this.props}),c(a,{taxonomySlug:this.props?.slug,_legacySelectedTerms:this.props?.terms})):c(b,{...this.props})}})}};return Object.assign({load:()=>{document.body.addEventListener("tsf-onload",o)}},{l10n:a})}(),window.tsfPTGB.load();

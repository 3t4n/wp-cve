!function(u){function n(t){this.data=t,this.id=this.data.id,this.selected=!1,this.events=u({}),this.$editor=u(".layers-editor"),this.$viewportLayers=this.$editor.find(".viewport-layers"),this.$viewportLayer=null,this.$listLayer=this.$editor.find('.list-layer[data-id="'+this.id+'"]'),this.$layerSettings=this.$editor.find('.layer-settings[data-id="'+this.id+'"]'),this.init()}var o={slides:[],slideCounter:0,postsData:{},allowSlideImageResize:!0,init:function(){"single"===sp_js_vars.page?this.initSingleSliderPage():"all"===sp_js_vars.page&&this.initAllSlidersPage()},initSingleSliderPage:function(){var i=this;this.initSlides(),-1!==parseInt(sp_js_vars.id,10)&&this.loadSliderData(function(){i.checkSlideImageSize(),u(".slides-container").attr("data-loaded","true")}),u("form").on("submit",function(t){t.preventDefault(),i.saveSlider(),i.checkSlideImageSize()}),u(".preview-slider").on("click",function(t){t.preventDefault(),i.previewSlider()}),u(".update-presets").on("click",function(t){t.preventDefault(),i.updatePresets(u(this))}),u(".slider-setting-presets").on("change",function(t){t.preventDefault(),i.updateSettings(u(this).val())}),u('.add-slide, .slide-type a[data-type="empty"]').on("click",function(t){t.preventDefault(),i.addEmptySlide()}),u('.slide-type a[data-type="image"]').on("click",function(t){t.preventDefault(),i.addImageSlides()}),u('.slide-type a[data-type="posts"]').on("click",function(t){t.preventDefault(),i.addPostsSlides()}),u('.slide-type a[data-type="gallery"]').on("click",function(t){t.preventDefault(),i.addGallerySlides()}),u('.slide-type a[data-type="flickr"]').on("click",function(t){t.preventDefault(),i.addFlickrSlides()}),u(".add-breakpoint").on("click",function(t){t.preventDefault(),i.addBreakpoint()}),u(".breakpoints").on("click",".breakpoint-setting-name a",function(t){t.preventDefault();var e=u(this).attr("data-type"),t=u(this).parents(".breakpoint").find(".breakpoint-settings");i.addBreakpointSetting(e,t)}),u(".breakpoints").on("click",".remove-breakpoint",function(t){u(this).parents(".breakpoint").remove()}),u(".breakpoints").on("click",".remove-breakpoint-setting",function(t){u(this).parents("tr").remove()}),u(".breakpoints").lightSortable({children:".breakpoint",placeholder:""}),u(".postbox .hndle, .postbox .handlediv").on("click",function(){var t=u(this).parent(".postbox");!0===t.hasClass("closed")?t.removeClass("closed"):t.addClass("closed")}),u(".sidebar-settings").on("mouseover","label",function(){i.showInfo(u(this))}),u(".image-size-warning-close").click(function(t){t.preventDefault(),u(".image-size-warning").remove(),u.ajax({url:sp_js_vars.ajaxurl,type:"post",data:{action:"sliderpro_close_image_size_warning",nonce:sp_js_vars.cp_nonce}})}),u(window).resize(function(){!0===i.allowSlideImageResize&&(i.resizeSlideImages(),i.allowSlideImageResize=!1,setTimeout(function(){i.resizeSlideImages(),i.allowSlideImageResize=!0},250))})},initAllSlidersPage:function(){var e=this;u(".getting-started-close").click(function(t){t.preventDefault(),u(".getting-started-info").hide(),u.ajax({url:sp_js_vars.ajaxurl,type:"post",data:{action:"sliderpro_close_getting_started",nonce:sp_js_vars.cp_nonce}})}),u(".custom-css-js-warning-close").click(function(t){t.preventDefault();var e=u('<div class="modal-overlay"></div><div class="modal-window-container">\t<div class="modal-window delete-slider-dialog">\t\t<p class="dialog-question">'+sp_js_vars.remove_custom_css_js_warning+'</p>\t\t<div class="dialog-buttons">\t\t\t<a class="button dialog-ok" href="#">'+sp_js_vars.yes+'</a>\t\t\t<a class="button dialog-cancel" href="#">'+sp_js_vars.cancel+"</a>\t\t</div>\t</div></div>").appendTo("body");e.find(".dialog-ok").one("click",function(t){t.preventDefault(),u(".custom-css-js-warning").hide(),u.ajax({url:sp_js_vars.ajaxurl,type:"post",data:{action:"sliderpro_close_custom_css_js_warning",nonce:sp_js_vars.cp_nonce}}),e.remove()}),e.find(".dialog-cancel").one("click",function(t){t.preventDefault(),e.remove()}),e.find(".modal-overlay").one("click",function(t){e.remove()})}),u(".sliders-list").on("click",".preview-slider",function(t){t.preventDefault(),e.previewSliderAll(u(this))}),u(".sliders-list").on("click",".delete-slider",function(t){t.preventDefault(),e.deleteSlider(u(this))}),u(".sliders-list").on("click",".duplicate-slider",function(t){t.preventDefault(),e.duplicateSlider(u(this))}),u(".sliders-list").on("click",".export-slider",function(t){t.preventDefault(),e.exportSlider(u(this))}),u(".import-slider").on("click",function(t){var e=u.lightURLParse(u(this).attr("href")),i=void 0!==e.sp_page?parseInt(e.sp_page,10):1,e=void 0!==e.pages?parseInt(e.pages,10):1;t.preventDefault(),a.open(),a.setPaginationParams({currentPage:i,totalPages:e})}),u(".clear-all-cache").on("click",function(t){t.preventDefault(),u(".clear-cache-spinner").css({display:"inline-block",visibility:"visible"});t=u(this).attr("data-nonce");u.ajax({url:sp_js_vars.ajaxurl,type:"post",data:{action:"sliderpro_clear_all_cache",nonce:t},complete:function(t){u(".clear-cache-spinner").css({display:"",visibility:""})}})})},loadSliderData:function(e){var n=this;u(".slide-spinner").css({display:"inline-block",visibility:"visible"}),u.ajax({url:sp_js_vars.ajaxurl,type:"get",data:{action:"sliderpro_get_slider_data",id:sp_js_vars.id,nonce:sp_js_vars.lad_nonce},complete:function(t){t=u.parseJSON(t.responseText);u.each(t.slides,function(t,e){var i={mainImage:{},thumbnail:{},caption:e.caption,layers:e.layers,html:e.html,settings:u.isArray(e.settings)?{}:e.settings};u.each(e,function(t,e){-1!==t.indexOf("main_image")?i.mainImage[t]=e:-1!==t.indexOf("thumbnail")&&(i.thumbnail[t]=e)}),n.getSlide(t).setData("all",i)}),u(".slide-spinner").css({display:"",visibility:""}),e()}})},saveSlider:function(){var t=this.getSliderData();t.nonce=sp_js_vars.sa_nonce,t.action="save";var t=JSON.stringify(t),e=u(".update-spinner").css({display:"inline-block",visibility:"visible"});u.ajax({url:sp_js_vars.ajaxurl,type:"post",data:{action:"sliderpro_save_slider",data:t},complete:function(t){e.css({display:"",visibility:""}),-1===parseInt(sp_js_vars.id,10)&&!1===isNaN(t.responseText)?(u("h2").after('<div class="updated"><p>'+sp_js_vars.slider_create+"</p></div>"),window.location=sp_js_vars.admin+"?page=sliderpro&id="+t.responseText+"&action=edit"):0===u(".updated").length&&u("h2").after('<div class="updated"><p>'+sp_js_vars.slider_update+"</p></div>")}})},getSliderData:function(){var n=this,a={id:sp_js_vars.id,name:u("input#title").val(),settings:{},slides:[],panels_state:{}},i=[];return u(".slides-container").find(".slide").each(function(t){var e=u(this),i=n.getSlide(parseInt(e.attr("data-id"),10)).getData("all");i.position=parseInt(e.attr("data-position"),10),a.slides[t]=i}),u(".sidebar-settings").find(".setting").each(function(){var t=u(this);a.settings[t.attr("name")]="checkbox"===t.attr("type")?t.is(":checked"):t.val()}),u(".breakpoints").find(".breakpoint").each(function(){var t=u(this),e={breakpoint_width:t.find('input[name="breakpoint_width"]').val()};t.find(".breakpoint-setting").each(function(){var t=u(this);e[t.attr("name")]="checkbox"===t.attr("type")?t.is(":checked"):t.val()}),i.push(e)}),0<i.length&&(a.settings.breakpoints=i),u(".sidebar-settings").find(".postbox").each(function(){var t=u(this);a.panels_state[t.attr("data-name")]=t.hasClass("closed")?"closed":""}),a},previewSlider:function(){w.open(this.getSliderData())},previewSliderAll:function(t){var e=u.lightURLParse(t.attr("href")),t=e.lad_nonce,e=parseInt(e.id,10);u.ajax({url:sp_js_vars.ajaxurl,type:"get",data:{action:"sliderpro_get_slider_data",id:e,nonce:t},complete:function(t){t=u.parseJSON(t.responseText);w.open(t)}})},updatePresets:function(t){var a,t=u.lightURLParse(t.attr("href")),s=t.method,o=t.up_nonce,t=u(".slider-setting-presets").val();("update"!==s&&"delete"!==s||null!==t)&&("save-new"===s?a=u('<div class="modal-overlay"></div><div class="modal-window-container">\t<div class="modal-window save-new-preset-dialog">\t\t<label>'+sp_js_vars.preset_name+'</label><input type="text" value="" class="preset-name">\t\t<div class="dialog-buttons">\t\t\t<a class="button dialog-ok" href="#">'+sp_js_vars.save+'</a>\t\t\t<a class="button dialog-cancel" href="#">'+sp_js_vars.cancel+"</a>\t\t</div>\t</div></div>").appendTo("body"):"update"===s?a=u('<div class="modal-overlay"></div><div class="modal-window-container">\t<div class="modal-window delete-preset-dialog">\t\t<p>'+sp_js_vars.preset_update+'</p>\t\t<div class="dialog-buttons">\t\t\t<a class="button dialog-ok" href="#">'+sp_js_vars.yes+'</a>\t\t\t<a class="button dialog-cancel" href="#">'+sp_js_vars.cancel+"</a>\t\t</div>\t</div></div>").appendTo("body"):"delete"===s&&(a=u('<div class="modal-overlay"></div><div class="modal-window-container">\t<div class="modal-window delete-preset-dialog">\t\t<p>'+sp_js_vars.preset_delete+'</p>\t\t<div class="dialog-buttons">\t\t\t<a class="button dialog-ok" href="#">'+sp_js_vars.yes+'</a>\t\t\t<a class="button dialog-cancel" href="#">'+sp_js_vars.cancel+"</a>\t\t</div>\t</div></div>").appendTo("body")),a.find(".dialog-ok").on("click",function(t){t.preventDefault();var e=("save-new"===s?a.find(".preset-name"):u(".slider-setting-presets")).val(),i={},n=[];("save-new"!==s||""!==e&&0===u(".slider-setting-presets").find('option[value="'+e+'"]').length)&&(u(".sidebar-settings").find(".setting").each(function(){var t=u(this);i[t.attr("name")]="checkbox"===t.attr("type")?t.is(":checked"):t.val()}),u(".breakpoints").find(".breakpoint").each(function(){var t=u(this),e={breakpoint_width:t.find('input[name="breakpoint_width"]').val()};t.find(".breakpoint-setting").each(function(){var t=u(this);e[t.attr("name")]="checkbox"===t.attr("type")?t.is(":checked"):t.val()}),n.push(e)}),0<n.length&&(i.breakpoints=n),u.ajax({url:sp_js_vars.ajaxurl,type:"post",data:{action:"sliderpro_update_presets",method:s,name:e,settings:JSON.stringify(i),nonce:o},complete:function(t){"save-new"===s?u('<option value="'+e+'">'+e+"</option>").appendTo(u(".slider-setting-presets")):"delete"===s&&u(".slider-setting-presets").find('option[value="'+e+'"]').remove()}}),a.remove())}),a.find(".dialog-cancel").one("click",function(t){t.preventDefault(),a.remove()}),a.find(".modal-overlay").one("click",function(t){a.remove()}))},updateSettings:function(t){u.ajax({url:sp_js_vars.ajaxurl,type:"get",data:{action:"sliderpro_get_preset_settings",name:t},complete:function(t){t=u.parseJSON(t.responseText);u.each(t,function(t,e){var i=u(".sidebar-settings").find('.setting[name="'+t+'"]');"checkbox"===i.attr("type")?!0===e?i.prop("checked",!0):!1===e&&i.prop("checked",!1):i.val(e),u(".breakpoints").empty(),"breakpoints"===t&&u.ajax({url:sp_js_vars.ajaxurl,type:"get",data:{action:"sliderpro_get_breakpoints_preset",data:JSON.stringify(e)},complete:function(t){u(t.responseText).appendTo(u(".breakpoints"))}})})}})},deleteSlider:function(t){var e=u.lightURLParse(t.attr("href")),i=e.da_nonce,n=parseInt(e.id,10),a=t.parents("tr"),s=u('<div class="modal-overlay"></div><div class="modal-window-container">\t<div class="modal-window delete-slider-dialog">\t\t<p class="dialog-question">'+sp_js_vars.slider_delete+'</p>\t\t<div class="dialog-buttons">\t\t\t<a class="button dialog-ok" href="#">'+sp_js_vars.yes+'</a>\t\t\t<a class="button dialog-cancel" href="#">'+sp_js_vars.cancel+"</a>\t\t</div>\t</div></div>").appendTo("body");s.find(".dialog-ok").one("click",function(t){t.preventDefault(),u.ajax({url:sp_js_vars.ajaxurl,type:"post",data:{action:"sliderpro_delete_slider",id:n,nonce:i},complete:function(t){n===parseInt(t.responseText,10)&&a.fadeOut(300,function(){a.remove()})}}),s.remove()}),s.find(".dialog-cancel").one("click",function(t){t.preventDefault(),s.remove()}),s.find(".modal-overlay").one("click",function(t){s.remove()})},duplicateSlider:function(t){var e=u.lightURLParse(t.attr("href")),i=e.dua_nonce,t=parseInt(e.id,10),n=void 0!==e.pages?parseInt(e.pages,10):1,a=void 0!==e.sp_page?parseInt(e.sp_page,10):1;u.ajax({url:sp_js_vars.ajaxurl,type:"post",data:{action:"sliderpro_duplicate_slider",id:t,nonce:i,total_pages:n,current_page:a},complete:function(t){1<n&&a!==n?window.location=sp_js_vars.admin+"?page=sliderpro&sp_page="+n:u(t.responseText).appendTo(u(".sliders-list tbody")).hide().fadeIn()}})},exportSlider:function(t){var e=u.lightURLParse(t.attr("href")),t=e.ea_nonce,e=parseInt(e.id,10);i.open(e,t)},initSlides:function(){var e=this;u(".slides-container").find(".slide").each(function(t){e.initSlide(u(this))}),u(".slides-container").lightSortable({children:".slide",placeholder:"slide slide-placeholder",sortEnd:function(t){u(".slide").each(function(t){u(this).attr("data-position",t)})}})},initSlide:function(t,e){var i=this,t=t,e=new s(t,this.slideCounter,e);this.slides.push(e),e.on("duplicateSlide",function(t){i.duplicateSlide(t.slideData)}),e.on("deleteSlide",function(t){i.deleteSlide(t.id)}),t.attr("data-id",this.slideCounter),t.attr("data-position",this.slideCounter),this.slideCounter++},getSlide:function(i){var n;return u.each(this.slides,function(t,e){if(e.id===i)return n=e,!1}),n},duplicateSlide:function(t){var e=this,i=u.extend(!0,{},t),t=[{settings:{content_type:i.settings.content_type},main_image_source:i.mainImage.main_image_source}];u.ajax({url:sp_js_vars.ajaxurl,type:"post",data:{action:"sliderpro_add_slides",data:JSON.stringify(t)},complete:function(t){t=u(t.responseText).appendTo(u(".slides-container"));e.initSlide(t,i)}})},deleteSlide:function(t){var e=this,i=e.getSlide(t),n=u('<div class="modal-overlay"></div><div class="modal-window-container">\t<div class="modal-window delete-slide-dialog">\t\t<p class="dialog-question">'+sp_js_vars.slide_delete+'</p>\t\t<div class="dialog-buttons">\t\t\t<a class="button dialog-ok" href="#">'+sp_js_vars.yes+'</a>\t\t\t<a class="button dialog-cancel" href="#">'+sp_js_vars.cancel+"</a>\t\t</div>\t</div></div>").appendTo("body");n.find(".dialog-ok").one("click",function(t){t.preventDefault(),i.off("duplicateSlide"),i.off("deleteSlide"),i.remove(),n.remove(),e.slides.splice(u.inArray(i,e.slides),1)}),n.find(".dialog-cancel").one("click",function(t){t.preventDefault(),n.remove()}),n.find(".modal-overlay").one("click",function(t){n.remove()})},addEmptySlide:function(){var e=this;u.ajax({url:sp_js_vars.ajaxurl,type:"post",data:{action:"sliderpro_add_slides"},complete:function(t){t=u(t.responseText).appendTo(u(".slides-container"));e.initSlide(t)}})},addImageSlides:function(){var n=this;y.open(function(t){var i=[];u.each(t,function(t,e){i.push({main_image_id:e.id,main_image_source:e.url,main_image_alt:e.alt,main_image_title:e.title,main_image_width:e.width,main_image_height:e.height})}),u.ajax({url:sp_js_vars.ajaxurl,type:"post",data:{action:"sliderpro_add_slides",data:JSON.stringify(i)},complete:function(t){var e=u(".slides-container").find(".slide").length-1,e=-1==e?"":":gt("+e+")";u(".slides-container").append(t.responseText).find(".slide"+e).each(function(t){var e=u(this);n.initSlide(e,{mainImage:i[t],thumbnail:{},caption:"",layers:{},html:"",settings:{}})}),o.checkSlideImageSize()}})})},addPostsSlides:function(){var i=this;u.ajax({url:sp_js_vars.ajaxurl,type:"post",data:{action:"sliderpro_add_slides",data:JSON.stringify([{settings:{content_type:"posts"}}])},complete:function(t){var e=u(t.responseText).appendTo(u(".slides-container")),t=i.slideCounter;i.initSlide(e,{mainImage:{main_image_source:"[sp_image_src]",main_image_alt:"[sp_image_alt]",main_image_link:"[sp_link_url]"},thumbnail:{},caption:"",layers:[{id:1,name:"Layer 1",type:"paragraph",text:"[sp_title]",settings:{position:"bottomLeft",horizontal:"0",vertical:"0",preset_styles:["sp-black","sp-padding"]}}],html:"",settings:{content_type:"posts"}}),m.open(t)}})},addGallerySlides:function(){var i=this;u.ajax({url:sp_js_vars.ajaxurl,type:"post",data:{action:"sliderpro_add_slides",data:JSON.stringify([{settings:{content_type:"gallery"}}])},complete:function(t){var e=u(t.responseText).appendTo(u(".slides-container")),t=i.slideCounter;i.initSlide(e,{mainImage:{main_image_source:"[sp_image_src]",main_image_alt:"[sp_image_alt]"},thumbnail:{},caption:"",layers:{},html:"",settings:{content_type:"gallery"}}),m.open(t)}})},addFlickrSlides:function(){var i=this;u.ajax({url:sp_js_vars.ajaxurl,type:"post",data:{action:"sliderpro_add_slides",data:JSON.stringify([{settings:{content_type:"flickr"}}])},complete:function(t){var e=u(t.responseText).appendTo(u(".slides-container")),t=i.slideCounter;i.initSlide(e,{mainImage:{main_image_source:"[sp_image_src]",main_image_link:"[sp_image_link]"},thumbnail:{},caption:"",layers:[{id:1,name:"Layer 1",type:"paragraph",text:"[sp_image_description]",settings:{position:"bottomLeft",horizontal:"0",vertical:"0",preset_styles:["sp-black","sp-padding"]}}],html:"",settings:{content_type:"flickr"}}),m.open(t)}})},addBreakpoint:function(){var t="",e=u('input[name="breakpoint_width"]').last().val();void 0===e?t="960":""!==e&&(t=e-190),u.ajax({url:sp_js_vars.ajaxurl,type:"get",data:{action:"sliderpro_add_breakpoint",data:t},complete:function(t){u(t.responseText).appendTo(u(".breakpoints"))}})},addBreakpointSetting:function(t,e){u.ajax({url:sp_js_vars.ajaxurl,type:"get",data:{action:"sliderpro_add_breakpoint_setting",data:t},complete:function(t){u(t.responseText).appendTo(e)}})},getTaxonomies:function(t,e){var i=this,n=[];u.each(t,function(t,e){void 0===i.postsData[e]&&n.push(e)}),0!==n.length?u.ajax({url:sp_js_vars.ajaxurl,type:"get",data:{action:"sliderpro_get_taxonomies",post_names:JSON.stringify(n)},complete:function(t){t=u.parseJSON(t.responseText);u.each(t,function(t,e){i.postsData[t]=e}),e(i.postsData)}}):e(this.postsData)},showInfo:function(t){var e=t,t=e.attr("data-info"),i=null;void 0!==t&&(i=u('<div class="info-tooltip">'+t+"</div>").appendTo(e.parent())).css({left:-i.outerWidth(!0),marginTop:.5*-i.outerHeight(!0)-9}),e.on("mouseout",function(){null!==i&&i.remove()})},resizeSlideImages:function(){var e=u(".slide-preview").width()/u(".slide-preview").height();u(".slide-preview > img").each(function(){var t=u(this);t.width()/t.height()>e?t.css({width:"auto",height:"100%"}):t.css({width:"100%",height:"auto"})})},checkSlideImageSize:function(t){var i,n,a;0!==u(".image-size-warning").length&&(i=!1,n=u(".sidebar-settings").find('.setting[name="width"]').val(),a=u(".sidebar-settings").find('.setting[name="height"]').val(),u.each(this.slides,function(t,e){e=e.getData("mainImage");0!==parseInt(e.main_image_width,10)&&0!==parseInt(e.main_image_height,10)&&(!1===isNaN(n)&&parseInt(e.main_image_width,10)<parseInt(n,10)||!1===isNaN(a)&&parseInt(e.main_image_height,10)<parseInt(a,10))&&(i=!0)}),!0===i?u(".image-size-warning").css("display","block"):u(".image-size-warning").css("display",""))}},i={exportWindow:null,open:function(t,e){var i=this;u.ajax({url:sp_js_vars.ajaxurl,type:"post",data:{action:"sliderpro_export_slider",id:t,nonce:e},complete:function(t){i.exportWindow=u(t.responseText).appendTo("body"),i.init()}})},init:function(){var e=this;this.exportWindow.find(".close-x").on("click",function(t){t.preventDefault(),e.close()}),this.exportWindow.find("textarea").on("click",function(t){t.preventDefault(),u(this).focus(),u(this).select()})},close:function(){this.exportWindow.find(".close-x").off("click"),this.exportWindow.find("textarea").off("click"),this.exportWindow.remove()}},a={importWindow:null,$importButton:null,paginationParams:null,open:function(){var e=this;u.ajax({url:sp_js_vars.ajaxurl,type:"post",data:{action:"sliderpro_import_slider"},complete:function(t){e.importWindow=u(t.responseText).appendTo("body"),e.init()}})},setPaginationParams:function(t){this.paginationParams=this.paginationParams||{},this.paginationParams.currentPage=t.currentPage,this.paginationParams.totalPages=t.totalPages},init:function(){var i=this;this.$importButton=this.importWindow.find(".save"),this.$importButton.data("label",this.$importButton.text()),this.$importButton.on("click",function(t){var e=i.importWindow.find("textarea").val();t.preventDefault(),""!==e&&(i.importWindow.find(".save").addClass("disabled").text(sp_js_vars.slider_importing),i.save())}),this.importWindow.find(".close-x").on("click",function(t){t.preventDefault(),i.close()})},save:function(){var e,i=this,n=this.importWindow.find("textarea").val();if(-1!==n.indexOf("<?xml version"))this.loadLegacyMap(function(t){try{e=i.convertLegacySlider(n,t),i.sendData(e)}catch(t){i.importWindow.find("textarea").val(t),i.$importButton.removeClass("disabled").text(i.$importButton.data("label"))}});else try{e=u.parseJSON(n),this.sendData(e)}catch(t){this.importWindow.find("textarea").val(t),this.$importButton.removeClass("disabled").text(this.$importButton.data("label"))}},sendData:function(t){var e=this;t.id=-1,t.nonce=sp_js_vars.sa_nonce,t.action="import";var i=null!==this.paginationParams?{sp_page:void 0!==this.paginationParams.currentPage?this.paginationParams.currentPage:1,pages:void 0!==this.paginationParams.totalPages?this.paginationParams.totalPages:1}:{};u.ajax({url:sp_js_vars.ajaxurl,type:"post",data:{action:"sliderpro_save_slider",data:JSON.stringify(t),...i},complete:function(t){0!==u(".sliders-list .no-slider-row").length&&u(".sliders-list .no-slider-row").remove(),null!==e.paginationParams&&1<e.paginationParams.totalPages&&e.paginationParams.currentPage!==e.paginationParams.totalPages?window.location=sp_js_vars.admin+"?page=sliderpro&sp_page="+e.paginationParams.totalPages:(u(t.responseText).appendTo(u(".sliders-list tbody")).hide().fadeIn(),e.close())}})},loadLegacyMap:function(e){u.ajax({url:sp_js_vars.plugin+"/admin/assets/js/legacy-map.json",type:"get",dataType:"json",success:function(t){e(t)}})},decodeHTML:function(t){var e,i,n={"&amp;":"&","&quot;":'"',"&#039":"'","&lt;":"<","&gt;":">"};for(e in n)n.hasOwnProperty(e)&&(i=new RegExp(e,"g"),t=t.replace(i,n[e]));return t=t.replace(/\\/g,"")},convertLegacySlider:function(t,e){try{var i=u.parseXML(t)}catch(t){throw new Error(t)}var s=this,o={name:u(i).find("name").first().text(),settings:{},slides:[]},r=e.settings,c=e.slideContent,p=e.slideSettings,h=e.layerSettings;return u(i).find("settings").first().children().each(function(t,e){var i,n,a,s=r[e.nodeName];void 0!==s&&(i=s.newName,"select"===(n=s.type)?a=s.options[e.textContent]:"boolean"===n?a="0"!=e.textContent:"number"===n?a=parseFloat(e.textContent):"string"===n?a=e.textContent:"mixed"===n&&(a=isNaN(e.textContent)?e.textContent:parseFloat(e.textContent)),o.settings[i]=a)}),u(i).find("slide").each(function(t,e){var r={settings:{}},d=[],l=0;u(e).find("content").first().children().each(function(t,e){var i,n,a=c[e.nodeName];void 0!==a?(i=a.newName,"string"===a.type&&(n=s.decodeHTML(e.textContent)),r[i]=n):-1!==e.nodeName.indexOf("layer_")&&((n={type:"div"}).text=s.decodeHTML(e.textContent),d.push(n))}),u(e).find("settings").first().children().each(function(t,e){var i,n,a,o,s=p[e.nodeName];void 0!==s?(i=s.newName,"stringToArray"===(n=s.type)?a=e.textContent.split(s.delimiter):"select"===n?a=s.options[e.textContent]:"boolean"===n?a="0"!=e.textContent:"number"===n?a=parseFloat(e.textContent):"string"===n?a=e.textContent:"mixed"===n&&(a=isNaN(e.textContent)?e.textContent:parseFloat(xmlNode.textContent)),r.settings[i]=a):-1!==e.nodeName.indexOf("layer_")&&(o={},e.textContent.split("+").forEach(function(t){var e,i=t.split("="),n=i[0],a=i[1],s=h[n];void 0!==s&&(t=s.newName,"stringToArray"===(i=s.type)?"layer_preset_styles"===n&&(n=a.split(s.delimiter),e=[],n.forEach(function(t){void 0!==s.options[t]&&e.push(s.options[t])})):"select"===i?e=s.options[a]:"boolean"===i?e="0"!=a:"number"===i?e=parseFloat(a):"string"===i?e=a:"mixed"===i&&(e=isNaN(a)?a:parseFloat(a)),o[t]=e)}),d[l].position=l,d[l].name="Layer "+l,d[l].settings=o,l++)}),0!==d.length&&(r.layers=d),o.slides.push(r)}),o},close:function(){this.importWindow.find(".close-x").off("click"),this.importWindow.find(".save").off("click"),this.importWindow.remove()}},s=function(t,e,i){this.$slide=t,this.id=e,this.data=i,this.events=u({}),void 0===this.data&&(this.data={mainImage:{},thumbnail:{},caption:"",layers:{},html:"",settings:{}}),this.init()},e={editor:null,currentSlide:null,needsPreviewUpdate:!(s.prototype={init:function(){var i=this;this.$slide.find(".slide-preview").on("click",function(t){var e=i.getData("settings").content_type;void 0!==e&&"custom"!==e||y.open(function(t){t=t[0];i.setData("mainImage",{main_image_id:t.id,main_image_source:t.url,main_image_alt:t.alt,main_image_title:t.title,main_image_width:t.width,main_image_height:t.height}),i.updateSlidePreview(),o.checkSlideImageSize()})}),this.$slide.find(".edit-main-image").on("click",function(t){t.preventDefault(),e.open(i.id)}),this.$slide.find(".edit-thumbnail").on("click",function(t){t.preventDefault(),r.open(i.id)}),this.$slide.find(".edit-caption").on("click",function(t){t.preventDefault(),d.open(i.id)}),this.$slide.find(".edit-layers").on("click",function(t){t.preventDefault(),c.open(i.id)}),this.$slide.find(".edit-html").on("click",function(t){t.preventDefault(),l.open(i.id)}),this.$slide.find(".edit-settings").on("click",function(t){t.preventDefault(),m.open(i.id)}),this.$slide.find(".delete-slide").on("click",function(t){t.preventDefault(),i.trigger({type:"deleteSlide",id:i.id})}),this.$slide.find(".duplicate-slide").on("click",function(t){t.preventDefault(),i.trigger({type:"duplicateSlide",slideData:i.data})}),this.resizeImage()},getData:function(t){if("all"!==t)return"mainImage"===t?this.data.mainImage:"thumbnail"===t?this.data.thumbnail:"caption"===t?this.data.caption:"layers"===t?this.data.layers:"html"===t?this.data.html:"settings"===t?this.data.settings:void 0;var i={};return u.each(this.data.mainImage,function(t,e){i[t]=e}),u.each(this.data.thumbnail,function(t,e){i[t]=e}),i.caption=this.data.caption,i.layers=this.data.layers,i.html=this.data.html,i.settings=this.data.settings,i},setData:function(t,e){var i=this;"all"===t?this.data=e:"mainImage"===t?u.each(e,function(t,e){i.data.mainImage[t]=e}):"thumbnail"===t?u.each(e,function(t,e){i.data.thumbnail[t]=e}):"caption"===t?this.data.caption=e:"layers"===t?this.data.layers=e:"html"===t?this.data.html=e:"settings"===t&&(this.data.settings=e)},remove:function(){this.$slide.find(".slide-preview").off("click"),this.$slide.find(".edit-main-image").off("click"),this.$slide.find(".edit-caption").off("click"),this.$slide.find(".edit-layers").off("click"),this.$slide.find(".edit-html").off("click"),this.$slide.find(".edit-settings").off("click"),this.$slide.find(".delete-slide").off("click"),this.$slide.find(".duplicate-slide").off("click"),this.$slide.fadeOut(500,function(){u(this).remove()})},updateSlidePreview:function(){var t,i=this.$slide.find(".slide-preview"),e=this.data.settings.content_type;i.empty(),void 0===e||"custom"===e?(void 0!==(t=this.data.mainImage.main_image_source)&&""!==t?(u('<img src="'+t+'" />').appendTo(i),this.resizeImage()):0!==this.data.layers.length&&u.each(this.data.layers,function(t,e){if("video"===e.type&&""!==e.video_poster)return u('<img src="'+e.video_poster+'" />').appendTo(i),!1}),0===i.find("img").length&&u('<p class="no-image">'+sp_js_vars.no_image+"</p>").appendTo(i),this.$slide.removeClass("dynamic-slide")):"posts"===e?(u("<p>[ "+sp_js_vars.posts_slides+" ]</p>").appendTo(i),this.$slide.addClass("dynamic-slide")):"gallery"===e?(u("<p>[ "+sp_js_vars.gallery_slides+" ]</p>").appendTo(i),this.$slide.addClass("dynamic-slide")):"flickr"===e&&(u("<p>[ "+sp_js_vars.flickr_slides+" ]</p>").appendTo(i),this.$slide.addClass("dynamic-slide"))},resizeImage:function(){var t,e=this.$slide.find(".slide-preview"),i=this.$slide.find(".slide-preview > img");i.length&&(t=setInterval(function(){!0===i[0].complete&&(clearInterval(t),i.width()/i.height()>e.width()/e.height()?i.css({width:"auto",height:"100%"}):i.css({width:"100%",height:"auto"}))},100))},on:function(t,e){this.events.on(t,e)},off:function(t){this.events.off(t)},trigger:function(t){this.events.triggerHandler(t)}}),open:function(t){this.currentSlide=o.getSlide(t);var e=this,i=this.currentSlide.getData("mainImage"),n=this.currentSlide.getData("settings").content_type,a=u('.slide[data-id="'+t+'"]').find(".slide-spinner").css({display:"inline-block",visibility:"visible"});void 0===n&&(n="custom"),u.ajax({url:sp_js_vars.ajaxurl,type:"post",dataType:"html",data:{action:"sliderpro_load_main_image_editor",data:JSON.stringify(i),content_type:n},complete:function(t){u("body").append(t.responseText),e.init(),a.css({display:"",visibility:""})}})},init:function(){var e=this;this.$editor=u(".main-image-editor"),this.$editor.find(".close-x").on("click",function(t){t.preventDefault(),e.save(),e.close(),o.checkSlideImageSize()}),this.$editor.find(".image-loader, .additional-image-loader").on("click",function(t){t.preventDefault(),e.openMediaLibrary(t)}),this.$editor.find(".clear-fieldset").on("click",function(t){t.preventDefault(),e.clearFieldset(t)}),this.$editor.find('input[name="main_image_source"]').on("input",function(t){e.needsPreviewUpdate=!0}),this.$editor.find(".show-additional-images, .hide-additional-images").on("click",function(t){setTimeout(function(){u(window).trigger("resize")},1)}),u(window).on("resize.mainImageEditor",function(){e.$editor.find(".modal-window").outerWidth()>=u(window).width()?e.$editor.addClass("modal-window-left"):e.$editor.removeClass("modal-window-left"),e.$editor.find(".modal-window").outerHeight()>=u(window).height()-60?e.$editor.addClass("modal-window-top"):e.$editor.removeClass("modal-window-top")}),this.$editor.find(".show-hide-info, .show-hide-dynamic-tags").on("click",function(){u(window).trigger("resize")}),u(window).trigger("resize")},openMediaLibrary:function(t){t.preventDefault();var e=this,i=this.$editor.find(".main-image .image-loader"),n=u(t.target).hasClass("additional-image-loader"),a=u(t.target).siblings("input");y.open(function(t){t=t[0];!0===n?a.val(t.url):(0!==i.find("img").length?i.find("img").attr("src",t.url):(i.find(".no-image").remove(),u('<img src="'+t.url+'" />').appendTo(i)),e.$editor.find('input[name="main_image_id"]').val(t.id),e.$editor.find('input[name="main_image_source"]').val(t.url),e.$editor.find('input[name="main_image_alt"]').val(t.alt),e.$editor.find('input[name="main_image_title"]').val(t.title),e.$editor.find('input[name="main_image_width"]').val(t.width),e.$editor.find('input[name="main_image_height"]').val(t.height),e.needsPreviewUpdate=!0)})},clearFieldset:function(t){t.preventDefault();var e=u(t.target).parents(".fieldset"),t=e.find(".image-loader");e.find("input").val(""),0!==t.find("img").length&&(t.find("img").remove(),u('<p class="no-image">'+sp_js_vars.no_image+"</p>").appendTo(t),this.needsPreviewUpdate=!0)},save:function(){var e={};this.$editor.find(".field").each(function(){var t=u(this);e[t.attr("name")]=t.val()}),this.currentSlide.setData("mainImage",e),!0===this.needsPreviewUpdate&&(this.currentSlide.updateSlidePreview(),this.needsPreviewUpdate=!1)},close:function(){this.$editor.find(".close-x").off("click"),this.$editor.find(".image-loader").off("click"),this.$editor.find(".additional-image-loader").off("click"),this.$editor.find(".clear-fieldset").off("click"),this.$editor.find('input[name="main_image_source"]').off("input"),u(window).off("resize.mainImageEditor"),u("body").find(".modal-overlay, .modal-window-container").remove()}},r={editor:null,currentSlide:null,open:function(t){this.currentSlide=o.getSlide(t);var e=this,i=this.currentSlide.getData("thumbnail"),n=this.currentSlide.getData("settings").content_type,a=u('.slide[data-id="'+t+'"]').find(".slide-spinner").css({display:"inline-block",visibility:"visible"});void 0===n&&(n="custom"),u.ajax({url:sp_js_vars.ajaxurl,type:"post",dataType:"html",data:{action:"sliderpro_load_thumbnail_editor",data:JSON.stringify(i),content_type:n},complete:function(t){u("body").append(t.responseText),e.init(),a.css({display:"",visibility:""})}})},init:function(){var e=this;this.$editor=u(".thumbnail-editor"),this.$editor.find(".close-x").on("click",function(t){t.preventDefault(),e.save(),e.close()}),this.$editor.find(".image-loader, .additional-image-loader").on("click",function(t){t.preventDefault(),e.openMediaLibrary(t)}),this.$editor.find(".clear-fieldset").on("click",function(t){t.preventDefault(),e.clearFieldset(t)}),this.$editor.find(".thumbnail-html-code").codeEditor(),u(window).on("resize.thumbnailEditor",function(){e.$editor.find(".modal-window").outerWidth()>=u(window).width()?e.$editor.addClass("modal-window-left"):e.$editor.removeClass("modal-window-left"),e.$editor.find(".modal-window").outerHeight()>=u(window).height()-60?e.$editor.addClass("modal-window-top"):e.$editor.removeClass("modal-window-top")}),this.$editor.find(".show-hide-info, .show-hide-dynamic-tags").on("click",function(){u(window).trigger("resize")}),u(window).trigger("resize.thumbnailEditor")},openMediaLibrary:function(t){t.preventDefault();var e=this,i=this.$editor.find(".thumbnail .image-loader"),n=u(t.target).hasClass("additional-image-loader"),a=u(t.target).siblings("input");y.open(function(t){t=t[0];!0===n?a.val(t.url):(0!==i.find("img").length?i.find("img").attr("src",t.url):(i.find(".no-image").remove(),u('<img src="'+t.url+'" />').appendTo(i)),e.$editor.find('input[name="thumbnail_source"]').val(t.url),e.$editor.find('input[name="thumbnail_alt"]').val(t.alt),e.$editor.find('input[name="thumbnail_title"]').val(t.title))})},clearFieldset:function(t){t.preventDefault();var e=u(t.target).parents(".fieldset"),t=e.find(".image-loader");e.find("input").val(""),0!==t.find("img").length&&(t.find("img").remove(),u('<p class="no-image">'+sp_js_vars.no_image+"</p>").appendTo(t))},save:function(){var e={};this.$editor.find(".field").each(function(){var t=u(this);"thumbnail_content"===t.attr("name")?e.thumbnail_content=t.data("codeEditor").getValue():e[t.attr("name")]=t.val()}),this.currentSlide.setData("thumbnail",e)},close:function(){this.$editor.find(".close-x").off("click"),this.$editor.find(".image-loader").off("click"),this.$editor.find(".additional-image-loader").off("click"),this.$editor.find(".clear-fieldset").off("click"),this.$editor.find('input[name="thumbnail_source"]').off("input"),this.$editor.find(".thumbnail-html-code").codeEditor("destroy"),u(window).off("resize.thumbnailEditor"),u("body").find(".modal-overlay, .modal-window-container").remove()}},d={editor:null,currentSlide:null,open:function(t){this.currentSlide=o.getSlide(t);var e=this,i=this.currentSlide.getData("caption"),n=u('.slide[data-id="'+t+'"]').find(".slide-spinner").css({display:"inline-block",visibility:"visible"}),t=this.currentSlide.getData("settings").content_type;u.ajax({url:sp_js_vars.ajaxurl,type:"post",dataType:"html",data:{action:"sliderpro_load_caption_editor",data:i,content_type:t},complete:function(t){u("body").append(t.responseText),e.init(),n.css({display:"",visibility:""})}})},init:function(){var e=this;this.$editor=u(".caption-editor"),this.$editor.find(".close-x").on("click",function(t){t.preventDefault(),e.save(),e.close()}),u(window).on("resize.captionEditor",function(){e.$editor.find(".modal-window").outerWidth()>=u(window).width()?e.$editor.addClass("modal-window-left"):e.$editor.removeClass("modal-window-left"),e.$editor.find(".modal-window").outerHeight()>=u(window).height()-60?e.$editor.addClass("modal-window-top"):e.$editor.removeClass("modal-window-top")}),this.$editor.find(".show-hide-info, .show-hide-dynamic-tags").on("click",function(){u(window).trigger("resize")}),u(window).trigger("resize")},save:function(){this.currentSlide.setData("caption",this.$editor.find("textarea").val())},close:function(){this.$editor.find(".close-x").off("click"),u(window).off("resize.captionEditor"),u("body").find(".modal-overlay, .modal-window-container").remove()}},l={editor:null,currentSlide:null,open:function(t){this.currentSlide=o.getSlide(t);var e=this,i=this.currentSlide.getData("html"),n=u('.slide[data-id="'+t+'"]').find(".slide-spinner").css({display:"inline-block",visibility:"visible"}),t=this.currentSlide.getData("settings").content_type;u.ajax({url:sp_js_vars.ajaxurl,type:"post",dataType:"html",data:{action:"sliderpro_load_html_editor",data:i,content_type:t},complete:function(t){u("body").append(t.responseText),e.init(),n.css({display:"",visibility:""})}})},init:function(){var e=this;this.$editor=u(".html-editor"),this.$editor.find(".html-code").codeEditor(),this.$editor.find(".close-x").on("click",function(t){t.preventDefault(),e.save(),e.close()}),u(window).on("resize.htmlEditor",function(){e.$editor.find(".modal-window").outerWidth()>=u(window).width()?e.$editor.addClass("modal-window-left"):e.$editor.removeClass("modal-window-left"),e.$editor.find(".modal-window").outerHeight()>=u(window).height()-60?e.$editor.addClass("modal-window-top"):e.$editor.removeClass("modal-window-top")}),this.$editor.find(".show-hide-info, .show-hide-dynamic-tags").on("click",function(){u(window).trigger("resize")}),u(window).trigger("resize")},save:function(){this.currentSlide.setData("html",this.$editor.find(".html-code").data("codeEditor").getValue())},close:function(){this.$editor.find(".close-x").off("click"),this.$editor.find(".html-code").codeEditor("destroy"),u("window").off("resize.htmlEditor"),u("body").find(".modal-overlay, .modal-window-container").remove()}},c={editor:null,currentSlide:null,layersData:null,layers:[],counter:0,isWorking:!1,open:function(t){this.currentSlide=o.getSlide(t),this.layersData=this.currentSlide.getData("layers");var e=this,i=u('.slide[data-id="'+t+'"]').find(".slide-spinner").css({display:"inline-block",visibility:"visible"}),t=this.currentSlide.getData("settings").content_type;u.ajax({url:sp_js_vars.ajaxurl,type:"post",dataType:"html",data:{action:"sliderpro_load_layers_editor",data:JSON.stringify(this.layersData),content_type:t},complete:function(t){u("body").append(t.responseText),e.init(),i.css({display:"",visibility:""})}})},init:function(){var a=this;this.counter=0,this.$editor=u(".layers-editor"),this.$editor.find(".close-x").on("click",function(t){t.preventDefault(),a.save(),a.close()}),u(window).on("resize.layersEditor",function(){a.$editor.find(".modal-window").outerWidth()>=u(window).width()?a.$editor.addClass("modal-window-left"):a.$editor.removeClass("modal-window-left"),a.$editor.find(".modal-window").outerHeight()>=u(window).height()-60?a.$editor.addClass("modal-window-top"):a.$editor.removeClass("modal-window-top")}),this.$editor.find(".show-hide-info").on("click",function(){u(window).trigger("resize")}),this.$editor.find(".add-layer-group").on("click",function(t){var e;t.preventDefault(),!0!==a.isWorking&&(e="paragraph",void 0!==u(t.target).attr("data-type")&&(e=u(t.target).attr("data-type")),a.addNewLayer(e))}),this.$editor.find(".delete-layer").on("click",function(t){t.preventDefault(),a.deleteLayer()}),this.$editor.find(".duplicate-layer").on("click",function(t){t.preventDefault(),!0!==a.isWorking&&a.duplicateLayer()}),this.initViewport(),u.each(this.layersData,function(t,e){e.createMode="init",a.createLayer(e),a.counter=Math.max(a.counter,e.id)}),u(".list-layers").lightSortable({children:".list-layer",placeholder:"list-layer-placeholder",sortEnd:function(t){var e,i,n;t.startPosition!==t.endPosition&&(n=a.layers[t.startPosition],a.layers.splice(t.startPosition,1),a.layers.splice(t.endPosition,0,n),i=(e=a.$editor.find(".viewport-layers")).children().length-1,u(".list-layers").find(".list-layer").each(function(t,e){u(e).attr("data-position",t)}),n=e.find(".viewport-layer").eq(i-t.startPosition).detach(),i-t.startPosition<i-t.endPosition?n.insertAfter(e.find(".viewport-layer").eq(i-1-t.endPosition)):n.insertBefore(e.find(".viewport-layer").eq(i-t.endPosition)))}}),u(".list-layers").find(".list-layer").each(function(t,e){u(e).attr("data-position",t)}),0!==this.layers.length&&this.layers[0].triggerSelect(),u(window).trigger("resize.layersEditor")},initViewport:function(){var t=this.$editor.find(".layer-viewport"),e=u('<div class="slider-pro viewport-layers"></div>').appendTo(t),i=u(".sidebar-settings").find('.setting[name="width"]').val(),n=u(".sidebar-settings").find('.setting[name="height"]').val(),a=u(".sidebar-settings").find('.setting[name="custom_class"]').val(),s=this.currentSlide.getData("mainImage").main_image_source,i=isNaN(i)?u(window).width()*(parseInt(i,10)/100):parseInt(i,10),n=isNaN(n)?u(window).height()*(parseInt(n,10)/100):parseInt(n,10);t.css({width:i,height:n}),e.css({width:i,height:n}),""!==a&&e.addClass(a),void 0!==s&&""!==s&&-1===s.indexOf("[")&&(n=u(".sidebar-settings").find('.setting[name="image_scale_mode"]').val(),a=u(".sidebar-settings").find('.setting[name="center_image"]').is(":checked"),backgroundImage={"background-image":"url("+s+")","background-repeat":"no-repeat"},"cover"===n?backgroundImage["background-size"]="cover":"contain"===n?backgroundImage["background-size"]="contain":"exact"===n&&(backgroundImage["background-size"]="100% 100%"),!0===a&&(backgroundImage["background-position"]="center center"),e.css(backgroundImage))},createLayer:function(t){var e,n=this;"paragraph"===t.type?e=new p(t):"heading"===t.type?e=new h(t):"image"===t.type?e=new f(t):"div"===t.type?e=new g(t):"video"===t.type&&(e=new v(t)),"new"===t.createMode||"duplicate"===t.createMode?this.layers.unshift(e):this.layers.push(e),e.on("select",function(i){u.each(n.layers,function(t,e){!0===e.isSelected()&&e.deselect(),e.getID()===i.id&&e.select()})}),e.triggerSelect(),this.isWorking=!1,this.$editor.removeClass("no-layers")},addNewLayer:function(e){var i=this;this.isWorking=!0,this.counter++,u.ajax({url:sp_js_vars.ajaxurl,type:"post",dataType:"html",data:{action:"sliderpro_add_layer_settings",id:this.counter,type:e},complete:function(t){u(t.responseText).appendTo(u(".layers-settings")),u('<li class="list-layer" data-id="'+i.counter+'" data-position="'+i.layers.length+'">Layer '+i.counter+"</li>").prependTo(i.$editor.find(".list-layers")),i.createLayer({id:i.counter,type:e,createMode:"new"}),u(window).trigger("resize.layersEditor")}})},deleteLayer:function(){var i,n=this;u.each(this.layers,function(t,e){if(!0===e.isSelected())return e.destroy(),n.layers.splice(t,1),i=t,!1}),0!==this.layers.length?(0===i?this.layers[0]:this.layers[i-1]).triggerSelect():this.$editor.addClass("no-layers")},duplicateLayer:function(){var i,e=this;u.each(this.layers,function(t,e){!0===e.isSelected()&&(i=e.getData())}),void 0!==i&&(this.isWorking=!0,this.counter++,u.ajax({url:sp_js_vars.ajaxurl,type:"post",dataType:"html",data:{action:"sliderpro_add_layer_settings",id:this.counter,type:i.type,text:i.text,heading_type:i.heading_type,image_source:i.image_source,image_alt:i.image_alt,image_link:i.image_link,image_retina:i.image_retina,settings:JSON.stringify(i.settings)},complete:function(t){u(t.responseText).appendTo(u(".layers-settings")),u('<li class="list-layer" data-id="'+e.counter+'">Layer '+e.counter+"</li>").prependTo(e.$editor.find(".list-layers")),i.id=e.counter,i.createMode="duplicate",e.createLayer(i),u(window).trigger("resize.layersEditor")}}))},save:function(){var i=[];u.each(this.layers,function(t,e){i.push(e.getData())}),this.currentSlide.setData("layers",i),this.currentSlide.updateSlidePreview()},close:function(){this.$editor.find(".close-x").off("click"),this.$editor.find(".add-layer-group").off("click"),this.$editor.find(".delete-layer").off("click"),this.$editor.find(".duplicate-layer").off("click"),u(window).off("resize.layersEditor"),u(".list-layers").lightSortable("destroy"),u.each(this.layers,function(t,e){e.destroy()}),this.layers.length=0,u("body").find(".modal-overlay, .modal-window-container").remove()}};n.prototype={init:function(){this.initLayerContent(),this.initLayerSettings(),this.initViewportLayer(),this.initLayerDragging(),this.initListLayer()},getData:function(){var i={};return i.id=this.id,i.position=parseInt(this.$listLayer.attr("data-position"),10),i.name=this.$listLayer.text(),i.settings={},this.$layerSettings.find(".setting").each(function(){var t=u(this),e=t.attr("type");"radio"===e?t.is(":checked")&&(i.settings[t.attr("name").split("-")[0]]=t.val()):"checkbox"===e?i.settings[t.attr("name")]=t.is(":checked"):t.is("select")&&void 0!==t.attr("multiple")?i.settings[t.attr("name")]=null===t.val()?[]:t.val():i.settings[t.attr("name")]=t.val()}),i},getID:function(){return this.id},select:function(){this.selected=!0,this.$listLayer.addClass("selected-list-layer"),this.$layerSettings.addClass("selected-layer-settings")},deselect:function(){this.selected=!1,this.$listLayer.removeClass("selected-list-layer"),this.$layerSettings.removeClass("selected-layer-settings")},triggerSelect:function(){this.trigger({type:"select",id:this.id})},isSelected:function(){return this.selected},destroy:function(){this.$viewportLayer.off("mousedown"),this.$viewportLayer.off("mouseup"),this.$viewportLayer.off("click"),this.$listLayer.off("click"),this.$listLayer.off("dblclick"),this.$listLayer.off("selectstart"),this.$editor.off("mousemove.layer"+this.id),this.$editor.off("click.layer"+this.id),this.$layerSettings.find('select[name="preset_styles"]').multiCheck("destroy"),this.$layerSettings.find('.setting[name="width"]').off("change"),this.$layerSettings.find('.setting[name="height"]').off("change"),this.$layerSettings.find('.setting[name="position"]').off("change"),this.$layerSettings.find('.setting[name="horizontal"]').off("change"),this.$layerSettings.find('.setting[name="vertical"]').off("change"),this.$layerSettings.find('.setting[name="preset_styles"]').off("change"),this.$layerSettings.find('.setting[name="custom_class"]').off("change"),this.$viewportLayer.remove(),this.$listLayer.remove(),this.$layerSettings.remove()},on:function(t,e){this.events.on(t,e)},off:function(t){this.events.off(t)},trigger:function(t){this.events.triggerHandler(t)},initViewportLayer:function(){var t,e,i,n,a,s,o,r=this;this.$viewportLayer.attr("data-id",this.id),"new"===this.data.createMode||"duplicate"===this.data.createMode?this.$viewportLayer.appendTo(this.$viewportLayers):"init"===this.data.createMode&&this.$viewportLayer.prependTo(this.$viewportLayers),"new"===this.data.createMode?(this.$viewportLayer.css({width:"auto",height:"auto",left:0,top:0}),(this.$viewportLayer.hasClass("sp-layer")?this.$viewportLayer:this.$viewportLayer.find(".sp-layer")).addClass("sp-black sp-padding")):"init"!==this.data.createMode&&"duplicate"!==this.data.createMode||(s=null!==this.data.settings.preset_styles?this.data.settings.preset_styles.join(" "):"",s+=" "+this.data.settings.custom_class,(this.$viewportLayer.hasClass("sp-layer")?this.$viewportLayer:this.$viewportLayer.find(".sp-layer")).addClass(s),this.$viewportLayer.css({width:this.data.settings.width,height:this.data.settings.height}),o=this.data.settings.position.toLowerCase(),t=this.data.settings.horizontal,e=this.data.settings.vertical,i=parseInt(r.$viewportLayer.css("width"),10),n=parseInt(r.$viewportLayer.css("height"),10),a=-1!==o.indexOf("right")?"right":-1!==o.indexOf("left")?"left":"center",s=-1!==o.indexOf("bottom")?"bottom":-1!==o.indexOf("top")?"top":"center",o=-1===t.indexOf("px")&&-1===t.indexOf("%")?"px":"","center"===a?this.$viewportLayer.css({width:i,marginLeft:"auto",marginRight:"auto",left:t+o,right:0}):this.$viewportLayer.css(a,t+o),o=-1===e.indexOf("px")&&-1===e.indexOf("%")?"px":"","center"===s?this.$viewportLayer.css({height:n,marginTop:"auto",marginBottom:"auto",top:e+o,bottom:0}):this.$viewportLayer.css(s,e+o)),this.$viewportLayer.on("mousedown",function(){r.triggerSelect()}),this.$viewportLayer.on("click","a",function(t){t.preventDefault()})},initLayerDragging:function(){var d=this,e=0,i=0,n=0,a=0,l=!1,c=!1,p=!1;this.$viewportLayer.on("mousedown",function(t){t.preventDefault(),e=t.pageX,i=t.pageY,n=d.$viewportLayer[0].offsetLeft,a=d.$viewportLayer[0].offsetTop,p=!(l=!0)}),this.$editor.find(".viewport-layers").on("mousemove.layer"+this.id,function(t){t.preventDefault(),(p=!0)===l&&(d.$viewportLayer.css({left:n+t.pageX-e,top:a+t.pageY-i}),!1===c&&(c=!0,d.$viewportLayer.css({right:"auto",bottom:"auto"})))}),this.$viewportLayer.on("mouseup",function(t){var e,i,n,a,s,o,r;t.preventDefault(),(c=l=!1)!==p&&(r=d.$layerSettings.find('.setting[name="position"]').val().toLowerCase(),e=parseInt(d.$viewportLayer.css("left"),10),i=parseInt(d.$viewportLayer.css("top"),10),s=parseInt(d.$viewportLayer.css("width"),10),o=parseInt(d.$viewportLayer.css("height"),10),n=d.$editor.find(".viewport-layers").width(),a=d.$editor.find(".viewport-layers").height(),t=-1!==r.indexOf("right")?"right":-1!==r.indexOf("left")?"left":"center",r=-1!==r.indexOf("bottom")?"bottom":-1!==r.indexOf("top")?"top":"center","left"===t?d.$layerSettings.find('.setting[name="horizontal"]').val(e):"right"===t?(t=n-e-s,d.$layerSettings.find('.setting[name="horizontal"]').val(t),d.$viewportLayer.css({left:"auto",right:t})):(s=-(n-2*e-s),d.$layerSettings.find('.setting[name="horizontal"]').val(s),d.$viewportLayer.css({left:s,right:0})),"top"===r?d.$layerSettings.find('.setting[name="vertical"]').val(i):"bottom"===r?(r=a-i-o,d.$layerSettings.find('.setting[name="vertical"]').val(r),d.$viewportLayer.css({top:"auto",bottom:r})):(o=-(a-2*i-o),d.$layerSettings.find('.setting[name="vertical"]').val(o),d.$viewportLayer.css({top:o,bottom:0})))})},initListLayer:function(){var n=this,a=!1;this.$listLayer.on("click",function(t){n.trigger({type:"select",id:n.id})}),this.$listLayer.on("dblclick",function(t){var e,i;!0!==a&&(a=!0,e=n.$listLayer.text(),(i=u('<input type="text" value="'+e+'" />').appendTo(n.$listLayer)).on("change",function(){a=!1;var t=""!==i.val()?i.val():"Layer "+n.id;n.$listLayer.text(t),i.remove()}))}),this.$listLayer.on("selectstart",function(t){t.preventDefault()}),this.$editor.on("click.layer"+this.id,function(t){var e;u(t.target).is("input")||!0!==a||(a=!1,t=""!==(e=n.$listLayer.find("input")).val()?e.val():"Layer "+n.id,n.$listLayer.text(t),e.remove())})},initLayerContent:function(){},initLayerSettings:function(){var d=this;this.$layerSettings.find('select[name="preset_styles"]').multiCheck({width:120}),this.$layerSettings.find('.setting[name="position"], .setting[name="horizontal"], .setting[name="vertical"], .setting[name="width"], .setting[name="height"]').on("change",function(){var t=d.$layerSettings.find('.setting[name="position"]').val().toLowerCase(),e=d.$layerSettings.find('.setting[name="horizontal"]').val(),i=d.$layerSettings.find('.setting[name="vertical"]').val(),n=d.$layerSettings.find('.setting[name="width"]').val(),a=d.$layerSettings.find('.setting[name="height"]').val(),s=parseInt(d.$viewportLayer.css("width"),10),o=parseInt(d.$viewportLayer.css("height"),10),r=-1!==t.indexOf("right")?"right":-1!==t.indexOf("left")?"left":"center",t=-1!==t.indexOf("bottom")?"bottom":-1!==t.indexOf("top")?"top":"center";d.$viewportLayer.css({width:n,height:a,top:"auto",bottom:"auto",left:"auto",right:"auto"}),a=-1===e.indexOf("px")&&-1===e.indexOf("%")?"px":"","center"===r?d.$viewportLayer.css({width:s,marginLeft:"auto",marginRight:"auto",left:e+a,right:0}):d.$viewportLayer.css(r,e+a),a=-1===i.indexOf("px")&&-1===i.indexOf("%")?"px":"","center"===t?d.$viewportLayer.css({height:o,marginTop:"auto",marginBottom:"auto",top:i+a,bottom:0}):d.$viewportLayer.css(t,i+a)}),this.$layerSettings.find('.setting[name="preset_styles"], .setting[name="custom_class"]').on("change",function(){var t="",e=d.$layerSettings.find('.setting[name="preset_styles"]').val(),i=d.$layerSettings.find('.setting[name="custom_class"]').val();t+=null!==e?" "+e.join(" "):"",t+=""!==i?" "+i:"",d.$viewportLayer.hasClass("sp-layer")?d.$viewportLayer.attr("class","viewport-layer sp-layer"+t):d.$viewportLayer.find(".sp-layer").attr("class","sp-layer"+t)})}};var p=function(t){n.call(this,t)};p.prototype=Object.create(n.prototype),(p.prototype.constructor=p).prototype.initLayerContent=function(){var t=this;this.text="new"===this.data.createMode?this.$layerSettings.find('textarea[name="text"]').val():this.data.text,this.$layerSettings.find('textarea[name="text"]').on("input",function(){t.text=u(this).val(),t.$viewportLayer.html(t.text)})},p.prototype.initViewportLayer=function(){this.$viewportLayer=u('<p class="viewport-layer sp-layer">'+this.text+"</p>"),n.prototype.initViewportLayer.call(this)},p.prototype.getData=function(){var t=n.prototype.getData.call(this);return t.type="paragraph",t.text=this.text,t},p.prototype.destroy=function(){this.$layerSettings.find('textarea[name="text"]').off("input"),n.prototype.destroy.call(this)};var h=function(t){n.call(this,t)};h.prototype=Object.create(n.prototype),(h.prototype.constructor=h).prototype.initLayerContent=function(){var e=this;this.headingType="new"===this.data.createMode?"h3":this.data.heading_type,this.headingText="new"===this.data.createMode?this.$layerSettings.find('textarea[name="text"]').val():this.data.text,this.$layerSettings.find('select[name="heading_type"]').on("change",function(){e.headingType=u(this).val();var t=e.$viewportLayer.find(".sp-layer").attr("class");e.$viewportLayer.html("<"+e.headingType+' class="'+t+'">'+e.headingText+"</"+e.headingType+">")}),this.$layerSettings.find('textarea[name="text"]').on("input",function(){e.headingText=u(this).val(),e.$viewportLayer.find(".sp-layer").html(e.headingText)})},h.prototype.initViewportLayer=function(){this.$viewportLayer=u('<div class="viewport-layer"><'+this.headingType+' class="sp-layer">'+this.headingText+"</"+this.headingType+"></div>"),n.prototype.initViewportLayer.call(this)},h.prototype.getData=function(){var t=n.prototype.getData.call(this);return t.type="heading",t.heading_type=this.headingType,t.text=this.headingText,t},h.prototype.destroy=function(){this.$layerSettings.find('select[name="heading_type"]').off("change"),this.$layerSettings.find('textarea[name="text"]').off("input"),n.prototype.destroy.call(this)};var f=function(t){n.call(this,t)};f.prototype=Object.create(n.prototype),(f.prototype.constructor=f).prototype.initLayerContent=function(){var i=this,t=sp_js_vars.plugin+"/admin/assets/css/images/image-placeholder.png";this.imageSource="new"===this.data.createMode?t:this.data.image_source,this.hasPlaceholder="new"===this.data.createMode,this.$layerSettings.find('input[name="image_source"]').on("change",function(){i.imageSource=u(this).val(),""!==i.imageSource?(i.$viewportLayer.attr("src",i.imageSource).removeClass("has-placeholder"),i.hasPlaceholder=!1):(i.$viewportLayer.attr("src",t).addClass("has-placeholder"),i.hasPlaceholder=!0)}),this.$layerSettings.find(".layer-image-loader").on("click",function(t){var e="image_source"===u(t.target).siblings("input").attr("name")?"default":"retina";y.open(function(t){t=t[0];"default"==e?(i.$layerSettings.find('input[name="image_source"]').val(t.url).trigger("change"),i.$layerSettings.find('input[name="image_alt"]').val(t.alt)):"retina"==e&&i.$layerSettings.find('input[name="image_retina"]').val(t.url)})})},f.prototype.initLayerSettings=function(){n.prototype.initLayerSettings.call(this);var t=this;this.$layerSettings.find('.setting[name="preset_styles"], .setting[name="custom_class"]').on("change",function(){!0===t.hasPlaceholder?t.$viewportLayer.addClass("has-placeholder"):t.$viewportLayer.removeClass("has-placeholder")})},f.prototype.initViewportLayer=function(){this.$viewportLayer=u('<img class="viewport-layer sp-layer" src="'+this.imageSource+'" />'),!0===this.hasPlaceholder?this.$viewportLayer.addClass("has-placeholder"):this.$viewportLayer.removeClass("has-placeholder"),n.prototype.initViewportLayer.call(this)},f.prototype.getData=function(){var t=n.prototype.getData.call(this);return t.type="image",t.image_source=this.imageSource,t.image_alt=this.$layerSettings.find('input[name="image_alt"]').val(),t.image_link=this.$layerSettings.find('input[name="image_link"]').val(),t.image_retina=this.$layerSettings.find('input[name="image_retina"]').val(),t},f.prototype.destroy=function(){this.$layerSettings.find('input[name="image_source"]').off("change"),this.$layerSettings.find(".layer-image-loader").off("click"),n.prototype.destroy.call(this)};var g=function(t){n.call(this,t);var e=this;this.on("select",function(){setTimeout(function(){e.$layerSettings.find(".div-layer-html-code").codeEditor("refresh")},1)}),this.$layerSettings.find(".layer-settings-tab-label").on("click",function(){setTimeout(function(){e.$layerSettings.find(".div-layer-html-code").codeEditor("refresh")},1)})};g.prototype=Object.create(n.prototype),(g.prototype.constructor=g).prototype.initLayerContent=function(){var e=this;this.text="new"===this.data.createMode?this.$layerSettings.find('textarea[name="text"]').val():this.data.text,e.$layerSettings.find(".div-layer-html-code").codeEditor().on("edit",function(t){e.text=t.value,e.$viewportLayer.html(e.text)})},g.prototype.initViewportLayer=function(){this.$viewportLayer=u('<div class="viewport-layer sp-layer">'+this.text+"</div>"),n.prototype.initViewportLayer.call(this)},g.prototype.getData=function(){var t=n.prototype.getData.call(this);return t.type="div",t.text=this.text,t},g.prototype.destroy=function(){this.$layerSettings.find('textarea[name="text"]').off("input"),this.$layerSettings.find(".div-layer-html-code").codeEditor("destroy"),n.prototype.destroy.call(this)};var v=function(t){n.call(this,t)};v.prototype=Object.create(n.prototype),(v.prototype.constructor=v).prototype.initLayerContent=function(){var i=this;this.$layerSettings.find(".layer-image-loader").on("click",function(t){var e="video_poster"===u(t.target).siblings("input").attr("name")?"default":"retina";y.open(function(t){t=t[0];"default"==e?i.$layerSettings.find('input[name="video_poster"]').val(t.url).trigger("change"):"retina"==e&&i.$layerSettings.find('input[name="video_retina_poster"]').val(t.url)})})},v.prototype.initViewportLayer=function(){var i=this;this.$viewportLayer=u('<div class="viewport-layer sp-layer has-placeholder"><span class="video-placeholder"></span></div>'),n.prototype.initViewportLayer.call(this),this.$layerSettings.find('input[name="width"], input[name="height"]').on("change",function(){var t=i.$layerSettings.find('input[name="width"]').val(),e=i.$layerSettings.find('input[name="height"]').val();"auto"===t&&i.$viewportLayer.css("width",300),"auto"===e&&i.$viewportLayer.css("height",150)}),this.$layerSettings.find('input[name="width"], input[name="height"]').trigger("change")},v.prototype.initLayerSettings=function(){n.prototype.initLayerSettings.call(this);var t=this;this.$layerSettings.find('.setting[name="preset_styles"], .setting[name="custom_class"]').on("change",function(){t.$viewportLayer.addClass("has-placeholder")})},v.prototype.getData=function(){var t=n.prototype.getData.call(this);return t.type="video",t.video_source=this.$layerSettings.find('select[name="video_source"]').val(),t.video_id=this.$layerSettings.find('input[name="video_id"]').val(),t.video_poster=this.$layerSettings.find('input[name="video_poster"]').val(),t.video_retina_poster=this.$layerSettings.find('input[name="video_retina_poster"]').val(),t.video_load_mode=this.$layerSettings.find('select[name="video_load_mode"]').val(),t.video_params=this.$layerSettings.find('input[name="video_params"]').val(),t};var m={editor:null,currentSlide:null,needsPreviewUpdate:!(v.prototype.destroy=function(){this.$layerSettings.find('input[name="width"]').off("change"),this.$layerSettings.find('input[name="height"]').off("change"),n.prototype.destroy.call(this)}),open:function(t){this.currentSlide=o.getSlide(t);var e=this,i=this.currentSlide.getData("settings"),n=u('.slide[data-id="'+t+'"]').find(".slide-spinner").css({display:"inline-block",visibility:"visible"});u.ajax({url:sp_js_vars.ajaxurl,type:"post",dataType:"html",data:{action:"sliderpro_load_settings_editor",data:JSON.stringify(i)},complete:function(t){u("body").append(t.responseText),e.init(),n.css({display:"",visibility:""})}})},init:function(){var e=this;this.$editor=u(".settings-editor"),this.$editor.find(".close, .close-x").on("click",function(t){t.preventDefault(),e.save(),e.close()}),this.$editor.find('.slide-setting[name="content_type"]').on("change",function(){var t=u(this).val();e.loadControls(t),e.needsPreviewUpdate=!0}),"posts"===this.$editor.find('.slide-setting[name="content_type"]').val()&&this.handlePostsSelects(),u(window).on("resize.settingsEditor",function(){e.$editor.find(".modal-window").outerWidth()>=u(window).width()?e.$editor.addClass("modal-window-left"):e.$editor.removeClass("modal-window-left"),e.$editor.find(".modal-window").outerHeight()>=u(window).height()-60?e.$editor.addClass("modal-window-top"):e.$editor.removeClass("modal-window-top")}),this.$editor.on("click",".show-hide-info",function(){u(window).trigger("resize")}),u(window).trigger("resize")},loadControls:function(e){var i=this,t=this.currentSlide.getData("settings");this.$editor.find(".content-type-settings").empty(),u.ajax({url:sp_js_vars.ajaxurl,type:"post",data:{action:"sliderpro_load_content_type_settings",type:e,data:JSON.stringify(t)},complete:function(t){u(".content-type-settings").append(t.responseText),"posts"===e&&i.handlePostsSelects()}})},handlePostsSelects:function(){var t=this.$editor.find('select[name="posts_post_types"]'),a=this.$editor.find('select[name="posts_taxonomies"]'),s=a.val()||[];t.on("change",function(){var t=u(this).val();a.empty(),null!==t?o.getTaxonomies(t,function(i){u.each(t,function(t,e){e=i[e];u.each(e,function(t,e){var n=u('<optgroup label="'+e.label+'"></optgroup>').appendTo(a);u.each(e.terms,function(t,e){var i=-1!==u.inArray(e.full,s)?' selected="selected"':"";u('<option value="'+e.full+'"'+i+">"+e.name+"</option>").appendTo(n)})})}),a.multiCheck("refresh")}):a.multiCheck("refresh")}),a.on("change",function(t){a.find("option").each(function(){var t=u(this),e=t.attr("value"),i=u.inArray(e,s);!0===t.is(":selected")&&-1===i?s.push(e):!1===t.is(":selected")&&-1!==i&&s.splice(i,1)})}),t.multiCheck({width:215}),a.multiCheck({width:215})},save:function(){var e={};this.$editor.find(".slide-setting").each(function(){var t=u(this);void 0!==t.attr("multiple")?e[t.attr("name")]=null!==t.val()?t.val():[]:"checkbox"===t.attr("type")?e[t.attr("name")]=t.is(":checked"):e[t.attr("name")]=t.val()}),this.currentSlide.setData("settings",e),!0===this.needsPreviewUpdate&&(this.currentSlide.updateSlidePreview(),this.needsPreviewUpdate=!1)},close:function(){this.$editor.find(".close-x").off("click"),this.$editor.find('select[name="posts_post_types"]').multiCheck("destroy"),this.$editor.find('select[name="posts_taxonomies"]').multiCheck("destroy"),this.$editor.find('select[name="content_type"]').off("change"),this.$editor.find('select[name="posts_post_types"]').off("change"),this.$editor.find('select[name="posts_taxonomies"]').off("change"),u(window).off("resize.settingsEditor"),u("body").find(".modal-overlay, .modal-window-container").remove()}},y={open:function(e){var o=[],i=wp.media.editor.insert;wp.media.editor.send.attachment=function(t,e){var i=void 0!==e.sizes[t.size]?e.sizes[t.size]:e.sizes.full,n=e.id,a=i.url,s=i.width,t=i.height,i=e.alt,e=e.title;o.push({id:n,url:a,alt:i,title:e,width:s,height:t})},wp.media.editor.insert=function(t){e.call(this,o),wp.media.editor.insert=i},wp.media.editor.open("media-loader")}},w={previewWindow:null,slider:null,sliderData:null,open:function(t){var e=this,i=u(".preview-spinner").css({display:"inline-block",visibility:"visible"});u("body").append('<div class="modal-overlay"></div><div class="modal-window-container preview-window">\t<div class="modal-window">\t\t<span class="close-x"></span>\t</div></div>'),this.sliderData=t,this.init(),u.ajax({url:sp_js_vars.ajaxurl,type:"post",data:{action:"sliderpro_preview_slider",data:JSON.stringify(t)},complete:function(t){e.previewWindow.append(t.responseText),e.slider=e.previewWindow.find(".slider-pro"),e.previewWindow.css("visibility",""),i.css({display:"",visibility:""}),setTimeout(function(){u(window).trigger("resize")},100)}})},init:function(){var e=this;this.previewWindow=u(".preview-window .modal-window"),this.previewWindow.find(".close-x").on("click",function(t){e.close()}),this.previewWindow.css("visibility","hidden");var t=this.sliderData.settings.width,i=this.sliderData.settings.height,n=this.sliderData.settings.visible_size,a=this.sliderData.settings.force_size,s=this.sliderData.settings.orientation,o=this.sliderData.settings.auto_thumbnail_images,r="top"===this.sliderData.settings.thumbnails_position||"bottom"===this.sliderData.settings.thumbnails_position?"horizontal":"vertical";u.each(this.sliderData.slides,function(t,e){(void 0!==e.thumbnail_source&&""!==e.thumbnail_source||void 0!==e.thumbnail_content&&""!==e.thumbnail_content)&&(o=!0)}),"auto"!==n&&("horizontal"===s?t=n:"vertical"===s&&(i=n)),"fullWidth"===a?t="100%":"fullWindow"===a&&(i=t="100%");var d=-1!==t.toString().indexOf("%"),l=-1!==i.toString().indexOf("%");!1==d&&!0===o&&"vertical"==r&&(t=parseInt(t,10)+parseInt(this.sliderData.settings.thumbnail_width,10)),u(window).on("resize.sliderPro",function(){!0==d?e.previewWindow.css("width",u(window).width()*(parseInt(t,10)/100)-60):t>=u(window).width()-60?e.previewWindow.css("width",u(window).width()-60):e.previewWindow.css("width",t),!0==l&&e.previewWindow.css("height",u(window).height()*(parseInt(i,10)/100)),e.previewWindow.outerWidth()>=u(window).width()?e.previewWindow.parent().addClass("modal-window-left"):e.previewWindow.parent().removeClass("modal-window-left"),e.previewWindow.outerHeight()>=u(window).height()-60?e.previewWindow.parent().addClass("modal-window-top"):e.previewWindow.parent().removeClass("modal-window-top")}),u(window).trigger("resize")},close:function(){this.previewWindow.find(".close-x").off("click"),u(window).off("resize.sliderPro"),this.slider.sliderPro("destroy"),u("body").find(".modal-overlay, .modal-window-container").remove()}};u(document).ready(function(){o.init()}),window.sliderpro=window.sliderpro||{},window.sliderpro.admin=o,window.sliderpro.preview=w}(jQuery),function(n){function a(t,e){this.options=e,this.isOpened=!1,this.$select=n(t),this.$multiCheck=null,this.$multiCheckHeader=null,this.$multiCheckContent=null,this.uid=(new Date).valueOf()*Math.random(),this.counter=0,this.init()}a.prototype={init:function(){var e=this;this.settings=n.extend({},this.defaults,this.options),this.$multiCheck=n('<div class="multi-check"></div>').css("width",this.settings.width),this.$multiCheckHeader=n('<button type="button" class="multi-check-header"><span class="multi-check-header-text"></span><span class="multi-check-header-arrow"></span></button>').appendTo(this.$multiCheck),this.$multiCheckContent=n('<ul class="multi-check-content"></ul>').appendTo(this.$multiCheck),this.$multiCheckHeader.on("mousedown.multiCheck",function(t){!1===e.isOpened?e.open():!0===e.isOpened&&e.close()}),n(document).on("mousedown.multiCheck."+this.uid,function(t){!1===n.contains(e.$multiCheck[0],t.target)&&e.close()}),this.refresh(),this.$select.after(this.$multiCheck),this.$select.hide(),this.$multiCheckContent.hide()},refresh:function(){var t=this;this.counter=0,this.$multiCheckContent.find(".single-check").off("change.multiCheck"),this.$multiCheckContent.empty(),this.$select.children().each(function(){n(this).is("optgroup")?(n('<li class="group-label">'+n(this).attr("label")+"</li>").appendTo(t.$multiCheckContent),n(this).children().each(function(){t._optionToCheckbox(n(this))})):t._optionToCheckbox(n(this))}),this.$multiCheckContent.find(".single-check").on("change.multiCheck",function(){n(this).is(":checked")?n(this).data("option").prop("selected",!0):n(this).data("option").prop("selected",!1),t.$select.trigger("change"),t._updateHeader()}),this._updateHeader()},_optionToCheckbox:function(t){var e=n('<li class="single-check-container"></li>').appendTo(this.$multiCheckContent),i=n('<input id="single-check-'+this.uid+"-"+this.counter+'" class="single-check" type="checkbox" value="'+t.attr("value")+'"'+(t.is(":selected")?' checked="checked"':"")+" />").appendTo(e);n('<label for="single-check-'+this.uid+"-"+this.counter+'">'+t.text()+"</label>").appendTo(e);i.data("option",t),this.counter++},_updateHeader:function(){var t=this.$multiCheckHeader.find(".multi-check-header-text"),e="",i=0;this.$multiCheckContent.find(".single-check").each(function(){n(this).is(":checked")&&(""!==e&&(e+=", "),e+=n(this).siblings("label").text(),i++)}),0===i?e="Click to select":2<=i&&(e=i+" selected"),t.text(e)},open:function(){this.isOpened=!0,this.$multiCheckContent.show()},close:function(){this.isOpened=!1,this.$multiCheckContent.hide()},destroy:function(){this.$select.removeData("multiCheck"),this.$multiCheckHeader.off("mousedown.multiCheck"),n(document).off("mousedown.multiCheck."+this.uid),this.$multiCheckContent.find(".single-check").off("change.multiCheck"),this.$multiCheck.remove(),this.$select.show()},defaults:{width:200}},n.fn.multiCheck=function(e){var i=Array.prototype.slice.call(arguments,1);return this.each(function(){var t;void 0===n(this).data("multiCheck")?(t=new a(this,e),n(this).data("multiCheck",t)):void 0!==e&&("function"==typeof(t=n(this).data("multiCheck"))[e]?t[e].apply(t,i):n.error(e+" does not exist in multiCheck."))})}}(jQuery),function(n){function a(t,e){this.options=e,this.$container=n(t),this.$selectedChild=null,this.$placeholder=null,this.currentMouseX=0,this.currentMouseY=0,this.slideInitialX=0,this.slideInitialY=0,this.initialMouseX=0,this.initialMouseY=0,this.isDragging=!1,this.checkHover=0,this.uid=(new Date).valueOf(),this.events=n({}),this.startPosition=0,this.endPosition=0,this.init()}a.prototype={init:function(){this.settings=n.extend({},this.defaults,this.options),this.$container.on("mousedown.lightSortable"+this.uid,n.proxy(this._onDragStart,this)),n(document).on("mousemove.lightSortable."+this.uid,n.proxy(this._onDragging,this)),n(document).on("mouseup.lightSortable."+this.uid,n.proxy(this._onDragEnd,this))},_onDragStart:function(t){1!==t.which||n(t.target).is("select")||n(t.target).is("input")||n(t.target).is("a")||(this.$selectedChild=n(t.target).is(this.settings.children)?n(t.target):n(t.target).parents(this.settings.children),1===this.$selectedChild.length&&(this.initialMouseX=t.pageX,this.initialMouseY=t.pageY,this.slideInitialX=this.$selectedChild.position().left,this.slideInitialY=this.$selectedChild.position().top,this.startPosition=this.$selectedChild.index(),t.preventDefault()))},_onDragging:function(t){var e;null!==this.$selectedChild&&0!==this.$selectedChild.length&&(t.preventDefault(),this.currentMouseX=t.pageX,this.currentMouseY=t.pageY,this.isDragging||(this.isDragging=!0,this.trigger({type:"sortStart"}),n.isFunction(this.settings.sortStart)&&this.settings.sortStart.call(this,{type:"sortStart"}),t=this.$container.is("ul")||this.$container.is("ol")?"li":"div",this.$placeholder=n("<"+t+">").addClass("ls-ignore "+this.settings.placeholder).insertAfter(this.$selectedChild),0===this.$placeholder.width()&&this.$placeholder.css("width",this.$selectedChild.outerWidth()),0===this.$placeholder.height()&&this.$placeholder.css("height",this.$selectedChild.outerHeight()),this.$selectedChild.css({"pointer-events":"none",position:"absolute",left:this.$selectedChild.position().left,top:this.$selectedChild.position().top,width:this.$selectedChild.width(),height:this.$selectedChild.height()}).addClass("ls-ignore"),this.$container.append(this.$selectedChild),n("body").css("user-select","none"),(e=this).checkHover=setInterval(function(){e.$container.find(e.settings.children).not(".ls-ignore").each(function(){var t=n(this);e.currentMouseX>t.offset().left&&e.currentMouseX<t.offset().left+t.width()&&e.currentMouseY>t.offset().top&&e.currentMouseY<t.offset().top+t.height()&&(t.index()>=e.$placeholder.index()?e.$placeholder.insertAfter(t):e.$placeholder.insertBefore(t))})},200)),this.$selectedChild.css({left:this.currentMouseX-this.initialMouseX+this.slideInitialX,top:this.currentMouseY-this.initialMouseY+this.slideInitialY}))},_onDragEnd:function(){this.isDragging&&(this.isDragging=!1,n("body").css("user-select",""),this.$selectedChild.css({position:"",left:"",top:"",width:"",height:"","pointer-events":""}).removeClass("ls-ignore").insertAfter(this.$placeholder),this.$placeholder.remove(),clearInterval(this.checkHover),this.endPosition=this.$selectedChild.index(),this.trigger({type:"sortEnd"}),n.isFunction(this.settings.sortEnd)&&this.settings.sortEnd.call(this,{type:"sortEnd",startPosition:this.startPosition,endPosition:this.endPosition})),this.$selectedChild=null},destroy:function(){this.$container.removeData("lightSortable"),this.isDragging&&this._onDragEnd(),this.$container.off("mousedown.lightSortable."+this.uid),n(document).off("mousemove.lightSortable."+this.uid),n(document).off("mouseup.lightSortable."+this.uid)},on:function(t,e){return this.events.on(t,e)},off:function(t){return this.events.off(t)},trigger:function(t){return this.events.triggerHandler(t)},defaults:{placeholder:"",sortStart:function(){},sortEnd:function(){}}},n.fn.lightSortable=function(e){var i=Array.prototype.slice.call(arguments,1);return this.each(function(){var t;void 0===n(this).data("lightSortable")?(t=new a(this,e),n(this).data("lightSortable",t)):void 0!==e&&("function"==typeof(t=n(this).data("lightSortable"))[e]?t[e].apply(t,i):n.error(e+" does not exist in lightSortable."))})}}(jQuery),function(e){e.lightURLParse=function(t){var t=t.split("?")[1].split("&"),i=[];return e.each(t,function(t,e){e=e.split("=");i[e[0]]=e[1]}),i}}(jQuery),function(n){function a(t,e={}){this.options=e,this.$textarea=n(t),this.isCodeMirror=!1,this.codeMirror=null,this.init()}a.prototype={init:function(){var t,e=this;this.settings=n.extend({},this.defaults,this.options),void 0!==wp.codeEditor.initialize?(t=wp.codeEditor.initialize(this.$textarea,this.setting),this.codeMirror=t.codemirror,this.isCodeMirror=!0,this.codeMirror.on("change",function(){e.trigger({type:"edit",value:e.codeMirror.getValue()})})):this.$textarea.on("input",function(){e.trigger({type:"edit",value:e.$textarea.val()})})},getValue:function(){return!0===this.isCodeMirror?this.codeMirror.getValue():this.$textarea.val()},on:function(t,e){return this.$textarea.on(t,e)},off:function(t){return this.$textarea.off(t)},trigger:function(t){return this.$textarea.triggerHandler(t)},refresh:function(){!0===this.isCodeMirror&&this.codeMirror.refresh()},destroy:function(){this.$textarea.removeData("codeEditor"),!0===this.isCodeMirror?(this.codeMirror.toTextArea(),this.codeMirror.off("change")):this.$textarea.off("input")},defaults:{}},n.fn.codeEditor=function(e){var i=Array.prototype.slice.call(arguments,1);return this.each(function(){var t;void 0===n(this).data("codeEditor")?(t=new a(this,e),n(this).data("codeEditor",t)):void 0!==e&&("function"==typeof(t=n(this).data("codeEditor"))[e]?t[e].apply(t,i):n.error(e+" does not exist in codeEditor."))})}}(jQuery);
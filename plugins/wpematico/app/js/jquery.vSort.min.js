/**
 * vSort 1.2
 * https://github.com/lastdates/vSort
 */
!function($){var mY,t,b,tY,ph,nh,el,d=$(document),M=function(e){if(e.preventDefault(),mY=e.pageY||e.originalEvent.touches[0].pageY,tY=0,el=$(this).parent(),!el.hasClass("sortitem"))return!1;var P=el.parent(),i=el.index(),H=P.innerHeight(),T=P.children().first().offset().top,F=P.data("callback"),h=el.outerHeight(),r=el.data("restrict");if(r){var R="[data-restrict="+r+"]:first";r=el.prevAll(R),r.length&&(H+=T,T=r.offset().top+r.outerHeight(),H-=T),r=el.nextAll(R),r.length&&(H=r.offset().top-T)}return t=el.offset().top-T,b=t+h,ph=el.prev().outerHeight()/2,nh=el.next().outerHeight()/2,el.addClass("dragging"),d.bind("mousemove touchmove",function(e){e.preventDefault(),tY=(e.pageY||e.originalEvent.touches[0].pageY)-mY,0>t+tY?tY=-1*t:b+tY>H?tY=H-b:tY>=nh?(el.insertAfter(el.next()),S(2*nh)):0>=tY+ph&&(el.insertBefore(el.prev()),S(-2*ph)),el.css({top:tY+"px"})}),d.bind("mouseup touchend",function(e){d.unbind("mousemove mouseup touchmove touchend"),function R(){tY>3?tY-=3:-3>tY?tY+=3:tY=0,el.css({top:tY+"px"}),0==tY?(el.removeClass("dragging"),F&&el.index()!=i&&setTimeout(function(){eval(F)},20)):setTimeout(R,10)}()}),!1},S=function(e){mY+=e,tY-=e,t+=e,b+=e,ph=el.prev().outerHeight()/2,nh=el.next().outerHeight()/2};$.fn.vSort=function(){$(".sorthandle").attr("unselectable","on").bind("touchstart mousedown",M)},$("<style>.sortitem{position:relative;}.sortitem .sorthandle{cursor:move;}.sortitem.dragging{z-index:9999;opacity:.85;-webkit-box-shadow:0 0 0.625em rgba(0,0,0,0.5);box-shadow:0 0 0.625em rgba(0,0,0,0.5);}</style>").appendTo("head"),d.ready(function(){d.vSort()})}(jQuery);

var _feedHolder;function wppfm_getFeedAttributes(feedId,channel,feedType,callback){wppfm_getOutputFields(feedId,channel,feedType,(function(fields){if(fields!=="0"){callback(JSON.parse(fields))}else{callback([])}}))}function wppfm_customSourceFields(sourceId,callback){wppfm_getSourceFields(sourceId,(function(fields){callback(fields&&fields!=="0"?JSON.parse(fields):"0")}))}function wppfm_mainFeedFilters(feedId,callback){wppfm_getMainFeedFilters(feedId,(function(filters){callback(filters!=="0"?JSON.parse(filters):null)}))}function wppfm_addFeedAttributes(outputs,channel){var inputs=wppfm_getAdvisedInputs(channel);var i=0;_feedHolder.clearAllAttributes();for(var field in outputs){var outputTitle=outputs[field]["field_label"];var activity=true;if(parseInt(outputs[field]["category_id"])>2&&outputs[field]["value"]===""){activity=false}else if(outputs[field]["category_id"]==="0"){activity=false}else if(parseInt(outputs[field]["category_id"])>2&&outputs[field]["value"]===undefined){activity=false}wppfm_setChannelRelatedPresets(outputs[field],channel);_feedHolder.addAttribute(i,outputTitle,inputs[outputTitle],outputs[field]["value"],outputs[field]["category_id"],activity,0,0,0);i++}}function wppfm_saveFeedToDb(feed,callback){_feedHolder=feed;var feedDataSelectorTable=jQuery("#wppfm-feed-editor-page-data-storage").data("wppfmAjaxFeedDataToDatabaseConversionArray");var feedDataToStore=wppfm_getFeedDataToStore(feedDataSelectorTable);var metaToStore="3"!==_feedHolder["feedType"]&&_feedHolder["promotions"]?wppfm_filterActiveMetaData(_feedHolder["attributes"],_feedHolder["categoryMapping"]):wpppfm_convertPromotionToAttribute(_feedHolder["promotions"]);var feedFilter=_feedHolder["feedFilter"];wppfm_updateFeedToDb(feedDataToStore,metaToStore,feedFilter,(function(response){callback(response.trim())}))}function wppfm_filterActiveMetaData(metaData,categoryMapping){var activeMeta=[];for(var i=0;i<metaData.length;i++){if(metaData[i]["value"]!==undefined&&metaData[i]["value"]!==""&&metaData[i]["isActive"]===true){activeMeta.push(new Wppfm_AttributeMeta(metaData[i]["fieldName"],metaData[i]["value"]))}}if(categoryMapping.length>0){activeMeta.push(new Wppfm_AttributeMeta("category_mapping",categoryMapping))}return activeMeta}function wppfm_getFeedDataToStore(feedData){var result=[];for(var i=0;i<feedData.length;i++){var dataItem={name:feedData[i]["db"],value:undefined!==_feedHolder[feedData[i]["feed"]]?_feedHolder[feedData[i]["feed"]]:"",type:feedData[i]["type"]};result.push(dataItem)}return result}function wppfm_getFileNameFromForm(){var standardFileNameElement=jQuery("#wppfm-feed-file-name");if(false===wppfm_validateFileName(standardFileNameElement.val())){standardFileNameElement.val("")}return standardFileNameElement.val()}function wppfm_standardProductFeedSelected(){wppfm_initializeStandardProductFeedForm(wppfm_getFileNameFromForm())}
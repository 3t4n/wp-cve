function wppfm_activateFeedCategoryMapping(id){var feedSelectorElement=jQuery("#feed-selector-"+id);var children=feedSelectorElement.attr("data-children")?JSON.parse(feedSelectorElement.attr("data-children")):[];feedSelectorElement.prop("checked",true);wppfm_activateFeedCategorySelector(id);for(var i=0;i<children.length;i++){wppfm_activateFeedCategorySelector(children[i])}}function wppfm_activateFeedCategorySelection(id){var feedSelectorElement=jQuery("#feed-selector-"+id);var children=feedSelectorElement.attr("data-children")?JSON.parse(feedSelectorElement.attr("data-children")):[];feedSelectorElement.prop("checked",true);_feedHolder.activateCategory(id,true);for(var i=0;i<children.length;i++){wppfm_activateFeedCategorySelection(children[i])}}function wppfm_activateAllFeedCategoryMapping(){var tableType=0!==document.getElementsByClassName("wppfm-category-mapping-selector").length?"category_mapping_table":"category_selection_table";var idCollection="category_mapping_table"===tableType?document.getElementsByClassName("wppfm-category-mapping-selector"):document.getElementsByClassName("wppfm-category-selector");for(var j=0;j<idCollection.length;j++){if("category_mapping_table"===tableType){wppfm_activateFeedCategorySelector(idCollection[j].value)}else{wppfm_activateFeedCategorySelection(idCollection[j].value)}}}function wppfm_activateFeedCategorySelector(id){var usesOwnCategories=wppfm_channelUsesOwnCategories(_feedHolder["channel"]);var feedCategoryText=usesOwnCategories?"shopCategory":"default";var feedSelectorElement=jQuery("#feed-selector-"+id);var feedCategoryElement=jQuery("#feed-category-"+id);_feedHolder.activateCategory(id,usesOwnCategories);var children=feedSelectorElement.attr("data-children")?JSON.parse(feedSelectorElement.attr("data-children")):[];if(feedCategoryElement.html()===""){feedCategoryElement.html(wppfm_mapToDefaultCategoryElement(id,feedCategoryText))}feedSelectorElement.prop("checked",true);for(var i=0;i<children.length;i++){wppfm_activateFeedCategorySelector(children[i])}}function wppfm_deactivateFeedCategorySelection(id){var feedSelectorElement=jQuery("#feed-selector-"+id);var children=feedSelectorElement.attr("data-children")?JSON.parse(feedSelectorElement.attr("data-children")):[];feedSelectorElement.prop("checked",false);_feedHolder.deactivateCategory(id);for(var i=0;i<children.length;i++){wppfm_deactivateFeedCategorySelection(children[i])}}function wppfm_deactivateFeedCategoryMapping(id){var feedSelectorElement=jQuery("#feed-selector-"+id);wppfm_deactivateFeedCategorySelector(id,true);var children=feedSelectorElement.attr("data-children")?JSON.parse(feedSelectorElement.attr("data-children")):[];for(var i=0;i<children.length;i++){wppfm_deactivateFeedCategorySelector(children[i],false)}}function wppfm_deactivateAllFeedCategoryMapping(){var idCollection=0!==document.getElementsByClassName("wppfm-category-mapping-selector").length?document.getElementsByClassName("wppfm-category-mapping-selector"):document.getElementsByClassName("wppfm-category-selector");for(var j=0;j<idCollection.length;j++){wppfm_deactivateFeedCategorySelector(idCollection[j].value)}}function wppfm_contains_special_characters(string){var specialChars="%^#<>\\{}[]/~`@?:;=&";for(var i=0;i<specialChars.length;i++){if(string.indexOf(specialChars[i])>-1){return true}}return false}function wppfm_deactivateFeedCategorySelector(id,parent){var feedSelectorElement=jQuery("#feed-selector-"+id);_feedHolder.deactivateCategory(id);jQuery("#feed-category-"+id).html("");jQuery("#category-selector-catmap-"+id).hide();feedSelectorElement.prop("checked",false);if(!parent){var children=feedSelectorElement.attr("data-children")?JSON.parse(feedSelectorElement.attr("data-children")):[];for(var i=0;i<children.length;i++){wppfm_deactivateFeedCategorySelector(children[i],false)}}}function wppfm_hideSubs(currentLevelId){var level=currentLevelId.match(/(\d+)$/)[0];var idString=currentLevelId.substring(0,currentLevelId.length-level.length);for(var i=7;i>level;i--){var categorySubLevelSelector=jQuery("#"+idString+i);categorySubLevelSelector.css("display","none");categorySubLevelSelector.empty()}}function wppfm_escapeHtml(text){text=text||"";text=text.replace(/&([^#])(?![a-z1-4]{1,8};)/gi,"&#038;$1");return text.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function wppfm_sanitizeInputString(fileName){return fileName.trim().replace(/[<>:"\/\\|?*]/g,"_")}function wppfm_sanitizeEmail(email){const re=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;if(re.test(String(email).toLowerCase())){return email}else{return false}}function wppfm_splitCombinedFieldElements(fieldString){if(!fieldString){return[]}var reg=/\|[0-9]/;var result=[];var sliceStart=0;var match;while((match=reg.exec(fieldString))!==null){var ind=match.index;result.push(fieldString.substring(sliceStart,ind));fieldString=fieldString.slice(ind+1)}result.push(fieldString);return result}function wppfm_showWorkingSpinner(){jQuery("#wppfm-working-spinner").show();jQuery("body").css("cursor","wait")}function wppfm_hideWorkingSpinner(){jQuery("#wppfm-working-spinner").hide();jQuery("body").css("cursor","default")}function wppfm_getButtonIds(){return{"google-product-review-feed":{generate:"wpprfm-generate-review-feed-button",save:"wpprfm-save-review-feed-button"},"google-merchant-promotions-feed":{generate:"wpppfm-generate-merchant-promotions-feed-button",save:"wpppfm-save-merchant-promotions-feed-button"},"product-feed":{generate:"wppfm-generate-feed-button",save:"wppfm-save-feed-button"}}}function wppfm_enableFeedActionButtons(feedType="product-feed"){let buttonIds=wppfm_getButtonIds()[feedType];jQuery(`#${buttonIds.generate}-top`).removeClass("wppfm-disabled-button").blur();jQuery(`#${buttonIds.generate}-bottom`).removeClass("wppfm-disabled-button").blur();jQuery(`#${buttonIds.save}-top`).removeClass("wppfm-disabled-button").blur();jQuery(`#${buttonIds.save}-bottom`).removeClass("wppfm-disabled-button").blur();if(""!==jQuery("#wppfm-feed-editor-page-data-storage").data("wppfmFeedUrl")){wppfm_enableViewFeedButtons()}}function disableFeedActionButtons(feedType="product-feed"){let buttonIds=wppfm_getButtonIds()[feedType];jQuery(`#${buttonIds.generate}-top`).addClass("wppfm-disabled-button");jQuery(`#${buttonIds.generate}-bottom`).addClass("wppfm-disabled-button");jQuery(`#${buttonIds.save}-top`).addClass("wppfm-disabled-button");jQuery(`#${buttonIds.save}-bottom`).addClass("wppfm-disabled-button");wppfm_disableViewFeedButtons()}function wppfm_enableViewFeedButtons(){jQuery("#wppfm-view-feed-button-top").removeClass("wppfm-disabled-button").blur();jQuery("#wppfm-view-feed-button-bottom").removeClass("wppfm-disabled-button").blur()}function wppfm_disableViewFeedButtons(){jQuery("#wppfm-view-feed-button-top").addClass("wppfm-disabled-button");jQuery("#wppfm-view-feed-button-bottom").addClass("wppfm-disabled-button")}function wppfm_convertDtInputDateTimeToIsoDateTime(dtInputValue){const dateParts=dtInputValue.split(" ");const dateElements=dateParts[0].split("-");const timeElements=dateParts[1].split(":");return new Date(dateElements[2],dateElements[1],dateElements[0],timeElements[0],timeElements[1]).toISOString()}function wppfm_convertIsoDateTimeToDtInputDateTime(isoDateTime){const date=new Date(isoDateTime);const day=date.getDate();const month=date.getMonth();const year=date.getFullYear();const hours=(date.getHours()<10?"0":"")+date.getHours();const minutes=(date.getMinutes()<10?"0":"")+date.getMinutes();return`${day}-${month}-${year} ${hours}:${minutes}`}function wppfm_showErrorMessage(message){var errorMessageSelector=jQuery("#wppfm-error-message");errorMessageSelector.empty();errorMessageSelector.append("<p>"+message+"</p>");errorMessageSelector.show()}function wppfm_showSuccessMessage(message){var successMessageSelector=jQuery("#wppfm-success-message");successMessageSelector.empty();successMessageSelector.append("<p>"+message+"</p>");successMessageSelector.show()}function wppfm_showWarningMessage(message){var warningMessageSelector=jQuery("#wppfm-warning-message");warningMessageSelector.empty();warningMessageSelector.append("<p>"+message+"</p>");warningMessageSelector.show()}function wppfm_showChannelInfoPopup(channel_short_name){var channelInfoDataElement=jQuery("#wppfm-"+channel_short_name+"-channel-data");var name=channelInfoDataElement.data("channel-name");var status=channelInfoDataElement.data("status");var installedVersion=channelInfoDataElement.data("installed-version");var version=channelInfoDataElement.data("version");var infoLink=channelInfoDataElement.data("info-link");var specificationsLink=channelInfoDataElement.data("specifications-link");var installedVersionElement=jQuery("#wppfm-channel-info-popup__installed-version");var infoLinkElement=jQuery("#wppfm-channel-info-popup__info-link");var specificationsLinkElement=jQuery("#wppfm-channel-info-popup__feed-specifications-link");jQuery("#wppfm-channel-info-popup__name").html(name);jQuery("#wppfm-channel-info-popup__status").html("Status: "+status);if("installed"===status){installedVersionElement.html("Installed version: "+installedVersion);installedVersionElement.show()}else{installedVersionElement.hide()}jQuery("#wppfm-channel-info-popup__latest-version").html("Latest version: "+version);if(""!==infoLink){infoLinkElement.html('<a href="'+infoLink+'" target="_blank">More about selling on this channel</a>');infoLinkElement.show()}else{infoLinkElement.hide()}if(""!==specificationsLink){specificationsLinkElement.html('<a href="'+specificationsLink+'" target="_blank">Channels feed specifications</a>');specificationsLinkElement.show()}else{specificationsLinkElement.hide()}jQuery("#wppfm-channel-info-popup").show()}
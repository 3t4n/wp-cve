jQuery(function(a){let c;function o(t){var e,c;n("#wcdp-ajax-send")&&(a("#wcdp-spinner").show(),a("#wcdp-ajax-button").hide(),c=(e=a("#wcdp-ajax-send")).serialize(),a.ajax({type:"POST",url:e.attr("action"),data:c}).done(function(e){!0===e.success?(a(".woocommerce-error").remove(),a("body").trigger("update_checkout"),a("#wcdp-ajax-button").show(),a("#wcdp-spinner").hide(),e.recurring?(a("#createaccount").prop("checked",!0).trigger("change"),a(".create-account:has(#createaccount)").hide()):a(".create-account:has(#createaccount)").show(),s(t)):d(e.message,e.reload)}).fail(function(){a("#wcdp-spinner").hide(),d(a(".wcdp-choose-donation").attr("wcdp-error-default"))}))}function n(e){var t=a("#variation_id");try{return a(e)[0].reportValidity()&&(0===t.length||""!=t.attr("value"))}catch(e){}}function d(e="An unexpected error occurred. Please reload the page and try again. If the problem persists, please contact our support team.",t=!0){t||a("#wcdp-ajax-button").show(),a("#wcdp-spinner").hide(),a("#wcdp-ajax-error").remove(),a("form.checkout.woocommerce-checkout").prepend('<ul class="woocommerce-error" id="wcdp-ajax-error" role="alert"><li></li></ul>'),a("#wcdp-ajax-error li").text(e)}a("#wcdp-ajax-send").on("submit",function(e){e.preventDefault();e=a("#wcdp-ajax-send").serialize();c!=e?(c=e,o("2")):s(2)});let e=0,i=(a(".wcdp-body > #wcdp-ajax-send").on("input blur keyup paste change",function(){c!=a("#wcdp-ajax-send").serialize()&&(e++,c=a("#wcdp-ajax-send").serialize(),setTimeout(function(){0==--e&&o()},1300))}),0),r=0,p=(a(".wcdp-body").on("input blur keyup paste change load",function(){const e=document.querySelector(".wcdp-body .single_add_to_cart_button");var t=document.querySelector("#wcdp-post-send");e&&t&&t.checkValidity()?e.classList.remove("disabled"):e&&e.classList.add("disabled"),a(".wcdp-express-amount").val(a("#wcdp-donation-amount").val()),i++,setTimeout(function(){0==--i&&r!=a("#wcdp-donation-amount").val()&&(r=a("#wcdp-donation-amount").val(),a(document.body).trigger("woocommerce_variation_has_changed"),e)&&e.classList.toggle("wcdp_price_changed")},500)}),1);function s(e){var t=a(":root")[0];switch(t.style.setProperty("--wcdp-step-2","var(--wcdp-main)"),t.style.setProperty("--wcdp-step-3","var(--wcdp-main)"),e){case"3":a("#wcdp-step-2").show(),a("form.checkout").find(".input-text:visible, select:visible, input:checkbox:visible").trigger("validate"),0<a("#wcdp-step-2 .woocommerce-invalid:visible").length?(a("#wcdp-invalid-fields").show(),a("#place_order").hide()):(a("#wcdp-invalid-fields").hide(),a("#place_order").show()),t.style.setProperty("--wcdp-step-3","var(--wcdp-main-2)");case"2":t.style.setProperty("--wcdp-step-2","var(--wcdp-main-2)");break;case"1":break;default:return}a(".wcdp-style5-active").removeClass("wcdp-style5-active"),a("#wcdp-style5-step-"+e).addClass("wcdp-style5-active"),a("#wcdp-progress-bar").css("width",33.33*(parseInt(e)-1)+"%"),a(".wcdp-tab").hide(),a("#wcdp-step-"+e).show(),p=e}a(".wcdp-button,.wcdp-step").click(function(){var e,t=a(this).attr("value");1!=p?s(t):1!=t&&n("#wcdp-ajax-send")&&(e=a("#wcdp-ajax-send").serialize(),(c!=e?(c=e,o):s)(t))});let t=10;function u(){0<a("#wc-stripe-payment-request-button").children().length+a("#ppc-button, #ppc-button-ppcp-gateway").children().length?a(".wcdp-express-heading").show():t<1e4&&(t*=2,setTimeout(u,t))}a(document).ready(function(){a(".wcdp-loader").hide(),a(".wc-donation-platform").css({visibility:"visible","animation-name":"wcdp-appear-animation","animation-duration":"1s"}),h(!1);try{0!=a("#wcdp-donation-amount").val()&&a("#wcdp-ajax-send").trigger("change"),a(".wcdp-choose-donation")[0].checkValidity()&&(c=a("#wcdp-ajax-send").serialize(),o()),a(".woocommerce-checkout select").selectWoo()}finally{a("#wcdp-ajax-send,.wcdp_options").trigger("change"),setTimeout(u,t)}}),window.onhashchange=function(){h(!1)},a(".wcdp-modal-open").click(function(){h(!0)}),a(document).on("keypress","input",function(e){"Escape"==e.key&&w()}),a(".wcdp-modal-close").click(w);var l=!1;function w(){l&&(a(".wcdp-overlay").hide(),a("body").css("overflow-y"," auto"),history.pushState("",document.title,window.location.pathname+window.location.search),l=!1)}function h(e){var t=a(".wcdp-overlay");(e||"#wcdp-form"==location.hash&&0<t.length)&&(t.show(),a("body").css("overflow-y","hidden"),l=!0)}a(".wcdp_options").change(function(){var e=this.attributes["wcdp-name"].value,t=a('input[name="'+e+'"]:checked').val();t&&(a("#wcdp-"+e).val(t),(e=a("#"+e)).val(t),e.trigger("change"))}),a(document).on("change","#wcdp_fee_recovery",function(){setTimeout(function(){a("body").trigger("update_checkout")},400)}),a(document).on("change","input[name='payment_method']",function(){a("#wcdp_fee_recovery").prop("checked")&&setTimeout(function(){a("body").trigger("update_checkout")},400)}),a("#wcdp-range").on("input",function(){var e=a("#wcdp-range"),t=a("#wcdp-donation-amount");t.val(e.val()),e.val()==e.attr("max")&&t.select()}),a(".wcdp-amount-range-field").on("input",function(){a("#wcdp-range").val(a("#wcdp-donation-amount").val())}),a("#wcdp-donation-amount").on("change",function(){var e="#wcdp_value_"+a("#wcdp-donation-amount").val().replace(/./g,"-");(0==a(e).length?a("#wcdp_value_other"):a(e)).prop("checked",!0)}),a("#wcdp_value_other").click(function(){a("#wcdp-donation-amount").focus()}),a(".wcdp-choose-donation").on("change",function(){a(".wcdp_su input").each(function(){0==a("#"+this.name+' option[value="'+this.value+'"]').length?this.setAttribute("disabled","true"):this.removeAttribute("disabled")})})});

var youzify_load_attachments=!1;!function(n){"use strict";n(document).ready(function(){var a;function s(){for(var t,i,a,o=document.cookie.split(";"),e={},s=0;s<o.length;s++)t=(a=o[s]).indexOf("="),i=n.trim(unescape(a.slice(0,t))),a=unescape(a.slice(t+1)),0===i.indexOf("bp-")&&(e[i]=a);return encodeURIComponent(n.param(e))}n.youzify_google_map_init=function(){var t,a;"object"==typeof google&&"object"==typeof google.maps&&n(".youzify-activity-map-unloaded").each(function(){t=n(this),a=new google.maps.Map(t[0],{zoom:16,center:new google.maps.LatLng(50,50),panControl:!1,zoomControl:!1,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,overviewMapControl:!1,rotateControl:!1,fullscreenControl:!1,disableDefaultUI:!1,mapTypeId:google.maps.MapTypeId.ROADMAP}),new google.maps.places.PlacesService(a).getDetails({placeId:t.attr("data-place_id")},function(t,i){i===google.maps.places.PlacesServiceStatus.OK&&(i=t.geometry.location,new google.maps.Marker({position:i,map:a}),a.setCenter(i))}),t.removeClass("youzify-activity-map-unloaded").addClass("youzify-activity-map").fadeIn()})},n.youzify_google_map_init(),jQuery().viewportChecker&&(n.youzify_init_wall_posts_effect=function(){n(".youzify_effect")[0]&&n(".youzify_effect").viewportChecker({classToAdd:"animated",classToRemove:"invisible",removeClassAfterAnimation:!0,offset:"10%",callbackFunction:function(t,i){t.addClass(t.data("effect"))}},500)},n.youzify_init_wall_posts_effect(),n("#youzify div.activity")[0])&&new MutationObserver(function(t){n.youzify_init_wall_posts_effect(),n.youzify_sliders_init(),n.youzify_google_map_init(),"function"==typeof youzify_autosize&&youzify_autosize(jQuery(".youzify textarea")),n.youzify_pause_other_media_when_user_play_another_media()}).observe(n("#youzify div.activity")[0],{attributes:!1,childList:!0,subtree:!0,characterData:!1}),n(document).on("click",".youzify-trigger-who-modal",function(t){t.preventDefault();var i,a,o=n(this);o.hasClass("loading")||(o.addClass("loading"),a=!1,o.find("i").get(0)||(i=o.text(),a=!0,o.html('<i class="fas fa-spin fa-spinner"></i>')),t=n(this).closest("li.activity-item"),t={action:n(this).data("action"),post_id:t.attr("id").substr(9,t.attr("id").length)},jQuery.post(Youzify.ajax_url,t,function(t){a&&o.html(i),n.youzify_show_modal(n(t)),o.removeClass("loading")}))}),n(document).on("click",".youzify-delete-post",function(t){var i=n(this),a=i.parents("div.activity ul li"),o=a.prop("class").match(/date-recorded-([0-9]+)/);i.addClass("loading"),n.post(ajaxurl,{action:"delete_activity",cookie:s(),id:n(this).parent().attr("data-activity-id"),_wpnonce:i.attr("data-nonce")},function(t){t[0]+t[1]==="-1"?(a.prepend(t.substr(2,t.length)),a.children("#message").hide().fadeIn(300)):(a.slideUp(300),o&&activity_last_recorded===o[1]&&(newest_activities="",activity_last_recorded=0))})}),n(document).on("click",".youzify-show-tagged-users",function(t){t.preventDefault(),n(".youzify-wall-modal-overlay").fadeIn(500,function(){n(this).find(".youzify-modal-loader").fadeIn(400)});t=n(this).closest("li.activity-item"),t={action:"youzify_activity_tagged_users_modal",post_id:t.attr("id").substr(9,t.attr("id").length)};jQuery.post(Youzify.ajax_url,t,function(t){n("body").append(t).find(".youzify-wall-modal").addClass("youzify-wall-modal-show"),n(".youzify-wall-modal-overlay").find(".youzify-modal-loader").hide()})}),n(document).keyup(function(t){n(".youzify-wall-modal-show")[0]&&27===t.keyCode&&n(".youzify-wall-modal-close").trigger("click")}),n(document).mouseup(function(t){n(".youzify-wall-modal-overlay").is(t.target)&&n(".youzify-wall-modal-show")[0]&&n(".youzify-wall-modal-close").trigger("click")}),"on"==Youzify.activity_autoloader&&(a=n(window)).scroll(function(){var t,i=n("#activity-stream .load-more:visible");i.get(0)&&!i.data("youzify-autoloaded")&&(t=i.offset().top-3e3,a.scrollTop()+a.height()>t)&&(i.data("youzify-autoloaded",1),i.find("a").trigger("click"))}),n("#activity-stream").on("click",".friendship-button a",function(){n(this).parent().addClass("loading");var t=n(this).attr("id"),i=n(this).attr("href"),o=n(this);return t=(t=t.split("-"))[1],i=(i=(i=i.split("?_wpnonce="))[1].split("&"))[0],n.post(ajaxurl,{action:"addremove_friend",cookie:s(),fid:t,_wpnonce:i},function(t){var i=o.attr("rel"),a=o.parent();"add"===i?n(a).fadeOut(200,function(){a.removeClass("add_friend"),a.removeClass("loading"),a.addClass("pending_friend"),a.fadeIn(200).html(t)}):"remove"===i&&n(a).fadeOut(200,function(){a.removeClass("remove_friend"),a.removeClass("loading"),a.addClass("add"),a.fadeIn(200).html(t)})}),!1}),n("#activity-stream").on("click",".group-button a",function(t){n(this).hasClass("membership-requested")||n(this).addClass("youzify-btn-loading");var i=n(this).parent().attr("id"),a=n(this).attr("href"),e=n(this);return i=(i=i.split("-"))[1],a=(a=(a=a.split("?_wpnonce="))[1].split("&"))[0],e.hasClass("leave-group")&&!1===confirm(BP_DTheme.leave_group_confirm)||n.post(ajaxurl,{action:"joinleave_group",cookie:s(),gid:i,_wpnonce:a},function(a){var o=e.parent();n(o).fadeOut(200,function(){o.fadeIn(200).html(a);var t=n("#groups-personal span"),i=1;e.hasClass("leave-group")?(o.hasClass("hidden")&&o.closest("li").slideUp(200),i=0):e.hasClass("request-membership")&&(i=!1),t.length&&!1!==i&&(i?t.text(1+(t.text()>>0)):t.text((t.text()>>0)-1))})}),!1}),n.youzify_pause_other_media_when_user_play_another_media=function(){n("audio,video").on("play",function(t){n("audio,video").not(this).each(function(t,i){i.pause()}),n("iframe").each(function(t,i){n(i).attr("src",n(i).attr("src"))})})},n.youzify_pause_other_media_when_user_play_another_media(),n(document).on("click",".nice-select .option",function(t){n(this).parent().prev(".current").attr("data-value",n(this).attr("data-value"))}),n(".activity-list").on("click","li.load-more",function(t){var i,a;if(n(this).closest(".youzify-activity-shortcode")[0])return t.stopImmediatePropagation(),(i=n(this)).addClass("loading"),(t=n(this).parents(".youzify-activity-shortcode")).attr("data-page",parseInt(t.attr("data-page"))+1),(a=t.data()).page=t.attr("data-page"),n.post(ajaxurl,{data:a,action:"youzify_activity_load_activities"},function(t){t.success&&(i.hide(),t=n(t.data),i.parents("ul.activity-list").append(t),bp_legacy_theme_hide_comments(t))},"json"),!1}),n(document).on("click",".activity-item .youzify-show-item-tools",function(t){var i=n(this),a=i.closest("li.activity-item"),o=i.find("i").attr("class");i.hasClass("loaded")?a.find(".youzify-activity-tools").fadeToggle():i.hasClass("loading")||(i.addClass("loading"),i.find("i").attr("class","fas fa-spin fa-spinner"),n.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{activity_id:a.attr("id").substr(9,a.attr("id").length),action:"youzify_get_activity_tools"},success:function(t){i.find("i").attr("class",o),i.addClass("loaded"),i.removeClass("loading"),t.success&&n(t.data).prependTo(a).fadeIn(),n(t.data).find(".youzify-pin-tool").get(0)&&n("<script/>",{rel:"text/javascript",src:Youzify.assets+"js/youzify-sticky-posts.min.js"}).appendTo("head"),n(t.data).find(".youzify-bookmark-tool").get(0)&&n("<script/>",{rel:"text/javascript",src:Youzify.assets+"js/youzify-bookmark-posts.min.js"}).appendTo("head")}}))}),n(".youzify-activity-show-search-form").on("click",function(t){t.preventDefault();var i=n(this);i.closest("ul").find("#activity-filter-select .youzify-dropdown-area").fadeOut(1,function(){i.closest("li").find(".youzify-dropdown-area").fadeToggle(),i.closest("li").find("input").focus()})}),n(".youzify-activity-show-filter").on("click",function(t){t.preventDefault();var i=n(this);i.closest("ul").find(".youzify-activity-show-search .youzify-dropdown-area").fadeOut(1,function(){i.closest("li").find(".youzify-dropdown-area").fadeToggle()})}),n(".youzify-show-activity-search").on("click",function(t){t.preventDefault();var t=n(this).parents("#youzify"),i=t.find(".youzify-activity-show-search .youzify-dropdown-area");t.find("#activity-filter-select .youzify-dropdown-area, .activity-type-tabs").fadeOut(),i.fadeToggle(),i.find("input").focus()}),n(".youzify-show-activity-filter").on("click",function(t){t.preventDefault();t=n(this).parents("#youzify");t.find(".youzify-activity-show-search .youzify-dropdown-area, .activity-type-tabs").fadeOut(),t.find("#activity-filter-select .youzify-dropdown-area").fadeToggle()}),n(".youzify-show-activity-menu").on("click",function(t){t.preventDefault();t=n(this).parents("#youzify");t.find("#subnav .youzify-dropdown-area").fadeOut(),t.find(".activity-type-tabs").fadeToggle()}),n(".activity_share").on("click",".activity-read-more a",function(t){var i=n(this);return i.addClass("loading"),n.post(ajaxurl,{action:"get_single_activity_content",activity_id:i.parent().attr("id").split("-")[3]},function(t){i.closest(".activity-inner").slideUp(300).html(t).slideDown(300)}),!1}),n(document).on("click",".youzify-wall-modal-close",function(t){t.preventDefault(),n(".youzify-wall-modal").removeClass("youzify-wall-modal-show"),n(".youzify-wall-modal-overlay").fadeOut(600),setTimeout(function(){n(".youzify-wall-modal").remove()},500)}),n(document).on("click",".youzify-see-poll-results",function(){var i=n(this).closest(".youzify-poll-content");n(this).find("i").attr("class","fas fa-spinner fa-spin"),n.ajax({url:ajaxurl,type:"POST",data:{action:"youzify_activity_result_content",activity_id:i.attr("data-activity-id")},success:function(t){i.find(".youzify-poll-holder").html(n(t.data))}})}),n(document).on("click",".youzify-see-standard-poll-options",function(){var i=n(this).closest(".youzify-poll-content");n(this).find("i").attr("class","fas fa-spinner fa-spin"),n.ajax({url:ajaxurl,type:"POST",data:{action:"youzify_activity_revote_content",activity_id:i.attr("data-activity-id")},success:function(t){i.find(".youzify-poll-holder").html(n(t.data).find(".youzify-poll-options-holder"))}})}),n(document).on("click",".youzify-submit-vote",function(){var i,a,o=n(this),e=n(this).closest(".youzify-poll-content");o.hasClass("yz-loading")||(n(this).hasClass("youzify-disable-vote")?n.youzify_DialogMsg("error",Youzify.poll_option_empty):(i=[],e.find('input[name="youzify_poll_option[]"]:checked').each(function(t){i[t]=n(this).val()}),a=n(this).html(),n.ajax({url:ajaxurl,type:"POST",data:{action:"youzify_activity_poll_new_vote",voting_options:i,activity_id:e.attr("data-activity-id")},beforeSend:function(){o.addClass("yz-loading"),o.html('<i class="fas fa-spin fa-spinner"></i>')},success:function(t){o.removeClass("yz-loading"),o.html(a),t.success?("off"==o.attr("data-revote")&&(e.find(".youzify-poll-item-input").prop("disabled",!0),o.remove()),t.data.result?n.youzify_DialogMsg("success",t.data.msg):e.find(".youzify-poll-holder").html(n(t.data))):n.youzify_DialogMsg("error",t.data)}})))}),n(document).on("click",".youzify-poll-item-input",function(){var t=n(this).closest(".youzify-poll-options-holder");0<t.find(".youzify-poll-item-input:checked").length?t.find(".youzify-disable-vote").removeClass("youzify-disable-vote"):0==t.find(".youzify-poll-item-input:checked").length&&t.find(".youzify-submit-vote").addClass("youzify-disable-vote")}),n(document).on("click",".youzify-show-voters",function(){var i=n(this).closest(".youzify-poll-content"),a=n(this),o=a.html();a.html('<i class="fas fa-spinner fa-spin"></i>'),n.ajax({url:ajaxurl,type:"POST",data:{action:"youzify_activity_all_voters",activity_id:i.attr("data-activity-id"),option_id:n(this).attr("data-option-id")},success:function(t){a.html(o),i.find(".youzify-poll-holder").append(n(t.data))}})})})}(jQuery);
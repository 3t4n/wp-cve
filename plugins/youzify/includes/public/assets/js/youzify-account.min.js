!function(n){"use strict";n(document).ready(function(){jQuery().niceSelect&&n(".youzify select").not('[multiple="multiple"]').niceSelect(),n(document).on("click",".youzify-upload-photo",function(o){o.preventDefault();var e=n(this).closest(".youzify-uploader-item");e.find(".youzify_upload_file").attr("data-source",n("input[name=youzify_widget_source]").val()),e.find(".youzify_upload_file").attr("data-user-id",n("input[name=youzify_widget_user_id]").val()),e.find(".youzify_upload_file").trigger("click")}),n(document).on("change",".youzify_upload_file",function(o){o.stopPropagation();var e=new FormData,i=n(this),t=n(this).closest(".youzify-uploader-item"),a=t.find(".youzify-photo-preview"),u=t.find(".youzify-photo-url").val();e.append("nonce",n(this).closest("form").find("input[name='security']").val()),e.append("file",n(this)[0].files[0]),e.append("user_id",n(this).attr("data-user-id")),e.append("source",n(this).attr("data-source")),e.append("action","upload_files"),n.ajax({url:Youzify.ajax_url,type:"POST",data:e,contentType:!1,cache:!1,processData:!1,beforeSend:function(){n('<div class="youzify-load-photo"><i class="fas fa-spinner fa-spin"></i></div>').hide().appendTo(a).fadeIn(800)},success:function(o){if(i.val(""),0==o.success)return a.find(".youzify-load-photo").fadeOut(300).remove(),void n.youzify_DialogMsg("error",o.data.error);u&&n.youzify_DeletePhoto(u),a.find(".youzify-load-photo").fadeOut(300,function(){n(this).remove(),a.fadeOut(100,function(){n(this).css("background-image","url("+o.data.url+")").fadeIn(400),t.find(".youzify-photo-url").val(o.data.attachment_id).change(),t.find(".youzify-delete-photo").addClass("youzify-show-trash"),n.post(Youzify.ajax_url,t.closest("form").serialize()+"&die=true")})})}})}),n(".youzify-account-menu").on("click",function(o){var e=n(this).next(".youzify-account-menus");e.hasClass("youzify-show-account-menus")&&e.removeClass("youzify-show-account-menus").css("display","block"),n(this).next(".youzify-account-menus").slideToggle()}),n(document).on("click",".youzify-delete-photo",function(o){var e=n(this).closest(".youzify-uploader-item");n.youzify_DeletePhoto(e.find(".youzify-photo-url").val()),e.find(".youzify-photo-url").val("").trigger("change"),e.find(".youzify-photo-preview").css("background-image","url("+Youzify_Account.default_img+")"),n(this).removeClass("youzify-show-trash"),n.post(Youzify.ajax_url,e.closest("form").serialize()+"&die=true")}),n.youzify_DeletePhoto=function(o){var e=new FormData;e.append("attachment_id",o),e.append("action","youzify_delete_attachment"),n.ajax({type:"POST",data:e,url:Youzify.ajax_url,contentType:!1,processData:!1})},n(".youzify-account-photo .youzify-photo-url").on("change",function(o){o.preventDefault();var e=n(this).val();e||(e=Youzify_Account.default_img),n(".youzify-account-img").fadeOut(200,function(){n(this).css("background-image","url("+e+")").fadeIn(200)})}),n(".youzify-user-provider-unlink").on("click",function(o){if(o.preventDefault(),n(this).hasClass("loading"))return!1;var i=n(this).closest(".youzify-user-provider-connected"),t=n(this);t.addClass("loading");var e={action:"youzify_unlink_provider_account",provider:n(this).data("provider"),security:n(this).data("nonce")};n.post(ajaxurl,e,function(o){var e=n.parseJSON(o);return e.error?(t.removeClass("loading"),n.youzify_DialogMsg("error",e.error),!1):e.action?(t.removeClass("loading"),i.find(".youzify-user-provider-token").val(""),i.find(".youzify-user-provider-box").remove(),i.removeClass().addClass("youzify-user-provider-unconnected"),n.youzify_DialogMsg("success",e.msg),!1):void 0}).fail(function(o,e,i){return t.removeClass("loading"),n.youzify_DialogMsg("error",Youzify.unknown_error),!1})})})}(jQuery);
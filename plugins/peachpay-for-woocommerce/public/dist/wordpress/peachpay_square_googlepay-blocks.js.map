{"version":3,"file":"peachpay_square_googlepay-blocks.js","mappings":"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","sources":["webpack://peachpay-for-woocommerce/./core/blocks/src/currency-fallback.tsx","webpack://peachpay-for-woocommerce/./core/payments/square/blocks/src/currency.ts","webpack://peachpay-for-woocommerce/./core/payments/square/blocks/src/payment-request.ts","webpack://peachpay-for-woocommerce/./frontend/@shared/ts/currency.ts","webpack://peachpay-for-woocommerce/./frontend/@shared/ts/error.ts","webpack://peachpay-for-woocommerce/external window \"React\"","webpack://peachpay-for-woocommerce/external window \"regeneratorRuntime\"","webpack://peachpay-for-woocommerce/external window [\"peachpay_checkout_blocks\"]","webpack://peachpay-for-woocommerce/external window [\"wc\",\"wcBlocksRegistry\"]","webpack://peachpay-for-woocommerce/external window [\"wc\",\"wcSettings\"]","webpack://peachpay-for-woocommerce/external window [\"wp\",\"element\"]","webpack://peachpay-for-woocommerce/external window [\"wp\",\"htmlEntities\"]","webpack://peachpay-for-woocommerce/external window [\"wp\",\"i18n\"]","webpack://peachpay-for-woocommerce/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://peachpay-for-woocommerce/webpack/bootstrap","webpack://peachpay-for-woocommerce/webpack/runtime/compat get default export","webpack://peachpay-for-woocommerce/webpack/runtime/define property getters","webpack://peachpay-for-woocommerce/webpack/runtime/hasOwnProperty shorthand","webpack://peachpay-for-woocommerce/./core/payments/square/blocks/src/googlepay/index.tsx"],"sourcesContent":["import {peachpayUpdateCurrencyCookie} from '../../../frontend/@shared/ts/currency';\nimport {__} from '@wordpress/i18n';\n\nexport default function CurrencyFallback(props: {name: string; currency: string | null}) {\n\tfunction changeCurrency() {\n\t\tif (!props.currency) {\n\t\t\treturn;\n\t\t}\n\n\t\tpeachpayUpdateCurrencyCookie(props.currency);\n\t\twindow.location.reload();\n\t}\n\n\treturn props.currency ? (\n\t\t<div style={{display: 'flex', flexDirection: 'column'}}>\n\t\t\t<p style={{textAlign: 'justify', margin: '0.5rem 0 0', fontSize: 'smaller'}}>\n\t\t\t\t{props.name} {__('does not support the currency you currently have chosen.', 'peachpay-for-woocommerce')} <b>{__('Update to', 'peachpay-for-woocommerce')} {props.currency}</b> {__('below to use this payment method.', 'peachpay-for-woocommerce')}\n\t\t\t</p>\n\t\t\t<button type='button' className='button currency-fallback-button' style={{fontSize: 'smaller', marginBottom: '16px'}}\n\t\t\t\tonClick={changeCurrency}\n\t\t\t>{__('Update to', 'peachpay-for-woocommerce')} {props.currency}</button>\n\t\t</div>\n\t) : null;\n}\n","const SUPPORTED_ZERO_DECIMAL_CURRENCIES = [\n\t'BIF',\n\t'CLP',\n\t'DJF',\n\t'GNF',\n\t'JPY',\n\t'KMF',\n\t'KRW',\n\t'MGA',\n\t'PYG',\n\t'RWF',\n\t'UGX',\n\t'VND',\n\t'VUV',\n\t'XAF',\n\t'XOF',\n\t'XPF',\n];\n\n/**\n * Formats a WC amount to an amount expected by Square. WC blocks amounts are\n * formatted as the smallest unit(Ex: cents for USD) but square expects dollars.\n *\n * @param amount - The amount to format.\n * @param tax - The tax amount to add to the total.\n * @param currency - The currency code.\n * @param includeTax - Whether prices are displayed including tax.\n *\n * @returns The formatted amount as a string expected by Square.\n */\nfunction formatAmount(amount: string, tax: string, currency: string, includeTax = false): string {\n\tlet parsedAmount = Number.parseInt(amount);\n\n\tconst parsedTax = Number.parseInt(tax);\n\tif (includeTax) {\n\t\tparsedAmount += parsedTax;\n\t}\n\n\tif (!SUPPORTED_ZERO_DECIMAL_CURRENCIES.includes(currency)) {\n\t\tparsedAmount /= 100;\n\t}\n\n\treturn parsedAmount.toFixed(2);\n}\n\nexport {\n\tformatAmount,\n};\n","import {type LineItem, type PaymentRequestOptions} from '@square/web-payments-sdk-types';\nimport {type PreparedCartTotalItem, type CartItem} from '@woocommerce/types';\nimport {formatAmount} from './currency';\n\ntype CorrectedPreparedCartTotalItem = PreparedCartTotalItem & {key?: string; valueWithTax: number};\n\ntype WooCommerceBlocksData = {\n\tmerchantCountry: string;\n\tcurrency: string;\n\titems: CartItem[];\n\tsummary: PreparedCartTotalItem[];\n\ttotal: PreparedCartTotalItem;\n\tdisplayPricesIncludingTax: boolean;\n};\n\nfunction buildOptions(options: WooCommerceBlocksData): PaymentRequestOptions {\n\treturn {\n\t\tcountryCode: options.merchantCountry,\n\t\tcurrencyCode: options.currency,\n\t\tlineItems: lineItems(options),\n\t\tdiscounts: discounts(options),\n\t\ttaxLineItems: taxLineItems(options),\n\t\tshippingLineItems: shippingLineItems(options),\n\t\ttotal: total(options),\n\t\trequestBillingContact: false,\n\t\trequestShippingContact: false,\n\t};\n}\n\nfunction lineItems(options: WooCommerceBlocksData): LineItem[] {\n\tconst lineItems = new Array<LineItem>();\n\n\tfor (const cartItem of options.items) {\n\t\tlineItems.push({\n\t\t\tid: cartItem.sku,\n\t\t\tlabel: cartItem.name + ' × ' + cartItem.quantity,\n\t\t\tamount: formatAmount(\n\t\t\t\tcartItem.totals.line_subtotal,\n\t\t\t\tcartItem.totals.line_subtotal_tax,\n\t\t\t\tcartItem.totals.currency_code,\n\t\t\t\toptions.displayPricesIncludingTax,\n\t\t\t),\n\t\t});\n\t}\n\n\treturn lineItems;\n}\n\nfunction discounts(options: WooCommerceBlocksData): LineItem[] {\n\tconst discounts = new Array<LineItem>();\n\n\tfor (const lineTotal of options.summary as CorrectedPreparedCartTotalItem[]) {\n\t\tif (lineTotal['key'] !== 'total_discount') {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (lineTotal.value === 0) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst amount = String(options.displayPricesIncludingTax ? lineTotal.valueWithTax : lineTotal.value);\n\t\tconst tax = '0';\n\n\t\tdiscounts.push({\n\t\t\tlabel: lineTotal.label,\n\t\t\tamount: formatAmount(amount, tax, options.currency),\n\t\t});\n\t}\n\n\treturn discounts;\n}\n\nfunction taxLineItems(options: WooCommerceBlocksData): LineItem[] {\n\tconst taxLineItems = new Array<LineItem>();\n\n\tfor (const lineTotal of options.summary as CorrectedPreparedCartTotalItem[]) {\n\t\tif (lineTotal['key'] !== 'total_tax') {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (lineTotal.value === 0) {\n\t\t\tcontinue;\n\t\t}\n\n\t\ttaxLineItems.push({\n\t\t\tlabel: lineTotal.label,\n\t\t\tamount: formatAmount(String(lineTotal.value), '0', options.currency),\n\t\t});\n\t}\n\n\treturn taxLineItems;\n}\n\nfunction shippingLineItems(options: WooCommerceBlocksData): LineItem[] {\n\tconst shippingLineItems = new Array<LineItem>();\n\n\tfor (const lineTotal of options.summary as CorrectedPreparedCartTotalItem[]) {\n\t\tif (lineTotal['key'] !== 'total_shipping') {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (lineTotal.value === 0) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tshippingLineItems.push({\n\t\t\tlabel: lineTotal.label,\n\t\t\tamount: formatAmount(String(lineTotal.value), '0', options.currency),\n\t\t});\n\t}\n\n\treturn shippingLineItems;\n}\n\nfunction total(options: WooCommerceBlocksData): LineItem {\n\treturn {\n\t\tlabel: options.total.label,\n\t\tamount: formatAmount(String(options.total.value), '0', options.currency),\n\t};\n}\n\nexport {\n\tbuildOptions,\n};\n","function peachpayUpdateCurrencyCookie(newCurrency: string) {\n\tdocument.cookie = `pp_active_currency=${newCurrency};path=/`;\n}\n\nexport {peachpayUpdateCurrencyCookie};\n","/**\n * Gets a stringified error or if the stringified result is an empy string or empty object the default .toString() is used.\n * Created because JSON.stringify(error) will return {} for Error objects (https://stackoverflow.com/a/50738205/16998523).\n *\n * @param {unknown} error\n */\nexport function getErrorString(error: unknown): string {\n\tif (error instanceof Error && error.stack) {\n\t\treturn error.stack;\n\t}\n\n\tconst errorString = JSON.stringify(error);\n\treturn errorString && errorString !== '{}' ? errorString : `${error as string}`;\n}\n\n/**\n * Takes an unknown value and coerces it into an error and finally returns the error message string\n */\nexport function getErrorMessage(thrownError: unknown) {\n\treturn _toErrorWithMessage(thrownError).message;\n}\n\nfunction _toErrorWithMessage(thrownError: unknown): {message: string} {\n\tif (_isErrorWithMessage(thrownError)) {\n\t\treturn thrownError;\n\t}\n\n\ttry {\n\t\treturn new Error(JSON.stringify(thrownError));\n\t} catch {\n\t\treturn new Error(String(thrownError));\n\t}\n}\n\nfunction _isErrorWithMessage(thrownError: unknown): thrownError is {message: string} {\n\treturn (\n\t\ttypeof thrownError === 'object'\n    && thrownError !== null\n    && 'message' in thrownError\n    && typeof thrownError.message === 'string'\n\t);\n}\n","module.exports = window[\"React\"];","module.exports = window[\"regeneratorRuntime\"];","module.exports = window[\"peachpay_checkout_blocks\"];","module.exports = window[\"wc\"][\"wcBlocksRegistry\"];","module.exports = window[\"wc\"][\"wcSettings\"];","module.exports = window[\"wp\"][\"element\"];","module.exports = window[\"wp\"][\"htmlEntities\"];","module.exports = window[\"wp\"][\"i18n\"];","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n      args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n      _next(undefined);\n    });\n  };\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","import {__} from '@wordpress/i18n';\nimport {registerPaymentMethod} from '@woocommerce/blocks-registry';\nimport {getSetting} from '@woocommerce/settings';\nimport {decodeEntities} from '@wordpress/html-entities';\nimport {useEffect, useRef} from '@wordpress/element';\nimport {type PaymentMethodInterface} from '@woocommerce/types';\nimport {type CheckoutAfterProcessingWithErrorEventData} from '@woocommerce/checkout';\nimport {type TokenResult, type Payments, type GooglePay, type PaymentRequest} from '@square/web-payments-sdk-types';\nimport {startTransaction, updateTransaction, z} from '@peachpay/checkout-blocks';\nimport {getErrorString} from '../../../../../../frontend/@shared/ts/error';\nimport CurrencyFallback from '../../../../../blocks/src/currency-fallback';\nimport {buildOptions} from '../payment-request';\n\nconst SettingsSchema = z.object({\n\ticon: z.string(),\n\ttitle: z.string(),\n\tdescription: z.string(),\n\tfallback_currency: z.string().nullable(),\n\tsupports: z.string().array(),\n\tsquare: z.object({\n\t\tapplication_id: z.string(),\n\t\tlocation_id: z.string(),\n\t\tcountry_code: z.string(),\n\t}),\n});\n\nconst parsedResult = SettingsSchema.safeParse(getSetting('peachpay_square_googlepay_data'));\nif (!parsedResult.success) {\n\tthrow new Error(`Payment method \"peachpay_square_googlepay\" setup aborted. Invalid settings.\\n\\n${parsedResult.error.message}`);\n}\n\nconst settings = parsedResult.data;\nconst title = decodeEntities(settings.title);\nconst description = decodeEntities(settings.description);\n\nif (!window.Square) {\n\tthrow new Error('Payment method \"peachpay_square_googlepay\" setup aborted. Square SDK not loaded.');\n}\n\nlet payments: Payments;\ntry {\n\tpayments = window.Square.payments(settings.square.application_id, settings.square.location_id);\n} catch (err) {\n\tthrow new Error(`Payment method \"peachpay_square_googlepay\" setup aborted. Could not create Payments instance.\\n\\n${getErrorString(err)}`);\n}\n\n/**\n * Component to render the payment method label\n */\nfunction Label(props: PaymentMethodInterface) {\n\tconst {PaymentMethodLabel, PaymentMethodIcons} = props.components;\n\treturn (\n\t\t<>\n\t\t\t<PaymentMethodLabel text={title} />\n\t\t\t<PaymentMethodIcons className='pp-label-icon' icons={[{\n\t\t\t\tid: 'peachpay_square_googlepay',\n\t\t\t\tsrc: settings.icon,\n\t\t\t\talt: title,\n\t\t\t}]} />\n\t\t</>\n\t);\n}\n\n/**\n * Component to render the googlepay body.\n */\nfunction Content({billing, cartData, eventRegistration, emitResponse}: PaymentMethodInterface) {\n\tconst {\n\t\tonPaymentSetup,\n\t\tonCheckoutFail,\n\t} = eventRegistration;\n\n\tconst paymentRequestRef = useRef<PaymentRequest | null>(null);\n\tconst googlePayRef = useRef<GooglePay | null>(null);\n\n\t/**\n\t * Setup the Square PaymentRequest and GooglePay instance. This is only done\n     * once on component mount.\n\t */\n\tuseEffect(() => {\n\t\tconst setupGooglePay = async () => {\n\t\t\tpaymentRequestRef.current = payments.paymentRequest(buildOptions({\n\t\t\t\tmerchantCountry: settings.square.country_code,\n\t\t\t\tcurrency: billing.currency.code,\n\t\t\t\titems: cartData.cartItems,\n\t\t\t\tsummary: billing.cartTotalItems,\n\t\t\t\ttotal: billing.cartTotal,\n\t\t\t\tdisplayPricesIncludingTax: billing.displayPricesIncludingTax,\n\t\t\t}));\n\n\t\t\tgooglePayRef.current = await payments.googlePay(paymentRequestRef.current);\n\t\t};\n\n\t\tsetupGooglePay()\n\t\t\t.catch(console.error);\n\n\t\treturn () => {\n\t\t\tgooglePayRef.current?.destroy()\n\t\t\t\t.catch(console.error);\n\t\t};\n\t}, []);\n\n\t/**\n     * Make sure the Payment request object stays up to date so the google pay\n     * sheet displays the correct information to the customer.\n     */\n\tuseEffect(() => {\n\t\tpaymentRequestRef.current?.update(buildOptions({\n\t\t\tmerchantCountry: settings.square.country_code,\n\t\t\tcurrency: billing.currency.code,\n\t\t\titems: cartData.cartItems,\n\t\t\tsummary: billing.cartTotalItems,\n\t\t\ttotal: billing.cartTotal,\n\t\t\tdisplayPricesIncludingTax: billing.displayPricesIncludingTax,\n\t\t}));\n\t}, [\n\t\tcartData.cartItems,\n\t\tbilling.currency.code,\n\t\tbilling.cartTotalItems,\n\t\tbilling.cartTotal,\n\t\tbilling.displayPricesIncludingTax,\n\t]);\n\n\t/**\n\t * Handle payment tokenization right before the order is submitted.\n\t */\n\tuseEffect(() => onPaymentSetup(async () => {\n\t\tconst {result: transactionId, error} = await startTransaction('peachpay_square_googlepay');\n\t\tif (error || !transactionId) {\n\t\t\treturn {\n\t\t\t\ttype: emitResponse.responseTypes.ERROR,\n\t\t\t\tmessage: getErrorString(error) ?? __('An unknown error occured while creating the transaction.', 'peachpay-for-woocommerce'),\n\t\t\t};\n\t\t}\n\n\t\tif (!googlePayRef.current) {\n\t\t\tconst note = __('Missing ref to Square Google Pay element. Please try again or use a different payment method.', 'peachpay-for-woocommerce');\n\n\t\t\tawait updateTransaction(transactionId, {note, paymentStatus: 'creationfailed'});\n\t\t\treturn {\n\t\t\t\ttype: emitResponse.responseTypes.ERROR,\n\t\t\t\tmessage: note,\n\t\t\t};\n\t\t}\n\n\t\tlet tokenResult: TokenResult | null = null;\n\t\ttry {\n\t\t\ttokenResult = await googlePayRef.current.tokenize();\n\t\t\tif (tokenResult.status !== 'OK' || !tokenResult.token) {\n\t\t\t\tlet note = (tokenResult.errors\n\t\t\t\t\t?.map(err => err.message)\n\t\t\t\t\t?.join('<br/>')\n\t\t\t\t\t\t?? __('Google Pay tokenization failed. Please try again or use a different payment method.', 'peachpay-for-woocommerce')\n\t\t\t\t);\n\n\t\t\t\tif (tokenResult.status === 'Cancel') {\n\t\t\t\t\tnote = __('Payment was cancelled', 'peachpay-for-woocommerce');\n\t\t\t\t}\n\n\t\t\t\tawait updateTransaction(transactionId, {note, paymentStatus: 'creationfailed'});\n\t\t\t\treturn {\n\t\t\t\t\ttype: emitResponse.responseTypes.ERROR,\n\t\t\t\t\tmessage: note,\n\t\t\t\t};\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tconst note = getErrorString(err);\n\t\t\tawait updateTransaction(transactionId, {note, paymentStatus: 'creationfailed'});\n\t\t\treturn {\n\t\t\t\ttype: emitResponse.responseTypes.ERROR,\n\t\t\t\tmessage: note,\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\ttype: emitResponse.responseTypes.SUCCESS,\n\t\t\tmeta: {\n\t\t\t\tpaymentMethodData: {\n\t\t\t\t\tpeachpay_transaction_id: transactionId,\n\t\t\t\t\tpeachpay_square_source_id: tokenResult.token,\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}), [onPaymentSetup]);\n\n\t/**\n\t * Handle checkout failure after the order was submitted. Failure may or may\n\t * not be payment related.\n\t */\n\tuseEffect(() => onCheckoutFail(async (data: CheckoutAfterProcessingWithErrorEventData) => ({\n\t\ttype: emitResponse.responseTypes.ERROR,\n\t\tmessage: (data.processingResponse?.paymentDetails?.['message']) ?? __('An unknown error occured while processing the payment.', 'peachpay-for-woocommerce'),\n\t\tmessageContext: emitResponse.noticeContexts.PAYMENTS,\n\t})), [onCheckoutFail]);\n\n\t/**\n\t * If the payment method does not support the current currency we will show\n\t * a fallback button to allow changing the currency.\n\t *\n\t * Note: Due to how our currency switcher works the `fallback_currency` setting\n\t * is only defined when the payment does not support the current currency and\n\t * does not change after page load.\n\t */\n\tif (settings.fallback_currency) {\n\t\treturn <CurrencyFallback name={title} currency={settings.fallback_currency} />;\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<img style={{maxHeight: '25px'}} src={settings.icon}></img>\n\t\t\t<p style={{textAlign: 'left', margin: '0.5rem 0 0'}} >{title} {__('selected for checkout.', 'peachpay-for-woocommerce')}</p>\n\t\t\t<hr style={{margin: '0.5rem 0'}}/>\n\t\t\t<p style={{textAlign: 'left', margin: '0', fontSize: 'smaller'}}>{description}</p>\n\t\t</>\n\t);\n}\n\nregisterPaymentMethod({\n\tname: 'peachpay_square_googlepay',\n\tariaLabel: title,\n\tcanMakePayment(data) {\n\t\treturn data.paymentMethods.includes('peachpay_square_googlepay');\n\t},\n\t// @ts-expect-error WC will clone these components and pass the props when used.\n\tlabel: <Label />,\n\t// @ts-expect-error WC will clone these components and pass the props when used.\n\tcontent: <Content />,\n\t// @ts-expect-error WC will clone these components and pass the props when used.\n\tedit: <Content />,\n\tsupports: {\n\t\tfeatures: settings.supports,\n\t},\n});\n"],"names":["CurrencyFallback","props","currency","createElement","style","display","flexDirection","textAlign","margin","fontSize","name","__","type","className","marginBottom","onClick","peachpayUpdateCurrencyCookie","window","location","reload","SUPPORTED_ZERO_DECIMAL_CURRENCIES","formatAmount","amount","tax","includeTax","arguments","length","undefined","parsedAmount","Number","parseInt","parsedTax","includes","toFixed","buildOptions","options","countryCode","merchantCountry","currencyCode","lineItems","discounts","taxLineItems","shippingLineItems","total","requestBillingContact","requestShippingContact","_step","Array","_iterator","_createForOfIteratorHelper","items","s","n","done","cartItem","value","push","id","sku","label","quantity","totals","line_subtotal","line_subtotal_tax","currency_code","displayPricesIncludingTax","err","e","f","_i","_arr","summary","lineTotal","String","valueWithTax","_i2","_arr2","_i3","_arr3","newCurrency","document","cookie","getErrorString","error","Error","stack","errorString","JSON","stringify","module","exports","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","Promise","then","_asyncToGenerator","fn","self","this","args","apply","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","__esModule","d","a","definition","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","parsedResult","z","object","icon","string","title","description","fallback_currency","nullable","supports","array","square","application_id","location_id","country_code","safeParse","getSetting","success","message","payments","settings","data","decodeEntities","Square","Content","_ref","billing","cartData","eventRegistration","emitResponse","onPaymentSetup","onCheckoutFail","paymentRequestRef","useRef","googlePayRef","useEffect","setupGooglePay","_ref2","_regeneratorRuntime","_callee","_context","prev","next","current","paymentRequest","code","cartItems","cartTotalItems","cartTotal","googlePay","sent","stop","catch","console","_googlePayRef$current","destroy","_paymentRequestRef$cu","update","_callee2","_yield$startTransacti","transactionId","_getErrorString","note","tokenResult","_tokenResult$errors$m","_tokenResult$errors","_note","_note2","_context2","startTransaction","result","abrupt","responseTypes","ERROR","updateTransaction","paymentStatus","tokenize","status","token","errors","map","join","t0","SUCCESS","meta","paymentMethodData","peachpay_transaction_id","peachpay_square_source_id","_ref4","_callee3","_data$processingRespo","_data$processingRespo2","_context3","processingResponse","paymentDetails","messageContext","noticeContexts","PAYMENTS","_x","Fragment","maxHeight","src","registerPaymentMethod","ariaLabel","canMakePayment","paymentMethods","_props$components","components","PaymentMethodLabel","PaymentMethodIcons","text","icons","alt","content","edit","features"],"sourceRoot":""}
{"version":3,"file":"peachpay_square_card-blocks.js","mappings":"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","sources":["webpack://peachpay-for-woocommerce/./core/blocks/src/currency-fallback.tsx","webpack://peachpay-for-woocommerce/./frontend/@shared/ts/currency.ts","webpack://peachpay-for-woocommerce/./frontend/@shared/ts/error.ts","webpack://peachpay-for-woocommerce/external window \"React\"","webpack://peachpay-for-woocommerce/external window \"regeneratorRuntime\"","webpack://peachpay-for-woocommerce/external window [\"peachpay_checkout_blocks\"]","webpack://peachpay-for-woocommerce/external window [\"wc\",\"wcBlocksRegistry\"]","webpack://peachpay-for-woocommerce/external window [\"wc\",\"wcSettings\"]","webpack://peachpay-for-woocommerce/external window [\"wp\",\"element\"]","webpack://peachpay-for-woocommerce/external window [\"wp\",\"htmlEntities\"]","webpack://peachpay-for-woocommerce/external window [\"wp\",\"i18n\"]","webpack://peachpay-for-woocommerce/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://peachpay-for-woocommerce/webpack/bootstrap","webpack://peachpay-for-woocommerce/webpack/runtime/compat get default export","webpack://peachpay-for-woocommerce/webpack/runtime/define property getters","webpack://peachpay-for-woocommerce/webpack/runtime/hasOwnProperty shorthand","webpack://peachpay-for-woocommerce/./core/payments/square/blocks/src/card/index.tsx"],"sourcesContent":["import {peachpayUpdateCurrencyCookie} from '../../../frontend/@shared/ts/currency';\nimport {__} from '@wordpress/i18n';\n\nexport default function CurrencyFallback(props: {name: string; currency: string | null}) {\n\tfunction changeCurrency() {\n\t\tif (!props.currency) {\n\t\t\treturn;\n\t\t}\n\n\t\tpeachpayUpdateCurrencyCookie(props.currency);\n\t\twindow.location.reload();\n\t}\n\n\treturn props.currency ? (\n\t\t<div style={{display: 'flex', flexDirection: 'column'}}>\n\t\t\t<p style={{textAlign: 'justify', margin: '0.5rem 0 0', fontSize: 'smaller'}}>\n\t\t\t\t{props.name} {__('does not support the currency you currently have chosen.', 'peachpay-for-woocommerce')} <b>{__('Update to', 'peachpay-for-woocommerce')} {props.currency}</b> {__('below to use this payment method.', 'peachpay-for-woocommerce')}\n\t\t\t</p>\n\t\t\t<button type='button' className='button currency-fallback-button' style={{fontSize: 'smaller', marginBottom: '16px'}}\n\t\t\t\tonClick={changeCurrency}\n\t\t\t>{__('Update to', 'peachpay-for-woocommerce')} {props.currency}</button>\n\t\t</div>\n\t) : null;\n}\n","function peachpayUpdateCurrencyCookie(newCurrency: string) {\n\tdocument.cookie = `pp_active_currency=${newCurrency};path=/`;\n}\n\nexport {peachpayUpdateCurrencyCookie};\n","/**\n * Gets a stringified error or if the stringified result is an empy string or empty object the default .toString() is used.\n * Created because JSON.stringify(error) will return {} for Error objects (https://stackoverflow.com/a/50738205/16998523).\n *\n * @param {unknown} error\n */\nexport function getErrorString(error: unknown): string {\n\tif (error instanceof Error && error.stack) {\n\t\treturn error.stack;\n\t}\n\n\tconst errorString = JSON.stringify(error);\n\treturn errorString && errorString !== '{}' ? errorString : `${error as string}`;\n}\n\n/**\n * Takes an unknown value and coerces it into an error and finally returns the error message string\n */\nexport function getErrorMessage(thrownError: unknown) {\n\treturn _toErrorWithMessage(thrownError).message;\n}\n\nfunction _toErrorWithMessage(thrownError: unknown): {message: string} {\n\tif (_isErrorWithMessage(thrownError)) {\n\t\treturn thrownError;\n\t}\n\n\ttry {\n\t\treturn new Error(JSON.stringify(thrownError));\n\t} catch {\n\t\treturn new Error(String(thrownError));\n\t}\n}\n\nfunction _isErrorWithMessage(thrownError: unknown): thrownError is {message: string} {\n\treturn (\n\t\ttypeof thrownError === 'object'\n    && thrownError !== null\n    && 'message' in thrownError\n    && typeof thrownError.message === 'string'\n\t);\n}\n","module.exports = window[\"React\"];","module.exports = window[\"regeneratorRuntime\"];","module.exports = window[\"peachpay_checkout_blocks\"];","module.exports = window[\"wc\"][\"wcBlocksRegistry\"];","module.exports = window[\"wc\"][\"wcSettings\"];","module.exports = window[\"wp\"][\"element\"];","module.exports = window[\"wp\"][\"htmlEntities\"];","module.exports = window[\"wp\"][\"i18n\"];","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n      args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n      _next(undefined);\n    });\n  };\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","import {__} from '@wordpress/i18n';\nimport {registerPaymentMethod} from '@woocommerce/blocks-registry';\nimport {getSetting} from '@woocommerce/settings';\nimport {decodeEntities} from '@wordpress/html-entities';\nimport {useEffect, useRef} from '@wordpress/element';\nimport {type PaymentMethodInterface} from '@woocommerce/types';\nimport {type CheckoutAfterProcessingWithErrorEventData} from '@woocommerce/checkout';\nimport {type TokenResult, type BillingContact, type Card, type ChargeVerifyBuyerDetails, type Payments, type StoreVerifyBuyerDetails, type VerifyBuyerResponseDetails} from '@square/web-payments-sdk-types';\nimport {startTransaction, updateTransaction, z} from '@peachpay/checkout-blocks';\nimport {getErrorString} from '../../../../../../frontend/@shared/ts/error';\nimport CurrencyFallback from '../../../../../blocks/src/currency-fallback';\n\nconst SettingsSchema = z.object({\n\ticon: z.string(),\n\ttitle: z.string(),\n\tdescription: z.string(),\n\tfallback_currency: z.string().nullable(),\n\tsupports: z.string().array(),\n\tsquare: z.object({\n\t\tapplication_id: z.string(),\n\t\tlocation_id: z.string(),\n\t}),\n});\n\nconst parsedResult = SettingsSchema.safeParse(getSetting('peachpay_square_card_data'));\nif (!parsedResult.success) {\n\tthrow new Error(`Payment method \"peachpay_square_card\" setup aborted. Invalid settings.\\n\\n${parsedResult.error.message}`);\n}\n\nconst settings = parsedResult.data;\nconst title = decodeEntities(settings.title);\nconst description = decodeEntities(settings.description);\n\nif (!window.Square) {\n\tthrow new Error('Payment method \"peachpay_square_card\" setup aborted. Square SDK not loaded.');\n}\n\nlet payments: Payments;\ntry {\n\tpayments = window.Square.payments(settings.square.application_id, settings.square.location_id);\n} catch (err) {\n\tthrow new Error(`Payment method \"peachpay_square_card\" setup aborted. Could not create Payments instance.\\n\\n${getErrorString(err)}`);\n}\n\n/**\n * Component to render the payment method label\n */\nfunction Label(props: PaymentMethodInterface) {\n\tconst {PaymentMethodLabel, PaymentMethodIcons} = props.components;\n\treturn (\n\t\t<>\n\t\t\t<PaymentMethodLabel text={title} />\n\t\t\t<PaymentMethodIcons className='pp-label-icon' icons={[{\n\t\t\t\tid: 'peachpay_square_card',\n\t\t\t\tsrc: settings.icon,\n\t\t\t\talt: title,\n\t\t\t}]} />\n\t\t</>\n\t);\n}\n\n/**\n * Component to render the payment method card fields\n */\nfunction Content({billing, eventRegistration, emitResponse}: PaymentMethodInterface) {\n\tconst {\n\t\tonPaymentSetup,\n\t\tonCheckoutFail,\n\t} = eventRegistration;\n\n\tconst cardRef = useRef<Card | null>(null);\n\tconst containerRef = useRef<HTMLDivElement>(null);\n\n\t/**\n\t * Setup the Square card element and attach it to this react component.\n\t */\n\tuseEffect(() => {\n\t\tlet resize: ResizeObserver;\n\t\tconst setupCard = async () => {\n\t\t\tif (containerRef.current === null) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcardRef.current = await payments.card();\n\n\t\t\t// The Square card element does not automatically resize. This runs\n\t\t\t// whenever the container resizes to recalculate the card element size.\n\t\t\tconst resize = new ResizeObserver(() => {\n\t\t\t\tcardRef.current?.recalculateSize();\n\t\t\t});\n\t\t\tresize.observe(containerRef.current);\n\n\t\t\tawait cardRef.current.attach(containerRef.current);\n\t\t\t// Remove the loading UI\n\t\t\tcontainerRef.current.querySelector('.pp-loading-blur')?.remove();\n\t\t};\n\n\t\tsetupCard().catch(console.error);\n\n\t\treturn () => {\n\t\t\tresize?.disconnect();\n\t\t\tcardRef.current?.detach()\n\t\t\t\t.then(() => cardRef.current?.destroy())\n\t\t\t\t.catch(console.error);\n\t\t};\n\t}, []);\n\n\t/**\n\t * Handle payment tokenization and verification right before the order is submitted.\n\t */\n\tuseEffect(() => onPaymentSetup(async () => {\n\t\tconst {result: transactionId, error} = await startTransaction('peachpay_square_card');\n\t\tif (error || !transactionId) {\n\t\t\treturn {\n\t\t\t\ttype: emitResponse.responseTypes.ERROR,\n\t\t\t\tmessage: getErrorString(error) ?? __('An unknown error occured while creating the transaction.', 'peachpay-for-woocommerce'),\n\t\t\t};\n\t\t}\n\n\t\tif (!cardRef.current) {\n\t\t\tconst note = __('Missing ref to Square card element. Please try again or use a different payment method.', 'peachpay-for-woocommerce');\n\n\t\t\tawait updateTransaction(transactionId, {note, paymentStatus: 'creationfailed'});\n\t\t\treturn {\n\t\t\t\ttype: emitResponse.responseTypes.ERROR,\n\t\t\t\tmessage: note,\n\t\t\t};\n\t\t}\n\n\t\tlet tokenResult: TokenResult | null = null;\n\t\ttry {\n\t\t\ttokenResult = await cardRef.current.tokenize();\n\t\t\tif (tokenResult.status !== 'OK' || !tokenResult.token) {\n\t\t\t\tconst note = (tokenResult.errors\n\t\t\t\t\t?.map(err => err.message)\n\t\t\t\t\t?.join('<br/>')\n\t\t\t\t\t\t?? __('Card tokenization failed. Please try again or use a different payment method.', 'peachpay-for-woocommerce')\n\t\t\t\t);\n\n\t\t\t\tawait updateTransaction(transactionId, {note, paymentStatus: 'creationfailed'});\n\t\t\t\treturn {\n\t\t\t\t\ttype: emitResponse.responseTypes.ERROR,\n\t\t\t\t\tmessage: note,\n\t\t\t\t};\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tconst note = getErrorString(err);\n\t\t\tawait updateTransaction(transactionId, {note, paymentStatus: 'creationfailed'});\n\t\t\treturn {\n\t\t\t\ttype: emitResponse.responseTypes.ERROR,\n\t\t\t\tmessage: note,\n\t\t\t};\n\t\t}\n\n\t\tlet verificationResult: VerifyBuyerResponseDetails | null = null;\n\t\ttry {\n\t\t\tconst buyerDetails = () => {\n\t\t\t\tconst billingContact = {\n\t\t\t\t\taddressLines: [\n\t\t\t\t\t\tbilling.billingAddress.address_1,\n\t\t\t\t\t\tbilling.billingAddress.address_2,\n\t\t\t\t\t],\n\t\t\t\t\tcity: billing.billingAddress.city,\n\t\t\t\t\tcountryCode: billing.billingAddress.country,\n\t\t\t\t\temail: billing.billingAddress.email,\n\t\t\t\t\tfamilyName: billing.billingAddress.last_name,\n\t\t\t\t\tgivenName: billing.billingAddress.first_name,\n\t\t\t\t\tphone: billing.billingAddress.phone,\n\t\t\t\t\tstate: billing.billingAddress.state,\n\t\t\t\t\tpostalCode: billing.billingAddress.postcode,\n\t\t\t\t} satisfies BillingContact;\n\n\t\t\t\tif (billing.cartTotal.value > 0) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tintent: 'CHARGE',\n\t\t\t\t\t\tamount: String(billing.cartTotal.value),\n\t\t\t\t\t\tcurrencyCode: billing.currency.code,\n\t\t\t\t\t\tbillingContact,\n\t\t\t\t\t} satisfies ChargeVerifyBuyerDetails;\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\tintent: 'STORE',\n\t\t\t\t\tbillingContact,\n\t\t\t\t} satisfies StoreVerifyBuyerDetails;\n\t\t\t};\n\n\t\t\tverificationResult = await payments.verifyBuyer(tokenResult.token, buyerDetails());\n\t\t\tif (!verificationResult) {\n\t\t\t\tconst note = __('Card verification failed. Please try again or use a different payment method.', 'peachpay-for-woocommerce');\n\t\t\t\tawait updateTransaction(transactionId, {note, paymentStatus: 'creationfailed'});\n\n\t\t\t\treturn {\n\t\t\t\t\ttype: emitResponse.responseTypes.ERROR,\n\t\t\t\t\tmessage: note,\n\t\t\t\t};\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tlet note = getErrorString(err);\n\n\t\t\tif (err instanceof Error && err.name === 'VerifyBuyerError') {\n\t\t\t\tnote = __('Card verification failed or was canceled by the buyer.', 'peachpay-for-woocommerce');\n\t\t\t}\n\n\t\t\tawait updateTransaction(transactionId, {note, paymentStatus: 'creationfailed'});\n\t\t\treturn {\n\t\t\t\ttype: emitResponse.responseTypes.ERROR,\n\t\t\t\tmessage: note,\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\ttype: emitResponse.responseTypes.SUCCESS,\n\t\t\tmeta: {\n\t\t\t\tpaymentMethodData: {\n\t\t\t\t\tpeachpay_transaction_id: transactionId,\n\t\t\t\t\tpeachpay_square_source_id: tokenResult.token,\n\t\t\t\t\tpeachpay_square_verification_id: verificationResult.token,\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}), [\n\t\tbilling.billingAddress,\n\t\tbilling.cartTotal.value,\n\t\tbilling.currency.code,\n\t\tonPaymentSetup,\n\t]);\n\n\t/**\n\t * Handle checkout failure after the order was submitted. Failure may or may\n\t * not be payment related.\n\t */\n\tuseEffect(() => onCheckoutFail(async (data: CheckoutAfterProcessingWithErrorEventData) => ({\n\t\ttype: emitResponse.responseTypes.ERROR,\n\t\tmessage: (data.processingResponse?.paymentDetails?.['message']) ?? __('An unknown error occured while processing the payment.', 'peachpay-for-woocommerce'),\n\t\tmessageContext: emitResponse.noticeContexts.PAYMENTS,\n\t})), [onCheckoutFail]);\n\n\t/**\n\t * If the payment method does not support the current currency we will show\n\t * a fallback button to allow changing the currency.\n\t *\n\t * Note: Due to how our currency switcher works the `fallback_currency` setting\n\t * is only defined when the payment does not support the current currency and\n\t * does not change after page load.\n\t */\n\tif (settings.fallback_currency) {\n\t\treturn <CurrencyFallback name={title} currency={settings.fallback_currency} />;\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<p>{description}</p>\n\t\t\t<div ref={containerRef}>\n\t\t\t\t<div className='pp-loading-blur' style={{height: '5rem'}}></div>\n\t\t\t</div>\n\t\t</>\n\t);\n}\n\n/**\n * Component to handle saved payment method submissions.\n */\nconst SavedMethod = ({emitResponse, eventRegistration, token}: PaymentMethodInterface & {token: string}) => {\n\tconst {\n\t\tonPaymentSetup,\n\t} = eventRegistration;\n\n\t/**\n\t * Handle setting up a payment using a saved token before the order is submitted.\n\t */\n\tuseEffect(() => onPaymentSetup(async () => {\n\t\tconst {result: transactionId, error} = await startTransaction('peachpay_square_card');\n\t\tif (error || !transactionId) {\n\t\t\treturn {\n\t\t\t\ttype: emitResponse.responseTypes.ERROR,\n\t\t\t\tmessage: getErrorString(error),\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\ttype: emitResponse.responseTypes.SUCCESS,\n\t\t\tmeta: {\n\t\t\t\tpaymentMethodData: {\n\t\t\t\t\tpeachpay_transaction_id: transactionId,\n\t\t\t\t\t'wc-peachpay_square_card-payment-token': token,\n\t\t\t\t},\n\t\t\t},\n\n\t\t};\n\t}), [onPaymentSetup]);\n};\n\nregisterPaymentMethod({\n\tname: 'peachpay_square_card',\n\tariaLabel: title,\n\tcanMakePayment(data) {\n\t\treturn data.paymentMethods.includes('peachpay_square_card');\n\t},\n\t// @ts-expect-error WC will clone these components and pass the props when used.\n\tlabel: <Label />,\n\t// @ts-expect-error WC will clone these components and pass the props when used.\n\tcontent: <Content />,\n\t// @ts-expect-error WC will clone these components and pass the props when used.\n\tsavedTokenComponent: <SavedMethod />,\n\t// @ts-expect-error WC will clone these components and pass the props when used.\n\tedit: <Content />,\n\tsupports: {\n\t\tfeatures: settings.supports,\n\t\tshowSavedCards: !settings.fallback_currency,\n\t\tshowSaveOption: !settings.fallback_currency,\n\t},\n});\n"],"names":["CurrencyFallback","props","currency","createElement","style","display","flexDirection","textAlign","margin","fontSize","name","__","type","className","marginBottom","onClick","peachpayUpdateCurrencyCookie","window","location","reload","newCurrency","document","cookie","getErrorString","error","Error","stack","errorString","JSON","stringify","module","exports","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","done","Promise","then","_asyncToGenerator","fn","self","this","args","arguments","apply","err","undefined","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","d","a","definition","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","parsedResult","z","object","icon","string","title","description","fallback_currency","nullable","supports","array","square","application_id","location_id","safeParse","getSetting","success","message","payments","settings","data","decodeEntities","Square","Content","_ref","billing","eventRegistration","emitResponse","onPaymentSetup","onCheckoutFail","cardRef","useRef","containerRef","useEffect","setupCard","_ref2","_regeneratorRuntime","_callee","_containerRef$current","_context","prev","next","current","abrupt","card","sent","ResizeObserver","_cardRef$current","recalculateSize","observe","attach","querySelector","remove","stop","catch","console","_cardRef$current2","detach","_cardRef$current3","destroy","_callee2","_yield$startTransacti","transactionId","_getErrorString","note","tokenResult","_tokenResult$errors$m","_tokenResult$errors","_note","_note2","verificationResult","buyerDetails","_note3","_note4","_context2","startTransaction","result","responseTypes","ERROR","updateTransaction","paymentStatus","tokenize","status","token","errors","map","join","t0","billingContact","addressLines","billingAddress","address_1","address_2","city","countryCode","country","email","familyName","last_name","givenName","first_name","phone","state","postalCode","postcode","cartTotal","intent","amount","String","currencyCode","code","verifyBuyer","t1","SUCCESS","meta","paymentMethodData","peachpay_transaction_id","peachpay_square_source_id","peachpay_square_verification_id","_ref4","_callee3","_data$processingRespo","_data$processingRespo2","_context3","processingResponse","paymentDetails","messageContext","noticeContexts","PAYMENTS","_x","Fragment","ref","height","registerPaymentMethod","ariaLabel","canMakePayment","paymentMethods","includes","label","_props$components","components","PaymentMethodLabel","PaymentMethodIcons","text","icons","id","src","alt","content","savedTokenComponent","_ref5","_callee4","_yield$startTransacti2","_context4","edit","features","showSavedCards","showSaveOption"],"sourceRoot":""}
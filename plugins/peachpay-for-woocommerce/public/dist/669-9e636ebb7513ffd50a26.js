!function(){try{var n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e=(new Error).stack;e&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[e]="ed32dfb1-5be1-45fc-9f67-6850bf1debb9",n._sentryDebugIdIdentifier="sentry-dbid-ed32dfb1-5be1-45fc-9f67-6850bf1debb9")}catch(n){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"1.104.0"},(self.webpackChunkpeachpay_for_woocommerce=self.webpackChunkpeachpay_for_woocommerce||[]).push([[669],{1669:(n,e,t)=>{t.r(e),t.d(e,{default:()=>m});var i=t(3940),a=t(3629),o=t(1682),r=t(3984),s=t(7150),c=t(3458),d=t(7246),l=t(8072),u=t(2494),p=t(4284);function f(){c.h.subscribe((function(){!function(n,e,t){n.startsWith("peachpay_poynt_")&&"payment"===e?(0,a.HD)(".poynt-btn-container",(function(n){n.classList.remove("hide")})):(0,a.HD)(".poynt-btn-container",(function(n){n.classList.add("hide")}));"loading"===t?(0,a.HD)(".poynt-btn",(function(n){n.classList.add("hide")})):(0,a.HD)(".poynt-btn",(function(n){n.classList.remove("hide")}))}(r.hv.selectedGateway(),o.qA.modalUI.page(),o.qA.modalUI.loadingMode()),function(n){"loading"===n?(0,a.HD)(".poynt-spinner-container",(function(n){n.classList.remove("hide")})):(0,a.HD)(".poynt-spinner-container",(function(n){n.classList.add("hide")}));"processing"===n?(0,a.HD)(".poynt-btn-spinner",(function(n){n.classList.remove("hide")})):(0,a.HD)(".poynt-btn-spinner",(function(n){n.classList.add("hide")}));"processing"===n?(0,a.HD)(".poynt-btn > .button-text",(function(n){n.innerHTML=(0,p.M)("Processing")})):(0,a.HD)(".poynt-btn > .button-text",(function(n){n.innerHTML="".concat((0,p.M)("Pay")," ").concat((0,u.o)(l.AQ.total()))}));"finished"===n?(0,a.HD)(".poynt-btn",(function(n){n.disabled=!1})):(0,a.HD)(".poynt-btn",(function(n){n.disabled=!0}))}(o.qA.modalUI.loadingMode())}))}var h=t(5792),y=t(8883),b=function(){function n(n){this.businessId=n.businessId,this.applicationId=n.applicationId,this.$cardElement=new TokenizeJs(this.businessId,this.applicationId)}return n.prototype.mount=function(n,e){this.$cardElement.mount(n,document,e)},n.prototype.tokenize=function(n){return(0,i.mG)(this,void 0,void 0,(function(){var e=this;return(0,i.Jh)(this,(function(t){return[2,new Promise((function(t){e.$cardElement.on("nonce",(function(n){n.data.nonce&&t({nonce:n.data.nonce})})),e.$cardElement.on("error",(function(n){var e,i,a,o,r;t({error:null!==(r=null!==(i=null===(e=n.data)||void 0===e?void 0:e.message)&&void 0!==i?i:null===(o=null===(a=n.data)||void 0===a?void 0:a.error)||void 0===o?void 0:o.message)&&void 0!==r?r:"Something went wrong. Please try again."})})),e.$cardElement.getNonce(n)}))]}))}))},n}();var g=t(4681),v=t(4209);function m(n){return(0,i.mG)(this,void 0,void 0,(function(){var e,t,s,d;return(0,i.Jh)(this,(function(l){switch(l.label){case 0:return o.L0.enabled("peachpay_poynt_gateways")?(e=o.L0.metadata("peachpay_poynt_gateways","poynt_src"),t=o.L0.metadata("peachpay_poynt_gateways","business_id"),s=o.L0.metadata("peachpay_poynt_gateways","application_id"),t&&s&&e?(d={businessId:t,applicationId:s},[4,(0,a.ve)(e,null,(function(){var e=function(){var n={},e={};if(o.L0.enabled("peachpay_poynt_card_gateway")){var t=function(){var n,e={name:null!==(n=o.L0.metadata("peachpay_poynt_card_gateway","title"))&&void 0!==n?n:(0,p.M)("Card"),gatewayId:"peachpay_poynt_card",description:"",assets:{title:{src:h},badge:{src:y}}},t=null;return{config:e,init:function(n){var e=(0,a.MW)('#pp-pms-new div.pp-pm-saved-option[data-gateway="peachpay_poynt_card"]');e&&(e.setAttribute("id","pp-poynt-new"),e.style.padding="0px",e.style.border="0px",e.style.width="-webkit-fill-available",(t=new b(n)).mount("pp-poynt-new",{iFrame:{border:"0px",borderRadius:"0px",boxShadow:"none",height:"84px",width:"-webkit-fill-available"}}))},tokenize:function(n){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(e){return t?[2,t.tokenize(n)]:[2,{error:"Poynt Card element not found while attempting to tokenize card."}]}))}))}}}();e[t.config.gatewayId]=t.config,n[t.config.gatewayId]=t}return c.h.dispatch((0,r.Cj)(e)),n}();!function(n,e,t){var o,s,c=this;try{for(var d=(0,i.XA)(Object.entries(n)),l=d.next();!l.done;l=d.next()){var u=(0,i.CR)(l.value,2),p=(u[0],u[1]);p.init&&p.init(t)}}catch(n){o={error:n}}finally{try{l&&!l.done&&(s=d.return)&&s.call(d)}finally{if(o)throw o.error}}var f=function(t){return(0,i.mG)(c,void 0,void 0,(function(){var a,o,s;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return[4,v.Z.reportValidity()];case 1:return i.sent()?(a=t.target,(null==a?void 0:a.closest("button"))?(o=r.hv.selectedGateway(),(s=n[o])?[2,w(s,e)]:[2]):[2]):[2]}}))}))};(0,a.HD)(".poynt-btn",(function(n){n.addEventListener("click",(function(n){return(0,i.mG)(c,void 0,void 0,(function(){return(0,i.Jh)(this,(function(e){return[2,f(n)]}))}))}))}))}(e,n,d),f()}))]):[2]):[2];case 1:return l.sent(),[2]}}))}))}function w(n,e){return(0,i.mG)(this,void 0,void 0,(function(){var t,r,l,u,f,h,y,b,v,m,w;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return(0,a.HD)(".pp-pm-error-text",(function(n){n.remove()})),c.h.dispatch((0,o.N5)()),t=function(){var n={};s.g.billing.email()&&(n.emailAddress=s.g.billing.email());s.g.billing.firstName()&&(n.firstName=s.g.billing.firstName());s.g.billing.lastName()&&(n.lastName=s.g.billing.lastName());s.g.billing.address1()&&(n.line1=s.g.billing.address1());s.g.billing.postal()&&(n.zipCode=s.g.billing.postal());return n}(),[4,n.tokenize(t)];case 1:return r=i.sent(),l=r.nonce,u=r.error,[4,e.startTransaction(n.config.gatewayId)];case 2:return f=i.sent(),h=f.error,y=f.result,h||!y?(b=h?(0,g.H)(h):(0,p.M)("An unknown error occured while starting the transaction. Please refresh the page and try again."),(0,d.j1)(b),c.h.dispatch((0,o.tv)()),[2]):(null!=u?u:!l)?[4,y.complete({paymentStatus:"creationfailed",orderStatus:"unperformed",note:null!=u?u:"An unknown error occured while retrieving the nonce."})]:[3,4];case 3:return i.sent(),(0,d.j1)(null!=u?u:"An unknown error occured while tokenizing the payment method."),c.h.dispatch((0,o.tv)()),[2];case 4:return[4,e.placeOrder(y,{peachpay_poynt_nonce:l})];case 5:return v=i.sent(),m=v.error,w=v.result,m||!w||"success"!==w.result?(c.h.dispatch((0,o.tv)()),[2]):window.top?[4,y.complete()]:[3,7];case 6:i.sent(),window.top.location=w.redirect,i.label=7;case 7:return[2]}}))}))}},8883:(n,e,t)=>{n.exports=t.p+"img/d2a66f3e82ab3efab425-card.svg"},5792:(n,e,t)=>{n.exports=t.p+"img/b2c8b12eb49165de87d5-credit-card-regular.svg"}}]);
//# sourceMappingURL=669-9e636ebb7513ffd50a26.js.map
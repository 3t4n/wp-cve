!function(o,e,a,t){e.wp=e.wp||{},e.wp.gdmaq=e.wp.gdmaq||{},e.wp.gdmaq.admin={storage:{url:""},init:function(){"tools"===gdmaq_admin_data.page&&wp.gdmaq.admin.tools.init(),"settings"===gdmaq_admin_data.page&&wp.gdmaq.admin.settings.init(),"log"===gdmaq_admin_data.page&&(wp.gdmaq.admin.dialogs.log(),wp.gdmaq.admin.log.init())},dialogs:{classes:function(a){var t="wp-dialog d4p-dialog gdmaq-modal-dialog";return""!==a&&(t+=" "+a),t},defaults:function(){return{width:480,height:"auto",minHeight:24,autoOpen:!1,resizable:!1,modal:!0,closeOnEscape:!1,zIndex:3e5,open:function(){o(".gdmaq-button-focus").focus()}}},icons:function(a){o(a).next().find(".ui-dialog-buttonset button").each(function(){var a=o(this).data("icon");""!==a&&o(this).find("span.ui-button-text").prepend(gdmaq_admin_data["button_icon_"+a])})},log:function(){var a=o.extend({},wp.gdmaq.admin.dialogs.defaults(),{dialogClass:wp.gdmaq.admin.dialogs.classes("gdmaq-dialog-hidex"),buttons:[{id:"gdmaq-delete-delsingle-delete",class:"gdmaq-dialog-button-delete",text:gdmaq_admin_data.dialog_button_delete,data:{icon:"delete"},click:function(){e.location.href=wp.gdmaq.admin.storage.url}},{id:"gdmaq-delete-delsingle-cancel",class:"gdmaq-dialog-button-cancel gdmaq-button-focus",text:gdmaq_admin_data.dialog_button_cancel,data:{icon:"cancel"},click:function(){o("#gdmaq-dialog-log-delete-single").wpdialog("close")}}]}),t=o.extend({},wp.gdmaq.admin.dialogs.defaults(),{width:680,height:520,buttons:[{id:"gdmaq-log-entry-ok",class:"gdmaq-dialog-button-ok",text:gdmaq_admin_data.dialog_button_ok,data:{icon:"ok"},click:function(){o("#gdmaq-dialog-log-view-entry").wpdialog("close")}}]});o("#gdmaq-dialog-log-delete-single").wpdialog(a),o("#gdmaq-dialog-log-view-entry").wpdialog(t),wp.gdmaq.admin.dialogs.icons("#gdmaq-dialog-log-delete-single"),wp.gdmaq.admin.dialogs.icons("#gdmaq-dialog-log-view-entry")}},log:{init:function(){o(".gdmaq-action-delete-entry").click(function(a){a.preventDefault(),wp.gdmaq.admin.storage.url=o(this).attr("href"),o("#gdmaq-dialog-log-delete-single").wpdialog("open")}),o(".gdmaq-action-view-entry").click(function(a){a.preventDefault();var t=o(this).data("log"),e=o(this).data("nonce");o("#gdmaq-view-entry-inner").html(gdmaq_admin_data.dialog_content_pleasewait),o("#gdmaq-dialog-log-view-entry").wpdialog("open"),o.ajax({success:function(a){o("#gdmaq-view-entry-inner").html(a)},dataType:"html",data:{id:t},type:"post",timeout:9e5,url:ajaxurl+"?action=gdmaq_log_entry_preview&_ajax_nonce="+e})})}},settings:{init:function(){o(a).on("change","#gdmaqvalue_engine_phpmailer_mode",function(){var a=o(this).val();o('[class^="d4p-group d4p-group-service_"], [class^="d4p-group-separator d4p-group-service_"]').hide(),"mail"!==a&&o('[class^="d4p-group d4p-group-service_'+a+'"], [class^="d4p-group-separator d4p-group-service_'+a+'"]').show()})}},tools:{init:function(){"export"===gdmaq_admin_data.panel&&wp.gdmaq.admin.tools.export(),"test"===gdmaq_admin_data.panel&&wp.gdmaq.admin.tools.test(),"queue"===gdmaq_admin_data.panel&&wp.gdmaq.admin.tools.queue()},export:function(){o("#gdmaq-tool-export").click(function(a){a.preventDefault();var t=o("#gdmaq-export-url").val();o("#gdmaqtools-export-settings").is(":checked")&&(t+="&export[]=settings"),o("#gdmaqtools-export-statistics").is(":checked")&&(t+="&export[]=statistics"),e.location=t})},test:function(){o("#gdmaq-tool-test").click(function(a){a.preventDefault(),o("#d4p-tools-test-results").show().find(".d4p-group-inner").html(gdmaq_admin_data.dialog_content_pleasewait),o("#gdmaq-tools-form").find("[name='action']").remove(),o("#gdmaq-tools-form").ajaxSubmit({success:function(a){o("#d4p-tools-test-results .d4p-group-inner").html(a)},dataType:"html",type:"post",timeout:3e5,url:ajaxurl+"?action=gdmaq_tools_emailtest"})})},queue:function(){o("#gdmaq-tool-queue").click(function(a){a.preventDefault(),o("#d4p-tools-test-results").show().find(".d4p-group-inner").html(gdmaq_admin_data.dialog_content_pleasewait),o("#gdmaq-tools-form").find("[name='action']").remove(),o("#gdmaq-tools-form").ajaxSubmit({success:function(a){o("#d4p-tools-test-results .d4p-group-inner").html(a)},dataType:"html",type:"post",timeout:3e5,url:ajaxurl+"?action=gdmaq_tools_queuetest"})})}}},wp.gdmaq.admin.init()}(jQuery,window,document);
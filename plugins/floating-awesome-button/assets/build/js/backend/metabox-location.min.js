({"./assets/ts/metabox-location/metabox-location.ts":function(){var e=this&&this.__assign||function(){return(e=Object.assign||function(e){for(var t,a=1,o=arguments.length;a<o;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},t=this&&this.__spreadArray||function(e,t,a){if(a||2===arguments.length)for(var o,n=0,r=t.length;n<r;n++)!o&&n in t||(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))};window.FAB_METABOX_LOCATION=e(e({},window.FAB_METABOX_LOCATION),{defaultOptions:e(e({},window.FAB_METABOX_LOCATION.defaultOptions),{select2:{placeholder:"--choose--"},type:[],post_types:[]}),init:function(){jQuery("#post").on("submit",function(){var e=window.FAB_METABOX_LOCATION.check_invalid_rules();if(1==jQuery("#fab-location-rules .fab-location-rule-item").length&&e){var t=jQuery("#fab-location-rules .fab-location-rule-item").last();return jQuery('.select2[name="fab_location_type[]',t).val(""),jQuery('.select2[name="fab_location_type[]',t).trigger("change"),jQuery('.select2[name="fab_location_operator[]',t).val(""),jQuery('.select2[name="fab_location_operator[]',t).trigger("change"),jQuery('.select2[name="fab_location_value[]',t).val(""),jQuery('.select2[name="fab_location_value[]',t).trigger("change"),jQuery('.select2[name="fab_location_logic[]',t).val(""),jQuery('.select2[name="fab_location_logic[]',t).trigger("change"),!0}return e&&jQuery.dialog({icon:"fas fa-times",closeIcon:!0,animation:"scale",columnClass:"j-small",title:"Error",content:"Please check input, there are invalid location rules!"}),!e})},init_type_options:function(){var e=window.FAB_METABOX_LOCATION.post_types;e=(e=Object.keys(e).sort().map(function(t,a){return{id:t,text:e[t].label}})).filter(function(e,t){return!window.FAB_METABOX_LOCATION.excludes_post_types.includes(e.id)});var a=window.FAB_METABOX_LOCATION.post_taxonomies;a=Object.keys(a).sort().map(function(e,t){return{id:e,text:a[e].labels.name}}),window.FAB_METABOX_LOCATION.defaultOptions.post_types=e,window.FAB_METABOX_LOCATION.defaultOptions.type=t(t([],window.FAB_METABOX_LOCATION.defaultOptions.type,!0),[{text:"Post",children:t([{id:"post_type",text:"Post Type"}],e.map(function(e,t){var a=e.text.substr(e.text.length-1);return a="s"===a?e.text.substring(0,e.text.length-1):e.text,{id:"single_".concat(e.id),text:"Single ".concat(a)}}),!0)},{text:"Taxonomy",children:t([],a.map(function(e,t){return{id:"taxonomy_".concat(e.id),text:"".concat(e.text," (").concat(e.id,")")}}),!0)},{text:"User",children:[{id:"user_session",text:"Session"},{id:"user_role",text:"Role"}]}],!1)},check_invalid_rules:function(){var e=!1;return jQuery("#fab-location-rules .fab-location-rule-item").each(function(){return jQuery('.select2[name="fab_location_type[]',this).val()&&jQuery('.select2[name="fab_location_operator[]',this).val()&&jQuery('.select2[name="fab_location_value[]',this).val()&&jQuery('.select2[name="fab_location_logic[]',this).val()?void 0:(e=!0,!1)}),e},reloadSelect2:function(e,t){t.selectedValue||(t.selectedValue=e.val()),e.data("select2")&&(e.select2("destroy"),e.html("")),e.select2(t),e.val(t.selectedValue),e.trigger("change")},getComparatorOption:function(e,t){return void 0!==e&&e&&("post_type"===e?t.data=window.FAB_METABOX_LOCATION.defaultOptions.post_types:e.includes("taxonomy_")?t.ajax=window.FAB_METABOX_LOCATION.getComparatorOptionTaxonomyTermAjax(e):"user_session"===e?t.data=[{id:"user_session_logged_in",text:"Logged In"}]:"user_role"===e?t.data=window.FAB_METABOX_LOCATION.defaultOptions.user.roles:e.includes("single_")&&(t.ajax=window.FAB_METABOX_LOCATION.getComparatorOptionSingleAjax(e))),t},getComparatorOptionSingleAjax:function(t){return{delay:500,dataType:"json",url:function(e){t=t.replace("single_","");var a=window.FAB_METABOX_LOCATION.post_types[t].rest_base;return a=a||t,a+=window.FAB_PLUGIN.isNumeric(e.term)?"/".concat(e.term):"","".concat(window.FAB_METABOX_LOCATION.rest_url,"wp/v2/").concat(a)},data:function(t){var a={_fields:"id,title"};return window.FAB_PLUGIN.isNumeric(t.term)||(a=e(e({},a),{filter:{post_status:"publish,private"},page:t.page||1,search:t.term,orderby:"title",order:"asc"})),window.FAB_METABOX_LOCATION.ajax_params=a,a},processResults:function(e){var t={more:!1};return window.FAB_METABOX_LOCATION.ajax_params.page<this._request.getResponseHeader("X-WP-TotalPages")&&(t.more=!0),Array.isArray(e)||(e=[e]),{results:e=e.map(function(e,t){return{id:e.id,text:e.title.rendered.replace(/[^\w\s]/gi,"")}}),pagination:t}}}},getComparatorOptionTaxonomyTermAjax:function(e){return{delay:500,dataType:"json",url:function(t){e=e.replace("taxonomy_","");var a=window.FAB_METABOX_LOCATION.post_taxonomies[e].rest_base;return a=a||e,a+=window.FAB_PLUGIN.isNumeric(t.term)?"/".concat(t.term):"","".concat(window.FAB_METABOX_LOCATION.rest_url,"wp/v2/").concat(a)},data:function(e){var t={};return window.FAB_PLUGIN.isNumeric(e.term)||(t={page:e.page||1,per_page:10,search:e.term}),window.FAB_METABOX_LOCATION.ajax_params=t,t},processResults:function(e){var t={more:!1};return window.FAB_METABOX_LOCATION.ajax_params.page<this._request.getResponseHeader("X-WP-TotalPages")&&(t.more=!0),{results:e=e.map(function(e,t){return{id:e.id,text:e.name.replace(/[^\w\s]/gi,"")}}),pagination:t}}}}})}})["./assets/ts/metabox-location/metabox-location.ts"]();
(()=>{"use strict";var t={d:(e,o)=>{for(var r in o)t.o(o,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:o[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{add_shipping_info:()=>b,add_to_cart:()=>v,begin_checkout:()=>f,purchase:()=>$,remove_from_cart:()=>y,search:()=>k,select_content:()=>h,trackChangeCartItemQuantity:()=>w,trackEvent:()=>H,trackException:()=>E,view_item:()=>A,view_item_list:()=>g});const o=wcgai.config,r=window.wp.i18n,n=window.wp.hooks,c=(t,e)=>{var o;const r={};return t.variation&&(r.item_variant=t.variation),{item_id:s(t),item_name:t.name,...l(t),quantity:null!==(o=t.quantity)&&void 0!==o?o:e,price:i(t.prices.price,t.prices.currency_minor_unit),...r}},a=(t,e)=>({item_id:s(t),item_name:t.name,item_list_name:e,...l(t),price:i(t.prices.price,t.prices.currency_minor_unit)}),i=(t,e=2)=>parseInt(t,10)/10**e,d=(t,e,o)=>{(0,n.removeAction)(t,e),(0,n.addAction)(t,e,o)},s=t=>{const e=t.extensions?.woocommerce_google_analytics_integration?.identifier;return void 0!==e?e:"product_sku"===o.identifier?t.sku?t.sku:"#"+t.id:t.id},u=t=>t.coupons[0]?.code?{coupon:t.coupons[0]?.code}:{},l=t=>"categories"in t&&t.categories.length?_(t.categories):{},_=t=>Object.fromEntries(t.slice(0,5).map(((t,e)=>[m(e),t.name]))),m=t=>"item_category"+(t>0?t+1:""),p=(t,e,o)=>{var r;return null!==(r=o?.items?.find((({id:e})=>e===t)))&&void 0!==r?r:e?.find((({id:e})=>e===t))},g=({products:t,listName:e=(0,r.__)("Product List","woocommerce-google-analytics-integration")})=>0!==t.length&&{item_list_id:"engagement",item_list_name:(0,r.__)("Viewing products","woocommerce-google-analytics-integration"),items:t.map(((t,o)=>({...a(t,e),index:o+1})))},v=({product:t,quantity:e=1})=>({items:t?[c(t,e)]:[]}),y=({product:t,quantity:e=1})=>({items:t?[c(t,e)]:[]}),w=({product:t,quantity:e=1})=>{H("change_cart_quantity",{event_category:"ecommerce",event_label:(0,r.__)("Change Cart Item Quantity","woocommerce-google-analytics-integration"),items:[c(t,e)]})},f=({storeCart:t})=>({currency:t.totals.currency_code,value:i(t.totals.total_price,t.totals.currency_minor_unit),...u(t),items:t.items.map(c)}),b=({storeCart:t})=>({currency:t.totals.currency_code,value:i(t.totals.total_price,t.totals.currency_minor_unit),shipping_tier:t.shippingRates[0]?.shipping_rates?.find((t=>t.selected))?.name||"",...u(t),items:t.items.map(c)}),h=({product:t})=>!!t&&{content_type:"product",content_id:s(t)},k=({searchTerm:t})=>({search_term:t}),A=({product:t,listName:e=(0,r.__)("Product List","woocommerce-google-analytics-integration")})=>!!t&&{items:[a(t,e)]},$=({order:t})=>void 0!==t&&{transaction_id:t.id,affiliation:t.affiliation,currency:t.totals.currency_code,value:i(t.totals.total_price,t.totals.currency_minor_unit),tax:i(t.totals.tax_total,t.totals.currency_minor_unit),shipping:i(t.totals.shipping_total,t.totals.currency_minor_unit),items:t.items.map(c)},E=({status:t,content:e})=>{if("error"===t)return{description:e,fatal:!1}},H=(t,e)=>{if("function"!=typeof gtag)throw new Error("Function gtag not implemented.");window.gtag("event",t,e)};let L;const q=Object.freeze(new class{constructor(){if(L)throw new Error("Cannot instantiate more than one Tracker");function t(){window.dataLayer.push(arguments)}L=this,window.dataLayer=window.dataLayer||[],window[o.tracker_function_name]=t;for(const e of o.consent_modes||[])t("consent","default",e);t("js",new Date),t("set",`developer_id.${o.developer_id}`,!0),t("config",o.gtag_id,{allow_google_signals:o.allow_google_signals,link_attribution:o.link_attribution,anonymize_ip:o.anonymize_ip,logged_in:o.logged_in,linker:o.linker,custom_map:o.custom_map})}eventHandler(t){const r=e[t];if("function"!=typeof r)throw new Error(`Event ${t} is not supported.`);return function(e){const n=r(e);o.events.includes(t)&&n&&window[o.tracker_function_name]("event",t,n)}}}),S="woocommerce-google-analytics",C="experimental__woocommerce_blocks";d(`${C}-product-render`,S,q.eventHandler("view_item")),d(`${C}-cart-remove-item`,S,q.eventHandler("remove_from_cart")),d(`${C}-checkout-render-checkout-form`,S,q.eventHandler("begin_checkout")),d(`${C}-cart-add-item`,S,(({product:t})=>{q.eventHandler("add_to_cart")({product:t})})),d(`${C}-product-list-render`,S,q.eventHandler("view_item_list")),d(`${C}-product-view-link`,S,q.eventHandler("select_content")),(0,n.removeAction)(`${C}-checkout-submit`,S),(0,n.removeAction)(`${C}-checkout-set-email-address`,S),(0,n.removeAction)(`${C}-checkout-set-phone-number`,S),(0,n.removeAction)(`${C}-checkout-set-billing-address`,S),(0,n.removeAction)(`${C}-cart-set-item-quantity`,S),(0,n.removeAction)(`${C}-product-search`,S),(0,n.removeAction)(`${C}-store-notice-create`,S),window.wcgai.trackClassicPages=function({events:t,cart:e,products:o,product:r,added_to_cart:n,order:c}){const a={storeCart:e,products:o,product:r,order:c};Object.values(null!=t?t:{}).forEach((t=>{"add_to_cart"===t?q.eventHandler(t)({product:n}):q.eventHandler(t)(a)})),document.body.onadded_to_cart=(t,n,c,a)=>{const i=parseInt(a[0].dataset.product_id||a[0].value),d=r?.id===i?r:p(parseInt(i),o,e);d&&q.eventHandler("add_to_cart")({product:d})};const i=()=>{document.querySelectorAll(".woocommerce-cart-form .woocommerce-cart-form__cart-item .remove[data-product_id]").forEach((t=>t.addEventListener("click",d)))};function d(t){q.eventHandler("remove_from_cart")({product:p(parseInt(t.target.dataset.product_id),o,e)})}i();const s=document.body.onupdated_wc_div;document.body.onupdated_wc_div=(...t)=>{"function"==typeof s&&s(...t),i()};const u=document.body.onremoved_from_cart;document.body.onremoved_from_cart=(...t)=>{"function"==typeof u&&u(...t),d({target:t[3][0]})},document.querySelectorAll(".products .product:not(.wp-block-post)")?.forEach((t=>{const r=t.querySelector("a[data-product_id]")?.getAttribute("data-product_id");r&&t.addEventListener("click",(t=>{const n=t.target.closest(".woocommerce-loop-product__link"),c=t.target.classList.contains("button")&&t.target.hasAttribute("data-product_id"),a=t.target.classList.contains("add_to_cart_button")&&!t.target.classList.contains("product_type_variable");(n||c&&!a)&&q.eventHandler("select_content")({product:p(parseInt(r),o,e)})}))})),document.querySelectorAll(".products-block-post-template .product, .wc-block-product-template .product")?.forEach((t=>{const r=t.querySelector("[data-product_id]")?.getAttribute("data-product_id");r&&t.addEventListener("click",(t=>{const n=t.target,c=n.closest(".wc-block-components-product-image a"),a=n.closest(".wp-block-post-title a"),i=n.closest(".wc-block-components-product-button [data-product_id]");i&&i.classList.contains("add_to_cart_button")&&!i.classList.contains("product_type_variable")?q.eventHandler("add_to_cart")({product:p(parseInt(r),o,e)}):(c||i||a)&&q.eventHandler("select_content")({product:p(parseInt(r),o,e)})}))}))}})();
!function(s){var i={};function n(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return s[t].call(e.exports,e,e.exports,n),e.l=!0,e.exports}n.m=s,n.c=i,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(s,i,function(t){return e[t]}.bind(null,i));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="./admin/assets/js/playlist-edit.js")}({"./admin/assets/js/collections/tracks.js":function(t,e,s){"use strict";s.r(e),s.d(e,"Tracks",function(){return o});var i=s("backbone"),e=s.n(i),i=s("wp"),n=s.n(i),a=s("./admin/assets/js/modules/application.js"),s=s("./admin/assets/js/models/track.js");const o=e.a.Collection.extend({model:s.Track,comparator:function(t){return parseInt(t.get("order"),10)},fetch:function(){return n.a.ajax.post("cue_get_playlist_tracks",{post_id:a.settings.postId}).done(t=>this.reset(t))},save:function(t){return this.sort(),t=Object.assign({},t,{post_id:a.settings.postId,tracks:this.toJSON(),nonce:a.settings.saveNonce}),n.a.ajax.post("cue_save_playlist_tracks",t)}})},"./admin/assets/js/models/track.js":function(t,e,s){"use strict";s.r(e),s.d(e,"Track",function(){return i});e=s("backbone");const i=s.n(e).a.Model.extend({defaults:{artist:"",artworkId:"",artworkUrl:"",audioId:"",audioUrl:"",format:"",length:"",title:"",order:0}})},"./admin/assets/js/modules/application.js":function(t,i,n){"use strict";n.r(i),function(t){n.d(i,"l10n",function(){return e}),n.d(i,"settings",function(){return s});t.cue=t.cue||new class{constructor(){this.l10n={},this.settings={}}config(t){t.l10n&&(this.l10n=Object.assign(this.l10n,t.l10n),delete t.l10n),this.settings=Object.assign(this.settings,t)}},i.default=t.cue;const e=t.cue.l10n,s=t.cue.settings}.call(this,n("./node_modules/webpack/buildin/global.js"))},"./admin/assets/js/modules/workflows.js":function(t,e,s){"use strict";s.r(e);var i=s("underscore"),n=s.n(i),i=s("wp"),a=s.n(i),o=s("./admin/assets/js/modules/application.js"),r=s("./admin/assets/js/views/frame/track-media.js");const l=a.a.media.model["Attachment"],d=o.default["l10n"];e.default={frames:[],model:{},setModel:function(t){return this.model=t,this},get:function(t){var e="_"+t,t=this.frames[e]||null,t=this[e].call(this,t);return this.frames[e]=t},_addTracks:function(t){return t||((t=new r.TrackMediaFrame({title:d.workflows.addTracks.frameTitle,library:{type:"audio"},button:{text:d.workflows.addTracks.frameButtonText},multiple:"add"})).uploader.options.uploader.plupload={filters:{mime_types:[{title:d.workflows.addTracks.fileTypes,extensions:"m4a,mp3,ogg,wma"}]}},t.state("embed").props.off("change:url",t.state("embed").debouncedScan),t.state("insert").on("insert",function(t){n.a.each(t.models,function(t){o.default.tracks.push(t.toJSON().cue)})}),t.state("embed").on("select",function(){var t=this.props.toJSON();const e={audioId:"",audioUrl:t.url};"title"in t&&""!==t.title&&(e.title=t.title),o.default.tracks.push(e)}),t)},_selectArtwork:function(t){const i=this;return t||((t=a.a.media({title:d.workflows.selectArtwork.frameTitle,library:{type:"image"},button:{text:d.workflows.selectArtwork.frameButtonText},multiple:!1})).uploader.options.uploader.plupload={filters:{mime_types:[{files:d.workflows.selectArtwork.fileTypes,extensions:"jpg,jpeg,gif,png"}]}},t.on("open",function(){const t=this.get("library").get("selection");var e=i.model.get("artworkId");const s=[];e&&(s.push(l.get(e)),s[0].fetch()),t.reset(s)}),t.state("library").on("select",function(){var t=this.get("selection").first().toJSON();i.model.set({artworkId:t.id,artworkUrl:t.sizes.cue.url})}),t)},_selectAudio:function(a){const o=this;return a||((a=new r.TrackMediaFrame({title:d.workflows.selectAudio.frameTitle,library:{type:"audio"},button:{text:d.workflows.selectAudio.frameButtonText},multiple:!1})).uploader.options.uploader.plupload={filters:{mime_types:[{title:d.workflows.selectAudio.fileTypes,extensions:"m4a,mp3,ogg,wma"}]}},a.state("embed").props.off("change:url",a.state("embed").debouncedScan),a.on("open",function(){const t=this.get("insert").get("selection");var e=o.model.get("audioId"),s=o.model.get("audioUrl"),i=s&&!e;const n=[];e&&(n.push(l.get(e)),n[0].fetch()),t.reset(n),i?this.get("embed").props.set({url:s,title:o.model.get("title")}):this.get("embed").props.set({url:"",title:""}),a.setState(i?"embed":"insert")}),a.state("insert").on("insert",function(t){const s=t.first().toJSON().cue,i={};t=n.a.keys(o.model.attributes);n.a.without(t,["id","order"]),n.a.each(t,function(t){var e=o.model.get(t);!e&&t in s&&e!==s[t]&&(i[t]=s[t])}),i.audioId=s.audioId,i.audioUrl=s.audioUrl,o.model.set(i)}),a.state("embed").on("select",function(){var t=this.props.toJSON();const e={audioId:""};e.audioUrl=t.url,"title"in t&&""!==t.title&&(e.title=t.title),o.model.set(e)}),a.on("escape",function(){var t=o.model.toJSON();t.artworkUrl||t.audioUrl||o.model.destroy()}),a)}}},"./admin/assets/js/playlist-edit.js":function(t,e,s){"use strict";s.r(e);var i=s("jquery"),n=s.n(i),a=s("wp"),e=s.n(a),o=s("./admin/assets/js/modules/application.js"),r=s("./admin/assets/js/views/screen/edit-playlist.js"),i=s("./admin/assets/js/models/track.js"),a=s("./admin/assets/js/collections/tracks.js"),s=s("./admin/assets/js/modules/workflows.js");o.default.data=_cueSettings,o.default.config(_cueSettings),e.a.media.view.settings.post.id=o.default.data.postId,e.a.media.view.settings.defaultProps={},Object.assign(o.default,{collection:{},controller:{},model:{},view:{}}),o.default.model.Track=i.Track,o.default.model.Tracks=a.Tracks,o.default.workflows=s.default,n()(function(t){var e=new o.default.model.Tracks(o.default.data.tracks);o.default.tracks=e,delete o.default.data.tracks;const s=new r.EditPlaylistScreen({el:"#post",collection:e,l10n:o.default.l10n});s.render()})},"./admin/assets/js/views/edit-playlist/track-list.js":function(t,e,s){"use strict";s.r(e),s.d(e,"TrackList",function(){return o});var e=s("jquery"),i=s.n(e),e=s("underscore"),n=s.n(e),e=s("wp"),e=s.n(e),a=s("./admin/assets/js/views/edit-playlist/track/index.js");const o=e.a.Backbone.View.extend({className:"cue-tracklist",tagName:"ol",initialize:function(){this.listenTo(this.collection,"add",this.addTrack),this.listenTo(this.collection,"add remove",this.updateOrder),this.listenTo(this.collection,"reset",this.render)},render:function(){return this.$el.empty(),this.collection.each(this.addTrack,this),this.updateOrder(),this.$el.sortable({axis:"y",delay:150,forceHelperSize:!0,forcePlaceholderSize:!0,opacity:.6,start:(t,e)=>{e.placeholder.css("visibility","visible")},update:(t,e)=>{this.updateOrder()}}),this},addTrack:function(t){const e=new a.Track({model:t});this.$el.append(e.render().el)},updateOrder:function(){n.a.each(this.$el.find(".cue-track"),(t,e)=>{t=i()(t).data("cid");this.collection.get(t).set("order",e)})}})},"./admin/assets/js/views/edit-playlist/track/artwork.js":function(t,e,s){"use strict";s.r(e),s.d(e,"TrackArtwork",function(){return a});var e=s("underscore"),i=s.n(e),e=s("wp"),e=s.n(e),n=s("./admin/assets/js/modules/workflows.js");const a=e.a.Backbone.View.extend({tagName:"span",className:"cue-track-artwork",template:e.a.template("cue-playlist-track-artwork"),events:{click:"select"},initialize:function(t){this.parent=t.parent,this.listenTo(this.model,"change:artworkUrl",this.render)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.parent.$el.toggleClass("has-artwork",!i.a.isEmpty(this.model.get("artworkUrl"))),this},select:function(){n.default.setModel(this.model).get("selectArtwork").open()}})},"./admin/assets/js/views/edit-playlist/track/audio.js":function(t,e,s){"use strict";s.r(e),s.d(e,"TrackAudio",function(){return r});var e=s("jquery"),n=s.n(e),e=s("mediaelementjs"),a=s.n(e),e=s("wp"),e=s.n(e),o=s("./admin/assets/js/modules/application.js"),i=s("./admin/assets/js/modules/workflows.js");const r=e.a.Backbone.View.extend({tagName:"span",className:"cue-track-audio",template:e.a.template("cue-playlist-track-audio"),events:{"click .cue-track-audio-selector":"select"},initialize:function(t){this.parent=t.parent,this.listenTo(this.model,"change:audioUrl",this.refresh),this.listenTo(this.model,"destroy",this.cleanup)},render:function(){var t=this.model.toJSON(),e=this.$el.find(".mejs-audio").attr("id");""===t.audioUrl&&e&&a.a.players[e].remove(),this.$el.html(this.template(this.model.toJSON()));const s=this.$el.find(".cue-audio");if(s.length){s.wrap("<body></body>");const i={classPrefix:"mejs-",defaultAudioHeight:30,features:["playpause","current","progress","duration"],pluginPath:o.settings.pluginPath,stretching:"responsive",success:(t,e,s)=>{const i=n()(s.container).parent();n.a.nodeName(i.get(0),"body")&&i.replaceWith(i.get(0).childNodes)},error:t=>{const e=n()(t),s=e.closest(".cue-track");t=e.closest(".mejs-audio").attr("id");a.a.players[t].remove(),s.find("audio").remove()}};"m4a"===s.attr("src").split(".").pop()&&(i.pluginVars="isvideo=true"),s.mediaelementplayer(i)}return this},refresh:function(t){var e=this.model.toJSON(),s=this.$el.find(".mejs-audio").attr("id");const i=s?a.a.players[s]:null;i&&""!==e.audioUrl?(i.pause(),i.setSrc(e.audioUrl)):this.render()},cleanup:function(){var t=this.$el.find(".mejs-audio").attr("id");const e=t?a.a.players[t]:null;e&&e.remove()},select:function(){i.default.setModel(this.model).get("selectAudio").open()}})},"./admin/assets/js/views/edit-playlist/track/index.js":function(t,e,s){"use strict";s.r(e),s.d(e,"Track",function(){return o});var e=s("jquery"),n=s.n(e),e=s("wp"),e=s.n(e),i=s("./admin/assets/js/views/edit-playlist/track/artwork.js"),a=s("./admin/assets/js/views/edit-playlist/track/audio.js");const o=e.a.Backbone.View.extend({tagName:"li",className:"cue-track",template:e.a.template("cue-playlist-track"),events:{"change [data-setting]":"updateAttribute","click .js-toggle":"toggleOpenStatus","dblclick .cue-track-title":"toggleOpenStatus","click .js-close":"minimize","click .js-remove":"destroy"},initialize:function(){this.listenTo(this.model,"change:title",this.updateTitle),this.listenTo(this.model,"change",this.updateFields),this.listenTo(this.model,"destroy",this.remove)},render:function(){return this.$el.html(this.template(this.model.toJSON())).data("cid",this.model.cid),this.views.add(".cue-track-column-artwork",new i.TrackArtwork({model:this.model,parent:this})),this.views.add(".cue-track-audio-group",new a.TrackAudio({model:this.model,parent:this})),this},minimize:function(t){t.preventDefault(),this.$el.removeClass("is-open").find("input:focus").blur()},toggleOpenStatus:function(t){t.preventDefault(),this.$el.toggleClass("is-open").find("input:focus").blur(),this.$el.hasClass("is-open")&&n()(window).trigger("resize")},updateAttribute:function(t){var e=n()(t.target).data("setting"),t=t.target.value;this.model.get(e)!==t&&this.model.set(e,t)},updateFields:function(){var t=this.model.toJSON();const e=this.$el.find("[data-setting]");for(const i in t){var s=n()("<div/>").html(t[i]).text();e.filter('[data-setting="'+i+'"]').val(s)}},updateTitle:function(){var t=this.model.get("title");this.$el.find(".cue-track-title .text").text(t||"Title")},destroy:function(){this.model.trigger("destroy",this.model)},remove:function(){this.$el.remove()}})},"./admin/assets/js/views/frame/track-media.js":function(t,e,s){"use strict";s.r(e),s.d(e,"TrackMediaFrame",function(){return d});var e=s("wp"),i=s.n(e),n=s("./admin/assets/js/modules/application.js");const{MediaFrame:a,Toolbar:o}=i.a.media.view,{Post:r,Select:l}=a,d=r.extend({createStates:function(){var t=this.options;this.states.add([new i.a.media.controller.Library({id:"insert",title:t.title,priority:20,toolbar:"main-insert",filterable:"uploaded",library:i.a.media.query(t.library),multiple:!!t.multiple&&"reset",editable:!1,allowLocalEdits:!0,displaySettings:!1,displayUserSettings:!1}),new i.a.media.controller.Embed({title:n.l10n.addFromUrl,menuItem:{text:n.l10n.addFromUrl,priority:120},type:"link"})])},bindHandlers:function(){l.prototype.bindHandlers.apply(this,arguments),this.on("toolbar:create:main-insert",this.createToolbar,this),this.on("toolbar:create:main-embed",this.mainEmbedToolbar,this),this.on("menu:render:default",this.mainMenu,this),this.on("content:render:embed",this.embedContent,this),this.on("content:render:edit-selection",this.editSelectionContent,this),this.on("toolbar:render:main-insert",this.mainInsertToolbar,this)},mainInsertToolbar:function(t){this.selectionStatusToolbar(t),t.set("insert",{style:"primary",priority:80,text:this.options.button.text,requires:{selection:!0},click:()=>{const t=this.state();var e=t.get("selection");this.close(),t.trigger("insert",e).reset()}})},mainEmbedToolbar:function(t){t.view=new o.Embed({controller:this,text:this.options.button.text})}})},"./admin/assets/js/views/screen/button/add-tracks.js":function(t,e,s){"use strict";s.r(e),s.d(e,"AddTracksButton",function(){return a});var e=s("jquery"),i=s.n(e),e=s("wp"),e=s.n(e),n=s("./admin/assets/js/modules/workflows.js");const a=e.a.Backbone.View.extend({id:"add-tracks",tagName:"p",events:{"click .button":"click"},initialize:function(t){this.l10n=t.l10n},render:function(){var t=i()("<a />",{text:this.l10n.addTracks}).addClass("button button-secondary");return this.$el.html(t),this},click:function(t){t.preventDefault(),n.default.get("addTracks").open()}})},"./admin/assets/js/views/screen/edit-playlist.js":function(t,e,s){"use strict";s.r(e),s.d(e,"EditPlaylistScreen",function(){return o});var e=s("jquery"),i=s.n(e),e=s("wp"),e=s.n(e),n=s("./admin/assets/js/views/screen/button/add-tracks.js"),a=s("./admin/assets/js/views/edit-playlist/track-list.js");const o=e.a.Backbone.View.extend({saved:!1,events:{"click #publish":"buttonClick","click #save-post":"buttonClick"},initialize:function(t){this.l10n=t.l10n},render:function(){return this.views.add("#cue-playlist-editor .cue-panel-body",[new n.AddTracksButton({collection:this.collection,l10n:this.l10n}),new a.TrackList({collection:this.collection})]),this},buttonClick:function(t){const e=i()(t.target);return this.saved||this.collection.save().done(t=>{this.saved=!0,e.click()}),this.saved}})},"./node_modules/webpack/buildin/global.js":function(t,e){var s=function(){return this}();try{s=s||new Function("return this")()}catch(t){"object"==typeof window&&(s=window)}t.exports=s},backbone:function(t,e){t.exports=Backbone},jquery:function(t,e){t.exports=jQuery},mediaelementjs:function(t,e){t.exports=mejs},underscore:function(t,e){t.exports=_},wp:function(t,e){t.exports=wp}});
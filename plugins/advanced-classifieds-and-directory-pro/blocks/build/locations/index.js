(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var l in n)e.o(n,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:n[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.blocks,n=window.wp.element,l=window.wp.serverSideRender;var o=e.n(l);const a=window.wp.i18n,r=window.wp.blockEditor,c=window.wp.components,s=window.wp.hooks,i=window.wp.data;function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";var l;for(l=0;l<e.length;l+=1)t.push({label:n+e[l].name,value:e[l].id}),e[l].children.length>0&&u(e[l].children,t,n.trim()+"— ");return t}const d=JSON.parse('{"u2":"acadp/locations"}');(0,t.registerBlockType)(d.u2,{attributes:{parent:{type:"number",default:acadp_blocks.locations.parent},columns:{type:"number",default:acadp_blocks.locations.columns},depth:{type:"number",default:acadp_blocks.locations.depth},orderby:{type:"string",default:acadp_blocks.locations.orderby},order:{type:"string",default:acadp_blocks.locations.order},show_count:{type:"boolean",default:acadp_blocks.locations.show_count},hide_empty:{type:"boolean",default:acadp_blocks.locations.hide_empty}},edit:function(e){let{attributes:t,setAttributes:l}=e;const{parent:d,columns:p,depth:_,orderby:h,order:m,show_count:b,hide_empty:w}=t,g=(0,i.useSelect)((e=>{const t=e("core").getEntityRecords("taxonomy","acadp_locations",{per_page:100});let n=[{label:"— "+(0,a.__)("Select parent")+" —",value:0}];if(t&&t.length>0){let e=function(e,t){var n,l,o={},a=[];for(l=0;l<e.length;l+=1)o[e[l].id]=l,e[l].children=[];for(l=0;l<e.length;l+=1)(n=e[l]).parent==t?a.push(n):o.hasOwnProperty(n.parent)&&e[o[n.parent]].children.push(n);return a}(t,parseInt(acadp_blocks.base_location)),l=u(e);n=[...n,...l]}return n})),y=(0,n.useRef)();return(0,n.useEffect)((()=>{y.current?(0,s.doAction)("acadp_init_locations",t):y.current=!0})),(0,n.createElement)(n.Fragment,null,(0,n.createElement)(r.InspectorControls,null,(0,n.createElement)(c.PanelBody,{title:(0,a.__)("Locations settings")},(0,n.createElement)(c.PanelRow,null,(0,n.createElement)(c.SelectControl,{label:(0,a.__)("Select parent"),value:d,options:g,onChange:e=>l({parent:Number(e)})})),(0,n.createElement)(c.PanelRow,null,(0,n.createElement)(c.RangeControl,{label:(0,a.__)("Number of columns"),value:p,min:1,max:12,onChange:e=>l({columns:e})})),(0,n.createElement)(c.PanelRow,null,(0,n.createElement)(c.RangeControl,{label:(0,a.__)("Depth"),value:_,min:1,max:12,onChange:e=>l({depth:e})})),(0,n.createElement)(c.PanelRow,null,(0,n.createElement)(c.SelectControl,{label:(0,a.__)("Order by"),value:h,options:[{label:(0,a.__)("ID"),value:"id"},{label:(0,a.__)("Count"),value:"count"},{label:(0,a.__)("Name"),value:"name"},{label:(0,a.__)("Slug"),value:"slug"}],onChange:e=>l({orderby:e})})),(0,n.createElement)(c.PanelRow,null,(0,n.createElement)(c.SelectControl,{label:(0,a.__)("Order"),value:m,options:[{label:(0,a.__)("Ascending"),value:"asc"},{label:(0,a.__)("Descending"),value:"desc"}],onChange:e=>l({order:e})})),(0,n.createElement)(c.PanelRow,null,(0,n.createElement)(c.ToggleControl,{label:(0,a.__)("Show listings count"),help:(0,a.__)("Check this to show the listings count next to the location name"),checked:b,onChange:()=>l({show_count:!b})})),(0,n.createElement)(c.PanelRow,null,(0,n.createElement)(c.ToggleControl,{label:(0,a.__)("Hide empty locations"),help:(0,a.__)("Check this to hide locations with no listings"),checked:w,onChange:()=>l({hide_empty:!w})})))),(0,n.createElement)("div",(0,r.useBlockProps)(),(0,n.createElement)(c.Disabled,null,(0,n.createElement)(o(),{block:"acadp/locations",attributes:t}))))}})})();
(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{1166:function(e,t,a){"use strict";a.r(t);var c=a(0),n=a(820),r=a(67),i=a(2),o=a(3),l=a(832),s=a(278),b=a(4),u=a(10),m=a.n(u),f=a(5),O=a(815);function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);t&&(c=c.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,c)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){d(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function d(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function v(e,t,a,c,n,r,i){try{var o=e[r](i),l=o.value}catch(e){return void a(e)}o.done?t(l):Promise.resolve(l).then(c,n)}t.default=function(e){var t=e.bulkActionId,a=e.setStep,u=e.setPending,p=e.isPending,d=Object(n.a)(),w=d.getSingleBulkActionData,y=d.getActionList,E=d.getActionSchemaList,g=Object(O.a)().setSingleBulkActionValue,h=w(),k=E(),N=y(),_=h.count,P=void 0===_?0:_,S=h.actions,A=h.contactFilters,x=h.enable_automation_run,D=void 0!==x&&x,C=function(){var e,c=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u(!0),e.next=4,m()({path:Object(f.m)("/bulk-action/".concat(t)),method:"POST",data:j(j({},h),{},{start_bulk_action:!0})}).then((function(e){200===e.code?e.hasOwnProperty("result")&&!Object(o.isEmpty)(e.result)&&(g("data",e.result),setTimeout((function(){a(4),u(!1)}),1e3)):u(!1)}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),u(!1);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})),function(){var t=this,a=arguments;return new Promise((function(c,n){var r=e.apply(t,a);function i(e){v(r,c,n,i,o,"next",e)}function o(e){v(r,c,n,i,o,"throw",e)}i(void 0)}))});return function(){return c.apply(this,arguments)}}();return Object(c.createElement)(c.Fragment,null,Object(c.createElement)(r.a,null),Object(c.createElement)("div",{className:"bwf-card-wrap"},Object(c.createElement)("div",{className:"bwf-card-header"},Object(i.__)("Review","wp-marketing-automations-crm"))),Object(c.createElement)("div",{className:"bwf_clear_24"}),Object(c.createElement)("div",{className:"bwf-bulk-overview-wrapper"},Object(c.createElement)("div",{className:"bwf-bulk-overview-section"},Object(c.createElement)("div",{className:"bwf-bulk-header"},"Contacts"),Object(c.createElement)("div",{className:"bwf-bulk-data-wrap"},Object(c.createElement)("div",{className:"bwf-bulk-data-item"},Object(c.createElement)("div",{className:"bwf-bulk-data-item-label"},"Total Contacts"),Object(c.createElement)("div",{className:"bwf-bulk-data-item-value"},parseInt(P))),Object(c.createElement)("div",{className:"bwf-bulk-data-item"},Object(c.createElement)("div",{className:"bwf-bulk-data-item-label"},"Segment"),Object(c.createElement)("div",{className:"bwf-bulk-data-item-value"},Object(o.isEmpty)(A)?"-":Object(l.b)(A))))),Object(c.createElement)("div",{className:"bwf_clear_24"}),Object(c.createElement)("div",{className:"bwf-bulk-overview-section"},Object(c.createElement)("div",{className:"bwf-bulk-header"},"Actions"),Object(c.createElement)("div",{className:"bwf-bulk-data-wrap"},Object(c.createElement)("div",{className:"bwf-bulk-data-item"},Object(c.createElement)("div",{className:"bwf-bulk-data-item-value"},Object(c.createElement)(s.a,{actions:N,actionSchema:k,value:S}))))),Object(c.createElement)("div",{className:"bwf_clear_24"}),Object(c.createElement)("div",{className:"bwf-bulk-overview-section"},Object(c.createElement)("div",{className:"bwf-bulk-header"},"Automation"),Object(c.createElement)("div",{className:"bwf-bulk-data-wrap"},Object(c.createElement)("div",{className:"bwf-bulk-data-item"},Object(c.createElement)("div",{className:"bwf-bulk-data-item-label"},"Trigger automations"),Object(c.createElement)("div",{className:"bwf-bulk-data-item-value"},D?"Enable":"Disable"))))),Object(c.createElement)("div",{className:"bwf-bulk-action-footer"},Object(c.createElement)("div",{className:"bwf-display-flex bwf-space-between"},Object(c.createElement)(b.Button,{className:"bwf-display-flex",isSecondary:!0,onClick:function(){a(2)}},Object(i.__)("Previous","wp-marketing-automations-crm")),Object(c.createElement)(b.Button,{className:"bwf-display-flex",isPrimary:!0,onClick:C,isBusy:p},Object(i.__)("Start","wp-marketing-automations-crm")))))}},1205:function(e,t,a){"use strict";a.r(t);var c=a(0),n=a(2),r=a(4),i=a(3),o=a(820),l=a(815),s=a(202),b=a(8);a(429);function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);t&&(c=c.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,c)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){f(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function f(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],c=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(c=(i=o.next()).done)&&(a.push(i.value),!t||a.length!==t);c=!0);}catch(e){n=!0,r=e}finally{try{c||null==o.return||o.return()}finally{if(n)throw r}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return p(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,c=new Array(t);a<t;a++)c[a]=e[a];return c}var j=function(e){var t=e.index,a=e.actionInputType,o=e.group,l=e.actionData,u=e.setActionData,f=e.actionValue,p=e.customField,j=e.actions,d=e.setEdit,v=e.isOverview,w=O(Object(c.useState)("autonami"),2),y=(w[0],w[1]),E=O(Object(c.useState)({}),2),g=E[0],h=E[1];Object(c.useEffect)((function(){if(!Object(i.isEmpty)(o)){var e={};Object.keys(o).map((function(t){o[t].hasOwnProperty("actions")&&!Object(i.isEmpty)(o[t].actions)&&o[t].actions.map((function(a){e[a]=t}))})),h(e)}}),[o]),Object(c.useEffect)((function(){Object(i.isEmpty)(t)||y(g[t])}),[g,t]);var k=function(e){var t=[{label:Object(n.__)("Select Action","wp-marketing-automations-crm"),value:""}];return j.map((function(a){var c=!1;"autonami"!=g[a.value]&&(c=!0),l.hasOwnProperty(a.value)&&e!==a.value||c||(t.push({label:a.label,value:a.value}))})),t},N=function(e){var t="-";return Object(i.isEmpty)(j)||j.map((function(a){a.value==e&&(t=a.label)})),t};return v?Object(c.createElement)("div",{className:"bwf-group-select-overview"},Object(c.createElement)("div",{className:"bwf-group-select-overview-header"},Object(c.createElement)("div",{className:"bwf-group-select-action-name"},N(t)),Object(c.createElement)("div",{className:"bwf-group-select-action-events"},Object(c.createElement)("div",{onClick:function(){return d(t)}},Object(c.createElement)(b.a,{icon:"edit"})),Object(c.createElement)("div",{onClick:function(){var e=m({},l);delete e[t],u(e)}},Object(c.createElement)(b.a,{icon:"trash"})))),Object(c.createElement)("div",{className:"bwf-group-select-action-wrap"},Object(c.createElement)("div",{className:"bwf-group-select-action-style"},Object(c.createElement)("div",{className:"circle"}),t&&a.hasOwnProperty(t)&&!Object(i.isEmpty)(a[t])&&Object(c.createElement)(c.Fragment,null,Object(c.createElement)("div",{className:"line"}),Object(c.createElement)("div",{className:"circle from-bottom"}))),Object(c.createElement)("div",{className:"bwf-group-data-wrap"},Object(c.createElement)("div",{className:"bwf-group-select-action-data"},Object(c.createElement)("div",{className:"bwf-action-group"},Object(c.createElement)("div",{className:"bwf-bold-label"},Object(n.__)("Action","wp-marketing-automations-crm")),Object(c.createElement)("div",null,o.hasOwnProperty(g[t])&&o[g[t]].hasOwnProperty("label")?o[g[t]].label:"-")),Object(c.createElement)("div",{className:"bwf-action-map-icon"},Object(c.createElement)(b.a,{icon:"mapper",size:24})),Object(c.createElement)("div",{className:"bwf-action-action-selected"},Object(c.createElement)("div",{className:"bwf-bold-label"},Object(n.__)("Type")),Object(c.createElement)("div",null,N(t)))),Object(c.createElement)("div",{className:"bwf-group-data-values"},!p&&t&&a.hasOwnProperty(t)&&!Object(i.isEmpty)(a[t])&&Object(c.createElement)("div",{className:"bwf-bold-label"},Object(n.__)("Values","wp-marketing-automations-crm")),Object(c.createElement)("div",null,a.hasOwnProperty(t)&&!Object(i.isEmpty)(a[t])&&Object(c.createElement)(s.a,{selectorValue:f,data:t&&a.hasOwnProperty(t)?a[t]:{}})))))):Object(c.createElement)("div",{className:"bwf-group-select-edit"},Object(c.createElement)("div",{key:t,className:"bwf-action-selector-wrap"},Object(c.createElement)("div",{className:"bwf-action-select-wrp bwf-action-select"},Object(c.createElement)(r.SelectControl,{value:t,options:k(t),onChange:function(e){if(!Object(i.isEmpty)(e)){var a={};Object.entries(l).map((function(c){var n=O(c,2),r=n[0],i=n[1];r==t?a[e]={}:a[r]=i})),d(e),u(a)}},disabled:!(k(t).length>1)})),Object(c.createElement)("div",null)),!Object(i.isEmpty)(t)&&Object(c.createElement)("div",{className:p?"bwf-custom-field-wrapper":""},p&&Object(c.createElement)("div",{className:"bwf-custom-fields-row bwf-display-flex",style:{justifyContent:"flex-start"}},Object(c.createElement)("b",{className:"bwf-w-210"},Object(n.__)("Field","wp-marketing-automations-crm")),Object(c.createElement)("div",{className:"bwf-w-30"}),Object(c.createElement)("b",null,Object(n.__)("Value","wp-marketing-automations-crm"))),Object(c.createElement)(s.b,{selectorValue:f,escapeArrowIcon:!0,data:t&&a.hasOwnProperty(t)?a[t]:{},setActionSelectorValue:function(e){var a=m({},l);a[t]=e,u(a)}}),!p&&Object(c.createElement)("div",{className:"bwf_clear_10"}),Object(c.createElement)("div",{className:"bwf-display-flex bwf-mt-10",style:{justifyContent:"flex-start"}},"new"!=t&&Object(c.createElement)(r.Button,{isPrimary:!0,onClick:function(){d("")},className:"bwf-mr-10",disabled:Object(i.isEmpty)(f)&&!Object(i.isEmpty)(a[t])},Object(n.__)("Save","wp-marketing-automations-crm")),Object(c.createElement)(r.Button,{isSecondary:!0,onClick:function(){if("new"==t||Object(i.isEmpty)(f)){var e=m({},l);delete e[t],u(e)}d("")}},Object(n.__)("Cancel","wp-marketing-automations-crm")))))},d=function(e){var t=e.actions,a=e.actionSchema,o=e.value,l=void 0===o?{}:o,s=e.group,b=void 0===s?{}:s,u=e.setActionValue,f=O(Object(c.useState)(l),2),p=f[0],d=f[1],v=O(Object(c.useState)(""),2),w=v[0],y=v[1];Object(c.useEffect)((function(){var e=Object(i.cloneDeep)(p);e.hasOwnProperty("new")&&delete e.new,Object(i.isEmpty)(e)&&y("new")}),[]),Object(c.useEffect)((function(){Object(i.isEmpty)(p)?(d({new:{}}),y("new")):u(p)}),[p]);var E;return Object(c.createElement)(c.Fragment,null,function(){if(!Object(i.isEmpty)(w)){var e=!1;return"new"!==w&&a.hasOwnProperty(w)&&a[w].hasOwnProperty("type")&&"bwfupdatefield"===a[w].type&&(e=!0),Object(c.createElement)(j,{index:w,actionInputType:a,actionData:p,setActionData:d,actionValue:p[w],customField:e,group:b,actions:t,isOverview:!1,setEdit:y})}return Object(c.createElement)(c.Fragment,null,Object.entries(p).map((function(e,n){var r=O(e,2),i=r[0],o=r[1],l=!1;return"new"!==i&&a.hasOwnProperty(i)&&a[i].hasOwnProperty("type")&&"bwfupdatefield"===a[i].type&&(l=!0),Object(c.createElement)(j,{index:i,actionInputType:a,actionData:p,setActionData:d,actionValue:o,customField:l,group:b,actions:t,isOverview:!0,setEdit:y,key:n})})))}(),(E=!1,t.map((function(e){p.hasOwnProperty(e.value)||(E=!0)})),E&&Object(i.isEmpty)(w)&&Object(c.createElement)("div",{onClick:function(){var e=m(m({},p),{},{new:{}});d(e),y("new")}},Object(c.createElement)("div",{className:"bwf_clear_20"}),Object(c.createElement)(r.Button,{className:"bwf-cursor-pointer",isPrimary:!0},Object(n.__)("Add","wp-marketing-automations-crm")),Object(c.createElement)("div",{className:"bwf_clear_20"}))))},v=a(10),w=a.n(v),y=a(5),E=a(15),g=a(67);function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);t&&(c=c.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,c)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){N(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function N(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _(e,t,a,c,n,r,i){try{var o=e[r](i),l=o.value}catch(e){return void a(e)}o.done?t(l):Promise.resolve(l).then(c,n)}function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],c=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(c=(i=o.next()).done)&&(a.push(i.value),!t||a.length!==t);c=!0);}catch(e){n=!0,r=e}finally{try{c||null==o.return||o.return()}finally{if(n)throw r}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return S(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,c=new Array(t);a<t;a++)c[a]=e[a];return c}t.default=function(e){var t=Object(E.i)(),a=P(Object(c.useState)(""),2),s=a[0],b=a[1],u=e.bulkActionId,m=e.setStep,f=e.setPending,O=e.isPending,p=Object(l.a)().setSingleBulkActionValue,j=Object(o.a)(),v=j.getSingleBulkActionData,h=j.getActionGroup,N=j.getActionList,S=j.getActionSchemaList,A=v(),x=S(),D=N(),C=h(),T=A.actions,B=void 0===T?{}:T,I=A.contactFilters,V=void 0===I?{}:I,F=A.enable_automation_run,R=void 0!==F&&F,L=function(e){var t={};return Object.keys(e).map((function(e){if(Object(i.isEmpty)(B[e])||(t[e]=B[e]),Object(i.isObject)(t[e])){var a={};Object.keys(t[e]).map((function(c){Object(i.isEmpty)(t[e][c])||(a[c]=t[e][c])})),t[e]=a}Object(i.isEmpty)(t[e]&&Object(i.isEmpty)(x[e]))&&(t[e]=B[e])})),t},J=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,f(!0),t=L(B),!Object(i.isEmpty)(t)){e.next=6;break}return b("No actions selected"),e.abrupt("return");case 6:return e.next=8,w()({path:Object(y.m)("/bulk-action/".concat(u)),method:"POST",data:k(k({},A),{},{actions:t})}).then((function(e){200===e.code?e.hasOwnProperty("result")&&!Object(i.isEmpty)(e.result)&&(p("data",e.result),setTimeout((function(){m(3),f(!1)}),1e3)):(b(e.message),f(!1))}));case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),b(e.t0.message),f(!1);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})),function(){var t=this,a=arguments;return new Promise((function(c,n){var r=e.apply(t,a);function i(e){_(r,c,n,i,o,"next",e)}function o(e){_(r,c,n,i,o,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}();return Object(c.createElement)(c.Fragment,null,Object(c.createElement)(g.a,null),Object(c.createElement)("div",{className:"bwf-card-wrap"},Object(c.createElement)("div",{className:"bwf-card-header"},Object(n.__)("Actions","wp-marketing-automations-crm"))),Object(c.createElement)("div",{className:"bwf-bulk-action-wrapper"},s&&Object(c.createElement)(r.Notice,{status:"error",onRemove:function(){return b("")}},s),Object(c.createElement)("div",{className:"bwf-bulk-action-action-selector"},Object(c.createElement)("div",{className:"bwf-h4"},Object(n.__)("Add actions for selected contacts","wp-marketing-automations-crm")),Object(c.createElement)(d,{actions:D,actionSchema:x,group:C,value:Object(i.isEmpty)(B)?{new:{}}:B,setActionValue:function(e){p("data",k(k({},A),{},{actions:e}))}})),Object(c.createElement)("div",{className:"bwf_clear_30 bwf-bulk-action-line"}),Object(c.createElement)("div",{className:"bwf-bulk-action-action-selector"},Object(c.createElement)("div",{className:"bwf-h3"},Object(n.__)("Automation","wp-marketing-automations-crm")),Object(c.createElement)("div",{className:"bwf_clear_20"}),Object(c.createElement)(r.ToggleControl,{label:Object(n.__)("Trigger automations (for tag, list and status change related events)","wp-marketing-automations"),checked:R,className:"bwf-tooglecontrol-advance",onChange:function(e){p("data",k(k({},A),{},{enable_automation_run:e}))}})),Object(c.createElement)("div",{className:"bwf_clear_20"})),Object(c.createElement)("div",{className:"bwf-bulk-action-footer"},Object(c.createElement)("div",{className:"bwf-display-flex bwf-space-between"},Object(c.createElement)(r.Button,{className:"bwf-display-flex",isSecondary:!0,onClick:function(){Object(i.isEmpty)(V)||Object(E.k)(V,"/",t),m(1)}},Object(n.__)("Previous","wp-marketing-automations-crm")),Object(c.createElement)(r.Button,{className:"bwf-display-flex",isPrimary:!0,onClick:function(){Object(i.isEmpty)(B)?b(Object(n.__)("Please select some actions to perform on contacts.","wp-marketing-automations-crm")):J()},isBusy:O},Object(n.__)("Next","wp-marketing-automations-crm")))))}}}]);
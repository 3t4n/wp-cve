(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{1096:function(e,t,n){},1178:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(67),o=n(2),c=n(248),i=n(136);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var b=function(){var e=Object(i.a)("taskHistoryList"),t=e.getStateProp;return u(u({},m(e,["getStateProp"])),{},{getTaskHistory:function(){return t("tasks")},getPageNumber:function(){return parseInt(t("offset"))/parseInt(t("limit"))+1},getPerPageCount:function(){return parseInt(t("limit"))},getOffset:function(){return parseInt(t("offset"))},getTotalCount:function(){return parseInt(t("total"))},getLoadingStatus:function(){return t("isLoading")},getCompletedCount:function(){return t("completed")},getScheduledCount:function(){return t("scheduled")},getPausedCount:function(){return t("paused")},getFailedCount:function(){return t("failed")},getPageCountData:function(){return t("countData")}})},f=n(137),p=n(5);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var h=function(){var e=Object(f.a)("taskHistoryList"),t=e.fetch,n=e.setStateProp;return O(O({},j(e,["fetch","setStateProp"])),{},{fetch:function(e,n,r,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",c=n.s,i=void 0===c?"":c,s=n.automation,u=n.action,l={offset:r,limit:a,status:e,action_slug:u,automation_id:s,search:""!=o?o:i};t("GET",Object(p.m)("/automations/task-history"),l)},setTaskListValues:function(e,t){n(e,t)}})},y=n(3),v=n(59),w=n(91),k=n(16),_=n(4),E=n(135),S=n(10),P=n.n(S),C=n(6),T=n.n(C),x=(n(1096),n(15)),A=n(8),R=n(140),D=n(27);function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var M=function(e){var t=e.onSearch,n=N(Object(r.useState)([]),2),a=n[0],c=n[1];return Object(r.createElement)(D.a,{autocompleter:R.d,multiple:!1,allowFreeTextSearch:!0,inlineTags:!0,selected:a,onChange:function(e){c(e),t(Object(y.isEmpty)(e)?"":e[0].key)},placeholder:Object(o.__)("Search","wp-marketing-automations"),showClearButton:!0,disabled:!1,bwfMaintainSingleTerm:!0})},I=n(204),F=n(803);function B(e,t,n,r,a,o,c){try{var i=e[o](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,a)}var q=function(e){var t=e.isOpen,n=e.tasks,a=e.onSuccess,c=e.onError,i=e.onRequestClose,s=n?n.length:0,u=Object(F.a)(function(){var e,t=(e=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P()({path:Object(p.m)("/automations/tasks/"),method:"DELETE",data:{task_ids:t}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){B(o,r,a,c,i,"next",e)}function i(e){B(o,r,a,c,i,"throw",e)}c(void 0)}))});return function(e){return t.apply(this,arguments)}}(),{onSuccess:function(){setTimeout((function(){return u.reset()}),2500),a&&a()},onError:function(){c&&c()}});return Object(r.createElement)(E.a,{modalTitle:Object(o._n)("Delete Task","Delete Tasks",s,"wp-marketing-automations"),deleteDescriptionText:Object(r.createElement)(r.Fragment,null,Object(o.__)("You are about to delete ","wp-marketing-automations"),Object(o._n)("task","tasks",s,"wp-marketing-automations"),Object(o.__)(". This action cannot be undone. Cancel to stop, Delete to proceed.","wp-marketing-automations")),confirmButtonText:Object(o.__)("Delete","wp-marketing-automations"),cancelButtonText:Object(o.__)("Cancel","wp-marketing-automations"),onConfirm:function(){return u.mutate(n.map((function(e){return e.id})))},isLoading:u.isLoading,successMessage:u.isSuccess&&Object(o.__)("Tasks Deleted!","wp-marketing-automations"),errorMessage:u.isError&&(u.error&&u.error.message?u.error.message:Object(o.__)("Unable to delete tasks","wp-marketing-automations")),onRequestClose:function(){return!!i&&i()},isOpen:t,confirmDescription:Object(o.__)("This action is irreversible","wp-marketing-automations"),isDelete:!0})};function H(e,t,n,r,a,o,c){try{var i=e[o](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,a)}var U=function(e){var t=e.isOpen,n=e.tasks,a=e.onSuccess,c=e.onError,i=e.onRequestClose,s=e.screenType,u=Object(F.a)(function(){var e,t=(e=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P()({path:Object(p.m)("/automations/execute-tasks/"),method:"POST",data:{task_ids:t}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){H(o,r,a,c,i,"next",e)}function i(e){H(o,r,a,c,i,"throw",e)}c(void 0)}))});return function(e){return t.apply(this,arguments)}}(),{onSuccess:function(){setTimeout((function(){return u.reset()}),2500),a&&a()},onError:function(){c&&c()}});return Object(r.createElement)(E.a,{modalTitle:"failed"===s?Object(o.__)("Reschedule Task"):Object(o.__)("Execute Task"),deleteDescriptionText:"failed"===s?Object(o.__)("You are about to reschedule selected task. This action cannot be undone. Cancel to stop, Reschedule to proceed.","wp-marketing-automations"):Object(o.__)("You are about to execute selected task. This action cannot be undone. Cancel to stop, Execute to proceed.","wp-marketing-automations"),confirmButtonText:"failed"===s?Object(o.__)("Reschedule","wp-marketing-automations"):Object(o.__)("Execute","wp-marketing-automations"),cancelButtonText:Object(o.__)("Cancel","wp-marketing-automations"),onConfirm:function(){return u.mutate(n.map((function(e){return e.id})))},successMessage:u.isSuccess&&("failed"===s?Object(o.__)("Tasks Rescheduled!","wp-marketing-automations"):Object(o.__)("Tasks Executed!","wp-marketing-automations")),errorMessage:u.isError&&(u.error&&u.error.message?u.error.message:"failed"===s?Object(o.__)("Unable to reschedule tasks","wp-marketing-automations"):Object(o.__)("Unable to execute tasks","wp-marketing-automations")),onRequestClose:function(){return!!i&&i()},isOpen:t,isDelete:!0})};function Y(){return(Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return $(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var J=function(e){var t=e.floatingBarProps,n=void 0===t?{}:t,a=e.resetSelection,c=e.onSuccess,i=e.screenType,s=e.screenTypeId,u=G(Object(r.useState)([]),2),l=u[0],m=u[1],b=G(Object(r.useState)(!1),2),f=b[0],p=b[1],d=G(Object(r.useState)(!1),2),O=d[0],g=d[1],j=function(){a&&a(),m([])};Object(r.useEffect)((function(){j()}),[i]);var h,y,v=Object(r.useCallback)((function(e,t){switch(e){case"delete":m(t),p(!0);break;case"execute":m(t),g(!0)}}),[]);return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(I.a,Y({actions:(h=i,y=[{id:"delete",icon:"trash",hint:Object(o.__)("Delete Tasks","wp-marketing-automations")}],"completed"!==h&&y.push({id:"execute",icon:"play",hint:"failed"===h?Object(o.__)("Reschedule","wp-marketing-automations"):Object(o.__)("Execute","wp-marketing-automations")}),y),onAction:v},n)),Object(r.createElement)(q,{tasks:l,isOpen:f,onSuccess:function(){c&&c("delete",l),j()},onError:j,onRequestClose:function(){return p(!1)}}),Object(r.createElement)(U,{tasks:l,isOpen:O,onSuccess:function(){c&&c("execute",l),j()},onError:j,onRequestClose:function(){return g(!1)},screenType:i,screenTypeId:s}))};function Q(){return(Q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){z(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function K(e,t,n,r,a,o,c){try{var i=e[o](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,a)}function X(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){K(o,r,a,c,i,"next",e)}function i(e){K(o,r,a,c,i,"throw",e)}c(void 0)}))}}function Z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||ee(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(e,t){if(e){if("string"==typeof e)return te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?te(e,t):void 0}}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ne=function(e){var t=e.type,n=e.query,a=n.automation,i=n.action,s=h(),u=b(),l=Object(r.useContext)(p.d),m=s.fetch,f=s.setTaskListValues,d=u.getTaskHistory,O=u.getPageNumber,g=u.getPerPageCount,j=u.getTotalCount,S=u.getOffset,C=u.getLoadingStatus,R=u.getCompletedCount,D=u.getFailedCount,N=u.getPausedCount,L=u.getScheduledCount,F=Object(r.useRef)(new AbortController),B=Z(Object(r.useState)({loading:!1,status:!1}),2),q=B[0],H=B[1],U=Z(Object(r.useState)([]),2),Y=U[0],G=U[1],$=Z(Object(r.useState)([]),2),V=$[0],z=$[1],K=Z(Object(r.useState)(!1),2),te=K[0],ne=K[1],re=Z(Object(r.useState)({}),2),ae=re[0],oe=re[1],ce=Z(Object(r.useState)(""),2),ie=ce[0],se=ce[1],ue=[],le=Z(Object(r.useState)([]),2),me=(le[0],le[1]),be=d(),fe=g(),pe=S(),de=j(),Oe=O(),ge=C(),je=L(),he=D(),ye=R(),ve=N(),we="t_0";Object(y.isEmpty)(t)||("paused"===t?we="t_1":"completed"===t?we="l_1":"failed"===t&&(we="l_0")),Object(r.useEffect)((function(){me([]),m(we,n,pe,fe,ie)}),[pe,fe,t,a,i]);var ke=function(){var e=X(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P()({path:Object(p.m)("/automations/task-filters"),method:"GET",signal:F.current.signal}).then((function(e){200==e.code&&(e.result.hasOwnProperty("automations")&&G(Object.entries(e.result.automations).map((function(e){var t=Z(e,2),n=t[0];return{label:t[1],value:n}}))),e.result.hasOwnProperty("actions")&&z(e.result.actions&&Object.entries(e.result.actions).map((function(e){var t=Z(e,2),n=t[0];return{label:t[1],value:n}}))))})).catch((function(e){console.log(e)}));case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){return ke(),function(){F.current.abort()}}),[]);var _e=function(e){e!==fe&&f("limit",e)},Ee=function(){var e=X(regeneratorRuntime.mark((function e(t,r){var a,c,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="",c="",i="","delete"===r?(a=Object(p.m)("/automations/tasks"),c="DELETE",i="Deleting..."):"execute"===r?(a=Object(p.m)("/automations/execute-tasks"),c="POST",i="Executing..."):"run"===r&&(a=Object(p.m)("/automations/run-tasks"),c="POST",i="Running..."),l(i),!(Array.isArray(t)&&!Object(y.isEmpty)(t)||"run"===r&&parseInt(t)>0)){e.next=18;break}return e.prev=6,e.next=9,P()({path:a,method:c,data:{task_ids:t}}).then((function(e){if(200===e.code)H({status:!1}),m(we,n,0,fe,ie),l(e.message);else{var t=e&&e.message&&e.message.msg?e.message.msg:"";t=!t&&e&&e.message?e.message:t,l(t)}}));case 9:e.next=16;break;case 11:e.prev=11,e.t0=e.catch(6),s=!(s=e.t0&&e.t0.message&&e.t0.message.msg?e.t0.message.msg:"")&&e.t0&&e.t0.message?e.t0.message:s,l(s);case 16:e.next=19;break;case 18:l(Object(o.__)("No Task Selected","wp-marketing-automations"));case 19:Object(p.gb)(l,2e3);case 20:case"end":return e.stop()}}),e,null,[[6,11]])})));return function(t,n){return e.apply(this,arguments)}}(),Se=Object(r.useMemo)((function(){var e={};if(Array.isArray(be)){var t,n=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=ee(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return c=e.done,e},e:function(e){i=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(i)throw o}}}}(be);try{for(n.s();!(t=n.n()).done;){var r=t.value;e[r.id]=r}}catch(e){n.e(e)}finally{n.f()}}return e}),[be]),Pe=Object(I.b)(Se),Ce=Pe.singleSelectProps,Te=Pe.selectAllProps,xe=Pe.floatingBarProps,Ae=Pe.resetSelection,Re=be?be.map((function(e){var t,n=[{display:Object(r.createElement)(_.CheckboxControl,Q({"aria-label":Object(o.__)("Select","wp-marketing-automations")},Ce[e.id])),value:e.id},{display:(t=e,Object(r.createElement)(v.a,{label:Object(o.__)("Quick Actions","wp-marketing-automations"),menuPosition:"bottom right",renderContent:function(e){var n=e.onToggle;return Object(r.createElement)(r.Fragment,null,["t_0","t_1"].includes(we)&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(w.a,{isClickable:!0,onInvoke:function(){Ee(t.id,"run"),n()}},Object(r.createElement)(k.a,{justify:"flex-start"},Object(r.createElement)(k.c,null,Object(r.createElement)(A.a,{icon:"play"})),Object(r.createElement)(k.c,null,Object(o.__)("Run now","wp-marketing-automations"))))),Object(r.createElement)(w.a,{isClickable:!0,onInvoke:function(){var e={status:!0,deleteDescriptionText:Object(o.__)("You are about to delete task. This action cannot be undone. Cancel to stop, Delete to proceed.","wp-marketing-automations"),buttonConfirm:Object(o.__)("Delete","wp-marketing-automations"),buttonCancel:Object(o.__)("Cancel","wp-marketing-automations"),modalTitle:Object(o.__)("Delete Task")};H(W(W({},e),{},{onConfirm:function(){return Ee([t.id],"delete",e)}})),n()}},Object(r.createElement)(k.a,{justify:"flex-start"},Object(r.createElement)(k.c,null,Object(r.createElement)(A.a,{icon:"trash"})),Object(r.createElement)(k.c,null,Object(o.__)("Delete","wp-marketing-automations")))))}})),value:""},{display:"#"+e.id,value:""},{display:e.task_integration+" : "+e.task_integration_action,value:e.task_integration},{display:e.task_details?Object(r.createElement)("ul",{dangerouslySetInnerHTML:{__html:e.task_details}}):"-",value:""},{display:e.automation_name?Object(r.createElement)("a",{href:e.automation_url,className:"bwf-a-no-underline"},e.automation_name):"-",value:e.automation_name},{display:e.task_date?Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:e.task_date}}):"-",value:""},{display:Object(r.createElement)("div",{onClick:function(){oe(e),ne(!0)}},Object(r.createElement)(A.a,{icon:"view"})),value:""}];return ue.push(e.id),n})):[],De=Object(r.createElement)(r.Fragment,null,Object(o.__)("Scheduled","wp-marketing-automations"),parseInt(je)>0?Object(r.createElement)("span",{className:"bwf-crm-btn-group-count"},je):""),Ne=Object(r.createElement)(r.Fragment,null,Object(o.__)("Completed","wp-marketing-automations"),parseInt(ye)>0?Object(r.createElement)("span",{className:"bwf-crm-btn-group-count"},ye):""),Le=Object(r.createElement)(r.Fragment,null,Object(o.__)("Failed","wp-marketing-automations"),parseInt(he)>0?Object(r.createElement)("span",{className:"bwf-crm-btn-group-count"},he):""),Me=Object(r.createElement)(r.Fragment,null,Object(o.__)("Paused","wp-marketing-automations"),parseInt(ve)>0?Object(r.createElement)("span",{className:"bwf-crm-btn-group-count"},ve):""),Ie=T()("bwfcrm-task-list-table",{"has-search":!0}),Fe=[{cellClassName:"is-checkbox-column",key:"id",label:Object(r.createElement)(_.CheckboxControl,Q({"aria-label":Object(o.__)("Select","wp-marketing-automations")},Te)),required:!0},{key:"action",label:"",isLeftAligned:!0,required:!0,cellClassName:"bwf-col-action bwf-w-45"},{key:"task",label:Object(o.__)("Task","wp-marketing-automations"),isLeftAligned:!0,required:!0,cellClassName:"bwf-w-100"},{key:"actions",label:Object(o.__)("Action","wp-marketing-automations"),isLeftAligned:!0},{key:"data",label:Object(o.__)("Data","wp-marketing-automations"),isLeftAligned:!0},{key:"automation",label:Object(o.__)("Automation","wp-marketing-automations"),isLeftAligned:!0},{key:"date",label:Object(o.__)("Date","wp-marketing-automations"),isLeftAligned:!0},{key:"view",label:"",isLeftAligned:!0,cellClassName:"bwf-w-60"}],Be=Object(r.createElement)("div",{className:"bwf-page-filters bwf-display-flex bwf-flex"},Object(r.createElement)(_.SelectControl,{className:"bwf-w-300 bwf-mr-10",value:a||"",options:[{label:Object(o.__)("Select Automation","wp-marketing-automations"),value:""}].concat(Y),onChange:function(e){if(e)Object(x.k)({automation:e},"/",n);else{var t=n;delete t.automation,Object(x.k)({},"/",t)}}}),Object(r.createElement)(_.SelectControl,{className:"bwf-w-300 bwf-mr-10",value:i||"",options:[{label:Object(o.__)("Select Action","wp-marketing-automations"),value:""}].concat(V),onChange:function(e){if(e)Object(x.k)({action:e},"/",n);else{var t=n;delete t.action,Object(x.k)({},"/",t)}}}));Object(o.__)("Delete Contacts","wp-marketing-automations");return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(_.ButtonGroup,{className:"bwf-btn-group-tabs"},Object(r.createElement)(_.Button,{isPrimary:!t||"scheduled"===t,isSecondary:t&&"scheduled"!==t,onClick:function(){return Object(x.k)({path:"/automations-v1/task-history/scheduled"},"/",n)}},De),Object(r.createElement)(_.Button,{isPrimary:t&&"paused"===t,isSecondary:t&&"paused"!==t,onClick:function(){return Object(x.k)({path:"/automations-v1/task-history/paused"},"/",n)}},Me),Object(r.createElement)(_.Button,{isPrimary:t&&"completed"===t,isSecondary:t&&"completed"!==t,onClick:function(){return Object(x.k)({path:"/automations-v1/task-history/completed"},"/",n)}},Ne),Object(r.createElement)(_.Button,{isPrimary:t&&"failed"===t,isSecondary:t&&"failed"!==t,onClick:function(){return Object(x.k)({path:"/automations-v1/task-history/failed"},"/",n)}},Le)),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(c.a,{rows:Re,className:Ie,headers:Fe,query:{paged:Oe},rowsPerPage:fe,totalRows:de,isLoading:ge,onPageChange:function(e,t){f("offset",(e-1)*fe)},onQueryChange:function(e){return"per_page"!==e?function(){}:_e},rowHeader:!0,showMenu:!1,actions:[Object(r.createElement)("div",{className:"bwf-flex",key:"bwf-an-task-history-filters"},Be),Object(r.createElement)(M,{query:n,onSearch:function(e){se(e||""),m(we,n,0,fe,e)},key:"bwf-an-task-history-search"})],emptyMessage:Object(o.__)("No tasks found","wp-marketing-automations")}),te&&Object(r.createElement)(_.Modal,{onRequestClose:function(){return ne(!1)},className:"bwf-message-preview-modal bwf-admin-modal bwf-admin-modal-large bwf-task-model bwf-h--core-header"},Object(r.createElement)("div",{className:"bwf-modal-header"},Object(r.createElement)("div",{className:"bwf-modal-heading"},Object(o.__)("Details","wp-marketing-automations")),Object(r.createElement)("span",{onClick:function(){return ne(!1)},className:"bwf-modal-close"},Object(r.createElement)(A.a,{icon:"close",color:"#353030"}))),Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-150 bwf_bold bwf_align_center"},Object(o.__)("Automation","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf_align_center"},ae.automation_name)),Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-150 bwf_bold bwf_align_center"},Object(o.__)("Event","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf_align_center"},ae.automation_source+" : "+ae.automation_event)),Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-150 bwf_bold bwf_align_center"},Object(o.__)("Action","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf_align_center"},ae.task_integration+(ae.task_integration_action?" : ".concat(ae.task_integration_action):""))),Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey bwf-task-details"},Object(r.createElement)("ul",{className:"bwf_align_center",dangerouslySetInnerHTML:{__html:ae.task_details}})),!Object(y.isEmpty)(ae.task_message)&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-h3 bwf-pt-15"},Object(o.__)("Notes","wp-marketing-automations")),Object.entries(ae.task_message).map((function(e,t){var n=Z(e,2),a=n[0],o=n[1];return Object(r.createElement)("div",{className:"bwf-p-15",key:t},Object(r.createElement)("div",{className:"bwfcrm-task_notes_card"},o),Object(r.createElement)("div",{className:"bwfcrm-task_notes_time"},Object(r.createElement)("i",null,a)))}))))),Object(r.createElement)(E.a,{modalTitle:q.modalTitle,deleteDescriptionText:q.deleteDescriptionText,confirmButtonText:q.buttonConfirm,cancelButtonText:q.buttonCancel,onConfirm:q.onConfirm,isLoading:q.loading,successMessage:q.success,errorMessage:q.error,onRequestClose:function(){return H({status:!1})},isOpen:q.status,content:q.content,isDelete:!0}),Object(r.createElement)(J,{floatingBarProps:xe,resetSelection:Ae,onSuccess:function(){return m(we,n,0,fe)},screenType:t,screenTypeId:we}))},re=n(802),ae=n(139),oe=n(134);function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(n),!0).forEach((function(t){se(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.default=function(e){var t=(0,b().getPageCountData)(),n=Object(ae.a)().getPageCountData,o=Object(oe.a)().setPageCountData,c=n();Object(r.useEffect)((function(){o(ie(ie({},c),t))}),[t]),Object(re.a)("task-history","","","","",0),Object(p.g)("Task History");var i=e.match.params.type,s=Object(x.i)();return Object(r.createElement)(a.a,null,Object(r.createElement)("div",{className:"bwfcrm-task-list"},Object(r.createElement)(ne,{query:s,type:i})))}},802:function(e,t,n){"use strict";var r=n(0),a=n(134),o=n(2),c=n(5),i=n(51),s=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={workflow:{name:Object(o.__)("Workflow","wp-marketing-automations"),link:t?"admin.php?page=autonami&path=/automation/".concat(e):"admin.php?page=autonami-automations&edit=".concat(e)}};return t&&(n.analytics={name:Object(o.__)("Analytics","wp-marketing-automations"),link:t?"admin.php?page=autonami&path=/automation/".concat(e,"/analytics"):"admin.php?page=autonami&path=/automation-v1/".concat(e,"/analytics"),isProFeature:!0,showOnClick:!0},n.contacts={name:Object(o.__)("Contacts","wp-marketing-automations"),link:"admin.php?page=autonami&path=/automation/".concat(e,"/contacts"),isProFeature:!0,showOnClick:!0}),n.engagement={name:Object(o.__)("Engagements","wp-marketing-automations"),link:t?"admin.php?page=autonami&path=/automation/".concat(e,"/engagements"):"admin.php?page=autonami&path=/automation-v1/".concat(e,"/engagements"),isProFeature:!0,showOnClick:!0},Object(c.yb)()&&(n.orders={name:Object(o.__)("Orders","wp-marketing-automations"),link:t?"admin.php?page=autonami&path=/automation/".concat(e,"/orders"):"admin.php?page=autonami&path=/automation-v1/".concat(e,"/orders"),isProFeature:!0,showOnClick:!0}),n};t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",c=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,m=arguments.length>6&&void 0!==arguments[6]&&arguments[6],b=arguments.length>7&&void 0!==arguments[7]&&arguments[7],f=arguments.length>8&&void 0!==arguments[8]&&arguments[8],p=bwfcrm_contacts_data&&bwfcrm_contacts_data.header_data?bwfcrm_contacts_data.header_data:{},d=p.automation_nav,O=p.automationv2_nav,g=Object(a.a)(),j=g.setActiveMultiple,h=g.resetHeaderMenu,y=g.setL2NavType,v=g.setL2Nav,w=g.setBackLink,k=g.setL2Title,_=g.setL2Content,E=g.setBackLinkLabel,S=g.setL2NavAlign,P=g.setPageHeader;return Object(r.useEffect)((function(){h(),!c&&y("menu"),f||v(l?s(l,b):b?O:d),j({leftNav:b?"automations-v2":"automations-v1",rightNav:e}),n&&w(n),l&&w(n&&!b?"admin.php?page=autonami&path=/automations-v1":"admin.php?page=autonami&path=/automations"),c||b&&l&&E(Object(o.__)("All Automations","wp-marketing-automations-crm")),!b&&l&&E(Object(o.__)("All Automations","wp-marketing-automations")),l&&S("left"),t&&k(t),!n&&u&&_(u),P(b?"Automations":Object(r.createElement)(r.Fragment,null,"Automations",Object(r.createElement)(i.a,{label:"Legacy"}))),m&&v({})}),[e,b,f]),!0}},803:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(12),a=n(7),o=n.n(a),c=n(25),i=n(13),s=n(26),u=n(253),l=function(e){function t(t,n){var r;return(r=e.call(this)||this).client=t,r.setOptions(n),r.bindMethods(),r.updateResult(),r}Object(s.a)(t,e);var n=t.prototype;return n.bindMethods=function(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)},n.setOptions=function(e){this.options=this.client.defaultMutationOptions(e)},n.onUnsubscribe=function(){var e;this.listeners.length||(null==(e=this.currentMutation)||e.removeObserver(this))},n.onMutationUpdate=function(e){this.updateResult();var t={listeners:!0};"success"===e.type?t.onSuccess=!0:"error"===e.type&&(t.onError=!0),this.notify(t)},n.getCurrentResult=function(){return this.currentResult},n.reset=function(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})},n.mutate=function(e,t){return this.mutateOptions=t,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,Object(r.a)({},this.options,{variables:void 0!==e?e:this.options.variables})),this.currentMutation.addObserver(this),this.currentMutation.execute()},n.updateResult=function(){var e=this.currentMutation?this.currentMutation.state:Object(u.b)();this.currentResult=Object(r.a)({},e,{isLoading:"loading"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset})},n.notify=function(e){var t=this;c.a.batch((function(){t.mutateOptions&&(e.onSuccess?(null==t.mutateOptions.onSuccess||t.mutateOptions.onSuccess(t.currentResult.data,t.currentResult.variables,t.currentResult.context),null==t.mutateOptions.onSettled||t.mutateOptions.onSettled(t.currentResult.data,null,t.currentResult.variables,t.currentResult.context)):e.onError&&(null==t.mutateOptions.onError||t.mutateOptions.onError(t.currentResult.error,t.currentResult.variables,t.currentResult.context),null==t.mutateOptions.onSettled||t.mutateOptions.onSettled(void 0,t.currentResult.error,t.currentResult.variables,t.currentResult.context))),e.listeners&&t.listeners.forEach((function(e){e(t.currentResult)}))}))},t}(n(52).a),m=n(251);function b(e,t,n){var a=o.a.useRef(!1),s=o.a.useState(0)[1],u=Object(i.k)(e,t,n),b=Object(m.b)(),f=o.a.useRef();f.current?f.current.setOptions(u):f.current=new l(b,u);var p=f.current.getCurrentResult();o.a.useEffect((function(){a.current=!0;var e=f.current.subscribe(c.a.batchCalls((function(){a.current&&s((function(e){return e+1}))})));return function(){a.current=!1,e()}}),[]);var d=o.a.useCallback((function(e,t){f.current.mutate(e,t).catch(i.i)}),[]);if(p.error&&f.current.options.useErrorBoundary)throw p.error;return Object(r.a)({},p,{mutate:d,mutateAsync:p.mutate})}}}]);
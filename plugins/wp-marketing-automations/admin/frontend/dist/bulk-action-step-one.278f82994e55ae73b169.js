(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{1204:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(4),c=n(2),o=n(10),l=n.n(o),i=n(3),s=n(829),b=n(822),u=n(144),f=n(5),m=n(15),d=n(68),p=n(16),O=n(267),j=n(38),y=n(250),g=n(8),v=n(248),w=n(6),h=n.n(w),_=n(816),E=n(807),P=n(255);function N(e){return function(e){if(Array.isArray(e))return x(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||S(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,c=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,c=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw c}}return n}(e,t)||S(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){if(e){if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(e,t):void 0}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var I=Object(d.a)(Object(f.Y)()).formatAmount,A=function(e){var t=e.setContactCount,n=e.excludedIds,o=void 0===n?[]:n,l=e.setExcluded,s=e.query,b=function(e){var t=Object(i.isEmpty)(e.country)?"":P[e.country],n=Object(f.zb)([e.city,e.state,t],", ");return Object(i.isEmpty)(Object(i.trim)(n))?"":n},u=function(e){var t=b(e);return e.country||t?Object(r.createElement)(p.a,{justify:"start"},!Object(i.isEmpty)(e.country)&&Object(r.createElement)(p.c,null,Object(r.createElement)(O.a,{code:e.country,size:18})),Object(r.createElement)(p.c,null,t&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("span",null,b(e)),Object(r.createElement)("br",null)))):"-"},m=function(e){return Object(r.createElement)(j.a,{href:"admin.php?page=autonami&path=/contact/"+e.id,className:"bwf-a-no-underline"},Object(r.createElement)(y.a,{contact:e,hideJoiningDate:!0}))},d=function(e){return Object(r.createElement)("div",{className:"bwf-c-contact-details-cell"},e.email&&Object(r.createElement)(p.a,{justify:"start",align:"top"},Object(r.createElement)(p.c,null,Object(r.createElement)(g.a,{icon:"mail"})),Object(r.createElement)(p.c,null,Object(r.createElement)(j.a,{href:"mailto:"+e.email,className:"bwf-a-no-underline",type:"external"},e.email))),e.phone&&Object(r.createElement)(p.a,{justify:"start",align:"top"},Object(r.createElement)(p.c,null,Object(r.createElement)(g.a,{icon:"phone"})),Object(r.createElement)(p.c,null,Object(r.createElement)(j.a,{href:"tel:"+e.phone,className:"bwf-a-no-underline",type:"external"},e.phone))))},w=Object(_.a)(),S=w.getPageNumber,x=w.getPerPageCount,A=w.getTotalCount,C=w.getLoading,D=w.getContacts,L=Object(E.a)().fetch,T=D(),F=S(),q=x(),R=A(),B=C(),J=k(Object(r.useState)(!0),2),G=J[0],M=J[1],z=k(Object(r.useState)(s),2),U=z[0],$=z[1];Object(r.useEffect)((function(){B||(G&&R>0&&M(!1),t(parseInt(R)))}),[R]),Object(r.useEffect)((function(){G||JSON.stringify(U)===JSON.stringify(s)||($(s),L(s,0,q,!0,!1,"",!1))}),[s]);var Q=[{cellClassName:"is-checkbox-column",key:"id",label:"",required:!0},{key:"contact",label:Object(c.__)("Contact","wp-marketing-automations"),isLeftAligned:!0,required:!0},{key:"contact_details",label:Object(c.__)("Details","wp-marketing-automations"),isLeftAligned:!0}];Object(f.yb)()?(Q.push({key:"total_spent",label:Object(c.__)("Total Spent","wp-marketing-automations"),isLeftAligned:!0}),Q.push({key:"last_order",label:Object(c.__)("Last Order","wp-marketing-automations"),isLeftAligned:!0})):Q.push({key:"column_location",label:Object(c.__)("Location","wp-marketing-automations"),isLeftAligned:!0});var V=function(e){var t=e.wc,n=t.total_order_count,a=t.total_order_value;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-c-listing-total-spent"},a&&n?Object(r.createElement)("div",{className:"bwf-c-total-spent-amount"},I(a)," |"," ",n," ",Object(c.__)(parseInt(n)>1?"orders":"order","wp-marketing-automations")):"-"))},Y=function(e){var t=e.wc.l_order_date;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",null,t&&"0000-00-00"!=t?Object(r.createElement)("div",{className:"bwf-c-total-spent-amount"},Object(f.N)(t)):"-"))},H=T.map((function(e){var t=function(e){return Object(i.merge)({id:0,email:"-",first_name:"",last_name:"",creation_date:"",fields:{marketing_status:"0",first_order_date:"",country:"",city:"",state:"",phone:""},wc:{id:1,l_order_date:"",total_order_count:0,total_order_value:0,total_purchased_items:0}},e)}(e),n=[{display:Object(r.createElement)(a.CheckboxControl,{onChange:function(e){return n=t.id,void l(e?o.filter((function(e){return e!==n})):[].concat(N(o),[n]));var n},"aria-label":Object(c.__)("Select"),checked:-1===o.indexOf(t.id)}),value:t.id},{display:m(t),value:Object(f.zb)([t.first_name,t.last_name]," ")},{display:d(t),value:Object(c.__)("Email: "+t.email+", Phone: "+t.phone,"wp-marketing-automations")}];return Object(f.yb)()?(n.push({display:V(t),value:""}),n.push({display:Y(t),value:""})):n.push({display:u(t),value:b(t)}),n})),K=function(e){e!==q&&L(s,0,e,!0,!1,"",!1)},W=h()("bwfcrm-contacts-list",{"has-search":!0}),X=parseInt(R)>0?" ("+(parseInt(R)-parseInt(o.length))+")":"";return Object(r.createElement)(v.a,{className:W,title:Object(c.__)("Contacts ","wp-marketing-automations")+X,rows:H,headers:Q,query:{paged:F},rowsPerPage:q,totalRows:R,isLoading:B,onPageChange:function(e,t){L(s,(e-1)*q,q)},onQueryChange:function(e){return"per_page"!==e?function(){}:K},showMenu:!1,emptyMessage:Object(c.__)("No contacts found","wp-marketing-automations")})};A.defaultProps={contacts:[]};var C=A,D=n(815),L=n(820),T=n(149),F=n(67);function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J(e,t,n,r,a,c,o){try{var l=e[c](o),i=l.value}catch(e){return void n(e)}l.done?t(i):Promise.resolve(i).then(r,a)}function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,c=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,c=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function z(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}t.default=function(e){var t=e.bulkActionId,n=e.setStep,o=e.setPending,d=e.isPending,p=Object(b.a)(!0),O=p.isLoading,j=p.filters,y=Object(m.i)(),g=y.page,v=y.path,w=z(y,["page","path"]),h=Object(E.a)(),_=G(Object(r.useState)(!0),2),P=_[0],N=_[1],k=G(Object(r.useState)(!1),2),S=k[0],x=k[1],I=G(Object(r.useState)(""),2),A=I[0],q=I[1],B=Object(D.a)().setSingleBulkActionValue,M=Object(L.a)(),U=M.getSingleBulkActionData,$=M.getSingleBulkActionLoad,Q=U(),V=$(),Y=Q.contactFilters,H=void 0===Y?{}:Y,K=Q.count,W=void 0===K?0:K,X=Q.exclude_ids,Z=void 0===X?[]:X;Object(r.useEffect)((function(){V||O||(Object(i.isEmpty)(H)||Object(m.k)(H,"/",y),N(!1))}),[H,O,V]);var ee=h.fetch;Object(r.useEffect)((function(){S||P||O||V||ee(w,0,10,!0,!1,"",!1)}),[P,O]);var te=function(){var e,r=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o(!0),x(!0),e.next=5,l()({path:Object(f.m)("/bulk-action/".concat(t)),method:"POST",data:R(R({},Q),{},{contactFilters:w,exclude_ids:Z,count:parseInt(W)-parseInt(Z.length)})}).then((function(e){200==e.code?e.hasOwnProperty("result")&&!Object(i.isEmpty)(e.result)&&(B("data",e.result),setTimeout((function(){x(!1),n(2),Object(m.k)({page:g,path:v},"/",{}),o(!1)}),1e3)):(q(e.message),x(!1),o(!1))}));case 5:e.next=12;break;case 7:e.prev=7,e.t0=e.catch(0),q(e.t0.message),o(!1),x(!1);case 12:case"end":return e.stop()}}),e,null,[[0,7]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var c=e.apply(t,n);function o(e){J(c,r,a,o,l,"next",e)}function l(e){J(c,r,a,o,l,"throw",e)}o(void 0)}))});return function(){return r.apply(this,arguments)}}(),ne=Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-card-wrap"},Object(r.createElement)("div",{className:"bwf-card-header"},Object(c.__)("Contacts","wp-marketing-automations-crm"))),Object(r.createElement)("div",{className:"bwf-bulk-action-step-loading bwf-p-20"},Object(r.createElement)("div",{className:"bwf-filter-placeholder "},Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"bwf-display-flex bwf-space-between bwf-p-20 bwf-pt-0 bwf-pb-0"},Object(r.createElement)("div",{className:"bwf-w-150"},Object(r.createElement)("div",{className:"bwf-placeholder-temp"})),Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-btn"})),Object(r.createElement)("div",{className:"bwf-w-300 bwf-p-20 bwf-pt-0 bwf-pb-0"},Object(r.createElement)("div",{className:"bwf-placeholder-temp"})),Object(r.createElement)("div",{className:"bwf-display-flex bwf-space-between bwf-p-20 bwf-pt-0 bwf-pb-0"},Object(r.createElement)("div",null),Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-btn"})),Object(r.createElement)("div",{className:"bwf_clear_20"})),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"bwf-w-150"},Object(r.createElement)("div",{className:"bwf-placeholder-temp"})),Object(r.createElement)(T.a,{numberOfRows:10,headers:[{key:"2",label:Object(r.createElement)("div",{className:"bwf-w-210"},Object(r.createElement)("div",{className:"bwf-placeholder-temp no-margin"}))},{key:"3",label:Object(r.createElement)("div",{className:"bwf-w-210"},Object(r.createElement)("div",{className:"bwf-placeholder-temp no-margin"}))},{key:"4",label:Object(r.createElement)("div",{className:"bwf-w-210"},Object(r.createElement)("div",{className:"bwf-placeholder-temp no-margin"}))}]}),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"bwf-bulk-action-footer"},Object(r.createElement)("div",{className:"bwf-display-flex bwf-space-between"},Object(r.createElement)("div",null),Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-btn"})))));return P||O||V?ne:Object(r.createElement)(r.Fragment,null,Object(r.createElement)(F.a,null),Object(r.createElement)("div",{className:"bwf-card-wrap"},Object(r.createElement)("div",{className:"bwf-card-header"},Object(c.__)("Contacts","wp-marketing-automations-crm"))),Object(r.createElement)("div",{className:"bwf-bulk-action-wrapper"},A&&Object(r.createElement)(a.Notice,{status:"error",onRemove:function(){return q("")}},A),Object(r.createElement)("div",{className:"bwf-bulk-action-contact-filter"},Object(r.createElement)("div",{className:"bwf-display-flex",style:{justifyContent:"space-between"}},Object(r.createElement)("div",{className:"bwf-h3 bwf-w-300"},Object(c.__)("Segment Contacts","wp-marketing-automations-crm")),Object(r.createElement)(s.c,{addAdvance:!1})),Object(r.createElement)("div",{className:"bwf-p-0"},Object(r.createElement)(u.a,{siteLocale:"en-US",currency:Object(f.yb)()?bwfcrm_contacts_data.currency:{},config:{title:Object(c.__)("Select Rules","wp-marketing-automations-crm"),filters:j,footerComponent:function(e){return Object(r.createElement)(s.a,{filter:e.data,config:e.config})},enableGrouping:!0},path:"/bulk-action/".concat(t),query:y,onAdvancedFilterAction:function(e,t){["filter","clear_all"].includes(e)&&B("data",R(R({},Q),{},{exclude_ids:[]}))}}))),Object(r.createElement)("div",{className:"bwf-bulk-action-table-wrapper"},Object(r.createElement)(C,{setContactCount:function(e){B("data",R(R({},Q),{},{count:parseInt(e)}))},excludedIds:Z,setExcluded:function(e){B("data",R(R({},Q),{},{exclude_ids:e}))},query:w}))),Object(r.createElement)("div",{className:"bwf-bulk-action-footer"},Object(r.createElement)("div",{className:"bwf-display-flex bwf-space-between"},Object(r.createElement)("div",null),Object(r.createElement)(a.Button,{className:"bwf-display-flex",isPrimary:!0,onClick:function(){W>0?te():q(Object(c.__)("Please select some contacts to perform bulk actions on them.","wp-marketing-automations-crm"))},isBusy:d,disabled:S||P||O||V},Object(c.__)("Next","wp-marketing-automations-crm")))))}},807:function(e,t,n){"use strict";var r=n(137),a=n(5),c=n(3);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}t.a=function(){var e=Object(r.a)("contacts"),t=e.fetch;return l(l({},s(e,["fetch"])),{},{fetch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,b=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],f=arguments.length>8&&void 0!==arguments[8]&&arguments[8],m=e.s,d=void 0===m?"":m,p=(e.page,e.filter,e.path,s(e,["s","page","filter","path"])),O={offset:n,limit:r,search:d,filters:p,get_wc:Object(a.yb)(),grab_totals:o,only_count:l,fetch_base:i,grab_custom_fields:!1,exclude_unsubs:b,exclude_unsubs_lists:u},j=Object(a.ab)("table_sort_data"),y=j.hasOwnProperty("contact_sort_data")?j.contact_sort_data:{},g=Object(c.isObject)(y)&&!Object(c.isEmpty)(y)?y:{},v=g.orderby,w=void 0===v?"last_modified":v,h=g.order,_=void 0===h?"desc":h;_&&w&&(O.order=_,O.order_by=w),f&&(O.unopen_broadcast=parseInt(f)),t("GET",Object(a.m)("/contacts"),O)},fetchListing:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,b=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],f=arguments.length>8&&void 0!==arguments[8]&&arguments[8],m=e.s,d=void 0===m?"":m,p=(e.page,e.filter,e.path,s(e,["s","page","filter","path"])),O={offset:n,limit:r,search:d,filters:p,get_wc:Object(a.yb)(),grab_totals:o,only_count:l,fetch_base:i,grab_custom_fields:!1,exclude_unsubs:b,exclude_unsubs_lists:u},j=Object(a.ab)("table_sort_data"),y=j.hasOwnProperty("contact_sort_data")?j.contact_sort_data:{},g=Object(c.isObject)(y)&&!Object(c.isEmpty)(y)?y:{},v=g.orderby,w=void 0===v?"last_modified":v,h=g.order,_=void 0===h?"desc":h;_&&w&&(O.order=_,O.order_by=w),f&&(O.unopen_broadcast=parseInt(f)),t("GET",Object(a.m)("/contacts/listing"),O)},startIndexing:function(){return t("GET",Object(a.m)("/contacts"),{start_indexing:!0})}})}},816:function(e,t,n){"use strict";var r=n(136);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}t.a=function(){var e=Object(r.a)("contacts"),t=e.getStateProp;return c(c({},l(e,["getStateProp"])),{},{getContacts:function(){return t("contacts_list")},getPageNumber:function(){return parseInt(t("offset"))/parseInt(t("limit"))+1},getPerPageCount:function(){return parseInt(t("limit"))},getTotalCount:function(){return parseInt(t("total"))},getCountData:function(){return t("countData")}})}}}]);
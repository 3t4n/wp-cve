(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{1177:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(17),c=n(2),o=n(137),i=n(5);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var b=function(){var e=Object(o.a)("campaignList"),t=e.fetch,n=e.setStateProp;return u(u({},m(e,["fetch","setStateProp"])),{},{fetch:function(e,n,a,r,c){var o=n.s,s=(n.page,n.filter,n.path,{offset:a,limit:r,type:e,search:o,filters:m(n,["s","page","filter","path"]),status:c});t("GET",Object(i.m)("/broadcasts"),s)},setCamapignListValues:function(e,t){n(e,t)}})},f=n(136);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var j=function(){var e=Object(f.a)("campaignList"),t=e.getStateProp;return d(d({},g(e,["getStateProp"])),{},{getCampaigns:function(){return t("campaigns")},getPageNumber:function(){return parseInt(t("offset"))/parseInt(t("limit"))+1},getPerPageCount:function(){return parseInt(t("limit"))},getOffset:function(){return parseInt(t("offset"))},getTotalCount:function(){return parseInt(t("total"))},getLoadingStatus:function(){return t("isLoading")},getPageCountData:function(){return t("countData")}})},h=n(10),w=n.n(h),y=n(248),v=n(785),_=n(59),E=n(4),k=n(91),P=n(27),C=n(32),S=n.n(C),x=n(115),N=n.n(x),I=n(31),A=n.n(I),R=n(3),D=n(15),B=n(14),L=n.n(B);function T(e,t,n,a,r,c,o){try{var i=e[c](o),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(a,r)}function M(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){T(c,a,r,o,i,"next",e)}function i(e){T(c,a,r,o,i,"throw",e)}o(void 0)}))}}var F=function(e){var t=e.query,n=e.status,o=e.type,s=t.hasOwnProperty("s")?t.s:"",u=function(e){return e.title},l=S()(s)?[]:[{key:s,label:Object(c.__)("Search Broadcast: ","wp-marketing-automations")+s,bwfLabelSource:"bwfcrm_campaign",isSearchTerm:!0}],m={name:"campaigns",className:"bwf-search-bwf-campaign-result",options:function(e){return(t=M(regeneratorRuntime.mark((function e(t){var a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={limit:5,offset:0,type:o,status:n},""!==t&&(a.search=t),e.next=4,w()({path:Object(i.m)("/broadcasts?"+Object(r.stringify)(a)),method:"GET"});case 4:return c=e.sent,e.abrupt("return",A()(c,"result")?c.result.campaigns:[]);case 6:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})(e);var t},isDebounced:!0,getOptionIdentifier:function(e){return e.id},getOptionKeywords:function(e){return[e.title]},getFreeTextOptions:function(e,t){return[{key:"name",label:Object(a.createElement)("span",{key:"name",className:"bwf-search-result-name"},L()({mixedString:Object(c.__)("All Broadcast with title that include {{query /}}","wp-marketing-automations"),components:{query:Object(a.createElement)("strong",{className:"components-form-token-field__suggestion-match"},e)}})),value:{id:e,name:e,campaigns:t.map((function(e){return A()(e,"value")?e.value:e})),searchTerm:e}}]},getOptionLabel:function(e,t){var n=Object(i.i)(u(e),t)||{};return Object(a.createElement)("span",{key:"name",className:"bwf-search-result-name","aria-label":u(e)},Object.keys(n).length>0?Object(a.createElement)(a.Fragment,null,n.suggestionBeforeMatch,Object(a.createElement)("strong",{className:"components-form-token-field__suggestion-match"},n.suggestionMatch),n.suggestionAfterMatch):u(e))},getOptionCompletion:function(e){return e}},b=function(){var e=M(regeneratorRuntime.mark((function e(n){var a,r,c,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(N()(n)){e.next=2;break}return e.abrupt("return");case 2:if(S()(n)||(a=n[n.length-1],(n=[])[0]=a),r=n.find((function(e){return A()(e,"searchTerm")})),!(Object(R.isUndefined)(r)&&n.length>0&&n[0].hasOwnProperty("id"))){e.next=7;break}return Object(D.k)({path:"/broadcast/"+n[0].id},"/",t),e.abrupt("return");case 7:if(c=Object(R.isUndefined)(r)?void 0:r.searchTerm,o=A()(t,"s")&&!S()(t.s)?t.s:"",c!==o){e.next=11;break}return e.abrupt("return");case 11:Object(D.k)({s:c},"/broadcasts",t);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.createElement)(P.a,{autocompleter:m,multiple:!1,allowFreeTextSearch:!0,inlineTags:!0,selected:l,onChange:b,placeholder:Object(c.__)("Search by name","wp-marketing-automations"),showClearButton:!0,disabled:!1,bwfEnableEmptySearch:!0})},q=n(68),U=n(16),z=(n(953),n(254)),V=n(256),G=n(44),Y=n(6),$=n.n(Y),H=n(8),W=n(28),J=n(204),K=n(803),Q=n(135);function X(e,t,n,a,r,c,o){try{var i=e[c](o),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(a,r)}function Z(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){X(c,a,r,o,i,"next",e)}function i(e){X(c,a,r,o,i,"throw",e)}o(void 0)}))}}var ee=function(e){var t=e.isOpen,n=e.tasks,r=e.onSuccess,o=e.onError,s=e.onRequestClose,u=e.actionType,l=n?n.length:0,m=Object(K.a)(function(){var e=Z(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w()({path:Object(i.m)("/bulk-action/broadcast"),method:"DELETE",data:{ids:t}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{onSuccess:function(){setTimeout((function(){return m.reset()}),2500),r&&r()},onError:function(){o&&o()}}),b=function(){var e=Z(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.mutate(n.map((function(e){return e.id})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f={delete:{title:Object(c._n)("Delete Broadcast","Delete Broadcasts",l,"wp-marketing-automations"),description:Object(a.createElement)(a.Fragment,null,Object(c.__)("You are about to delete ","wp-marketing-automations"),Object(c._n)("broadcast","broadcasts",l,"wp-marketing-automations"),Object(c.__)(". This action cannot be undone. Cancel to stop, Delete to proceed.","wp-marketing-automations")),confirmBtn:Object(c.__)("Delete","wp-marketing-automations"),cancelBtn:Object(c.__)("Cancel","wp-marketing-automations"),successMsg:Object(c.__)("Bulk action executed successfully","wp-marketing-automations"),errorMsg:Object(c.__)("Unable to delete broadcast","wp-marketing-automations"),confirmDescription:Object(c.__)("This action is irreversible","wp-marketing-automations")}};return Object(a.createElement)(Q.a,{modalTitle:f.hasOwnProperty(u)&&f[u].hasOwnProperty("title")?f[u].title:Object(c._n)("Perform Actions","Perform Actions",l,"wp-marketing-automations"),deleteDescriptionText:f.hasOwnProperty(u)&&f[u].hasOwnProperty("description")?f[u].description:"",confirmButtonText:f.hasOwnProperty(u)&&f[u].hasOwnProperty("confirmBtn")?f[u].confirmBtn:Object(c.__)("Confirm","wp-marketing-automations"),cancelButtonText:f.hasOwnProperty(u)&&f[u].hasOwnProperty("cancelBtn")?f[u].cancelBtn:Object(c.__)("Cancel","wp-marketing-automations"),onConfirm:b,isLoading:m.isLoading,successMessage:m.isSuccess&&(f.hasOwnProperty(u)&&f[u].hasOwnProperty("successMsg")?f[u].successMsg:Object(c.__)("Actions Done!","wp-marketing-automations")),errorMessage:m.isError&&(m.error&&m.error.message?m.error.message:f.hasOwnProperty(u)&&f[u].hasOwnProperty("errorMsg")?f[u].errorMsg:Object(c.__)("Unable to perform action","wp-marketing-automations")),onRequestClose:function(){return!!s&&s()},isOpen:t,confirmDescription:f.hasOwnProperty(u)&&f[u].hasOwnProperty("confirmDescription")?f[u].confirmDescription:"",isDelete:!0})};function te(){return(te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ne(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ae(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var re=function(e){var t=e.floatingBarProps,n=void 0===t?{}:t,r=e.resetSelection,o=e.onSuccess,i=e.screenType,s=e.screenTypeId,u=e.automationId,l=ne(Object(a.useState)([]),2),m=l[0],b=l[1],f=ne(Object(a.useState)(!1),2),p=f[0],d=f[1],O=ne(Object(a.useState)(""),2),g=O[0],j=O[1],h=function(){r&&r(),b([])};Object(a.useEffect)((function(){h()}),[i]);var w=Object(a.useCallback)((function(e,t){b(t),j(e),d(!0)}),[]);return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(J.a,te({actions:[{id:"delete",icon:"trash",hint:Object(c.__)("Delete","wp-marketing-automations")}],onAction:w},n)),Object(a.createElement)(ee,{tasks:m,isOpen:p,onSuccess:function(){o&&o(g,m),h()},onError:h,onRequestClose:function(){return d(!1)},screenType:i,screenTypeId:s,actionType:g,automationId:u}))},ce=n(805);function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){se(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ue(e,t,n,a,r,c,o){try{var i=e[c](o),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(a,r)}function le(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){ue(c,a,r,o,i,"next",e)}function i(e){ue(c,a,r,o,i,"throw",e)}o(void 0)}))}}function me(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=fe(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function be(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||fe(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(e,t){if(e){if("string"==typeof e)return pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pe(e,t):void 0}}function pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var de=function(e){var t=Object(a.useContext)(i.d),n=e.query,o=e.type,s=e.status,u=void 0===s?"all":s,l=e.onRequestSendUnopen,m=be(Object(a.useState)({status:!1}),2),f=m[0],p=m[1],d=be(Object(a.useState)(!1),2),O=d[0],g=d[1],h=be(Object(a.useState)({}),2),P=h[0],C=h[1],S=be(Object(a.useState)(!1),2),x=S[0],N=S[1],I=Object(i.ab)("campaign"),A=b(),B=j(),L=Object(ce.a)(),T=Object(i.r)(),M=A.fetch,Y=A.setCamapignListValues,K=B.getCampaigns,Q=B.getPageNumber,X=B.getPerPageCount,Z=B.getTotalCount,ee=B.getOffset,te=B.getLoadingStatus,ne=B.getPageCountData,ae=K(),oe=ee(),se=X(),ue=te(),fe=Z(),pe=Q(),de=ne(),Oe=Object(a.useRef)(new AbortController),ge=Object(q.a)(Object(i.Y)()).formatAmount,je=0;Object(R.isEmpty)(o)||("email"===o?je=1:"sms"===o?je=2:"whatsapp"===o&&(je=3)),Object(a.useEffect)((function(){g(!1),M(je,n,oe,se,u)}),[oe,se,o,n.s,u]),Object(a.useEffect)((function(){if(!ue&&!O&&!Object(R.isEmpty)(ae)||x)try{var e={broadcast_ids:[],force:x};ae.map((function(t){e.broadcast_ids.push(t.id)})),w()({method:"GET",path:Object(i.m)("/broadcasts-stats?"+Object(r.stringify)(e)),signal:Oe.current.signal}).then((function(e){200==e.code&&(C(e.result),g(!0),x&&(t("Data Updated"),Object(i.gb)(t,1e3),N(!1)))})).catch((function(e){console.log(e)}))}catch(e){g(!0),N(!1),console.log(e)}}),[ae,x]),Object(a.useEffect)((function(){return function(){Oe.current.abort()}}),[]);var he=Object(a.useMemo)((function(){var e={};if(Array.isArray(ae)){var t,n=me(ae);try{for(n.s();!(t=n.n()).done;){var a=t.value;e[a.id]=a}}catch(e){n.e(e)}finally{n.f()}}return e}),[ae]),we=Object(J.b)(he),ye=we.singleSelectProps,ve=we.selectAllProps,_e=we.floatingBarProps,Ee=we.resetSelection,ke=[{key:"select_template",label:Object(a.createElement)(E.CheckboxControl,ve),isLeftAligned:!0,required:!0,cellClassName:"bwf-col-action bwf-w-45"},{key:"action",label:"",isLeftAligned:!0,required:!0,cellClassName:"bwf-col-action bwf-w-45"},{key:"campaign",label:Object(c.__)("Name","wp-marketing-automations"),isLeftAligned:!0,required:!0},{key:"created_on",label:Object(c.__)("Created On","wp-marketing-automations"),isLeftAligned:!0,required:!0,cellClassName:"bwf-w-180"},{key:"schedule",label:Object(c.__)("Execution Date","wp-marketing-automations"),isLeftAligned:!0,cellClassName:"bwf-w-180"},{key:"contacts",label:Object(c.__)("Contacts","wp-marketing-automations"),isLeftAligned:!0,cellClassName:"bwf-col-center bwf-w-90"},{key:"sent",label:Object(c.__)("Sent","wp-marketing-automations"),isLeftAligned:!0,cellClassName:"bwf-col-center bwf-w-90"}];"sms"!==o&&ke.push({key:"open_rate",label:Object(c.__)("Open Rate","wp-marketing-automations"),isLeftAligned:!0,cellClassName:"bwf-col-center bwf-w-90"}),ke.push({key:"click_rate",label:Object(c.__)("Click Rate","wp-marketing-automations"),isLeftAligned:!0,cellClassName:"bwf-col-center bwf-w-90"}),Object(i.yb)()&&ke.push({key:"revenue",label:Object(c.__)("Revenue","wp-marketing-automations"),isLeftAligned:!0,cellClassName:"bwf-col-center bwf-w-120 bwf-p-10"}),ke.push({key:"status",label:Object(c.__)("Status","wp-marketing-automations"),isLeftAligned:!0,cellClassName:"bwf-w-30 bwf-col-center"});var Pe=function(e){e!==se&&Y("limit",e)},Ce=function(){var e=le(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w()({path:Object(i.m)("/broadcast/".concat(a,"/")),method:"DELETE"}).then((function(e){200==e.code?(t("Broadcast deleted"),M(je,n,0,se,u),p({status:!1})):p({status:!0,error:!0,message:e.message})}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),p({status:!0,error:!0,message:e.t0.message});case 8:Object(i.gb)(t,2e3);case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),Se=function(){var e=le(regeneratorRuntime.mark((function e(a,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 7!==parseInt(r)&&(o={1:Object(c.__)("Drafting broadcast…","wp-marketing-automations"),3:Object(c.__)("Resuming broadcast…","wp-marketing-automations"),6:Object(c.__)("Pausing broadcast…","wp-marketing-automations"),7:Object(c.__)("Canceling broadcast…","wp-marketing-automations")},t(o[r])),e.prev=1,e.next=4,w()({path:Object(i.m)("/broadcast/".concat(a,"/pause-unpause")),method:"POST",data:{status:parseInt(r)}}).then((function(e){200==e.code?(t(e.message),7===parseInt(r)&&p({}),setTimeout((function(){p({}),M(je,n,0,se,u)}),2e3)):7!==parseInt(r)?t(e.message):p({status:!0,error:!0,message:e.message})}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),7!==parseInt(u)?t(e.t0.message):p({status:!0,error:!0,message:e.t0.message});case 9:Object(i.gb)(t,2e3);case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}(),xe=function(){var e=le(regeneratorRuntime.mark((function e(a){var r,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]&&o[1],t(Object(c.__)("Cloning…","wp-marketing-automations")),e.prev=2,e.next=5,w()({path:Object(i.m)("/broadcast/".concat(a,"/clone")),method:"POST",data:{created_by:Object(i.x)(),send_to_unopen:r}}).then((function(e){200==e.code?(t(Object(c.__)("Broadcast cloned","wp-marketing-automations")),M(je,n,0,se,u)):t(e.message)}));case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),t(e.t0.message);case 10:Object(i.gb)(t,2e3);case 11:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}(),Ne=function(e){return Object(a.createElement)(_.a,{label:Object(c.__)("Quick Actions","wp-marketing-automations"),menuPosition:"bottom right",renderContent:function(t){var n=t.onToggle;return Object(a.createElement)(a.Fragment,null,parseInt(e.status)>1&&Object(a.createElement)(k.a,{isClickable:!0,onInvoke:function(){}},Object(a.createElement)(v.a,{to:"wp-admin/admin.php?page=autonami&path=/broadcast/"+e.id,onClick:function(t){t.preventDefault(),L.setCampaignValues("listData",e),Object(D.k)({page:"autonami",path:"/broadcast/"+parseInt(e.id)},"/",{})},type:"bwf-crm",className:"bwf-a-no-underline"},Object(a.createElement)(U.a,{justify:"flex-start"},Object(a.createElement)(U.c,null,Object(a.createElement)(H.a,{icon:"view",size:20})),Object(a.createElement)(U.c,null,Object(c.__)("View","wp-marketing-automations"))))),parseInt(e.status)<3&&Object(a.createElement)(k.a,{isClickable:!0,onInvoke:function(){}},Object(a.createElement)(v.a,{to:"admin.php?page=autonami&path=/broadcast/".concat(e.id,"&edit=true"),type:"bwf-crm",className:"bwf-a-no-underline",onClick:function(t){t.preventDefault(),L.setCampaignValues("listData",e),Object(D.k)({page:"autonami",path:"/broadcast/"+parseInt(e.id)},"/",{})}},Object(a.createElement)(U.a,{justify:"flex-start"},Object(a.createElement)(U.c,null,Object(a.createElement)(H.a,{icon:"edit",size:20})),Object(a.createElement)(U.c,null,Object(c.__)("Edit","wp-marketing-automations"))))),Object(a.createElement)(k.a,{isClickable:!0,onInvoke:function(){xe(e.id),n()}},Object(a.createElement)(U.a,{justify:"flex-start"},Object(a.createElement)(U.c,null,Object(a.createElement)(H.a,{icon:"duplicate"})),Object(a.createElement)(U.c,null,Object(c.__)("Clone","wp-marketing-automations")))),4===parseInt(e.status)&&"grandchild"!==e.level&&"email"===o&&Object(a.createElement)(k.a,{isClickable:!0,onInvoke:function(){l&&l(parseInt(e.id)),n()}},Object(a.createElement)(U.a,{justify:"flex-start"},Object(a.createElement)(U.c,null,Object(a.createElement)(H.a,{icon:"duplicate"})),Object(a.createElement)(U.c,null,Object(c.__)("Send to Unopen","wp-marketing-automations")))),3===parseInt(e.status)&&Object(a.createElement)(k.a,{isClickable:!0,onInvoke:function(){Se(e.id,6),n()}},Object(a.createElement)(U.a,{justify:"flex-start"},Object(a.createElement)(U.c,null,Object(a.createElement)(H.a,{icon:"pause"})),Object(a.createElement)(U.c,null,Object(c.__)("Pause","wp-marketing-automations")))),6===parseInt(e.status)&&Object(a.createElement)(k.a,{isClickable:!0,onInvoke:function(){Se(e.id,3),n()}},Object(a.createElement)(U.a,{justify:"flex-start"},Object(a.createElement)(U.c,null,Object(a.createElement)(H.a,{icon:"play"})),Object(a.createElement)(U.c,null,Object(c.__)("Resume","wp-marketing-automations")))),2===parseInt(e.status)&&Object(a.createElement)(k.a,{isClickable:!0,onInvoke:function(){Se(e.id,1),n()}},Object(a.createElement)(U.a,{justify:"flex-start"},Object(a.createElement)(U.c,null,Object(a.createElement)(H.a,{icon:"pause"})),Object(a.createElement)(U.c,null,Object(c.__)("Unschedule","wp-marketing-automations")))),[2,3,6].includes(parseInt(e.status))&&Object(a.createElement)(k.a,{isClickable:!0,onInvoke:function(){p({status:!0,id:e.id,modalContent:Object(a.createElement)(a.Fragment,null,Object(c.__)("You are about to cancel broadcast ","wp-marketing-automations"),Object(a.createElement)("strong",null,e.title,"."),Object(c.__)(" Cancel to stop, Confirm to proceed.","wp-marketing-automations")),title:Object(c.__)("Cancel Broadcast","wp-marketing-automations"),confirmBtnText:Object(c.__)("Confirm","wp-marketing-automations"),onConfirm:function(t){p(ie(ie({},t),{},{status:!0,id:e.id,loading:!0})),Se(e.id,7)}}),n()}},Object(a.createElement)(U.a,{justify:"flex-start"},Object(a.createElement)(U.c,null,Object(a.createElement)("span",{className:"bwf-display-flex bwf-h-20 bwf-w-20"},Object(a.createElement)(H.a,{icon:"cross",size:12}))),Object(a.createElement)(U.c,null,Object(c.__)("Cancel","wp-marketing-automations")))),Object(a.createElement)(k.a,{isClickable:!0,onInvoke:function(){p({status:!0,id:e.id,entityName:e.title,title:Object(c.__)("Delete Broadcast","wp-marketing-automations"),confirmBtnText:Object(c.__)("Delete","wp-marketing-automations"),onConfirm:function(t){p(ie(ie({},t),{},{status:!0,id:e.id,loading:!0})),Ce(e.id)}}),n()}},Object(a.createElement)(U.a,{justify:"flex-start"},Object(a.createElement)(U.c,null,Object(a.createElement)(H.a,{icon:"trash"})),Object(a.createElement)(U.c,null,Object(c.__)("Delete","wp-marketing-automations")))))}})},Ie=function(e){return Object(a.createElement)("a",{href:"admin.php?page=autonami&path=/broadcast/"+e.id,onClick:function(t){t.preventDefault(),L.setCampaignValues("listData",e),Object(D.k)({path:"/broadcast/"+parseInt(e.id)},"/",n)},className:"bwf-a-no-underline"},Object(a.createElement)("b",null,e.title.charAt(0).toUpperCase()+e.title.slice(1)+" "))},Ae=function(e){if(!O)return Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-60",title:"Loading"},"Loading");var t=P.hasOwnProperty(e.id)?P[e.id]:{};return t.hasOwnProperty("revenue")&&t.hasOwnProperty("conversions")&&parseFloat(t.revenue)>0?Object(a.createElement)(a.Fragment,null,parseInt(t.conversions)>0?Object(a.createElement)(a.Fragment,null,Object(a.createElement)("span",null,parseInt(t.conversions))," ",Object(a.createElement)("span",{className:"bwf-no-wrap"}," ","( "+ge(parseFloat(t.revenue))+" )")):ge(parseFloat(t.revenue))):" - "},Re=function(e){if(!O)return Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-60",title:"Loading"},"Loading");var t=P.hasOwnProperty(e.id)?P[e.id]:{};return Object(a.createElement)(a.Fragment,null,t.hasOwnProperty("sent")&&parseInt(t.sent)>0?t.sent:"-")},De=function(e){if(!O)return Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-60",title:"Loading"},"Loading");var t=P.hasOwnProperty(e.id)?P[e.id]:{};return Object(a.createElement)(a.Fragment,null,t.hasOwnProperty("open_rate")&&t.open_rate?parseFloat(t.open_rate).toFixed(2)+"%":"-")},Be=function(e){if(!O)return Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-60",title:"Loading"},"Loading");var t=P.hasOwnProperty(e.id)?P[e.id]:{};return Object(a.createElement)(a.Fragment,null,t.hasOwnProperty("click_rate")&&t.open_rate?parseFloat(t.click_rate).toFixed(2)+"%":"-")},Le=Object(a.useMemo)((function(){var e,t=[],n=me(ae);try{for(n.s();!(e=n.n()).done;){var a=e.value;if(a){var r=ie({},a);if(delete r.children,t.push(r),Array.isArray(a.children)&&!(a.children.length<=0)){var c,o=me(a.children);try{for(o.s();!(c=o.n()).done;){var i=c.value,s=ie(ie({},i),{},{level:"child"});if(delete s.children,t.push(s),Array.isArray(i.children)&&!(i.children.length<=0)){var u,l=me(i.children);try{for(l.s();!(u=l.n()).done;){var m=ie(ie({},u.value),{},{level:"grandchild"});t.push(m)}}catch(e){l.e(e)}finally{l.f()}}}}catch(e){o.e(e)}finally{o.f()}}}}}catch(e){n.e(e)}finally{n.f()}return t}),[ae]),Te=[],Me=Le?Le.map((function(e){e.level&&"child"===e.level?Te.push("bwf-c-broadcast-child"):e.level&&"grandchild"===e.level?Te.push("bwf-c-broadcast-grandchild"):Te.push("bwf-c-broadcast-parent");var t=[{display:ye.hasOwnProperty(e.id)?Object(a.createElement)(E.CheckboxControl,ye[e.id]):Object(a.createElement)(a.Fragment,null),value:null},{display:Ne(e),value:null},{display:Ie(e),value:e.title},{display:e.created_at?Object(i.O)(e.created_at,!1,!1):" - ",value:e.created_at},{display:e.execution_time?Object(i.O)(e.execution_time,!1,!0):" - ",value:e.execution_time},{display:parseInt(e.count)>0?e.count:"-",value:e.count>0?e.count:0},{display:Re(e),value:""}];return"sms"!==o&&t.push({display:De(e),value:""}),t.push({display:Be(e),value:""}),Object(i.yb)()&&t.push({display:Ae(e),value:parseFloat(e.revenue)}),t.push({display:T.hasOwnProperty(e.status)?Object(a.createElement)("span",{className:i.s[e.status]},T[e.status].label):e.status,value:e.status}),t})):[],Fe=$()("bwfcrm-campaign-list-table",{"has-search":!0});return Object(a.createElement)(a.Fragment,null,f&&f.status&&Object(a.createElement)(E.Modal,{onRequestClose:function(){return p({})},className:"bwf-admin-modal bwf-admin-modal-squeezy bwf-admin-modal-no-header bwf-h--core-header"},f.success?Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-t-center"},Object(a.createElement)(z.a,null),Object(a.createElement)("div",{className:"bwf-h1"},f.message))):f.error?Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-t-center"},Object(a.createElement)(V.a,null),Object(a.createElement)("div",{className:"bwf-h1"},f.message))):f.confirm?Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-t-center"},!f.content&&Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)(G.a,{spaceClass:f.content?"bwf_clear_15":"bwf_clear_30"}),f.content&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-h1"},Object(c.__)("Please wait…")),Object(a.createElement)("div",{className:"bwf-h4 bwf-h4-grey",style:{margin:0,fontSize:"0.9375rem"}},f.content),Object(a.createElement)("div",{className:"bwf_clear_15"})))):Object(a.createElement)(a.Fragment,null,f.title&&Object(a.createElement)("div",{className:"bwf-modal-header"},Object(a.createElement)("div",{className:"bwf-modal-heading"},f.title),Object(a.createElement)("span",{onClick:function(){return p({status:!1})},className:"bwf-modal-close"},Object(a.createElement)(H.a,{icon:"close",color:"#353030"}))),Object(a.createElement)("div",{className:"bwf-form-buttons"},Object(a.createElement)("div",{className:"bwf-h4 bwf-h4-grey"},f.hasOwnProperty("modalContent")?f.modalContent:Object(a.createElement)(a.Fragment,null,f.entityName?Object(a.createElement)(a.Fragment,null,Object(c.__)("You are about to delete broadcast "),Object(a.createElement)("strong",null,f.entityName,"."),Object(c.__)(" Cancel to stop, Delete to proceed.")):Object(c.__)("Once you delete this item. It will no longer available.","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf_text_right"},Object(a.createElement)(E.Button,{className:"bwf-cancel-btn",onClick:function(){p({status:!1})}},Object(c.__)("Cancel","wp-marketing-automations")),Object(a.createElement)(E.Button,{isPrimary:!0,className:"bwf-delete-btn",disabled:f.loading,isBusy:f.loading,onClick:function(){return f.onConfirm(f)}},f.hasOwnProperty("confirmBtnText")?f.confirmBtnText:Object(c.__)("Delete","wp-marketing-automations")))))),Object(a.createElement)(a.Fragment,null,Object(a.createElement)(E.ButtonGroup,{className:"bwf-btn-group-tabs"},Object(a.createElement)(E.Button,{isPrimary:!u||"all"===u,isSecondary:!!u||"all"!==u,onClick:function(){return Object(D.k)({path:"/broadcasts/".concat(o,"/all")},"/",n)}},Object(c.__)("All","wp-marketing-automations"),de.hasOwnProperty("status_all")&&parseInt(de.status_all)>0?Object(a.createElement)("span",{className:"bwf-crm-btn-group-count"},parseInt(de.status_all)):""),Object(a.createElement)(E.Button,{isPrimary:"scheduled"===u,isSecondary:"scheduled"!==u,onClick:function(){return Object(D.k)({path:"/broadcasts/".concat(o,"/scheduled")},"/",n)}},Object(c.__)("Scheduled","wp-marketing-automations"),de.hasOwnProperty("status_scheduled")&&parseInt(de.status_scheduled)>0?Object(a.createElement)("span",{className:"bwf-crm-btn-group-count"},parseInt(de.status_scheduled)):""),Object(a.createElement)(E.Button,{isPrimary:"ongoing"===u,isSecondary:"ongoing"!==u,onClick:function(){return Object(D.k)({path:"/broadcasts/".concat(o,"/ongoing")},"/",n)}},Object(c.__)("Ongoing","wp-marketing-automations"),de.hasOwnProperty("status_ongoing")&&parseInt(de.status_ongoing)>0?Object(a.createElement)("span",{className:"bwf-crm-btn-group-count"},parseInt(de.status_ongoing)):""),Object(a.createElement)(E.Button,{isPrimary:"completed"===u,isSecondary:"completed"!==u,onClick:function(){return Object(D.k)({path:"/broadcasts/".concat(o,"/completed")},"/",n)}},Object(c.__)("Completed","wp-marketing-automations"),de.hasOwnProperty("status_completed")&&parseInt(de.status_completed)>0?Object(a.createElement)("span",{className:"bwf-crm-btn-group-count"},parseInt(de.status_completed)):""),Object(a.createElement)(E.Button,{isPrimary:"paused"===u,isSecondary:"paused"!==u,onClick:function(){return Object(D.k)({path:"/broadcasts/".concat(o,"/paused")},"/",n)}},Object(c.__)("Paused","wp-marketing-automations"),de.hasOwnProperty("status_paused")&&parseInt(de.status_paused)>0?Object(a.createElement)("span",{className:"bwf-crm-btn-group-count"},parseInt(de.status_paused)):""),Object(a.createElement)(E.Button,{isPrimary:"cancelled"===u,isSecondary:"cancelled"!==u,onClick:function(){return Object(D.k)({path:"/broadcasts/".concat(o,"/cancelled")},"/",n)}},Object(c.__)("Cancelled","wp-marketing-automations"),de.hasOwnProperty("status_cancelled")&&parseInt(de.status_cancelled)>0?Object(a.createElement)("span",{className:"bwf-crm-btn-group-count"},parseInt(de.status_cancelled)):"")),Object(a.createElement)("div",{className:"bwf_clear_20"})),Object(a.createElement)(y.a,{className:Fe,rows:Me,headers:function(e){if(Object(R.isEmpty)(I))return e;var t=[];return e.map((function(e){I.includes(e.key)||(e.visible=!1),t.push(e)})),t}(ke),query:{paged:pe},rowsPerPage:se,totalRows:fe,isLoading:ue,onPageChange:function(e,t){Y("offset",(e-1)*se)},onQueryChange:function(e){return"per_page"!==e?function(){}:Pe},onColumnsChange:function(e,t){w()({path:Object(i.m)("/user-preference/".concat(Object(i.x)(),"/")),method:"POST",data:{data:{campaign_column:e}}}).then((function(t){200===t.code&&(bwfcrm_contacts_data.table_column_data.campaign=e)}))},actions:[Object(a.createElement)(F,{key:"search",query:n,type:je,status:u})],rowHeader:!0,emptyMessage:Object(c.__)("No broadcasts found","wp-marketing-automations"),rowClasses:Te,filterColumnIcon:Object(a.createElement)("span",{className:"bwf-cursor-pointer"},Object(a.createElement)(W.a,{icon:"filters",iconSize:20,size:20,toolTipText:Object(a.createElement)("span",{className:"bwfan_tooltip_text bwf-w-60","data-position":"top"},Object(c.__)("Filter","wp-marketing-automations"))})),extraSectionBeforefilterCol:Object(a.createElement)("div",{className:"bwf-display-flex gap-12"},Object(a.createElement)(E.Button,{isSecondary:!0,className:"bwf-btn-small bwf-btn-gray",title:Object(c.__)("Refresh Stats","wp-marketing-automations"),onClick:function(){return g(!1),void N(!0)},disabled:!O,isBusy:!O&&x},Object(a.createElement)(H.a,{icon:"retry",size:16}),Object(c.__)("Refresh")))}),Object(a.createElement)(re,{floatingBarProps:_e,resetSelection:Ee,onSuccess:function(){return M(je,n,oe,se,u)}}))},Oe=n(228);function ge(e,t,n,a,r,c,o){try{var i=e[c](o),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(a,r)}function je(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return he(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return he(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var we=function(e){e.query;var t=e.onCloseModal,n=e.type,r=e.createUnopen,o=Object(a.useContext)(i.d),s=je(Object(a.useState)(!1),2),u=s[0],l=s[1],m=je(Object(a.useState)(""),2),b=m[0],f=m[1],p=je(Object(a.useState)({}),2),d=(p[0],p[1]),O=je(Object(a.useState)(null),2),g=O[0],j=O[1],h=je(Object(a.useState)(""),2),y=h[0],v=h[1],_=Object(ce.a)().setCampaignValues;Object(a.useEffect)((function(){l(!1),d({}),j(""),v(""),f("")}),[]);var k=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),f(""),e.prev=2,t={title:g,description:y,type:n,created_by:Object(i.x)()},r&&(a=Object(c.__)("Send to Unopen","wp-marketing-automations"),g||(j(a),t.title=a),t.createUnopen=r),e.next=7,w()({path:Object(i.m)("/broadcast/"),method:"POST",data:t}).then((function(e){200==e.code?(Object(i.E)()||(bwfcrm_contacts_data.first_broadcast_id=1),o(e.message),_("listData",e.result),Object(D.k)({page:"autonami",path:"/broadcast/"+e.result.id},"/",{})):(l(!1),f(e.message))}));case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),l(!1),f(e.t0.message);case 13:Object(i.gb)(o,2e3);case 14:case"end":return e.stop()}}),e,null,[[2,9]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){ge(c,a,r,o,i,"next",e)}function i(e){ge(c,a,r,o,i,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}();Object(a.useEffect)((function(){r&&k()}),[r]);var P=function(){Object(Oe.a)(g)?f(Object(c.__)("Name is required.","wp-marketing-automations")):(f(""),k())},C={1:Object(c.__)("Add Email Broadcast","wp-marketing-automations"),2:Object(c.__)("Add SMS Broadcast","wp-marketing-automations"),3:Object(c.__)("Add WhatsApp Broadcast","wp-marketing-automations")};return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(E.Modal,{className:"bwf-admin-modal bwf-admin-modal-squeezy bwf-h--core-header",onRequestClose:function(){return t()}},Object(a.createElement)("div",{className:"bwf-modal-header"},Object(a.createElement)("div",{className:"bwf-modal-heading"},C[n]),Object(a.createElement)("span",{onClick:function(){return t()},className:"bwf-modal-close"},Object(a.createElement)(H.a,{icon:"close",color:"#353030"}))),3!=n||Object(i.wb)()?Object(a.createElement)("div",{className:"bwf-form-fields",onKeyPress:function(e){"Enter"==e.key&&P()}},b&&Object(a.createElement)(E.Notice,{status:"error",onRemove:function(){return f("")}},b),Object(a.createElement)(E.TextControl,{placeholder:Object(c.__)("Enter Name","wp-marketing-automations"),autoFocus:!0,label:Object(c.__)("Name","wp-marketing-automations"),value:g||"",onChange:function(e){return j(e)},disabled:u}),Object(a.createElement)("div",{className:"bwf_text_right bwf-form-buttons"},Object(a.createElement)(E.Button,{onClick:function(){return t()},className:"bwf-cancel-btn"},Object(c.__)("Cancel","wp-marketing-automations")),Object(a.createElement)(E.Button,{isPrimary:!0,disabled:u,isBusy:u,onClick:function(){P()}},Object(c.__)("Add","wp-marketing-automations")))):Object(a.createElement)(E.Notice,{status:"error",isDismissible:!1},"Whats service is not configured")))},ye=n(824),ve=n(67),_e=n(859),Ee=n(38),ke=n(92),Pe=n(139),Ce=n(134),Se=n(252);function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(n),!0).forEach((function(t){Ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Re(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}t.default=function(e){var t=e.match.params,n=t.type,o=void 0===n?"email":n,s=t.status,u=void 0===s?"all":s,l=location&&location.search?Object(r.parse)(location.search.substring(1)):{};Object(i.g)("Broadcasts");var m=Ae(Object(a.useState)(!1),2),b=m[0],f=m[1],p=Ae(Object(a.useState)(!0),2),d=p[0],O=p[1],g=Ae(Object(a.useState)(!1),2),h=g[0],w=g[1],y=Ae(Object(a.useState)(!1),2),v=y[0],_=y[1],k=(0,j().getPageCountData)(),P=Object(Pe.a)().getPageCountData,C=Object(Ce.a)().setPageCountData,S=P();Object(a.useEffect)((function(){C(Ne(Ne({},S),k))}),[k]),Object(ye.a)(o,Object(c.__)("ALL BROADCASTS","wp-marketing-automations"),!1,!1,("sms"!==o||!Object(R.isEmpty)(Object(i.k)()))&&Object(a.createElement)(E.Button,{isPrimary:!0,onClick:function(){Object(i.nb)()?(_(!1),f(!0)):w(!0)},className:"bwf-display-flex"},!Object(i.nb)()&&Object(a.createElement)(H.a,{icon:"lock",size:15}),Object(c.__)("Add New Broadcast","wp-marketing-automations")),1,k);var x=(Object(i.nb)()?Object(_e.a)():{}).data,N=x||{},I=N.reached,A=void 0!==I&&I,B=N.daily_limit,L=void 0===B?0:B,T={email:1,sms:2,whatsapp:3},M=[{type:"icon",data:{class:"bwf-pb-gap",content:Object(a.createElement)(H.a,{icon:"zero-broadcast",width:"90",height:"90"})}},{type:"content",data:{class:"bwf-h2 bwf-pb-10",content:Object(c.__)("Reach out with personalized messages","wp-marketing-automations")}},{type:"content",data:{class:"bwf-h4-1 bwf-pb-gap",content:Object(c.__)("Send announcements to all or tailored messages to specific customer segments. Filter contacts by last order date, item purchase, AOV & more.","wp-marketing-automations")}},{type:"buttons",data:{buttons:[{text:Object(c.__)("Add New Broadcast","wp-marketing-automations"),proCheck:!0,onClick:function(){Object(i.nb)()?(_(!1),f(!0)):w(!0)}}]}}],F=[{type:"icon",data:{class:"bwf-pb-gap",content:Object(a.createElement)(a.Fragment,null,Object(a.createElement)(H.a,{icon:"sms",width:"90",height:"90",color:"#135e96"}))}},{type:"content",data:{class:"bwf-h2 bwf-pb-10",content:Object(c.__)("SMS Service Not Connected","wp-marketing-automations")}},{type:"content",data:{class:"bwf-h4-1 bwf-pb-gap",content:Object(c.__)("Connect with an SMS provider such as Twilio or BulkGate to send SMS Campaigns.","wp-marketing-automations")}},{type:"buttons",data:{buttons:[{text:Object(c.__)("Go to Connectors","wp-marketing-automations"),onClick:function(){Object(D.k)({page:"autonami",path:"/connectors"},"/",{})}}]}}];return Object(a.createElement)(a.Fragment,null,Object(i.E)()?Object(a.createElement)(a.Fragment,null,Object(a.createElement)(ve.a,null),"email"===o&&!!A&&!!d&&Object(a.createElement)(E.Notice,{className:"bwf-error-notice",status:"warning",onRemove:function(){return O(!1)}},"".concat(Object(c.__)("Daily sending limit of","wp-marketing-automations")," ").concat(L," ").concat(Object(c.__)(" emails has been reached today. To send out more emails, go to ","wp-marketing-automations")," "),Object(a.createElement)(Ee.a,{href:"admin.php?page=autonami&path=/settings",className:"bwf-a-no-underline"},Object(c.__)("Settings > Emails","wp-marketing-automations")),Object(c.__)(" to increase the limit.","wp-marketing-automations")),Object(a.createElement)("div",{className:"bwfcrm-campaign-list"},"sms"===o&&Object(R.isEmpty)(Object(i.k)())?Object(a.createElement)(Se.a,{data:F}):Object(a.createElement)(de,{query:l,type:o,status:u,onRequestSendUnopen:function(e){Object(i.nb)()?(_(e),f(!0)):w(!0)}}))):Object(a.createElement)(Se.a,{data:M}),b&&Object(a.createElement)(we,{query:l,createUnopen:v,onCloseModal:function(){return f(!1)},type:T.hasOwnProperty(o)?T[o]:1}),Object(a.createElement)(ke.a,{isOpen:h,onRequestClose:function(){return w(!1)}}))}},796:function(e,t,n){"use strict";var a=n(136),r=n(269),c=Object(a.a)(r.a.campaign).getStateProp,o=Object(a.a)(r.a.recipient).getStateProp,i=Object(a.a)(r.a.conversion).getStateProp;t.a={getCampaignData:function(){return c("data")},getStep:function(){return parseInt(c("step"))},getLoading:function(){return c("isLoading")},getLisData:function(){return c("listData")},getCampaignId:function(){return parseInt(c("campaignId"))},getRecipientData:function(){return o("data")},getRecipientLoading:function(){return o("isLoading")},getRecipientCampaignId:function(){return o("campaignId")},getRecipientTotal:function(){return o("total")},getRecipientPage:function(){return parseInt(o("offset"))/parseInt(o("limit"))+1},getRecipientOffset:function(){return o("offset")},getRecipientLimit:function(){return o("limit")},getConversionData:function(){return i("data")},getConversionLoading:function(){return i("isLoading")},getConversionOffset:function(){return i("offset")},getConversionCampaignId:function(){return i("campaignId")},getConversionTotal:function(){return i("total")},getConversionPage:function(){return parseInt(i("offset"))/parseInt(i("limit"))+1},getConversionLimit:function(){return i("limit")},getExcludes:function(){var e=c("data");return e&&e.data&&Array.isArray(e.data.exclude)?e.data.exclude:[]},getEditableMode:function(){return c("editableMode")}}},803:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(12),r=n(7),c=n.n(r),o=n(25),i=n(13),s=n(26),u=n(253),l=function(e){function t(t,n){var a;return(a=e.call(this)||this).client=t,a.setOptions(n),a.bindMethods(),a.updateResult(),a}Object(s.a)(t,e);var n=t.prototype;return n.bindMethods=function(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)},n.setOptions=function(e){this.options=this.client.defaultMutationOptions(e)},n.onUnsubscribe=function(){var e;this.listeners.length||(null==(e=this.currentMutation)||e.removeObserver(this))},n.onMutationUpdate=function(e){this.updateResult();var t={listeners:!0};"success"===e.type?t.onSuccess=!0:"error"===e.type&&(t.onError=!0),this.notify(t)},n.getCurrentResult=function(){return this.currentResult},n.reset=function(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})},n.mutate=function(e,t){return this.mutateOptions=t,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,Object(a.a)({},this.options,{variables:void 0!==e?e:this.options.variables})),this.currentMutation.addObserver(this),this.currentMutation.execute()},n.updateResult=function(){var e=this.currentMutation?this.currentMutation.state:Object(u.b)();this.currentResult=Object(a.a)({},e,{isLoading:"loading"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset})},n.notify=function(e){var t=this;o.a.batch((function(){t.mutateOptions&&(e.onSuccess?(null==t.mutateOptions.onSuccess||t.mutateOptions.onSuccess(t.currentResult.data,t.currentResult.variables,t.currentResult.context),null==t.mutateOptions.onSettled||t.mutateOptions.onSettled(t.currentResult.data,null,t.currentResult.variables,t.currentResult.context)):e.onError&&(null==t.mutateOptions.onError||t.mutateOptions.onError(t.currentResult.error,t.currentResult.variables,t.currentResult.context),null==t.mutateOptions.onSettled||t.mutateOptions.onSettled(void 0,t.currentResult.error,t.currentResult.variables,t.currentResult.context))),e.listeners&&t.listeners.forEach((function(e){e(t.currentResult)}))}))},t}(n(52).a),m=n(251);function b(e,t,n){var r=c.a.useRef(!1),s=c.a.useState(0)[1],u=Object(i.k)(e,t,n),b=Object(m.b)(),f=c.a.useRef();f.current?f.current.setOptions(u):f.current=new l(b,u);var p=f.current.getCurrentResult();c.a.useEffect((function(){r.current=!0;var e=f.current.subscribe(o.a.batchCalls((function(){r.current&&s((function(e){return e+1}))})));return function(){r.current=!1,e()}}),[]);var d=c.a.useCallback((function(e,t){f.current.mutate(e,t).catch(i.i)}),[]);if(p.error&&f.current.options.useErrorBoundary)throw p.error;return Object(a.a)({},p,{mutate:d,mutateAsync:p.mutate})}},805:function(e,t,n){"use strict";var a=n(137),r=n(5),c=n(269),o=n(796);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.a=function(){var e=Object(a.a)(c.a.campaign),t=e.fetch,n=e.setStateProp,i=Object(a.a)(c.a.recipient),u=i.fetch,l=i.setStateProp,m=Object(a.a)(c.a.conversion),b=m.fetch,f=m.setStateProp,p=o.a.getCampaignData();return{fetch:function(e){t("GET",Object(r.m)("/broadcast/".concat(e)))},setCampaignValues:function(e,t){n(e,t)},fetchRecipient:function(e,t,n){u("GET",Object(r.m)("/broadcasts/".concat(e,"/recipients?limit=").concat(t,"&offset=").concat(n)))},setRecipientsValues:function(e,t){l(e,t)},fetchConversion:function(e,t,n){b("GET",Object(r.m)("/broadcasts/".concat(e,"/conversions?limit=").concat(t,"&offset=").concat(n)))},setConversionValues:function(e,t){f(e,t)},setExclude:function(e){n("data",s(s({},p),{},{data:s(s({},p.data),{},{exclude:e})}))},resetCampaign:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n("data",e),n("step",1),n("campaignId",e.id),n("isLoading",!1),n("editableMode",!1)},setEditableMode:function(e){n("editableMode",e)}}}},824:function(e,t,n){"use strict";var a=n(0),r=n(134),c=n(2),o=n(15),i=n(17),s=n(796),u=n(5),l=function(e,t,n){return decodeURIComponent(Object(o.f)(e,t,n))};t.a=function(e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",m=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,b=location&&location.search?Object(i.parse)(location.search.substring(1)):{},f=bwfcrm_contacts_data&&bwfcrm_contacts_data.header_data?bwfcrm_contacts_data.header_data:{},p=f.broadcasts_nav,d=s.a.getCampaignData(),O=s.a.getCampaignId(),g=s.a.getLoading(),j={overview:{name:Object(c.__)("Overview","wp-marketing-automations"),link:l({},"/broadcast/".concat(O,"/overview"),b)},analytics:{name:Object(c.__)("Analytics","wp-marketing-automations"),link:l({},"/broadcast/".concat(O,"/analytics"),b)},recipient:{name:Object(c.__)("Engagements","wp-marketing-automations"),link:l({},"/broadcast/".concat(O,"/engagements"),b)}};Object(u.yb)()&&(j.orders={name:Object(c.__)("Orders","wp-marketing-automations"),link:l({},"/broadcast/".concat(O,"/orders"),b)});var h=Object(r.a)(),w=h.setActiveMultiple,y=h.resetHeaderMenu,v=h.setL2NavType,_=h.setL2Nav,E=h.setBackLink,k=h.setL2Title,P=h.setL2Content,C=h.setBackLinkLabel,S=h.setL2NavAlign,x=h.setPageHeader;return Object(a.useEffect)((function(){y(),n?(v("menu"),_(j)):(!t&&v("menu"),!t&&_(p)),w({leftNav:"broadcasts",rightNav:e}),t&&1===m&&(C("Email Broadcasts"),E(l({},"/broadcasts/email",b))),t&&2===m&&(C("SMS Broadcasts"),E(l({},"/broadcasts/sms",b))),t&&3===m&&(C("WhatsApp Broadcasts"),E(l({},"/broadcasts/whatsapp",b))),!g&&n&&k(Object(a.createElement)(a.Fragment,null,d.title)),n&&S("left"),!t&&o&&P(o),x("Broadcasts")}),[e,m]),!0}},859:function(e,t,n){"use strict";var a=n(10),r=n.n(a),c=n(5),o=n(794);function i(e,t,n,a,r,c,o){try{var i=e[c](o),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(a,r)}var s=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r()({path:Object(c.m)("/messages/daily-limit")});case 2:if((t=e.sent)&&t.result&&200==t.code){e.next=5;break}throw Error(__("Unable to get daily limit","wp-marketing-automations"));case 5:return e.abrupt("return",t.result);case 6:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){i(c,a,r,o,s,"next",e)}function s(e){i(c,a,r,o,s,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}();t.a=function(){return Object(o.a)(["bwfcrm-get-daily-limit"],s,{retry:!1})}},953:function(e,t,n){}}]);
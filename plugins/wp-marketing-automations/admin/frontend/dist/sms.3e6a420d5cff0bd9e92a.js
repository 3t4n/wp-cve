(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{1116:function(e,t,a){},1154:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(804),c=a(798),i=a(248),o=a(2),s=a(5),l=a(4),u=a(8),m=a(833);function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done)&&(a.push(i.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}t.default=function(e){var t=e.contactId,a=e.tab,f=b(Object(n.useState)({}),2),p=f[0],d=f[1],y=b(Object(n.useState)(!1),2),w=y[0],O=y[1],g=Object(r.a)(),j=g.fetchSMSConversations,v=g.fetchWhatAppConversations,h=c.a.getContact,_=c.a.getSMSConversations,E=c.a.getSMSConversationTotal,S=c.a.getSMSConversationLimit,k=c.a.getSMSConversationOffset,A=c.a.getSMSConversationPage,C=c.a.getSMSConversationLoading,N=h(),I=_(),L=k(),P=S(),M=C(),x=A(),R=E();Object(n.useEffect)((function(){"sms"==a?j(t,0,P):"whatsapp"==a&&v(t,0,P)}),[a]);var T=[{key:"message",label:Object(o.__)("Message","wp-marketing-automations"),isLeftAligned:!1},{key:"sent_time",label:Object(o.__)("Sent On","wp-marketing-automations"),isLeftAligned:!0},{key:"last_activity",label:Object(o.__)("Last Activity","wp-marketing-automations"),isLeftAligned:!0},{key:"clicks",label:Object(o.__)("Clicks","wp-marketing-automations"),isLeftAligned:!0},{key:"view",label:"",isLeftAligned:!0,cellClassName:"bwf-w-60"}],D=I&&I.length>0?I.map((function(e){return"ID"in e&&parseInt(e.ID)>0&&[{display:(r=e,Object(n.createElement)(n.Fragment,null,Object(n.createElement)("span",{className:"bwf-mr-5 bwf-limit-word-inside bwf-w-210"},r.message?r.message:"-"))),value:e.subject},{display:Object(s.O)(e.created_at,!1),value:e.created_at},{display:e.o_interaction?(t=JSON.parse(e.o_interaction),a=t[t.length-1],Object(s.O)(a,!1,!1)):"-",value:""},{display:e.click?e.click:0,value:e.click},{display:Object(n.createElement)(l.Button,{className:"bwf-w-60 bwf-display-flex",onClick:function(){d(e),O(!0)}},Object(n.createElement)(u.a,{icon:"view"})),value:null}];var t,a,r})):[];return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf_clear_10"}),Object(n.createElement)("div",{className:"bwf-c-s-data"},Object(n.createElement)("div",{className:"bwf-c-s-section"},Object(n.createElement)(i.a,{className:"contact-single-table contact-emails",headers:T,rows:D,query:{paged:x},totalRows:R,rowsPerPage:P,isLoading:M,showMenu:!1,onPageChange:function(e,n){"sms"==a?j(t,(e-1)*P,P):"whatsapp"==a&&v(t,(e-1)*P,P)},onQueryChange:function(e){return"per_page"===e?function(e){e!==P&&("sms"==a?j(t,L,e):"whatsapp"==a&&v(t,L,e))}:function(){return{}}},emptyMessage:Object(o.__)("No messages found","wp-marketing-automations")}),Object(n.createElement)(m.a,{onRequestClose:function(){return O(!1)},conversation:p,contact:N,isOpen:w}))))}},1155:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(248),c=a(2),i=a(798),o=a(3),s=a(5),l=a(4),u=a(8),m=a(51),b=a(795),f=a(852),p=a(38),d=a(16),y=a(804);a(1116);function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done)&&(a.push(i.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return O(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return O(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var g={1:"Active",2:"Failed",3:"Paused",4:"Waiting",5:"Terminated",6:"Reattempt"},j={1:"bwf-tags bwf-tag-green",2:"bwf-tags bwf-tag-red",3:"bwf-tags bwf-tag-red",4:"bwf-tags bwf-tag-orange",5:"bwf-tags bwf-tag-red",6:"bwf-tags bwf-tag-blue"};t.default=function(){var e=Object(y.a)(),t=i.a.getContact(),a=i.a.getAutomationContactId(),O=i.a.getAutomations(),v=i.a.getAutomationLoading(),h=O&&"contacts"in O?O.contacts:[],_=w(Object(n.useState)(""),2),E=_[0],S=_[1],k=w(Object(n.useState)({}),2),A=k[0],C=k[1];Object(n.useEffect)((function(){t&&"id"in t&&parseInt(t.id)!==parseInt(a)&&e.fetchAutomation(parseInt(t.id))}));var N,I=[{key:"details",label:Object(c.__)("Automation","wp-marketing-automations"),cellClassName:"bwf-crm-col-contact-details",isLeftAligned:!0},{key:"event",label:Object(c.__)("Event","wp-marketing-automations"),cellClassName:"bwf-crm-col-contact-details",isLeftAligned:!0},{key:"startedon ",label:Object(c.__)("Started On","wp-marketing-automations"),cellClassName:"bwf-crm-col-stats-m",isLeftAligned:!0},{key:"last_run",label:Object(c.__)("Last Run","wp-marketing-automations"),cellClassName:"bwf-crm-col-stats-m",isLeftAligned:!0},{key:"next_last_run",label:Object(c.__)("Next Run Time","wp-marketing-automations"),cellClassName:"bwf-crm-col-stats-m",isLeftAligned:!0},{key:"status",label:Object(c.__)("Status","wp-marketing-automations"),cellClassName:"bwf-crm-col-stats-m",isLeftAligned:!0},{key:"journey",label:Object(c.__)("","wp-marketing-automations"),cellClassName:"bwf-crm-col-stats-m",isLeftAligned:!0}],L=function(e){return Object(n.createElement)(p.a,{href:"admin.php?page=autonami&path=/automation/"+e.aid,type:"bwf-crm",className:"bwf-crm-campaign-contactData-contact-link bwf-a-no-underline",key:e.aid},e.hasOwnProperty("automation_title")?e.automation_title:"-")},P=function(e){var t=e.trail,a=void 0===t?"":t;return Object(o.isEmpty)(a)?"-":Object(n.createElement)("a",{className:"bwf-cursor-pointe bwf-a-no-underline",onClick:function(){S(a),C(e)}},"View Journey")},M={1:"Delay",2:"Action",3:"Goal",4:"Condition"},x=function(e){var t=e.data,a=void 0===t?{}:t;if(Object(o.isEmpty)(a))return Object(n.createElement)(n.Fragment,null);var r=a.action,c=void 0===r?"":r,i=a.run_time,l=void 0===i?"":i,u=a.type,m=void 0===u?"":u;return Object(n.createElement)("div",{className:"bwf-c-contact-details-cell"},!Object(o.isEmpty)(m)&&M.hasOwnProperty(parseInt(m))&&Object(n.createElement)(d.a,{justify:"justify",align:"top"},Object(n.createElement)(d.c,null,Object(n.createElement)("span",{className:"bwf_bold"},M[parseInt(m)]),Object(o.isEmpty)(c)?"":" : "+c)),!Object(o.isEmpty)(l)&&Object(n.createElement)(d.a,{justify:"justify",align:"top"},Object(n.createElement)(d.c,null,Object(s.O)(l))),(Object(o.isEmpty)(m)||!M.hasOwnProperty(parseInt(m)))&&Object(o.isEmpty)(l)&&Object(n.createElement)("span",null,"-"))},R=h.map((function(e){return[{display:L(e),value:""},{display:e.hasOwnProperty("event")?e.event:"-",value:""},{display:e.hasOwnProperty("c_date")?Object(s.O)(e.c_date):"-",value:e.hasOwnProperty("c_date")?e.c_date:"-"},{display:x(e),value:""},{display:e.hasOwnProperty("e_time")&&(t=e,a=t.data,r=void 0===a?{}:a,!r.hasOwnProperty("type")||3!==parseInt(r.type))?Object(s.O)(e.e_time):"-",value:"-"},{display:e.hasOwnProperty("status")&&g.hasOwnProperty(parseInt(e.status))?Object(n.createElement)("span",{className:j[e.status]},g[e.status]):Object(n.createElement)("span",{className:"bwf-tags bwf-tag-green"},"Completed"),value:"-"},{display:P(e),value:"-"}];var t,a,r}));return Object(n.createElement)("div",{className:"bwf-c-s-full"},Object(n.createElement)(r.a,{className:"contact-single-table contact-automations",title:"",rows:R,headers:I,rowsPerPage:1,totalRows:1,isLoading:v,rowHeader:!1,showMenu:!1,emptyMessage:Object(c.__)("No automations found","wp-marketing-automations")}),!Object(o.isEmpty)(E)&&Object(n.createElement)(l.Modal,{title:"",onRequestClose:function(){S(""),C({})},className:"bwf-admin-modal bwf-admin-modal-no-header bwf-admin-modal-fullscreen"},Object(n.createElement)("div",{className:"bwf-stretch-header-customer-journey"},Object(n.createElement)("div",{className:"bwf-wrapper"},Object(n.createElement)("div",{className:"bwf-left-section"},Object(n.createElement)("div",{className:"bwf-back-button bwf-display-flex bwf-cursor-pointer",onClick:function(){S(""),C({})}},Object(n.createElement)(u.a,{icon:"arrow-left",size:20})),Object(n.createElement)("div",{className:"bwf-title bwf-h3"},A.hasOwnProperty("automation_title")?A.automation_title:"")),Object(n.createElement)("div",{className:"bwf-right-section"},Object(n.createElement)("div",{className:"bwf-display-flex bwf-flex-start"},Object(n.createElement)(u.a,{icon:"split-path",width:16,height:18}),Object(n.createElement)("span",null,Object(c.__)("Contact Journey"))),Object(n.createElement)("div",{className:"bwf_clear_10"}),Object(n.createElement)(m.a,{id:A.cid,label:(N="-",Object(o.isEmpty)(A)||(N=Object(o.isEmpty)(A.f_name)&&Object(o.isEmpty)(A.l_name)?A.email:A.f_name+" "+A.l_name),N)})))),Object(n.createElement)(b.e,null,Object(n.createElement)(f.a,{customerData:{trail:E},isConatctTab:!0,automatonID:A.aid}))))}},833:function(e,t,a){"use strict";var n=a(0),r=a(2),c=a(10),i=a.n(c),o=a(5),s=a(265);function l(e,t,a,n,r,c,i){try{var o=e[c](i),s=o.value}catch(e){return void a(e)}o.done?t(s):Promise.resolve(s).then(n,r)}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done)&&(a.push(i.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}t.a=function(e){var t=e.conversation,a=(t=void 0===t?{}:t).ID,c=t.mode,m=t.type,b=e.onRequestClose,f=e.isOpen,p=e.contact,d=void 0===p?{}:p,y=u(Object(n.useState)(null),2),w=y[0],O=y[1],g=u(Object(n.useState)(!1),2),j=g[0],v=g[1],h=u(Object(n.useState)(null),2),_=h[0],E=h[1],S=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a&&!(!parseInt(a)>0)){e.next=2;break}return e.abrupt("return");case 2:return v(!0),e.prev=3,e.next=6,i()({method:"GET",path:Object(o.m)("/contacts/".concat(d.id,"/engagement/").concat(parseInt(a),"?mode=1"))});case 6:"result"in(t=e.sent)&&O(t.result),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),console.log(e.t0),e.t0&&"message"in e.t0?E(e.t0.message):Object(r.__)("There are some technical difficulties while getting emails. Please contact support.","wp-marketing-automations");case 14:v(!1);case 15:case"end":return e.stop()}}),e,null,[[3,10]])})),function(){var t=this,a=arguments;return new Promise((function(n,r){var c=e.apply(t,a);function i(e){l(c,n,r,i,o,"next",e)}function o(e){l(c,n,r,i,o,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}();Object(n.useEffect)((function(){f&&S()}),[f]);return Object(n.createElement)(s.a,{isOpen:f,isLoading:j,onRequestClose:function(){b(),O(null),E(null)},error:_,subject:parseInt(c)<2&&w&&w.subject,body:w&&Object(n.createElement)("div",{dangerouslySetInnerHTML:{__html:w.body}}),sourceType:m,mode:c,contact:e.contact,conversation:e.conversation,template:w})}}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{1152:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a(2),c=a(3),s=a(6),l=a.n(s),i=a(68),o=a(798),m=a(804),b=a(5),u=a(248),p=a(149),d=a(93),f=a(141),O=a(8);function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,c=void 0;try{for(var s,l=e[Symbol.iterator]();!(r=(s=l.next()).done)&&(a.push(s.value),!t||a.length!==t);r=!0);}catch(e){n=!0,c=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return j(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return j(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var _=Object(i.a)(Object(b.Y)()).formatAmount;t.default=function(){var e=Object(m.a)(),t=o.a.getContact(),a=o.a.getOrdersLimit(),s=o.a.getOrdersOffset(),i=o.a.getOrderContactId(),j=o.a.getOrderPage(),g=o.a.getSubscriptions(),y=o.a.getSubscriptionLoading(),E=o.a.getSubscriptionsLimit(),v=o.a.getSubscriptionsTotal(),h=o.a.getSubscriptionsOffset(),k=o.a.getSubscriptionPage();Object(r.useEffect)((function(){t&&"id"in t&&parseInt(t.id)!==parseInt(i)&&(e.fetchOrders(parseInt(t.id),s,a),t&&!Object(c.isEmpty)(t.wcs)&&e.fetchSubscription(parseInt(t.id),h,E))}),[t]);var N,A=o.a.getOrders(),S=o.a.getOrderLoading(),I=o.a.getOrdersTotal(),L=t&&t.wc&&t.wc.purchased_products?t.wc.purchased_products:[],C=t&&t.wc&&t.wc.purchased_products_cats?t.wc.purchased_products_cats:[],F=t&&t.wc&&t.wc.purchased_products_tags?t.wc.purchased_products_tags:[],P=t&&t.wc&&t.wc.used_coupons?t.wc.used_coupons:[],D=l()("bwfcrm-contacts-orders",{"has-search":!0}),M=[{key:"column_date",label:Object(n.__)("Date","wp-marketing-automations"),isLeftAligned:!0},{key:"column_order_id",label:Object(n.__)("Order ID","wp-marketing-automations"),isLeftAligned:!1},{key:"column_status",label:Object(n.__)("Status","wp-marketing-automations"),isLeftAligned:!1},{key:"column_products",label:Object(n.__)("Products","wp-marketing-automations"),isLeftAligned:!1},{key:"column_net_sale",label:Object(n.__)("Revenue","wp-marketing-automations"),isLeftAligned:!1}],T=[{key:"date",label:Object(n.__)("Created On","wp-marketing-automations"),isLeftAligned:!0},{key:"sub_id",label:Object(n.__)("Subscription ID","wp-marketing-automations"),isLeftAligned:!1},{key:"renew_date",label:Object(n.__)("Next Renewal Date","wp-marketing-automations"),isLeftAligned:!1},{key:"status",label:Object(n.__)("Status","wp-marketing-automations"),isLeftAligned:!1},{key:"total_renewals",label:Object(n.__)("Total Renewal","wp-marketing-automations"),isLeftAligned:!1},{key:"total",label:Object(n.__)("Total","wp-marketing-automations"),isLeftAligned:!1}],x=function(e,t){var a,n,s,l=[{display:e.date?Object(b.N)(e.date):"-",value:""},{display:Object(r.createElement)("a",{className:"bwf-a-no-underline",target:"_blank",href:"post.php?post="+e.id+"&action=edit",rel:"noreferrer"},"#"+e.id),value:""}];return"subscription"==t&&l.push({display:e.next_renewal_date?Object(b.N)(e.next_renewal_date):"-",value:""}),l.push({display:e.status?e.status:"-",value:""}),"subscription"==t&&l.push({display:e.total_renewal?e.total_renewal:"0",value:""}),"order"==t&&l.push({display:(a=e.items?e.items:[],n="",s=[],Object.entries(a).map((function(e){var t=w(e,2),a=t[0],l=t[1];Object(c.isEmpty)(n)&&(n=Object(r.createElement)("a",{className:"bwf-a-no-underline",target:"_blank",href:"post.php?action=edit&post="+a,rel:"noreferrer"},l)),s.push(Object(r.createElement)("a",{className:"bwf-a-no-underline",target:"_blank",href:"post.php?action=edit&post="+a,rel:"noreferrer"},l))})),Object(r.createElement)(r.Fragment,null,!Object(c.isEmpty)(n)&&n,!Object(c.isEmpty)(s)&&s.length>1&&Object(r.createElement)(d.a,{items:s}))),value:""}),l.push({display:_(e.total?e.total:0),value:""}),l},R=Object(c.isArray)(A)?A.map((function(e){return x(e,"order")})):[],q=Object(c.isArray)(g)?g.map((function(e){return x(e,"subscription")})):[],H=function(r,n){var c=(n-1)*a;"order"==r?e.fetchOrders(parseInt(t.id),c,a):"subscription"==r&&e.fetchSubscription(parseInt(t.id),c,E)},J=function(e,t){return"per_page"!==t?function(){}:"order"==e?Q:"subscription"==e?U:void 0},Q=function(r){r!==a&&e.fetchOrders(parseInt(t.id),0,r)},U=function(a){a!==E&&e.fetchSubscription(parseInt(t.id),0,a)},V=function(){return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-c-s-list"},Object(r.createElement)("div",{className:"bwf-c-s-label"},Object(n.__)("Total Spend","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-c-s-po-value"},t&&t.wc&&t.wc.total_order_value?_(t.wc.total_order_value):0)),Object(r.createElement)("div",{className:"bwf-c-s-list"},Object(r.createElement)("div",{className:"bwf-c-s-label"},Object(n.__)("AOV","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-c-s-po-value"},t&&function(){var e="";if(t.wc){var a,n=t.wc.aov_contact?parseFloat(t.wc.aov_contact):0,c=t.wc.aov_store?parseFloat(t.wc.aov_store):0;a=Number.isFinite(n)&&Number.isFinite(c)?0===c?0:Math.round((n-c)/c*100):null,e=n?a>0?Object(r.createElement)("div",null,_(n),Object(r.createElement)("span",{className:"bwf-c-s-hl bwf-c-s-hl-g"},a,"%")):Object(r.createElement)("div",null,_(n),Object(r.createElement)("span",{className:"bwf-c-s-hl bwf-c-s-hl-r"},a,"%")):"-"}return e}())),Object(r.createElement)("div",{className:"bwf-c-s-list"},Object(r.createElement)("div",{className:"bwf-c-s-label"},Object(n.__)("Details","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-c-s-po-value"},S?Object(r.createElement)(p.a,{caption:Object(n.__)("Orders","wp-marketing-automations"),className:D,headers:M}):Object(c.isEmpty)(R)?"-":Object(r.createElement)(u.a,{className:D,title:"",rows:R,headers:M,query:{paged:j},rowsPerPage:a,totalRows:I,isLoading:S,showMenu:!1,rowHeader:!0,onPageChange:function(e){return H("order",e)},onQueryChange:function(e){return J("order",e)},emptyMessage:Object(n.__)("No orders found","wp-marketing-automations")}),Object(r.createElement)("div",{className:"bwf_clear_20"}))))};return Object(r.createElement)("div",{className:"bwf-c-s-data"},Object(r.createElement)(f.a,{items:(N=[{key:0,label:Object(n.__)("Products","wp-marketing-automations"),display:Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-c-s-list bwf-c-s-list-items"},Object(r.createElement)("div",{className:"bwf-c-s-label"},Object(n.__)("Items","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-c-s-po-value bwf-c-s-inline-p"},Object(c.isEmpty)(L)?"-":L.map((function(e,t){return Object(r.createElement)("a",{className:"bwf-a-no-underline",target:"_blank",href:"post.php?post="+parseInt(e.id)+"&action=edit",key:t,rel:"noreferrer"},e.name)})))),Object(r.createElement)("div",{className:"bwf-c-s-list bwf-c-s-term-ui bwf-c-s-list-terms"},Object(r.createElement)("div",{className:"bwf-c-s-label"},Object(n.__)("Categories","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-c-s-po-value"},Object(c.isEmpty)(C)?"-":Object(r.createElement)(r.Fragment,null,Object(r.createElement)("ul",null,C.map((function(e,t){return Object(r.createElement)("li",{key:e.id},Object(r.createElement)("a",{className:"bwf-a-no-underline",target:"_blank",href:"term.php?taxonomy=product_cat&post_type=product&tag_ID="+e.id,key:t,rel:"noreferrer"},Object(r.createElement)("span",null,e.name)))})))))),Object(r.createElement)("div",{className:"bwf-c-s-list bwf-c-s-term-ui bwf-c-s-list-terms"},Object(r.createElement)("div",{className:"bwf-c-s-label"},Object(n.__)("Tags","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-c-s-po-value"},Object(c.isEmpty)(F)?"-":Object(r.createElement)(r.Fragment,null,Object(r.createElement)("ul",null,F.map((function(e,t){return Object(r.createElement)("li",{key:e.id},Object(r.createElement)("a",{className:"bwf-a-no-underline",target:"_blank",href:"term.php?taxonomy=product_tag&post_type=product&tag_ID="+e.id,key:t,rel:"noreferrer"},Object(r.createElement)("span",null,e.name)))})))))))},{key:1,label:Object(n.__)("Marketing","wp-marketing-automations"),display:Object(r.createElement)("div",{className:"bwf-c-s-list bwf-c-s-term-ui bwf-c-s-list-coupons"},Object(r.createElement)("div",{className:"bwf-c-s-label"},Object(n.__)("Coupons","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-c-s-po-value"},Object(c.isEmpty)(P)?"-":Object(r.createElement)(r.Fragment,null,Object(r.createElement)("ul",null,P.map((function(e,t){return Object(r.createElement)("li",{key:t},Object(r.createElement)("span",{className:"bwf-mr-5"},Object(r.createElement)(O.a,{icon:"coupon"})),Object(r.createElement)("span",null,e))}))))))},{key:2,label:Object(n.__)("Orders","wp-marketing-automations"),display:V()}],t&&!Object(c.isEmpty)(t.wcs)&&N.push({key:3,label:Object(n.__)("Subscription","wp-marketing-automations"),display:Object(r.createElement)("div",{className:"bwf-c-s-list"},Object(r.createElement)("div",{className:"bwf-c-s-label"},Object(n.__)("Details","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-c-s-po-value"},y?Object(r.createElement)(p.a,{caption:Object(n.__)("Subscription","wp-marketing-automations"),className:D,headers:T}):Object(c.isEmpty)(q)?"-":Object(r.createElement)(u.a,{className:D,title:"",rows:q,headers:T,query:{paged:k},rowsPerPage:E,totalRows:v,isLoading:y,showMenu:!1,rowHeader:!0,onPageChange:function(e,t){return H("subscription",e)},onQueryChange:function(e){return J("subscription",e)},emptyMessage:Object(n.__)("No subscriptions found","wp-marketing-automations")}),Object(r.createElement)("div",{className:"bwf_clear_20"})))}),N)}))}}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{1100:function(e,t,n){},1101:function(e,t,n){},1102:function(e,t,n){},1103:function(e,t,n){},1104:function(e,t,n){},1105:function(e,t,n){},1106:function(e,t,n){},1107:function(e,t,n){},1108:function(e,t,n){},1109:function(e,t,n){},1169:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(795),c=n(3),o=n(6),i=n.n(o),l=n(2),s=(n(849),n(8)),u=n(4),m=n(249),b=n(138),d=n(5);var f=n(10),p=n.n(f),O=(n(850),n(135));function j(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function y(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){j(c,a,r,o,i,"next",e)}function i(e){j(c,a,r,o,i,"throw",e)}o(void 0)}))}}function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var _=function(e){var t=Object(a.useContext)(d.d),n=e.isOpen,r=e.onRequestClose,o=e.node,f=e.isEvent,j=void 0===f||f,w=e.automationID,g=o.id,h=Object(m.a)(),_=h.setNodeDatabyId,N=h.fetchAutomation,k=h.setAutomationData,C=h.showSidebar,P=Object(b.a)(),S=P.getEventsList,A=P.getActionsList,x=P.getAutomationSteps,D=P.getAutomationLinks,I=P.getCount,T=P.getAutomationData,M=P.getNodeDataByID,F=j?S():A(),L=E(Object(a.useState)({loading:!1,status:!1}),2),R=L[0],z=L[1],q=F.group,B=void 0===q?[]:q,U=F.list,H=void 0===U?{}:U,V=F.subgroup,$=void 0===V?[]:V,Y=F.subgroup_priority,G=void 0===Y?{}:Y,J=E(Object(a.useState)(""),2),Q=J[0],W=J[1],X=E(Object(a.useState)(""),2),Z=X[0],K=X[1],ee=E(Object(a.useState)(""),2),te=ee[0],ne=ee[1],ae=E(Object(a.useState)(""),2),re=ae[0],ce=ae[1],oe=E(Object(a.useState)(!1),2),ie=oe[0],le=oe[1],se=x(),ue=D(),me=I(),be=T("data"),de=M(g),fe=de.data,pe=void 0===fe?{}:fe,Oe=de.stepId,je=void 0===Oe?0:Oe,ye=Object.keys(G).sort((function(e,t){return G[e]-G[t]})),we=be.source,ve=void 0===we?"":we,ge=be.event,Ee=void 0===ge?"":ge,he=function(e){var t=[],n="";return B.map((function(a){(Object(c.isArray)(a.subgroup)&&a.subgroup.includes(e)||Object(c.isObject)(a.subgroup)&&Object.values(a.subgroup).includes(e))&&(t=a.subgroup,n=a.group_slug)})),{acsubgp:t,acgrp:n}};Object(a.useEffect)((function(){if(Object(c.isEmpty)(B)||(""!=ve||""!=Ee)&&j){var e=he(ve),t=e.acsubgp,n=e.acgrp;ne(Object(c.isObject)(t)?Object.values(t):t),K(n),ce(Ee)}else K(B[0].group_slug),ne(Object(c.isObject)(B[0].subgroup)?Object.values(B[0].subgroup):B[0].subgroup)}),[n]),Object(a.useEffect)((function(){if(Object(c.isEmpty)(Q))if(Object(c.isEmpty)(B)||(""!=ve||""!=Ee)&&j){var e=he(ve),t=e.acsubgp,n=e.acgrp;ne(Object(c.isObject)(t)?Object.values(t):t),K(n),ce(Ee)}else K(B[0].group_slug);else K("")}),[Q]);var _e,Ne,ke=function(){r&&r()},Ce=function(){var e=y(regeneratorRuntime.mark((function e(n,a,r,o){var i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=!1,o.hasOwnProperty("event")&&H.hasOwnProperty(o.event)&&H[o.event].hasOwnProperty("need_unique_key")&&H[o.event].need_unique_key&&(i=!0),s={},s=""==Ee?{steps:Object(c.cloneDeep)(n).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:a,count:r,data:o,need_unique_key:i}:{data:o,need_unique_key:i},e.prev=4,le(!0),t(Object(l.__)("Updating automation…","wp-marketing-automations-crm")),e.next=9,p()({path:Object(d.m)("/automation/".concat(w)),method:"POST",data:{data:s}}).then(function(){var e=y(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(200!==n.code){e.next=7;break}return e.next=3,N(w).then((function(){k("openStartSidebar",!0)}));case 3:t(n.message),Object(d.gb)(t,1e3),e.next=8;break;case 7:throw Error(Object(d.j)(null==n?void 0:n.message));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 9:e.next=16;break;case 11:e.prev=11,e.t0=e.catch(4),Object(d.gb)(t,1e3),le(!1),setTimeout((function(){z({status:!0,error:e.t0.message})}),[1500]);case 16:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t,n,a,r){return e.apply(this,arguments)}}(),Pe=function(){var e=y(regeneratorRuntime.mark((function e(n,a){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={steps:Object(c.cloneDeep)(se).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:ue,count:me,data:{action:{action:n,intergration:a}},updateStatus:2},e.prev=1,le(!0),t(Object(l.__)("Updating automation…","wp-marketing-automations-crm")),e.next=6,p()({path:Object(d.m)("/automation/".concat(w,"/step/").concat(je)),method:"POST",data:r}).then((function(e){if(200!==e.code)throw Error(Object(d.j)(null==e?void 0:e.message));_(o.id,{selected:n},{step_status:2}),t(e.message)})).then((function(){var e=Object(c.cloneDeep)(o);e.data.selected=n,k("sidebarNodeData",e),C(!0),le(!1),ke(),Object(d.gb)(t,1e3)}));case 6:e.next=13;break;case 8:e.prev=8,e.t0=e.catch(1),Object(d.gb)(t,1e3),le(!1),setTimeout((function(){z({status:!0,error:e.t0.message})}),[1500]);case 13:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}(),Se=function(e){if("string"==typeof e&&""!==e)if("start"===g&&j)pe.evtGroup=H[e].source_type,pe.event=e,function(e){var t={};t=se.map((function(t){return"start"==t.id&&(t.data=e),t}));var n=[];1==se.length?(t.push({id:"end",type:"end",data:{label:"End Automation"},hidden:!1,position:{x:250,y:600}}),n=[{id:"endlink",source:"start",target:"end",sourceHandle:"",animated:!1}]):n=Object(c.cloneDeep)(ue);var a=Object(c.cloneDeep)(be);a.event=e.event,a.source=e.evtGroup,Ce(t,n,2,a)}(pe);else{var n=H[e].integration_slug;Pe(e,n)}else t(j?Object(l.__)("Please choose an event."):Object(l.__)("Please choose an action.")),Object(d.gb)(t,1e3)};return n?Object(a.createElement)(u.Modal,{onRequestClose:ke,className:"bwf-admin-modal bwf-event-search-modal bwf-admin-modal-xl",shouldCloseOnEsc:!0,shouldCloseOnClickOutside:!1},Object(a.createElement)("div",{className:"bwf-modal-search-header"},Object(a.createElement)("div",{className:"bwf-modal-title"},j?Object(l.__)("Select an Event"):Object(l.__)("Select an Action")),Object(a.createElement)("div",{className:"bwf-modal-search-wrap"},Object(a.createElement)("div",{className:"bwf-component-search-control"},Object(a.createElement)(s.a,{icon:"search",size:15}),Object(a.createElement)(u.TextControl,{value:Q,onChange:W,placeholder:Object(l.__)("Search…..")}))),Object(a.createElement)("div",{className:"bwf-modal-close bwf-cursor-pointer",onClick:ke},Object(a.createElement)(s.a,{icon:"close",size:16}))),Object(a.createElement)("div",{className:"bwf-event-modal-main"},Object(a.createElement)("div",{className:"bwf-event-modal-body"},Object(a.createElement)("div",{className:"bwf-modal-sidebar"},Object(a.createElement)("div",{className:"bwf-modal-filter-wrap"},B.map((function(e,t){if(function(e){var t=!1;if(e.hasOwnProperty("subgroup")&&!Object(c.isEmpty)(e.subgroup)){var n=[];(Object(c.isObject)(e.subgroup)?Object.values(e.subgroup):e.subgroup).map((function(e){$.hasOwnProperty(e)&&n.push(e)})),Object(c.isEmpty)(n)||(t=!0)}return t}(e))return Object(a.createElement)("div",{key:t,className:i()("bwf-modal-filter",{active:Z===e.group_slug}),onClick:function(){ce(""),K(e.group_slug),ne(Object(c.isObject)(e.subgroup)?Object.values(e.subgroup):e.subgroup)}},e.label)})))),Object(a.createElement)("div",{className:"bwf-modal-content-content"},Object(a.createElement)("div",{className:"bwf-modal-content-brick"},Object(a.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(a.createElement)("div",{className:"bwf-brick-content"},(_e=[],Ne={},Object(c.isEmpty)(Q)?te.map((function(e){Ne=v(v({},Ne),$[e])})):Object.values($).map((function(e){Ne=v(v({},Ne),e)})),_e.push(Ne),_e).map((function(e,t){if(Object(c.isEmpty)(e))return Object(a.createElement)(a.Fragment,{key:t});var n=[],r=Object.keys(e);return Object(c.isEmpty)(ye)?n=r:ye.map((function(e){r.includes(e)&&n.push(e)})),Object(a.createElement)("div",{key:t+"-2"},n.map((function(t,n){var r=[];return r=function(e){var t=[];return(Object(c.isObject)(e)?Object.values(e):e).map((function(e){if(H.hasOwnProperty(e)&&H[e].hasOwnProperty(j?"event_name":"action_name")){var n=j?H[e].event_name:H[e].action_name;(Object(c.isEmpty)(Q)||n.toLowerCase().includes(Q.toLowerCase()))&&t.push(e)}})),t}(e[t]),!Object(c.isEmpty)(r)&&Object(a.createElement)(a.Fragment,{key:n},Object(a.createElement)("div",{className:"bwf-brick-content-header",key:n},t),r.map((function(e,t){var n=!!H[e].hasOwnProperty("lock")&&H[e].lock;return Object(a.createElement)(u.Button,{key:t,isPrimary:re===e,isSecondary:re!==e,className:"bwf-secondary-alter "+(Object(d.nb)()?n?"locked":"":"not-pro"),onClick:function(){Object(d.nb)()||!n?ce(e):k("showProModal",!0)},disabled:Object(d.nb)()&&n},re===e&&Object(a.createElement)("span",{className:"bwf-circle-tick"},Object(a.createElement)(s.a,{icon:"tick",size:10})),j?H[e].event_name:H[e].action_name,n&&!Object(d.nb)()&&Object(a.createElement)("span",{className:"bwf-display-flex bwf-ml-5"},Object(a.createElement)(s.a,{icon:"lock",size:15})))})))})))}))))),Object(a.createElement)("div",{className:"bwf-modal-inner-footer bwf_text_right"},Object(a.createElement)(u.Button,{className:"bwf-modal-cancel-btn",onClick:ke},Object(l.__)("Cancel")),Object(a.createElement)(u.Button,{isPrimary:!0,isBusy:ie,onClick:function(){ie||Se(re)}},Object(l.__)("Done")))))),Object(a.createElement)(O.a,{modalTitle:j?"Event Selection":"Action Selection",errorMessage:R.error,onRequestClose:function(){return z({status:!1})},isOpen:R.status})):""};function N(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var P=function(e){var t=Object(a.useContext)(d.d),n=e.isOpen,r=e.onRequestClose,o=e.node,f=e.automationID,O=o.id,j=Object(m.a)(),y=j.setNodeDatabyId,w=j.setAutomationData,v=j.showSidebar,g=Object(b.a)(),E=g.getGoals,h=g.getAutomationSteps,_=g.getAutomationLinks,C=g.getCount,P=g.getNodeDataByID,S=E(),A=S.group,x=void 0===A?[]:A,D=S.list,I=void 0===D?{}:D,T=S.subgroup,M=void 0===T?[]:T,F=S.subgroup_priority,L=void 0===F?{}:F,R=k(Object(a.useState)(""),2),z=R[0],q=R[1],B=k(Object(a.useState)(""),2),U=B[0],H=B[1],V=k(Object(a.useState)(""),2),$=V[0],Y=V[1],G=k(Object(a.useState)(""),2),J=G[0],Q=G[1],W=k(Object(a.useState)(!1),2),X=W[0],Z=W[1],K=h(),ee=_(),te=C(),ne=P(O),ae=ne.data,re=void 0===ae?{}:ae,ce=ne.stepId,oe=void 0===ce?0:ce,ie=L[U]?L[U]:{},le=re.source,se=void 0===le?"":le,ue=re.benchmark,me=void 0===ue?"":ue,be=function(e){var t=[],n="";return x.map((function(a){a.subgroup.includes(e)&&(t=a.subgroup,n=a.group_slug)})),{acsubgp:t,acgrp:n}};Object(a.useEffect)((function(){if(Object(c.isEmpty)(x)||""!=se||""!=me){var e=be(se),t=e.acsubgp,n=e.acgrp;Y(t),H(n),Q(me)}else H(x[0].group_slug),Y(x[0].subgroup)}),[n]),Object(a.useEffect)((function(){if(Object(c.isEmpty)(z))if(Object(c.isEmpty)(x)||""!=se||""!=me){var e=be(se),t=e.acsubgp,n=e.acgrp;Y(t),H(n),Q(me)}else H(x[0].group_slug);else H("")}),[z]);var de,fe=function(){r&&r()},pe=function(){var e,n=(e=regeneratorRuntime.mark((function e(n,a){var r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=re,Z(!0),r.benchmark=n,t("Adding benchmark.."),e.prev=4,i={steps:Object(c.cloneDeep)(K).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:ee,count:te,data:{action:{benchmark:n,source:a}},updateStatus:2},e.next=8,p()({path:Object(d.m)("/automation/".concat(f,"/step/").concat(oe)),method:"POST",data:i}).then((function(e){200===e.code&&(t(e.message),y(parseInt(O),r,{step_status:2}))})).then((function(){var e=Object(c.cloneDeep)(o);e.data.benchmark=n,w("sidebarNodeData",e),v(!0),Z(!1),fe()}));case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(4),console.log(e.t0),Z(!0);case 14:Object(d.gb)(t,1e3);case 15:case"end":return e.stop()}}),e,null,[[4,10]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){N(c,a,r,o,i,"next",e)}function i(e){N(c,a,r,o,i,"throw",e)}o(void 0)}))});return function(e,t){return n.apply(this,arguments)}}();return n?Object(a.createElement)(u.Modal,{onRequestClose:fe,className:"bwf-admin-modal bwf-event-search-modal bwf-admin-modal-xl",shouldCloseOnEsc:!0,shouldCloseOnClickOutside:!1},Object(a.createElement)("div",{className:"bwf-modal-search-header"},Object(a.createElement)("div",{className:"bwf-modal-title"},Object(l.__)("Select an Goal")),Object(a.createElement)("div",{className:"bwf-modal-search-wrap"},Object(a.createElement)("div",{className:"bwf-component-search-control"},Object(a.createElement)(s.a,{icon:"search",size:15}),Object(a.createElement)(u.TextControl,{value:z,onChange:q,placeholder:Object(l.__)("Search…..")}))),Object(a.createElement)("div",{className:"bwf-modal-close bwf-cursor-pointer",onClick:fe},Object(a.createElement)(s.a,{icon:"close",size:16}))),Object(a.createElement)("div",{className:"bwf-event-modal-main"},Object(a.createElement)("div",{className:"bwf-event-modal-body"},Object(a.createElement)("div",{className:"bwf-modal-sidebar"},Object(a.createElement)("div",{className:"bwf-modal-filter-wrap"},x.map((function(e,t){if(function(e){var t=!1;if(e.hasOwnProperty("subgroup")&&!Object(c.isEmpty)(e.subgroup)){var n=[];e.subgroup.map((function(e){M.hasOwnProperty(e)&&n.push(e)})),Object(c.isEmpty)(n)||(t=!0)}return t}(e))return Object(a.createElement)("div",{key:t,className:i()("bwf-modal-filter",{active:U===e.group_slug}),onClick:function(){Q(""),H(e.group_slug),Y(e.subgroup)}},e.label)})))),Object(a.createElement)("div",{className:"bwf-modal-content-content"},Object(a.createElement)("div",{className:"bwf-modal-content-brick"},Object(a.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(a.createElement)("div",{className:"bwf-brick-content"},(de=[],Object(c.isEmpty)(z)&&!Object(c.isEmpty)($)?$.map((function(e){de.push(M[e])})):Object.values(M).map((function(e){de.push(e)})),de).map((function(e,t){if(Object(c.isEmpty)(e))return Object(a.createElement)("div",{key:t});var n=[];return n=ie&&Object.keys(ie).length>0?Object.keys(e).sort((function(e,t){return ie[e]||ie[t]?ie[e]&&!ie[t]?1:!ie[e]&&ie[t]?-1:ie[e]-ie[t]:1})):Object.keys(e),Object(a.createElement)("div",{key:t},n.map((function(t,n){var r=function(e){var t=[];return e.map((function(e){if(I.hasOwnProperty(e)&&I[e].hasOwnProperty("event_name")){var n=I[e].event_name;(Object(c.isEmpty)(z)||n.toLowerCase().includes(z.toLowerCase()))&&t.push(e)}})),t}(e[t]);return!Object(c.isEmpty)(r)&&Object(a.createElement)("div",{key:n},Object(a.createElement)("div",{className:"bwf-brick-content-header"},t),r.map((function(e){return Object(a.createElement)(u.Button,{key:e,isPrimary:J===e,isSecondary:J!==e,className:"bwf-secondary-alter",onClick:function(){Q(e)}},J===e&&Object(a.createElement)("span",{className:"bwf-circle-tick"},Object(a.createElement)(s.a,{icon:"tick",size:10})),I[e].event_name)})))})))}))))),Object(a.createElement)("div",{className:"bwf-modal-inner-footer bwf_text_right"},Object(a.createElement)(u.Button,{className:"bwf-modal-cancel-btn",onClick:fe},Object(l.__)("Cancel")),Object(a.createElement)(u.Button,{isPrimary:!0,isBusy:X,onClick:function(){X||function(e){if("string"==typeof e&&""!==e){var n=I[e].source_type;pe(e,n)}else t(Object(l.__)("Please choose an benchmark.")),Object(d.gb)(t,1e3)}(J)}},Object(l.__)("Done"))))))):""},S=function(e){var t=e.onNodeClick,n=e.onNoteToggleClick,r=e.onElipsisToggleClick,c=e.onInfoToggleClick,o=e.onNodeStatClick,i=e.onNodeQueuedStatClick,l=Object(b.a)(),s=l.getEnableCopy,u=l.getEnableMove,m=s(),d=u(),f=Object(a.useCallback)((function(e,t){var n=!(!e.target||"string"!=typeof e.target.className)&&e.target.className;return!!n&&n.includes(t)||e.target.closest("."+t)}),[]);return function(e){if(!m&&!d)if(f(e,"bwf-note__toggle"))n&&n();else if(f(e,"bwf-ellipsis-menu__toggle"))r&&r();else if(f(e,"bwf-info__toggle"))c&&c();else if(f(e,"bwf-status-wrap"))o&&o();else if(f(e,"bwf-queued-status-wrap"))i&&i();else{var a=f(e,"bwf-ellipsis-menu"),l=f(e,"bwf-note-popup"),s=f(e,"bwf-info-popup");a||l||s||t&&t()}}},A=n(91),x=n(16),D=n(59);function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var M=function(e){e.data;var t=e.selected,n=void 0!==t&&t,o=I(Object(a.useState)(!1),2),i=o[0],u=o[1],f=Object(b.a)(),p=f.getEventsList,O=f.getAutomationData,j=f.getOpenStartSidebar,y=f.getEnableMove,w=f.getEnableCopy,v=f.getStatLoading,g=f.getStatData,E=w(),h=y(),N=O(),k=j(),C=v(),P=g(),T=N.ID,M=N.event,F=void 0===M?"":M,L=P.hasOwnProperty("start")?P.start:{};Object(a.useEffect)((function(){k&&(z("sidebarNodeData",e),q(!0))}),[k]);var R=Object(m.a)(),z=R.setAutomationData,q=R.showSidebar,B=p(),U=S({onNodeClick:!Object(c.isEmpty)(F)&&B.list.hasOwnProperty(F)&&function(){B.list[F].hasOwnProperty("fields")&&!Object(c.isEmpty)(B.list[F].fields)&&(z("sidebarNodeData",e),q(!0))},onNodeStatClick:function(){Object(d.nb)()?(z("showContactModalId",F),z("showContactModalType","completed")):z("showProModal",!0)},onNodeQueuedStatClick:function(){Object(d.nb)()?(z("showContactModalId",F),z("showContactModalType","active")):z("showProModal",!0)}});return Object(a.createElement)("div",{className:"bwf-node-wrapper"},Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(n?"bwf-selected-node":"")+(Object(c.isEmpty)(F)?" bwf-empty-start-node":""),onClick:U},Object(c.isEmpty)(F)?Object(a.createElement)("div",{className:"bwf-node-brick is-start-node",onClick:function(){return u(!0)}},Object(a.createElement)("div",{className:"bwf-node-icon"},Object(a.createElement)(s.a,{size:22,icon:"tap-icon"})),Object(a.createElement)("div",{className:"bwf-display-flex bwf-h4"},"Select Trigger")):Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-brick is-start-node-selected"},Object(a.createElement)("div",{className:"bwf-node-icon icon-start"},Object(a.createElement)(s.a,{size:22,icon:"rocket"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},B.list.hasOwnProperty(F)&&B.list[F].hasOwnProperty("source_label")?B.list[F].source_label:""),Object(a.createElement)("div",{className:"bwf-node-content-label"},B.list.hasOwnProperty(F)&&B.list[F].hasOwnProperty("event_name")?B.list[F].event_name:"Event Not Found")),Object(a.createElement)("div",{className:"bwf-node-action"},!Object(c.isEmpty)(F)&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)(D.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations-crm"),classes:"bwf-event-action",isDisable:!(!E&&!h),renderContent:function(e){var t=e.onToggle;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(A.a,{isClickable:!0,onInvoke:function(){u(!0),t()}},Object(a.createElement)(x.a,{justify:"flex-start"},Object(a.createElement)(x.c,null,Object(l.__)("Change Event","wp-marketing-automations-crm")))))}})))),Object(a.createElement)("div",{className:"bwf-node-status bwf-node-m-0"},Object(a.createElement)("div",{className:"bwf-queued-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Active","wp-marketing-automations-crm")),Object(a.createElement)("span",{className:"bwf-node-status-count"},C?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(a.createElement)(a.Fragment,null,L.hasOwnProperty("active")?Object(d.Ab)(parseInt(L.active)):0))),Object(a.createElement)("div",{className:"bwf-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations-crm")),Object(a.createElement)("span",{className:"bwf-node-status-count"},C?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(a.createElement)(a.Fragment,null,L.hasOwnProperty("completed")?Object(d.Ab)(parseInt(L.completed)):0)))))),!Object(c.isEmpty)(F)&&Object(a.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1}),Object(a.createElement)(_,{isOpen:i,node:e,onRequestClose:function(){return u(!1)},automationID:T}))},F=n(43);n(1100);function L(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var q=function(e){var t=e.node,n=t.id,r=void 0===n?"":n,o=t.data,f=Object(a.useContext)(d.d),O=R(Object(a.useState)(!1),2),j=O[0],y=O[1],w=R(Object(a.useState)(o.hasOwnProperty("note")?o.note:""),2),v=w[0],g=w[1],E=R(Object(a.useState)(!1),2),h=E[0],_=E[1],N=Object(m.a)().setNodeDatabyId,k=Object(b.a)(),C=k.getAutomationData,P=k.getNodeDataByID,S=k.getEnableMove,x=k.getEnableCopy,I=S(),T=x(),M=Object(c.isEmpty)(r)?{}:P(r),z=M.stepId,q=void 0===z?0:z,B=M.data,U=(void 0===B?{}:B).note,H=void 0===U?"":U,V=C().ID,$=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),e.prev=1,e.next=4,p()({path:Object(d.m)("/automation/".concat(V,"/step/").concat(q)),method:"POST",data:{data:{data:{note:t}}}}).then((function(e){200===e.code&&(f(e.message),o.note=t,N(r,o),_(!1))}));case 4:y(!1),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),f(e.t0.message),y(!1);case 11:Object(d.gb)(f,1e3);case 12:case"end":return e.stop()}}),e,null,[[1,7]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){L(c,a,r,o,i,"next",e)}function i(e){L(c,a,r,o,i,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}();return Object(a.createElement)("div",{className:"bwf-note-popup"},Object(a.createElement)(F.a,{contentClassName:"bwf-note__popover",position:"top right",renderToggle:function(e){var t=e.onToggle,n=e.isOpen,r=i()("bwf-note__toggle bwf-cursor-pointer",{"is-opened":n});return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:r,onClick:function(e){I||T||t(e)},"aria-expanded":n},!Object(c.isEmpty)(v)&&Object(a.createElement)("span",{className:"bwf-has-note"}),Object(a.createElement)(s.a,{size:16,icon:"note"})))},renderContent:function(e){var t,n=e.onToggle;return Object(a.createElement)("div",{className:"bwf-note-popover-container"},Object(a.createElement)("div",{className:"bwf-note-popover-header"},Object(a.createElement)("div",{className:"bwf-note-header-text"},Object(l.__)("Notes")),Object(a.createElement)("span",{className:"bwf-note-close",onClick:n},Object(a.createElement)(s.a,{icon:"close",size:"16"}))),Object(a.createElement)("div",{className:"bwf-note-popover-body"},Object(c.isEmpty)(v)||h?Object(a.createElement)(a.Fragment,null,Object(a.createElement)(u.TextareaControl,{value:v,autoFocus:!0,onChange:function(e){_(!0),g(e)}}),Object(a.createElement)("div",{className:"bwf_text_right",onClick:function(){return $(v)}},Object(a.createElement)(u.Button,{isPrimary:!0,isBusy:j},Object(c.isEmpty)(H)?Object(l.__)("Add","wp-marketing-automations-crm"):Object(l.__)("Update","wp-marketing-automations-crm")))):Object(a.createElement)("div",{className:"bwf-note-wrapper"},Object(a.createElement)("div",{className:"bwf-note--content"},Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:(t=v,t.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,'<a href="$1" target="_blank" class="bwf-a-no-underline">$1</a>'))}})),Object(a.createElement)(D.a,{label:Object(l.__)("Event note action","wp-marketing-automations-crm"),renderContent:function(e){var t=e.onToggle;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(A.a,{isClickable:!0,onInvoke:function(){_(!0)}},Object(l.__)("Edit","wp-marketing-automations-crm")),Object(a.createElement)(A.a,{isClickable:!0,onInvoke:function(){t(),g(""),$("")}},Object(l.__)("Delete","wp-marketing-automations-crm")))}}))))},focusOnMount:!0}))},B=n(879);function U(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function H(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return V(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return V(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var $=function(e){var t=e.readables;return Object(a.createElement)("div",{className:"bwf-step-brick"},t.map((function(e,t){var n=e.map((function(e,t){return Object(c.isEmpty)(e)?Object(a.createElement)(a.Fragment,null):Object(a.createElement)("div",{key:t},0!==t&&Object(a.createElement)("div",{className:"bwf-step-divider"},Object(a.createElement)("span",{className:"bwf-divider"},"AND")),Object(a.createElement)("div",{className:"bwf-step-content-content bwf-two-line-ellipse-text"},e))}));return 0!==t?Object(c.isEmpty)(n)?Object(a.createElement)(a.Fragment,null):Object(a.createElement)("div",{key:t+"-or"},Object(a.createElement)("div",{className:"bwf-step-divider divider-line bwf-or"},Object(a.createElement)("span",{className:"bwf-divider"},"OR")),n):n})))},Y=function(e){var t=e.data,n=void 0===t?{}:t,o=e.selected,i=void 0!==o&&o,u=e.id,f=H(Object(a.useState)({status:!1,loading:!0}),2),p=f[0],j=f[1],y=Object(m.a)(),w=y.deleteNode,v=y.setAutomationData,g=y.showSidebar,E=y.setNodeForAdd,h=y.copyNodeHere,_=y.setOpenStepModal,N=y.setModalAnchorNode,k=Object(b.a)(),C=k.getAutomationId,P=k.getAutomationData,I=k.getEnableCopy,T=k.getEnableMove,M=k.getNodeDataByID,F=k.getLastAddedNode,L=k.getStatLoading,R=k.getStatData,z=F(),V=P().event,Y=C(),G=L(),J=R();Object(a.useEffect)((function(){z==u&&(v("sidebarNodeData",e),g(!0),v("lastAddedNode",0))}),[z]);var Q,W,X=I(),Z=T(),K=M(e.id),ee=K.hasMultiParents,te=void 0!==ee&&ee,ne=K.stepId,ae=K.step_status,re=void 0===ae?1:ae,ce=J.hasOwnProperty(ne)?J[ne]:{},oe=!Object(c.isEmpty)(V)&&Object(d.nb)()?Object(B.a)(V,parseInt(Y)):{},ie=oe.isLoading,le=oe.error,se=oe.getReadableTexts,ue=oe.rules,me=Object(d.nb)()?(Q=n.sidebarValues,W=[],Object(c.isEmpty)(Q)?[]:(Object.keys(Q).map((function(e){var t=Q[e],n=[];!Object(c.isEmpty)(t)&&Object(c.isArray)(t)&&(t.map((function(e){ue.hasOwnProperty(e.filter)&&n.push(e)})),Object(c.isEmpty)(n)||W.push(n))})),W)):[],be=!Object(d.nb)()||ie||le||Object(c.isEmpty)(V)?[]:se(me),de=Object(d.nb)()?S({onNodeClick:function(){v("sidebarNodeData",e),g(!0)},onNodeStatClick:function(){Object(d.nb)()?(v("showContactModalId",ne),v("showContactModalType","completed")):v("showProModal",!0)}}):{};return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-wrapper","data-stepid":ne},Object(a.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),Object(d.nb)()?Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":"")+(2===parseInt(re)?" bwf-draft-node":""),onClick:de},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon"},Object(a.createElement)(s.a,{size:26,icon:"condition"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},"Step "+u),Object(a.createElement)("div",{className:"bwf-node-content-label"},"Condition")),Object(a.createElement)("div",{className:"bwf-node-action"},Object(a.createElement)(q,{node:e}),Object(a.createElement)(D.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations-crm"),classes:"bwf-event-action",isDisable:!(!X&&!Z),renderContent:function(t){var n=t.onToggle;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(A.a,{isClickable:!0,onInvoke:function(){v("enableCopy",!0),v("copyData",{type:"conditional",data:e.data,id:e.id}),n()}},Object(a.createElement)(x.a,{justify:"flex-start"},Object(a.createElement)(x.c,null,Object(l.__)("Copy","wp-marketing-automations-crm")))),Object(a.createElement)(A.a,{isClickable:!0,onInvoke:function(){v("enableMove",!0),v("moveID",e.id),v("copyData",{type:"conditional",data:e.data,id:e.id}),n()}},Object(a.createElement)(x.a,{justify:"flex-start"},Object(a.createElement)(x.c,null,Object(l.__)("Move","wp-marketing-automations-crm")))),Object(a.createElement)(A.a,{isClickable:!0,onInvoke:function(){var t,a;j({status:!0,onConfirm:(t=regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w(e).then((function(){return j({status:!1})}));case 2:case"end":return t.stop()}}),t)})),a=function(){var e=this,n=arguments;return new Promise((function(a,r){var c=t.apply(e,n);function o(e){U(c,a,r,o,i,"next",e)}function i(e){U(c,a,r,o,i,"throw",e)}o(void 0)}))},function(){return a.apply(this,arguments)})}),n()}},Object(a.createElement)(x.a,{justify:"flex-start"},Object(a.createElement)(x.c,null,Object(l.__)("Delete","wp-marketing-automations-crm")))))}}))),Array.isArray(be)&&be.length?Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-step-content"},Object(a.createElement)("div",{className:"bwf-step-content"},Object(a.createElement)($,{readables:be}))),Object(a.createElement)("div",{className:"bwf-node-status"},Object(a.createElement)("div",{className:"bwf-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations-crm")),Object(a.createElement)("span",{className:"bwf-node-status-count"},G?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(a.createElement)(a.Fragment,null,ce.hasOwnProperty("completed")?Object(d.Ab)(parseInt(ce.completed)):0))))):Object(a.createElement)(a.Fragment,null,ie?Object(a.createElement)("div",{className:"bwf-node-step-content"},Object(a.createElement)("div",{className:"bwf-step-brick"},Object(a.createElement)("div",{className:"bwf-step-content-content"},Object(a.createElement)("div",{className:"bwf-step-brick"},Object(a.createElement)("div",{className:"bwf-step-content-content"},Object(l.__)("Loading","wp-marketing-automations")))))):Object(a.createElement)("div",{className:"bwf-control-event-error"},Object(a.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer"},Object(l.__)("Not Configured","wp-marketing-automations-crm"))))):Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":"")+(2===parseInt(re)?" bwf-draft-node":""),onClick:function(){return v("showProModal",!0)}},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon"},Object(a.createElement)(s.a,{size:26,icon:"condition"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},"Step "+ne),Object(a.createElement)("div",{className:"bwf-node-content-label"},"Condition")),Object(a.createElement)("div",{className:"bwf-node-action"})),Object(a.createElement)("div",{className:"bwf-control-event-error"},Object(a.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer bwf-display-flex"},Object(a.createElement)("span",{className:"bwf-mr-5"},Object(a.createElement)(s.a,{icon:"lock",size:15,color:"#D72D1D"})),Object(l.__)("Pro Feature","wp-marketing-automations-crm")))),te&&Object(a.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},X||Z?Object(a.createElement)("div",{className:"bwf-drag-area",onClick:function(){return h(e,"before","")}},Object(a.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(a.createElement)("div",{className:"bwf-node-add"})),Object(a.createElement)("div",{className:"bwf-paste-label"},"Paste Here")):Object(a.createElement)("div",{className:"bwf-node-add",onClick:function(t){E(e.id,{option:"",position:"before"}),_(!0),N(t.target)}}))),Object(a.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1}),Object(a.createElement)(O.a,{modalTitle:Object(l.__)("Delete Conditional Step"),deleteEntityName:Object(l.__)("conditional step"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations-crm"),onConfirm:p.onConfirm,isLoading:!1,onRequestClose:function(){return j({status:!1})},isOpen:p.status,isDelete:!0}))},G=(n(1101),n(17));function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){W(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function X(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var K=function(e){var t=e.header,n=void 0===t?Object(l.__)("View Analytics","wp-marketing-automations"):t,r=e.icon,o=void 0===r?"analytic":r,u=e.automationId,m=e.analyticsId,b=e.mode,f=void 0===b?"":b,O=e.extraData,j=void 0===O?{}:O,y=X(Object(a.useState)(!0),2),w=y[0],v=y[1],g=X(Object(a.useState)(!1),2),E=g[0],h=g[1],_=X(Object(a.useState)({}),2),N=_[0],k=_[1],C=function(){parseInt(m)>0&&Object(d.nb)()?(v(!0),k({}),function(){try{var e=Q(Q({},j),{},{mode:f});p()({path:Object(d.m)("/automation/".concat(u,"/analytics/").concat(m,"?").concat(Object(G.stringify)(e))),method:"GET"}).then((function(e){200===e.code?Object(c.isEmpty)(e.result)||k(e.result):h(!0),v(!1)}))}catch(e){h(!0),v(!1)}}()):v(!1)},P=function(){var e,t=N.tile,n=void 0===t?[]:t;return E?Object(a.createElement)(a.Fragment,null,Object(l.__)("Error while fetching the Analytics.","wp-marketing-automations")):Object(d.nb)()?Object(a.createElement)("div",{className:"bwf-info-brick"},Object(c.isEmpty)(n)?Object(a.createElement)(a.Fragment,null,Object(l.__)("No analytics found.","wp-marketing-automations")):n.map((function(e,t){return Object(a.createElement)("div",{className:"bwf-info-item",key:t},Object(a.createElement)("span",{className:"bwf-node-content-type"},e.label),Object(a.createElement)("span",{className:"bwf-node-content-label"},e.value))}))):(e=[{label:Object(l.__)("Sent","wp-marketing-automations")},{label:Object(l.__)("Open Rate","wp-marketing-automations")}],"email"===f&&e.push({label:Object(l.__)("Click Rate","wp-marketing-automations")},{label:Object(l.__)("Click to Open Rate","wp-marketing-automations")}),e.push({label:Object(l.__)("Revenue","wp-marketing-automations")},{label:Object(l.__)("Revenue/Contact","wp-marketing-automations")},{label:Object(l.__)("Unsubscribe Rate","wp-marketing-automations")}),Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-info-brick bwf-lite-restrict-section"},e.map((function(e,t){return Object(a.createElement)("div",{className:"bwf-info-item",key:t},Object(a.createElement)("span",{className:"bwf-node-content-type"},e.label),Object(a.createElement)("div",{className:"bwf-placeholder-temp no-animation bwf-w-60 bwf-h-15"}))}))),Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-single-automation-notice is-info no-icon"},Object(a.createElement)("b",null,Object(l.__)("Email Analytics is a PRO feature.","wp-marketing-automations"))," ",Object(a.createElement)("a",{target:"__blank",className:"bwf-a-no-underline",href:Object(d.L)("upgrade",{utm_medium:"Get+PRO+Email+Analytics"})},Object(l.__)("Upgrade to PRO Now","wp-marketing-automations")))))};return Object(a.createElement)("div",{className:"bwf-info-popup"},Object(a.createElement)(F.a,{contentClassName:"bwf-info__popover",position:"top center",renderToggle:function(e){var t=e.onToggle,r=e.isOpen,c=i()("bwf-info__toggle bwf-cursor-pointer",{"is-opened":r});return Object(a.createElement)("div",{className:c,onClick:function(){t(),C()},"aria-expanded":r},Object(a.createElement)(s.a,{size:14,icon:o}),n)},renderContent:function(e){var t=e.onToggle;return Object(a.createElement)("div",{className:"bwf-info-popover-container"},Object(a.createElement)("div",{className:"bwf-info-popover-header"},Object(a.createElement)("div",{className:"bwf-info-header-text"},n),Object(a.createElement)("span",{className:"bwf-info-close",onClick:t},Object(a.createElement)(s.a,{icon:"close",size:20}))),Object(a.createElement)("div",{className:"bwf-info-popover-body"},Object(a.createElement)("div",{className:"bwf-info-wrapper"},Object(a.createElement)("div",{className:"bwf-info--content"},w?Object(a.createElement)("div",{className:"bwf-info-brick"},[1,2,3,4,5,6].map((function(e){return Object(a.createElement)("div",{className:"bwf-info-item",key:e},Object(a.createElement)("span",{className:"bwf-node-content-type"},Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-60 bwf-h-15"})),Object(a.createElement)("span",{className:"bwf-node-content-label"},Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-90 bwf-h-15"})))}))):P()))))},focusOnMount:!0}))},ee=n(93);function te(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function ne(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){te(c,a,r,o,i,"next",e)}function i(e){te(c,a,r,o,i,"throw",e)}o(void 0)}))}}function ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return re(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ce=function(e){var t=e.data,n=void 0===t?{}:t,o=e.selected,i=void 0!==o&&o,u=e.id,f=ae(Object(a.useState)(!1),2),p=f[0],j=f[1],y=ae(Object(a.useState)({status:!1,loading:!0}),2),w=y[0],v=y[1],g=Object(m.a)(),E=g.deleteNode,h=g.setAutomationData,N=g.showSidebar,k=g.setNodeForAdd,C=g.copyNodeHere,P=g.setOpenStepModal,I=g.setModalAnchorNode,T=Object(b.a)(),M=T.getActionsList,F=T.getAutomationData,L=T.getNodeDataByID,R=T.getEnableCopy,z=T.getEnableMove,B=T.getLastAddedNode,U=T.getStatLoading,H=T.getStatData,V=B(),$=M(),Y=F(),G=U(),J=H(),Q=Y.ID,W=R(),X=z(),Z=L(e.id),te=Z.hasMultiParents,re=void 0!==te&&te,ce=Z.stepId,oe=Z.step_status,ie=void 0===oe?1:oe,le=J.hasOwnProperty(ce)?J[ce]:{},se=n.sidebarValues,ue=void 0===se?{}:se,me=n.desc_text,be=void 0===me?"":me;Object(a.useEffect)((function(){V==u&&(j(!0),h("lastAddedNode",0))}),[V]);var de,fe,pe,Oe=S({onNodeClick:!!n.selected&&function(){$.list.hasOwnProperty(n.selected)&&(h("sidebarNodeData",e),N(!0))},onNodeStatClick:function(){Object(d.nb)()?(h("showContactModalId",ce),h("showContactModalType","completed")):h("showProModal",!0)},onInfoToggleClick:function(){return h("analyticNodeId",ce)}});return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-wrapper","data-stepid":ce},Object(a.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":"")+(n.hasOwnProperty("selected")&&n.selected&&$.list.hasOwnProperty(n.selected)&&2===parseInt(ie)&&$.list[n.selected].hasOwnProperty("fields")&&!Object(c.isEmpty)($.list[n.selected].fields)?" bwf-draft-node":""),onClick:Oe},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon icon-action"},Object(a.createElement)(s.a,{size:22,icon:"charge"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},"Step "+u),Object(a.createElement)("div",{className:"bwf-node-content-label"},"Action")),Object(a.createElement)("div",{className:"bwf-node-action"},n.hasOwnProperty("selected")&&!Object(c.isEmpty)(n.selected)&&Object(a.createElement)(q,{node:e}),Object(a.createElement)(D.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations-crm"),classes:"bwf-event-action",isDisable:!(!W&&!X),renderContent:function(t){var r=t.onToggle;return Object(a.createElement)(a.Fragment,null,n.hasOwnProperty("selected")&&!Object(c.isEmpty)(n.selected)&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)(A.a,{isClickable:!0,onInvoke:function(){h("enableCopy",!0),h("copyData",{type:"action",data:e.data}),r()}},Object(a.createElement)(x.a,{justify:"flex-start"},Object(a.createElement)(x.c,null,Object(l.__)("Copy","wp-marketing-automations-crm")))),Object(a.createElement)(A.a,{isClickable:!0,onInvoke:ne(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:h("enableMove",!0),h("moveID",e.id),h("copyData",{type:"action",data:e.data}),r();case 4:case"end":return t.stop()}}),t)})))},Object(a.createElement)(x.a,{justify:"flex-start"},Object(a.createElement)(x.c,null,Object(l.__)("Move","wp-marketing-automations-crm"))))),Object(a.createElement)(A.a,{isClickable:!0,onInvoke:function(){var t;v({status:!0,onConfirm:(t=ne(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E(e).then((function(){return v({status:!1})}));case 2:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})}),r()}},Object(a.createElement)(x.a,{justify:"flex-start"},Object(a.createElement)(x.c,null,Object(l.__)("Delete","wp-marketing-automations-crm")))))}}))),n.hasOwnProperty("selected")&&!Object(c.isEmpty)(n.selected)?Object(a.createElement)("div",{className:"bwf-node-step-content"},Object(a.createElement)("div",{className:"bwf-step-content"},Object(a.createElement)("div",{className:"bwf-step-brick"},Object(a.createElement)("div",{className:"bwf-step-content-content"},!Object(c.isEmpty)(n)&&n.hasOwnProperty("selected")&&(pe=Object(a.createElement)(a.Fragment,null),"wp_sendemail"===n.selected?(de=ue.bwfan_email_data,fe=void 0===de?{}:de,pe=Object(a.createElement)(a.Fragment,null,!Object(c.isEmpty)(fe)&&fe.hasOwnProperty("subject")&&""!==fe.subject&&Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf-mt-3 bwf-cursor-pointer bwf-info__toggle "},Object(a.createElement)(K,{automationId:Q,analyticsId:ce,mode:"email"})))):"twilio_send_sms"!==n.selected&&"bulkgate_send_transactional_sms"!==n.selected&&"linkmobility_send_sms"!==n.selected||(pe=Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf-mt-3 bwf-cursor-pointer bwf-info__toggle"},Object(a.createElement)(K,{automationId:Q,analyticsId:ce,mode:"sms"}))),Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-content-type"},$.list.hasOwnProperty(n.selected)&&$.list[n.selected].hasOwnProperty("integration_nicename")?$.list[n.selected].integration_nicename:""),Object(a.createElement)("div",{className:"bwf-node-content-label"},$.list.hasOwnProperty(n.selected)?$.list[n.selected].action_name:"Action Not Found"),!Object(c.isEmpty)(be)&&Object(a.createElement)("div",{className:"bwf-node-content-label bwf-node-desc"+(Object(c.isArray)(be)?"":" bwf-two-line-ellipse-text")},function(e){if(Object(c.isEmpty)(e))return Object(a.createElement)(a.Fragment,null);if(Object(c.isArray)(e)){var t="",n=[];return e.map((function(e){Object(c.isEmpty)(t)&&(t=e),n.push(Object(a.createElement)("span",{key:e},e))})),Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-table-v-center"},Object(a.createElement)("span",null,!Object(c.isEmpty)(t)&&t),!Object(c.isEmpty)(n)&&n.length>1&&Object(a.createElement)("div",{className:"bwf-display-inline",onClick:function(e){e.preventDefault(),e.stopPropagation()}},Object(a.createElement)(ee.a,{items:n}))))}return e}(be)),pe,$.list.hasOwnProperty(n.selected)&&$.list[n.selected].hasOwnProperty("analytics_mode")&&""!==$.list[n.selected].analytics_mode?Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf-mt-3 bwf-cursor-pointer bwf-info__toggle"},Object(a.createElement)(K,{automationId:Q,analyticsId:ce,mode:$.list[n.selected].analytics_mode})):null)))))):Object(a.createElement)("div",{className:"bwf-control-event-error"},Object(a.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer",onClick:function(){return j(!0)}},Object(l.__)("Not Configured","wp-marketing-automations-crm"))),n.hasOwnProperty("selected")&&!Object(c.isEmpty)(n.selected)&&Object(a.createElement)("div",{className:"bwf-node-status"},Object(a.createElement)("div",{className:"bwf-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations-crm")),Object(a.createElement)("span",{className:"bwf-node-status-count"},G?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(a.createElement)(a.Fragment,null,le.hasOwnProperty("completed")?Object(d.Ab)(parseInt(le.completed)):0))))),re&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},W||X?Object(a.createElement)("div",{className:"bwf-drag-area",onClick:function(){return C(e,"before","")}},Object(a.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(a.createElement)("div",{className:"bwf-node-add"})),Object(a.createElement)("div",{className:"bwf-paste-label"},"Paste Here")):Object(a.createElement)("div",{className:"bwf-node-add",onClick:function(t){k(e.id,{option:"",position:"before"}),P(!0),I(t.target)}})))),Object(a.createElement)(r.d,{type:"source",isConnectable:!1,position:"bottom"}),Object(a.createElement)(_,{isOpen:p,onRequestClose:function(){return j(!1)},node:e,isEvent:!1,automationID:Q}),Object(a.createElement)(O.a,{modalTitle:Object(l.__)("Delete Action Step"),deleteEntityName:Object(l.__)("action step"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations-crm"),onConfirm:w.onConfirm,isLoading:!1,onRequestClose:function(){return v({status:!1})},isOpen:w.status,isDelete:!0}))},oe=function(e){var t=Object(b.a)(),n=t.getEnableCopy,c=t.getEnableMove,o=t.getNodeDataByID,i=n(),l=c(),s=Object(m.a)(),u=s.copyNodeHere,d=s.setNodeForAdd,f=s.setOpenStepModal,p=s.setModalAnchorNode,O=o(e.id).hasMultiParents,j=void 0!==O&&O;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-wrapper"},j?Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},i||l?Object(a.createElement)("div",{className:"bwf-drag-area",onClick:function(){return u(e,"before","")}},Object(a.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(a.createElement)("div",{className:"bwf-node-add"})),Object(a.createElement)("div",{className:"bwf-paste-label"},"Paste Here")):Object(a.createElement)("div",{className:"bwf-node-add",onClick:function(t){d(e.id,{option:"",position:"before"}),f(!0),p(t.target)}})),Object(a.createElement)(r.d,{type:"source",position:"top",isConnectable:!1})):Object(a.createElement)(r.d,{type:"source",position:"top",isConnectable:!1}),Object(a.createElement)("div",{className:"bwf-node-content bwf-end"},Object(a.createElement)("div",{className:"bwf-node-content-item"},"End Automation"))))};function ie(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function le(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return se(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ue=function(e){var t=e.data,n=void 0===t?{}:t,o=e.selected,i=void 0!==o&&o,u=e.id,f=le(Object(a.useState)(!1),2),p=f[0],j=f[1],y=le(Object(a.useState)({status:!1,loading:!0}),2),w=y[0],v=y[1],g=Object(m.a)(),E=g.deleteNode,h=g.setAutomationData,_=g.showSidebar,N=g.setNodeForAdd,k=g.copyNodeHere,C=g.setOpenStepModal,I=g.setModalAnchorNode,T=Object(b.a)(),M=T.getGoals,F=T.getNodeDataByID,L=T.getEnableCopy,R=T.getEnableMove,z=T.getLastAddedNode,B=T.getAutomationData,U=T.getStatLoading,H=T.getStatData,V=M().list,$=z(),Y=L(),G=R(),J=U(),Q=H();Object(a.useEffect)((function(){$==u&&(j(!0),h("lastAddedNode",0))}),[$]);var W=B(),X=F(e.id),Z=X.hasMultiParents,K=void 0!==Z&&Z,te=X.stepId,ne=X.step_status,ae=void 0===ne?1:ne,re=W.ID,ce=Q.hasOwnProperty(te)?Q[te]:{},oe=n.desc_text,se=void 0===oe?"":oe,ue=S({onNodeClick:!!n&&!!n.benchmark&&function(){h("sidebarNodeData",e),_(!0)},onNodeStatClick:function(){Object(d.nb)()?(h("showContactModalId",te),h("showContactModalType","completed")):h("showProModal",!0)},onNodeQueuedStatClick:function(){Object(d.nb)()?(h("showContactModalId",te),h("showContactModalType","queued")):h("showProModal",!0)}});return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-wrapper","data-stepid":te},Object(a.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),Object(d.nb)()?Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":"")+(2===parseInt(ae)?" bwf-draft-node":""),onClick:ue},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon icon-goal"},Object(a.createElement)(s.a,{size:26,icon:"goal"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},"Step "+u),Object(a.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Goal","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf-node-action"},n.hasOwnProperty("benchmark")&&!Object(c.isEmpty)(n.benchmark)&&Object(a.createElement)(q,{node:e}),Object(a.createElement)(D.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations-crm"),classes:"bwf-event-action",isDisable:!(!Y&&!G),renderContent:function(t){var r=t.onToggle;return Object(a.createElement)(a.Fragment,null,n.hasOwnProperty("benchmark")&&!Object(c.isEmpty)(n.benchmark)&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)(A.a,{isClickable:!0,onInvoke:function(){h("enableCopy",!0),h("copyData",{type:"benchmark",data:e.data}),r()}},Object(a.createElement)(x.a,{justify:"flex-start"},Object(a.createElement)(x.c,null,Object(l.__)("Copy","wp-marketing-automations-crm")))),Object(a.createElement)(A.a,{isClickable:!0,onInvoke:function(){h("enableMove",!0),h("moveID",e.id),h("copyData",{type:"benchmark",data:e.data}),r()}},Object(a.createElement)(x.a,{justify:"flex-start"},Object(a.createElement)(x.c,null,Object(l.__)("Move","wp-marketing-automations-crm"))))),Object(a.createElement)(A.a,{isClickable:!0,onInvoke:function(){var t,n;v({status:!0,onConfirm:(t=regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E(e).then((function(){return v({status:!1})}));case 2:case"end":return t.stop()}}),t)})),n=function(){var e=this,n=arguments;return new Promise((function(a,r){var c=t.apply(e,n);function o(e){ie(c,a,r,o,i,"next",e)}function i(e){ie(c,a,r,o,i,"throw",e)}o(void 0)}))},function(){return n.apply(this,arguments)})}),r()}},Object(a.createElement)(x.a,{justify:"flex-start"},Object(a.createElement)(x.c,null,Object(l.__)("Delete","wp-marketing-automations-crm")))))}}))),!n.hasOwnProperty("benchmark")||Object(c.isEmpty)(n.benchmark)?Object(a.createElement)("div",{className:"bwf-control-event-error"},Object(a.createElement)("div",{className:"bwf-control-error-msg",onClick:function(){return j(!0)}},"Not Configured")):Object(a.createElement)("div",{className:"bwf-node-step-content"},Object(a.createElement)("div",{className:"bwf-step-content"},Object(a.createElement)("div",{className:"bwf-step-brick"},Object(a.createElement)("div",{className:"bwf-step-content-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},V.hasOwnProperty(n.benchmark)&&V[n.benchmark].hasOwnProperty("source_label")?V[n.benchmark].source_label:""),Object(a.createElement)("div",{className:"bwf-node-content-label"},V.hasOwnProperty(n.benchmark)?V[n.benchmark].event_name:"Goal Not Found"),!Object(c.isEmpty)(se)&&Object(a.createElement)("div",{className:"bwf-node-content-label bwf-node-desc"+(Object(c.isArray)(se)?"":" bwf-two-line-ellipse-text")},function(e){if(Object(c.isEmpty)(e))return Object(a.createElement)(a.Fragment,null);if(Object(c.isArray)(e)){var t="",n=[];return e.map((function(e){Object(c.isEmpty)(t)&&(t=e),n.push(Object(a.createElement)("span",{key:e},e))})),Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-table-v-center"},Object(a.createElement)("span",null,!Object(c.isEmpty)(t)&&t),!Object(c.isEmpty)(n)&&n.length>1&&Object(a.createElement)("div",{className:"bwf-display-inline",onClick:function(e){e.preventDefault(),e.stopPropagation()}},Object(a.createElement)(ee.a,{items:n}))))}return e}(se)))))),n.hasOwnProperty("benchmark")&&!Object(c.isEmpty)(n.benchmark)&&Object(a.createElement)("div",{className:"bwf-node-status"},Object(a.createElement)("div",{className:"bwf-queued-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Queued","wp-marketing-automations-crm")),Object(a.createElement)("span",{className:"bwf-node-status-count"},J?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(a.createElement)(a.Fragment,null,ce.hasOwnProperty("queued")?Object(d.Ab)(parseInt(ce.queued)):0))),Object(a.createElement)("div",{className:"bwf-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations-crm")),Object(a.createElement)("span",{className:"bwf-node-status-count"},J?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(a.createElement)(a.Fragment,null,ce.hasOwnProperty("completed")?Object(d.Ab)(parseInt(ce.completed)):0))))):Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":"")+(2===parseInt(ae)?" bwf-draft-node":""),onClick:function(){return h("showProModal",!0)}},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon icon-goal"},Object(a.createElement)(s.a,{size:26,icon:"goal"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},"Step "+u),Object(a.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Goal","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf-node-action"})),Object(a.createElement)("div",{className:"bwf-control-event-error"},Object(a.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer bwf-display-flex"},Object(a.createElement)("span",{className:"bwf-mr-5"},Object(a.createElement)(s.a,{icon:"lock",size:15,color:"#D72D1D"})),Object(l.__)("Pro Feature","wp-marketing-automations-crm")))),K&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},Y||G?Object(a.createElement)("div",{className:"bwf-drag-area",onClick:function(){return k(e,"before","")}},Object(a.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(a.createElement)("div",{className:"bwf-node-add"})),Object(a.createElement)("div",{className:"bwf-paste-label"},"Paste Here")):Object(a.createElement)("div",{className:"bwf-node-add",onClick:function(t){N(e.id,{option:"",position:"before"}),C(!0),I(t.target)}})))),Object(a.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1}),Object(a.createElement)(P,{isOpen:p,onRequestClose:function(){return j(!1)},node:e,automationID:re}),Object(a.createElement)(O.a,{modalTitle:Object(l.__)("Delete Goal Step"),deleteEntityName:Object(l.__)("goal step"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations-crm"),onConfirm:w.onConfirm,isLoading:!1,onRequestClose:function(){return v({status:!1})},isOpen:w.status,isDelete:!0,deleteDescriptionText:"Once you delete this step, all the queued contacts will move to next step right away."}))},me=n(77),be=n(9),de=n.n(be);function fe(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function pe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Oe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Oe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var je={1:Object(l.__)("Delay for a specific period","wp-marketing-automations-crm"),2:Object(l.__)("Delay until a specific date and time","wp-marketing-automations-crm"),3:Object(l.__)("Delay until a custom field date","wp-marketing-automations-crm"),4:Object(l.__)("Delay with variable","wp-marketing-automations-crm")},ye={1:"Sun",2:"Mon",3:"Tue",4:"Wed",5:"Thu",6:"Fri",7:"Sat"},we=function(e){var t=e.data,n=e.selected,o=void 0!==n&&n,i=e.id,u=pe(Object(a.useState)({status:!1,loading:!0}),2),f=u[0],p=u[1],j=Object(m.a)(),y=j.deleteNode,w=j.setAutomationData,v=j.showSidebar,g=j.setNodeForAdd,E=j.copyNodeHere,h=j.setOpenStepModal,_=j.setModalAnchorNode,N=Object(b.a)(),k=N.getNodeDataByID,C=N.getEnableCopy,P=N.getEnableMove,I=N.getLastAddedNode,T=N.getStatLoading,M=N.getStatData,F=I(),L=!Object(c.isEmpty)(t)&&t.hasOwnProperty("sidebarValues")?t.sidebarValues:{},R=L.type,z=void 0===R?0:R,B=L.data,U=void 0===B?{}:B,H=T(),V=M();Object(a.useEffect)((function(){F==i&&(w("sidebarNodeData",e),v(!0),w("lastAddedNode",0))}),[F]);var $=function(){switch(parseInt(z)){case 1:var e=U.day_delay,t=void 0===e?{}:e,n=U.enable_time_delay,r=void 0!==n&&n,o=U.enable_week_delay,i=void 0!==o&&o,l=U.time_delay,s=void 0===l?{time:""}:l,u=U.week_delay,m=void 0===u?[]:u;if(!Object(c.isEmpty)(t)){var b=t.text+" "+function(e,t){switch(e){case"min":return parseInt(t)>1?"Minutes":"Minute";case"hours":return parseInt(t)>1?"Hours":"Hour";case"days":return parseInt(t)>1?"Days":"Day";case"weeks":return parseInt(t)>1?"Weeks":"Week";case"months":return parseInt(t)>1?"Months":"Month";default:return""}}(t.unit,t.text),d=[];return i&&!Object(c.isEmpty)(m)&&m.map((function(e){ye.hasOwnProperty(e)&&d.push(ye[e])})),r&&s.hasOwnProperty("time")&&!Object(c.isEmpty)(s.time)?(b+=" till "+Object(me.format)(bwfcrm_contacts_data.time_format,de()(s.time,"HH:mm:ss")),Object(c.isEmpty)(d)||(b+=" "+d.join("/")),s.hasOwnProperty("in_contact_timezone")&&s.in_contact_timezone&&(b+=" in Contact's Timezone")):Object(c.isEmpty)(d)||(b+=" "+d.join("/")),b+"."}break;case 2:var f=U.date,p=void 0===f?"":f,O=U.time_delay,j=void 0===O?{time:"",in_contact_timezone:!1}:O,y=U.enable_step_skip,w=void 0!==y&&y,v=U.skip_to_step,g=void 0===v?{step:"",name:""}:v;if(!Object(c.isEmpty)(p)&&!Object(c.isEmpty)(j.time)){var E="",h="";return j.hasOwnProperty("in_contact_timezone")&&j.in_contact_timezone?E+=" in Contact's Timezone.":E+=".",w&&!Object(c.isEmpty)(g)&&g.hasOwnProperty("step")&&""!=g.step&&g.hasOwnProperty("name")&&""!=g.name&&(h=" Jump to ".concat(g.name,".")),"Delay till "+Object(me.format)(bwfcrm_contacts_data.date_format,de()(p))+" at "+Object(me.format)(bwfcrm_contacts_data.time_format,de()(j.time,"HH:mm:ss"))+" "+E+h}break;case 3:var _=U.custom_field,N=U.enable_time_delay,k=void 0!==N&&N,C=U.time_delay,P=U.enable_step_skip,S=void 0!==P&&P,A=U.skip_to_step;if(_.hasOwnProperty("field")&&""!==_.field){var x="Delay";return k?C.hasOwnProperty("duration")&&(x+=" of ".concat(C.duration," ").concat(C.type," ").concat(C.timing," ")):x+=" till",_.hasOwnProperty("custom_field_label")&&""!==_.custom_field_label?x+=" Contacts '".concat(_.custom_field_label,"' field value"):x+=" Contacts ( ".concat(_.field," ) field value"),_.hasOwnProperty("time")&&""!==_.time&&(x+=" till ".concat(Object(me.format)(bwfcrm_contacts_data.time_format,de()(_.time,"HH:mm:ss")))),_.hasOwnProperty("in_contact_timezone")&&_.in_contact_timezone?x+=" in Contact's Timezone.":x+=".",S&&!Object(c.isEmpty)(A)&&A.hasOwnProperty("step")&&""!=A.step&&A.hasOwnProperty("name")&&""!=A.name&&(x+=" Jump to ".concat(A.name,".")),x}break;case 4:var D=U.variable_field,I=U.enable_time_delay,T=void 0!==I&&I,M=U.time_delay,F=U.enable_step_skip,L=void 0!==F&&F,R=U.skip_to_step;if(D.hasOwnProperty("variable")&&""!==D.variable){var q="Delay";return T?M.hasOwnProperty("duration")&&(q+=" of ".concat(M.duration," ").concat(M.type," ").concat(M.timing," ")):q+=" till",D.hasOwnProperty("variable")&&""!==D.variable&&(q+=" Orders meta key ".concat(D.variable," value")),D.hasOwnProperty("time")&&""!==D.time&&(q+=" till ".concat(Object(me.format)(bwfcrm_contacts_data.time_format,de()(D.time,"HH:mm:ss")))),D.hasOwnProperty("in_contact_timezone")&&D.in_contact_timezone?q+=" in Contact's Timezone.":q+=".",L&&!Object(c.isEmpty)(R)&&R.hasOwnProperty("step")&&""!=R.step&&R.hasOwnProperty("name")&&""!=R.name&&(q+=" Jump to ".concat(R.name,".")),q}break;default:return Object(a.createElement)(a.Fragment,null)}return Object(a.createElement)(a.Fragment,null)},Y=C(),G=P(),J=k(e.id),Q=J.hasMultiParents,W=void 0!==Q&&Q,X=J.stepId,Z=J.step_status,K=void 0===Z?1:Z,ee=V.hasOwnProperty(X)?V[X]:{},te=S({onNodeClick:function(){w("sidebarNodeData",e),v(!0)},onNodeStatClick:function(){Object(d.nb)()?(w("showContactModalId",X),w("showContactModalType","completed")):w("showProModal",!0)},onNodeQueuedStatClick:function(){Object(d.nb)()?(w("showContactModalId",X),w("showContactModalType","queued")):w("showProModal",!0)}});return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-wrapper","data-stepid":X},Object(a.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(o?"bwf-selected-node":"")+(2===parseInt(K)?" bwf-draft-node":""),onClick:te},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon icon-delay"},Object(a.createElement)(s.a,{size:28,icon:"time-left"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},"Step "+i),Object(a.createElement)("div",{className:"bwf-node-content-label"},"Delay")),Object(a.createElement)("div",{className:"bwf-node-action"},Object(a.createElement)(q,{node:e}),Object(a.createElement)(D.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations-crm"),classes:"bwf-event-action",isDisable:!(!Y&&!G),renderContent:function(t){var n=t.onToggle;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(A.a,{isClickable:!0,onInvoke:function(){w("enableCopy",!0),w("copyData",{type:"wait",data:e.data}),n()}},Object(a.createElement)(x.a,{justify:"flex-start"},Object(a.createElement)(x.c,null,Object(l.__)("Copy","wp-marketing-automations-crm")))),Object(a.createElement)(A.a,{isClickable:!0,onInvoke:function(){w("enableMove",!0),w("moveID",e.id),w("copyData",{type:"wait",data:e.data}),n()}},Object(a.createElement)(x.a,{justify:"flex-start"},Object(a.createElement)(x.c,null,Object(l.__)("Move","wp-marketing-automations-crm")))),Object(a.createElement)(A.a,{isClickable:!0,onInvoke:function(){var t,a;p({status:!0,onConfirm:(t=regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y(e).then((function(){return p({status:!1})}));case 2:case"end":return t.stop()}}),t)})),a=function(){var e=this,n=arguments;return new Promise((function(a,r){var c=t.apply(e,n);function o(e){fe(c,a,r,o,i,"next",e)}function i(e){fe(c,a,r,o,i,"throw",e)}o(void 0)}))},function(){return a.apply(this,arguments)})}),n()}},Object(a.createElement)(x.a,{justify:"flex-start"},Object(a.createElement)(x.c,null,Object(l.__)("Delete","wp-marketing-automations-crm")))))}}))),Object(c.isEmpty)(t)||!parseInt(z)>0?Object(a.createElement)("div",{className:"bwf-control-event-error"},Object(a.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer"},"Not Configured")):Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-step-content"},Object(a.createElement)("div",{className:"bwf-step-content"},Object(a.createElement)("div",{className:"bwf-step-brick"},Object(a.createElement)("div",{className:"bwf-step-content-content"},je.hasOwnProperty(z)&&Object(a.createElement)("div",{className:"bwf-node-content-type"},je[z]),Object(a.createElement)("div",{className:"bwf-node-content-label bwf-two-line-ellipse-text",title:$()},$()))))),Object(a.createElement)("div",{className:"bwf-node-status"},Object(a.createElement)("div",{className:"bwf-queued-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Queued","wp-marketing-automations-crm")),Object(a.createElement)("span",{className:"bwf-node-status-count"},H?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(a.createElement)(a.Fragment,null,ee.hasOwnProperty("queued")?Object(d.Ab)(parseInt(ee.queued)):0))),Object(a.createElement)("div",{className:"bwf-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations-crm")),Object(a.createElement)("span",{className:"bwf-node-status-count"},H?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(a.createElement)(a.Fragment,null,ee.hasOwnProperty("completed")?Object(d.Ab)(parseInt(ee.completed)):0)))))),W&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},Y||G?Object(a.createElement)("div",{className:"bwf-drag-area",onClick:function(){return E(e,"before","")}},Object(a.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(a.createElement)("div",{className:"bwf-node-add"})),Object(a.createElement)("div",{className:"bwf-paste-label"},"Paste Here")):Object(a.createElement)("div",{className:"bwf-node-add",onClick:function(t){g(e.id,{option:"",position:"before"}),h(!0),_(t.target)}})))),Object(a.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1}),Object(a.createElement)(O.a,{modalTitle:Object(l.__)("Delete Delay Step"),deleteEntityName:Object(l.__)("delay step"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations-crm"),onConfirm:f.onConfirm,isLoading:!1,onRequestClose:function(){return p({status:!1})},isOpen:f.status,isDelete:!0,deleteDescriptionText:"Once you delete this step, all the queued contacts will move to next step right away."}))},ve=function(e){return Object(a.createElement)("div",{className:e&&e.data&&e.data.direction&&"no"===e.data.direction?"bwf-yes-no-node  bwf-no-node":"bwf-yes-no-node bwf-yes-node"},Object(a.createElement)(r.d,{type:"target",position:"top",style:{opacity:0},isConnectable:!1}),Object(a.createElement)("span",{className:"bwf-yes-no-wrap"},e&&e.data&&e.data.direction&&"no"===e.data.direction?"No":"Yes"),Object(a.createElement)(r.d,{type:"source",position:"bottom",style:{opacity:0},isConnectable:!1}))};function ge(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function Ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return he(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return he(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var _e=function(e){e.data;var t=e.selected,n=void 0!==t&&t,c=e.id,o=Ee(Object(a.useState)({status:!1,loading:!0}),2),i=o[0],u=o[1],f=Object(m.a)(),p=f.deleteNode,j=f.setAutomationData,y=f.setNodeForAdd,w=f.copyNodeHere,v=f.setOpenStepModal,g=f.setModalAnchorNode,E=Object(b.a)(),h=E.getNodeDataByID,_=E.getEnableCopy,N=E.getEnableMove,k=E.getLastAddedNode,C=E.getStatLoading,P=E.getStatData,I=k(),T=_(),M=N(),F=C(),L=P();Object(a.useEffect)((function(){I==c&&j("lastAddedNode",0)}),[I]);var R=h(e.id),z=R.hasMultiParents,q=void 0!==z&&z,B=R.stepId,U=L.hasOwnProperty(B)?L[B]:{},H=S({onNodeStatClick:function(){j("showContactModalId",B),j("showContactModalType","completed")}});return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-wrapper","data-stepid":B},Object(a.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),Object(d.nb)()?Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(n?"bwf-selected-node":""),onClick:H},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon icon-exit"},Object(a.createElement)(s.a,{size:26,icon:"exit"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},"Step "+c),Object(a.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Exit Automation","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf-node-action"},Object(a.createElement)(D.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations-crm"),classes:"bwf-event-action",isDisable:!(!T&&!M),renderContent:function(t){var n=t.onToggle;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(A.a,{isClickable:!0,onInvoke:function(){var t,a;u({status:!0,onConfirm:(t=regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p(e).then((function(){return u({status:!1})}));case 2:case"end":return t.stop()}}),t)})),a=function(){var e=this,n=arguments;return new Promise((function(a,r){var c=t.apply(e,n);function o(e){ge(c,a,r,o,i,"next",e)}function i(e){ge(c,a,r,o,i,"throw",e)}o(void 0)}))},function(){return a.apply(this,arguments)})}),n()}},Object(a.createElement)(x.a,{justify:"flex-start"},Object(a.createElement)(x.c,null,Object(l.__)("Delete","wp-marketing-automations-crm")))))}}))),Object(a.createElement)("div",{className:"bwf-node-status"},Object(a.createElement)("div",{className:"bwf-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations-crm")),Object(a.createElement)("span",{className:"bwf-node-status-count"},F?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(a.createElement)(a.Fragment,null,U.hasOwnProperty("completed")?Object(d.Ab)(parseInt(U.completed)):0))))):Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(n?"bwf-selected-node":""),onClick:function(){return j("showProModal",!0)}},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon icon-exit"},Object(a.createElement)(s.a,{size:26,icon:"exit"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},"Step "+c),Object(a.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Exit Automation","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf-node-action"})),Object(a.createElement)("div",{className:"bwf-control-event-error"},Object(a.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer bwf-display-flex"},Object(a.createElement)("span",{className:"bwf-mr-5"},Object(a.createElement)(s.a,{icon:"lock",size:15,color:"#D72D1D"})),Object(l.__)("Pro Feature","wp-marketing-automations-crm")))),q&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},T||M?Object(a.createElement)("div",{className:"bwf-drag-area",onClick:function(){return w(e,"before","")}},Object(a.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(a.createElement)("div",{className:"bwf-node-add"}))):Object(a.createElement)("div",{className:"bwf-node-add",onClick:function(t){y(e.id,{option:"",position:"before"}),v(!0),g(t.target)}})))),Object(a.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1,style:{opacity:0}}),Object(a.createElement)(O.a,{modalTitle:Object(l.__)("Delete Exit Step"),deleteEntityName:Object(l.__)("exit step"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations-crm"),onConfirm:i.onConfirm,isLoading:!1,onRequestClose:function(){return u({status:!1})},isOpen:i.status,isDelete:!0}))};function Ne(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function ke(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){Ne(c,a,r,o,i,"next",e)}function i(e){Ne(c,a,r,o,i,"throw",e)}o(void 0)}))}}function Ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Se=function(e){var t=e.data,n=void 0===t?{}:t,o=e.selected,i=void 0!==o&&o,u=e.id,f=Ce(Object(a.useState)({status:!1,loading:!0}),2),p=f[0],j=f[1],y=Object(m.a)(),w=y.deleteNode,v=y.setAutomationData,g=y.setNodeForAdd,E=y.copyNodeHere,h=y.setOpenStepModal,_=y.setModalAnchorNode,N=y.showSidebar,k=Object(b.a)(),C=k.getNodeDataByID,P=k.getEnableCopy,I=k.getEnableMove,T=k.getLastAddedNode,M=k.getStatLoading,F=k.getStatData,L=T(),R=P(),z=I(),q=M(),B=F();Object(a.useEffect)((function(){L==u&&v("lastAddedNode",0)}),[L]);var U=(!Object(c.isEmpty)(n)&&n.hasOwnProperty("sidebarValues")?n.sidebarValues:{}).jump_to,H=void 0===U?{}:U,V=H.name,$=void 0===V?"":V,Y=H.step,G=void 0===Y?"":Y,J=C(e.id),Q=J.hasMultiParents,W=void 0!==Q&&Q,X=J.stepId,Z=B.hasOwnProperty(X)?B[X]:{},K=S({onNodeClick:function(){v("sidebarNodeData",e),N(!0)},onNodeStatClick:function(){Object(d.nb)()?(v("showContactModalId",X),v("showContactModalType","completed")):v("showProModal",!0)}});return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-wrapper","data-stepid":X},Object(a.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),Object(d.nb)()?Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":""),onClick:K},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon icon-exit"},Object(a.createElement)(s.a,{size:26,icon:"jump"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},"Step "+u),Object(a.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Jump","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf-node-action"},Object(a.createElement)(D.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations-crm"),classes:"bwf-event-action",isDisable:!(!R&&!z),renderContent:function(t){var n=t.onToggle;return Object(a.createElement)(a.Fragment,null,""!=G&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)(A.a,{isClickable:!0,onInvoke:function(){v("enableCopy",!0),v("copyData",{type:"jump",data:e.data}),n()}},Object(a.createElement)(x.a,{justify:"flex-start"},Object(a.createElement)(x.c,null,Object(l.__)("Copy","wp-marketing-automations-crm")))),Object(a.createElement)(A.a,{isClickable:!0,onInvoke:ke(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:v("enableMove",!0),v("moveID",e.id),v("copyData",{type:"jump",data:e.data}),n();case 4:case"end":return t.stop()}}),t)})))},Object(a.createElement)(x.a,{justify:"flex-start"},Object(a.createElement)(x.c,null,Object(l.__)("Move","wp-marketing-automations-crm"))))),Object(a.createElement)(A.a,{isClickable:!0,onInvoke:function(){var t;j({status:!0,onConfirm:(t=ke(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w(e).then((function(){return j({status:!1})}));case 2:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})}),n()}},Object(a.createElement)(x.a,{justify:"flex-start"},Object(a.createElement)(x.c,null,Object(l.__)("Delete","wp-marketing-automations-crm")))))}}))),Object(c.isEmpty)(n)||Object(c.isEmpty)(H)||""==G?Object(a.createElement)("div",{className:"bwf-control-event-error no-padding"},Object(a.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer"},"Not Configured")):Object(a.createElement)("div",{className:"bwf-node-step-content"},Object(a.createElement)("div",{className:"bwf-step-content"},Object(a.createElement)("div",{className:"bwf-step-brick"},Object(a.createElement)("div",{className:"bwf-step-content-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},"Jump to"),Object(a.createElement)("div",{className:"bwf-node-content-label bwf-two-line-ellipse-text"},""!==$?$:"step #"+G))))),Object(a.createElement)("div",{className:"bwf-node-status"},Object(a.createElement)("div",{className:"bwf-status-wrap"},Object(a.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations-crm")),Object(a.createElement)("span",{className:"bwf-node-status-count"},q?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(a.createElement)(a.Fragment,null,Z.hasOwnProperty("completed")?Object(d.Ab)(parseInt(Z.completed)):0))))):Object(a.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":""),onClick:function(){return v("showProModal",!0)}},Object(a.createElement)("div",{className:"bwf-node-brick"},Object(a.createElement)("div",{className:"bwf-node-icon icon-exit"},Object(a.createElement)(s.a,{size:26,icon:"jump"})),Object(a.createElement)("div",{className:"bwf-node-inner-content"},Object(a.createElement)("div",{className:"bwf-node-content-type"},"Step "+u),Object(a.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Jump","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf-node-action"})),Object(a.createElement)("div",{className:"bwf-control-event-error"},Object(a.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer bwf-display-flex"},Object(a.createElement)("span",{className:"bwf-mr-5"},Object(a.createElement)(s.a,{icon:"lock",size:15,color:"#D72D1D"})),Object(l.__)("Pro Feature","wp-marketing-automations-crm")))),W&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},R||z?Object(a.createElement)("div",{className:"bwf-drag-area",onClick:function(){return E(e,"before","")}},Object(a.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(a.createElement)("div",{className:"bwf-node-add"}))):Object(a.createElement)("div",{className:"bwf-node-add",onClick:function(t){g(e.id,{option:"",position:"before"}),h(!0),_(t.target)}})))),Object(a.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1,style:{opacity:0}}),Object(a.createElement)(O.a,{modalTitle:Object(l.__)("Delete Jump Step"),deleteEntityName:Object(l.__)("jump step"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations-crm"),onConfirm:p.onConfirm,isLoading:!1,onRequestClose:function(){return j({status:!1})},isOpen:p.status,isDelete:!0}))},Ae=(n(1102),n(71)),xe=n(95),De=n(282),Ie=n(28);n(1103);function Te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(n),!0).forEach((function(t){Fe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Le(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Re(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ze=function(e){var t=Object(a.useRef)(null),n=e.mergetag,r=e.copyTagToClipBoard,o=e.automationId,l=Le(Object(a.useState)({}),2),s=l[0],m=l[1],b=Le(Object(a.useState)({}),2),d=b[0],f=b[1],p=Le(Object(a.useState)({}),2),O=p[0],j=p[1],y=n.schema,w=void 0===y?[]:y,v=n.tag_name,g=void 0===v?"":v,E=n.default_val,h=void 0===E?[]:E;Object(a.useEffect)((function(){var e={},t={};w.map((function(n){e[n.id]=n.type,t[n.id]=n})),f(e),j(t)}),[w]);var _,N=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!1,a=t.fields,r=t.relation,c=void 0===r?"OR":r;c=c.toUpperCase();try{var o=null;if("OR"===c){if(a&&Array.isArray(a))for(var i=0;i<a.length;i++){o=e[a[i].id];var l=void 0===a[i].value||a[i].value;if(""!=l&&o==l||""==l&&""!=o&&null!=o)return!0}}else"AND"==c&&a&&Array.isArray(a)&&(n=a.every((function(t){o=e[t.id];var n=void 0===t.value||t.value;return(""===n||o==n)&&(""!=n||""!=o&&null!=o)})))}catch(e){console.log(e)}return n},k=function(){var e=["{{"+g];if(!Object(c.isEmpty)(s))if("cart_recovery_link"===g){var t=s.coupon_type,n=void 0===t?"":t,a=s.dynamic_coupon,r=void 0===a?"":a,o=s.static_coupon,i=void 0===o?"":o;"static"===n&&""!==i?e.push("coupon='"+i+"'"):"dynamic"===n&&""!==r&&e.push("coupon='"+r+"'")}else Object.entries(s).map((function(t){var n=Le(t,2),a=n[0],r=n[1];if(!O[a].hasOwnProperty("toggler")||Object(c.isEmpty)(O[a].toggler)||N(s,O[a].toggler,O[a]))if("search"!=d[a]||Object(c.isEmpty)(r))""!==r&&e.push(a+"='"+r+"'");else{var o=[];r.map((function(e){o.push(e.id)})),e.push(a+"='"+o.join(",")+"'")}}));return e.join(" ")+"}}"},C=function(){var e=k();return w.map((function(t){!t.hasOwnProperty("required")||!t.required||s.hasOwnProperty(t.id)&&""!==s[t.id]||(e="")})),""!==e};return Object(a.createElement)("div",{className:"bwf-merge-tag-wrap bwf_w_full"},Object(a.createElement)(Ae.a,{onChange:function(e){!function(e){var t=Me(Me({},h),s);t[e.name]=e.value,m(t)}(e)},initialValues:Me(Me({},h),s),validate:function(){return!1}},(function(e){var n=e.getInputProps,r=e.values;e.errors,e.handleSubmit;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"wr_content",ref:t},Object(a.createElement)("fieldset",null,w.map((function(e,t){return Object(a.createElement)(a.Fragment,{key:t},(Object(c.isEmpty)(e.toggler)||N(r,e.toggler,e))&&e.wrap_before&&Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_before}}),e.type?Object(a.createElement)(a.Fragment,null,!1!==e.show&&(Object(c.isEmpty)(e.toggler)||N(r,e.toggler,e))&&Object(a.createElement)(xe.a,{input:e,formProps:n(e.id),values:r,automationId:o})):e.hint?Object(a.createElement)(a.Fragment,{dangerouslySetInnerHTML:{__html:e.hint},className:i()(e.class)}):null,(Object(c.isEmpty)(e.toggler)||N(r,e.toggler,e))&&e.wrap_after&&Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_after}}))})))))})),(_=k(),Object(a.createElement)("div",{className:"bwf-merge-tag-config-view"},Object(a.createElement)("span",{className:"bwf-merge-tag"},_),Object(a.createElement)(u.Button,{isPrimary:!0,onClick:function(){r(_)},disabled:!C()},"Copy"))))},qe=n(152);function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){He(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function He(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ve(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return $e(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $e(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Ye=function(e){var t=Object(a.useContext)(d.d),n=Object(a.useContext)(qe.a).setSelectedMergeTag,r=e.isOpen,o=e.onRequestClose,m=e.automationID,f=Ve(Object(a.useState)(""),2),p=f[0],O=f[1],j=Ve(Object(a.useState)(""),2),y=j[0],w=j[1],v=Ve(Object(a.useState)({}),2),g=v[0],E=v[1],h=(0,Object(b.a)().getMergeTagList)();Object(a.useEffect)((function(){r||(E({}),O(""),Object(c.isEmpty)(h)||w(Object.keys(h)[0]))}),[r]);var _=function(){o&&o()},N=function(e){n(e);var a=document.createElement("textarea");a.value=e,document.body.appendChild(a),a.select(),document.execCommand("copy"),document.body.removeChild(a),t(Object(l.__)("Merge tag copied.","wp-marketing-automations")),Object(d.gb)(t,2e3),_()},k=function(){var e,t=(e={},Object.entries(h).map((function(t){var n=Ve(t,2),a=n[0],r=n[1];""!==y?y==a&&(e=r):""!==p?Object.entries(r).map((function(t){var n=Ve(t,2),a=n[0],r=n[1];(a.includes(p)||r.hasOwnProperty("tag_name")&&r.tag_name.includes(p))&&(e[a]=r)})):e=Ue(Ue({},e),r)})),e);return Object(c.isEmpty)(t)?Object(a.createElement)("tr",null,Object(a.createElement)("td",{className:"bwf-no-merge-tag"},Object(l.__)("No Merge Tag Available","wp-marketing-automations"))):Object(a.createElement)(a.Fragment,null,Object.entries(t).map((function(e,t){var n=Ve(e,2),r=(n[0],n[1]);return Object(a.createElement)("tr",{key:"row"+t},Object(a.createElement)("td",null,Object(a.createElement)("span",{className:"bwf-tag-label"},r.tag_description)),Object(a.createElement)("td",null,Object(a.createElement)("span",{className:"bwf-tag-slug"},"{{"+r.tag_name+"}}")),Object(a.createElement)("td",null,r.hasOwnProperty("schema")?Object(a.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){return E(r)},title:"Configure"},Object(a.createElement)(s.a,{color:"#353030",icon:"settings"})):Object(a.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){return N("{{"+r.tag_name+"}}")},title:"Copy"},Object(a.createElement)(s.a,{color:"#353030",icon:"duplicate"}))))})))};return r?Object(a.createElement)(u.Modal,{onRequestClose:_,className:"bwf-admin-modal bwf-event-search-modal bwf-event-search-modal__merge-tag bwf-admin-modal-xl",shouldCloseOnEsc:!0,shouldCloseOnClickOutside:!0},Object(a.createElement)("div",{className:"bwf-modal-search-header"},Object(a.createElement)("div",{className:"bwf-modal-title"},Object(c.isEmpty)(g)?Object(l.__)("Merge Tags"):Object(a.createElement)("div",{className:"bwf-display-flex"},Object(a.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){E({})}},Object(a.createElement)(s.a,{icon:Object(l.isRTL)()?"arrow-right":"arrow-left"})),g.hasOwnProperty("tag_description")?g.tag_description:"")),Object(a.createElement)("div",{className:"bwf-modal-search-wrap"},Object(c.isEmpty)(g)&&Object(a.createElement)("div",{className:"bwf-component-search-control"},Object(a.createElement)(s.a,{icon:"search",size:15}),Object(a.createElement)(u.TextControl,{value:p,onChange:function(e){""===e?Object(c.isEmpty)(h)||w(Object.keys(h)[0]):w(""),O(e)},placeholder:Object(l.__)("Search by name")}))),Object(a.createElement)("div",{className:"bwf-modal-close bwf-cursor-pointer",onClick:_},Object(a.createElement)(s.a,{icon:"close",size:16}))),Object(a.createElement)("div",{className:"bwf-event-modal-main"},Object(a.createElement)("div",{className:"bwf-event-modal-body bwf-merge-modal-content"+(Object(c.isEmpty)(g)&&!Object(c.isEmpty)(h)?"":" gridfull")},Object(c.isEmpty)(g)?Object(c.isEmpty)(h)?Object(a.createElement)("div",{className:"bwf-modal-content-content"},Object(a.createElement)("div",{className:"bwf-modal-content-brick no-padding set-height"},Object(a.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(a.createElement)("div",{className:"bwf-brick-content"},Object(a.createElement)("div",{className:"bwf-merge-tag-list"},Object(a.createElement)("div",{className:"bwf-no-merge-tag"},Object(l.__)("No Merge Tag Available","wp-marketing-automations"))))))):Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-modal-sidebar"},Object(a.createElement)("div",{className:"bwf-modal-filter-wrap"},Object.keys(h).map((function(e){return Object(a.createElement)("div",{key:e,className:i()("bwf-modal-filter",{active:y===e}),onClick:function(){O(""),w(e)}},e)})))),Object(a.createElement)("div",{className:"bwf-modal-content-content"},Object(a.createElement)("div",{className:"bwf-modal-content-brick no-padding set-height"},Object(a.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(a.createElement)("div",{className:"bwf-brick-content"},Object(a.createElement)("div",{className:"bwf-merge-tag-list"},Object(a.createElement)("table",null,Object(a.createElement)("tbody",null,k())))))))):Object(a.createElement)(ze,{mergetag:g,copyTagToClipBoard:N,automationId:m})))):""};function Ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(n),!0).forEach((function(t){Qe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function We(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function Xe(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){We(c,a,r,o,i,"next",e)}function i(e){We(c,a,r,o,i,"throw",e)}o(void 0)}))}}function Ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ke(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ke(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ke(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var et=function(){var e=Object(a.useContext)(d.d),t=Object(b.a)(),n=t.getSidebarNodeData,r=t.getSelectedSidebarData,o=t.getAutomationId,f=t.getNodeDataByID,O=t.getAutomationData,j=Object(m.a)(),y=j.showSidebar,w=j.setNodeDatabyId,v=j.setAutomationData,g=O().event,E=void 0===g?"":g,h=o(),_=Object(a.useRef)(null),N=Ze(Object(a.useState)(!1),2),k=N[0],C=N[1],P=Ze(Object(a.useState)(!1),2),S=P[0],A=P[1],x=Ze(Object(a.useState)(!1),2),D=x[0],I=x[1],T=Ze(Object(a.useState)([]),2),M=T[0],F=T[1],L=Ze(Object(a.useState)(!1),2),R=L[0],z=L[1],q=Ze(Object(a.useState)(!1),2),B=q[0],U=q[1],H=n(),V=Ze(Object(a.useState)(!1),2),$=V[0],Y=V[1],G=!Object(c.isEmpty)(H)&&H.hasOwnProperty("data")?H.data:{},J=Object(c.isEmpty)(H)?{}:r(H),Q=J.side_header,W=void 0===Q?[]:Q,X=!Object(c.isEmpty)(G)&&G.hasOwnProperty("sidebarValues")?G.sidebarValues:{},Z=Object(c.isEmpty)(J)?{}:J,K=Z.fields,ee=void 0===K?[]:K,te=Z.default_values,ne=void 0===te?{}:te,ae=!Object(c.isEmpty)(H)&&H.hasOwnProperty("id")?f(H.id):{},re=ae.stepId,ce=void 0===re?0:re,oe=ae.data;(void 0===oe?{}:oe).sidebarValues;Object(a.useEffect)((function(){F([]),C(!1)}),[]);var ie=function(e,t,n){var a=!1,r=t.fields,c=t.relation,o=void 0===c?"OR":c;o=o.toUpperCase();try{var i=null;if("OR"===o){if(r&&Array.isArray(r))for(var l=0;l<r.length;l++){i=e[r[l].id];var s=void 0===r[l].value||r[l].value;if(Array.isArray(s)&&s.includes(i))return!0;if(""!=s&&i==s||""==s&&""!=i&&null!=i)return!0}}else"AND"==o&&r&&Array.isArray(r)&&(a=r.every((function(t){i=e[t.id];var n=void 0===t.value||t.value;return!(!Array.isArray(n)||!n.includes(i))||(""===n||i==n)&&(""!=n||""!=i&&null!=i)})))}catch(e){console.log(e)}return a},le=[];Object(c.isEmpty)(ee)||ee.forEach((function(e){e.hasOwnProperty("required")&&e.required&&le.push(e)}));var se=function(e){var t={};return le.map((function(n){if(n.hasOwnProperty("toggler")&&!Object(c.isEmpty)(n.toggler)&&!ie(e,n.toggler))return!1;(Array.isArray(e[n.id])&&0===e[n.id].length||""===e[n.id]||void 0===e[n.id])&&(t[n.id]=n.hasOwnProperty("errorMsg")?n.errorMsg:Object(l.__)("This is required field.","wp-marketing-automations")),"custom_fields"===n.id&&e[n.id].map((function(e,a){var r,o;!e.hasOwnProperty("field_value")||""==e.field_value||(r=e.field_value,o=!1,Object(c.isObject)(r)?Object.keys(r).map((function(e){["",void 0,null].includes(r[e])&&(o=!0)})):["",void 0,null].includes(r)&&(o=!0),o)?t["field_value_"+a]=n.hasOwnProperty("errorMsg")?n.errorMsg:Object(l.__)("This is required field.","wp-marketing-automations"):t.hasOwnProperty(n.id)&&delete t[n.id]})),"bwfan_email_data"===n.id&&(!e.hasOwnProperty("bwfan_email_data")||e.bwfan_email_data.hasOwnProperty("subject")&&Object(c.isEmpty)(e.bwfan_email_data.subject)?t[n.id]="error":t={})})),F(t),t},ue=function(){var t=Xe(regeneratorRuntime.mark((function t(n){var a,r,o=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=!(o.length>1&&void 0!==o[1])||o[1],r=[],r=a?se(n):[],!Object(c.isEmpty)(r)){t.next=19;break}return G.sidebarValues=n,z(!0),t.prev=6,t.next=9,p()({path:Object(d.m)("/automation/".concat(h,"/step/").concat(ce)),method:"POST",data:{data:{data:{sidebarData:n}}}}).then((function(t){if(200!==t.code)throw Error(Object(d.j)(null==t?void 0:t.message));var n="";t.hasOwnProperty("result")&&t.result.hasOwnProperty("desc_text")&&!Object(c.isEmpty)(t.result.desc_text)&&(n=t.result.desc_text),w(H.id,Je(Je({},G),{},{desc_text:n}),{step_status:1}),a&&(e(t.message),B||setTimeout((function(){y(!1)}),100)),z(!1),I(!1)})).catch((function(e){throw Error(Object(d.j)(null==e?void 0:e.message))}));case 9:t.next=16;break;case 11:t.prev=11,t.t0=t.catch(6),v("modalData",{status:!0,modalTitle:"Update Action",error:null===t.t0||void 0===t.t0?void 0:t.t0.message}),z(!1),I(!1);case 16:Object(d.gb)(e,1e3),t.next=20;break;case 19:I(!1);case 20:case"end":return t.stop()}}),t,null,[[6,11]])})));return function(e){return t.apply(this,arguments)}}();return Object(a.createElement)(d.b.Provider,{value:{errorList:M,setErrorList:F,stepId:ce}},Object(a.createElement)(d.a.Provider,{value:{isOpenTags:k,setOpenTags:C}},Object(a.createElement)("div",{className:"wr_header"},Object(a.createElement)("div",{className:"bwf-node-icon icon-action"},Object(a.createElement)(s.a,{size:22,icon:"charge"})),Object(a.createElement)("div",{className:"wr_event_title"},J.hasOwnProperty("action_name")?J.action_name:""),Object(a.createElement)("div",{className:"wr_event_variant"},W.includes("link-trigger")&&Object(a.createElement)(De.a,{canCreate:!0,isLinkTriggerOpen:$,setLinkTriggerOpen:Y,hideButton:!1}),W.includes("merge-tag")&&Object(a.createElement)("span",{onClick:function(){C(!0)},className:"bwf-cursor-pointer bwf-modal-icon-link-trigger",key:"merge-tag"},Object(a.createElement)(Ie.a,{icon:"merge-tag",iconSize:28,size:100,toolTipText:Object(a.createElement)("span",{className:"bwfan_tooltip_text bwf-w-120","data-position":"top"},Object(l.__)("Merge tags","wp-marketing-automations-crm"))}))),Object(a.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){return y(!1)}},Object(a.createElement)(s.a,{icon:"close"}))),Object(c.isEmpty)(ee)?Object(a.createElement)("div",{className:"wr_content"},Object(a.createElement)("div",{className:"bwf-single-automation-notice is-info"},Object(l.__)("No settings to configure.","wp-marketing-automations"))):Object(a.createElement)(Ae.a,{onSubmit:function(){var e=Xe(regeneratorRuntime.mark((function e(t){var n,a=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(a.length>1&&void 0!==a[1])||a[1],e.next=3,ue(t,n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),initialValues:Je(Je({},ne),X),validate:function(){return!1}},(function(e){var t,n=e.getInputProps,r=e.values,o=e.errors,s=e.handleSubmit;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:(t="wr_content",J.hasOwnProperty("slug")&&(t=t+" wr_action_"+J.slug),t),ref:_},Object(a.createElement)("fieldset",null,ee.map((function(e,t){return Object(a.createElement)(a.Fragment,{key:t},(Object(c.isEmpty)(e.toggler)||ie(r,e.toggler))&&e.wrap_before&&Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_before}}),e.type?Object(a.createElement)(a.Fragment,null,!1!==e.show&&(Object(c.isEmpty)(e.toggler)||ie(r,e.toggler))&&Object(a.createElement)(xe.a,{input:e,formProps:n(e.id),values:r,isOpenTemplate:S,setOpenTemplate:function(){Object(d.nb)()?A(!S):v("showProModal",!0)},automationId:h,automationEvent:E,setMergeTagModal:C,saveNodeDataOnSubmit:s})):e.hint?Object(a.createElement)(a.Fragment,{dangerouslySetInnerHTML:{__html:e.hint},className:i()(e.class)}):null,(Object(c.isEmpty)(e.toggler)||ie(r,e.toggler))&&e.wrap_after&&Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_after}}))})))),Object(a.createElement)("div",{className:"wr_footer"},Object(a.createElement)(u.Button,{isTertiary:!0,onClick:function(){return y(!1)}},Object(l.__)("Cancel")),!Object(c.isEmpty)(J)&&J.hasOwnProperty("slug")&&"wp_sendemail"===J.slug&&Object(a.createElement)(u.Button,{isSecondary:!0,onClick:function(){U(!1),I(!0),setTimeout((function(){return s()}),100)},isBusy:D,disabled:Object.keys(o).length},Object(l.__)("Save & Close")),Object(a.createElement)(u.Button,{isPrimary:!0,onClick:function(){!Object(c.isEmpty)(J)&&J.hasOwnProperty("slug")&&"wp_sendemail"===J.slug&&U(!0),setTimeout((function(){return s()}),100)},isBusy:R&&!D},Object(l.__)("Save","wp-marketing-automations"))))})),Object(a.createElement)(Ye,{isOpen:k,onRequestClose:C,automationID:h})))};n(1104);function tt(e){return function(e){if(Array.isArray(e))return rt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||at(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||at(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function at(e,t){if(e){if("string"==typeof e)return rt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rt(e,t):void 0}}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ct=function(e){var t=e.options,n=e.selected,r=e.setSelected,o=e.selectedContent,i=void 0===o?"":o,l=e.liteDummyData,u=void 0===l?[]:l,m=nt(Object(a.useState)([]),2),b=m[0],f=m[1];return Object(c.isEmpty)(t)?Object(a.createElement)(a.Fragment,null):Object(a.createElement)(a.Fragment,null,t.map((function(e,t){if(Object(c.isEmpty)(e)||!e.hasOwnProperty("value"))return!1;var o=e.value==n?"selected":"";return Object(a.createElement)("div",{className:"bwf-custom-radio-control",key:t},Object(a.createElement)("div",{className:"bwf-custom-radio-option",key:e.value,onClick:function(){return r(e.value)}},Object(a.createElement)("div",{className:"bwf-select-option-indicator "+o},e.hasOwnProperty("isProFeature")&&e.isProFeature&&!Object(d.nb)()?Object(a.createElement)(s.a,{icon:"lock"}):Object(a.createElement)("div",{className:"bwf-option-mark-outer"},Object(a.createElement)("div",{className:"bwf-option-mark-inner"}))),Object(a.createElement)("div",{className:"bwf-select-option-info"},Object(a.createElement)("div",{className:"bwf-bold"},e.hasOwnProperty("label")?e.label:""),Object(a.createElement)("div",{className:"bwf-desc"},e.hasOwnProperty("desc")?e.desc:"")),e.hasOwnProperty("isProFeature")&&e.isProFeature&&!Object(d.nb)()&&Object(a.createElement)("a",{onClick:function(t){t.stopPropagation();var n=tt(b);n.includes(e.value)?n.pop(e.value):n.push(e.value),f(n)},className:"bwf-no-underline bwf-cursor-pointer"},"Explore")),b.includes(e.value)&&u.hasOwnProperty(e.value)&&Object(a.createElement)(a.Fragment,null,u[e.value]),o&&Object(a.createElement)("div",{className:"bwf-option-content"},i))})))},ot=n(286),it=n(147);n(1105);function lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function st(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lt(Object(n),!0).forEach((function(t){ut(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ut(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return bt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var dt=function(e){var t=Object(a.useRef)(null),n=e.mergetag,r=e.copyTagToClipBoard,o=e.automationId,l=mt(Object(a.useState)({}),2),s=l[0],m=l[1],b=mt(Object(a.useState)({}),2),d=b[0],f=b[1],p=n.schema,O=void 0===p?[]:p,j=n.tag_name,y=void 0===j?"":j,w=n.default_val,v=void 0===w?[]:w;Object(a.useEffect)((function(){var e=[];O.map((function(t){e[t.id]=t.type})),f(e)}),[O]);var g,E=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!1,a=t.fields,r=t.relation,c=void 0===r?"OR":r;c=c.toUpperCase();try{var o=null;if("OR"===c){if(a&&Array.isArray(a))for(var i=0;i<a.length;i++){o=e[a[i].id];var l=void 0===a[i].value||a[i].value;if(""!=l&&o==l||""==l&&""!=o&&null!=o)return!0}}else"AND"==c&&a&&Array.isArray(a)&&(n=a.every((function(t){o=e[t.id];var n=void 0===t.value||t.value;return(""===n||o==n)&&(""!=n||""!=o&&null!=o)})))}catch(e){console.log(e)}return n},h=function(){var e=["{{"+y];if(!Object(c.isEmpty)(s))if("cart_recovery_link"===y){var t=s.coupon_type,n=void 0===t?"":t,a=s.dynamic_coupon,r=void 0===a?"":a,o=s.static_coupon,i=void 0===o?"":o;"static"===n&&""!==i?e.push("coupon='"+i+"'"):"dynamic"===n&&""!==r&&e.push("coupon='"+r+"'")}else Object.entries(s).map((function(t){var n=mt(t,2),a=n[0],r=n[1];if("search"!=d[a]||Object(c.isEmpty)(r))""!==r&&e.push(a+"='"+r+"'");else{var o=[];r.map((function(e){o.push(e.id)})),e.push(a+"='"+o.join(",")+"'")}}));return e.join(" ")+"}}"},_=function(){var e=h();return O.map((function(t){!t.hasOwnProperty("required")||!t.required||s.hasOwnProperty(t.id)&&""!==s[t.id]||(e="")})),""!==e};return Object(a.createElement)("div",{className:"bwf-merge-tag-wrap bwf_w_full"},Object(a.createElement)(Ae.a,{onChange:function(e){!function(e){var t=st({},s);t[e.name]=e.value,m(t)}(e)},initialValues:st(st({},v),s),validate:function(){return!1}},(function(e){var n=e.getInputProps,r=e.values;e.errors,e.handleSubmit;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"wr_content",ref:t},Object(a.createElement)("fieldset",null,O.map((function(e,t){return Object(a.createElement)(a.Fragment,{key:t},(Object(c.isEmpty)(e.toggler)||E(r,e.toggler,e))&&e.wrap_before&&Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_before}}),e.type?Object(a.createElement)(a.Fragment,null,!1!==e.show&&(Object(c.isEmpty)(e.toggler)||E(r,e.toggler,e))&&Object(a.createElement)(xe.a,{input:e,formProps:n(e.id),values:r,automationId:o})):e.hint?Object(a.createElement)(a.Fragment,{dangerouslySetInnerHTML:{__html:e.hint},className:i()(e.class)}):null,(Object(c.isEmpty)(e.toggler)||E(r,e.toggler,e))&&e.wrap_after&&Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_after}}))})))))})),(g=h(),Object(a.createElement)("div",{className:"bwf-merge-tag-config-view"},Object(a.createElement)("span",{className:"bwf-merge-tag"},g),Object(a.createElement)(u.Button,{isPrimary:!0,onClick:function(){r(g)},disabled:!_()},"Select"))))};function ft(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function pt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ft(Object(n),!0).forEach((function(t){Ot(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ft(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ot(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return yt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var wt=function(e){Object(a.useContext)(d.d);var t=Object(a.useContext)(qe.a).setSelectedMergeTag,n=e.isOpen,r=e.onRequestClose,o=e.automationID,m=e.onSelect,f=jt(Object(a.useState)(""),2),p=f[0],O=f[1],j=jt(Object(a.useState)(""),2),y=j[0],w=j[1],v=jt(Object(a.useState)({}),2),g=v[0],E=v[1],h=(0,Object(b.a)().getDelayTagList)();Object(a.useEffect)((function(){n||(E({}),O(""),Object(c.isEmpty)(h)||w(Object.keys(h)[0]))}),[n]);var _=function(){r&&r()},N=function(e){t(e),m(e),_()},k=function(){var e,t=(e={},Object.entries(h).map((function(t){var n=jt(t,2),a=n[0],r=n[1];""!==y?y==a&&(e=r):""!==p?Object.entries(r).map((function(t){var n=jt(t,2),a=n[0],r=n[1];(a.includes(p)||r.hasOwnProperty("tag_name")&&r.tag_name.includes(p))&&(e[a]=r)})):e=pt(pt({},e),r)})),e);return Object(c.isEmpty)(t)?Object(a.createElement)("tr",null,Object(a.createElement)("td",{className:"bwf-no-merge-tag"},Object(l.__)("No Delay Tag Available","wp-marketing-automations"))):Object(a.createElement)(a.Fragment,null,Object.entries(t).map((function(e,t){var n=jt(e,2),r=(n[0],n[1]);return Object(a.createElement)("tr",{key:"row"+t},Object(a.createElement)("td",null,Object(a.createElement)("span",{className:"bwf-tag-label"},r.tag_description)),Object(a.createElement)("td",null,Object(a.createElement)("span",{className:"bwf-tag-slug"},"{{"+r.tag_name+"}}")),Object(a.createElement)("td",null,r.hasOwnProperty("schema")?Object(a.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){return E(r)},title:"Configure"},Object(a.createElement)(s.a,{color:"#353030",icon:"settings"})):Object(a.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){return N("{{"+r.tag_name+"}}")},title:"Copy"},Object(a.createElement)(s.a,{color:"#353030",icon:"duplicate"}))))})))};return n?Object(a.createElement)(u.Modal,{onRequestClose:_,className:"bwf-admin-modal bwf-event-search-modal bwf-event-search-delay-tag bwf-admin-modal-xl bwf-overflow-remove",shouldCloseOnEsc:!0,shouldCloseOnClickOutside:!0},Object(a.createElement)("div",{className:"bwf-modal-search-header"},Object(a.createElement)("div",{className:"bwf-modal-title"},Object(c.isEmpty)(g)?Object(l.__)("Delay Tags"):Object(a.createElement)("div",{className:"bwf-display-flex"},Object(a.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){E({})}},Object(a.createElement)(s.a,{icon:Object(l.isRTL)()?"arrow-right":"arrow-left"})),g.hasOwnProperty("tag_description")?g.tag_description:"")),Object(a.createElement)("div",{className:"bwf-modal-search-wrap"},Object(c.isEmpty)(g)&&Object(a.createElement)("div",{className:"bwf-component-search-control"},Object(a.createElement)(s.a,{icon:"search",size:15}),Object(a.createElement)(u.TextControl,{value:p,onChange:function(e){""===e?Object(c.isEmpty)(h)||w(Object.keys(h)[0]):w(""),O(e)},placeholder:Object(l.__)("Search by name")}))),Object(a.createElement)("div",{className:"bwf-modal-close bwf-cursor-pointer",onClick:_},Object(a.createElement)(s.a,{icon:"close",size:16}))),Object(a.createElement)("div",{className:"bwf-event-modal-main"},Object(a.createElement)("div",{className:"bwf-event-modal-body bwf-merge-modal-content"+(Object(c.isEmpty)(g)&&!Object(c.isEmpty)(h)?"":" gridfull")},Object(c.isEmpty)(g)?Object(c.isEmpty)(h)?Object(a.createElement)("div",{className:"bwf-modal-content-content"},Object(a.createElement)("div",{className:"bwf-modal-content-brick no-padding set-height"},Object(a.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(a.createElement)("div",{className:"bwf-brick-content"},Object(a.createElement)("div",{className:"bwf-merge-tag-list"},Object(a.createElement)("div",{className:"bwf-no-merge-tag"},Object(l.__)("No Delay Tag Available","wp-marketing-automations"))))))):Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-modal-sidebar"},Object(a.createElement)("div",{className:"bwf-modal-filter-wrap"},Object.keys(h).map((function(e){return Object(a.createElement)("div",{key:e,className:i()("bwf-modal-filter",{active:y===e}),onClick:function(){O(""),w(e)}},e)})))),Object(a.createElement)("div",{className:"bwf-modal-content-content"},Object(a.createElement)("div",{className:"bwf-modal-content-brick no-padding set-height"},Object(a.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(a.createElement)("div",{className:"bwf-brick-content"},Object(a.createElement)("div",{className:"bwf-merge-tag-list"},Object(a.createElement)("table",null,Object(a.createElement)("tbody",null,k())))))))):Object(a.createElement)(dt,{mergetag:g,copyTagToClipBoard:N,automationId:o})))):""};function vt(e){return function(e){if(Array.isArray(e))return Pt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Ct(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(n),!0).forEach((function(t){ht(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ht(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _t(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function Nt(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){_t(c,a,r,o,i,"next",e)}function i(e){_t(c,a,r,o,i,"throw",e)}o(void 0)}))}}function kt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||Ct(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ct(e,t){if(e){if("string"==typeof e)return Pt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pt(e,t):void 0}}function Pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var St=function(){var e=kt(Object(a.useState)({}),2),t=e[0],n=e[1],r=kt(Object(a.useState)({}),2),o=r[0],i=r[1],f=kt(Object(a.useState)(!0),2),O=f[0],j=f[1],y=kt(Object(a.useState)(!1),2),w=y[0],v=y[1],g=kt(Object(a.useState)(!1),2),E=g[0],h=g[1],_=Object(a.useContext)(d.d),N=Object(m.a)(),k=N.showSidebar,C=N.setNodeDatabyId,P=N.setAutomationData,S=N.getElementsAfterStep,A=kt(Object(a.useState)(!1),2),x=A[0],D=A[1],I=Object(b.a)(),T=I.getSidebarNodeData,M=I.getNodeDataByID,F=I.getAutomationId,L=I.getAutomationLinks,R=I.getAutomationSteps,z=I.getCount,q=I.getActionsList,B=I.getGoals,U=I.getDelayTagList,H=T(),V=F(),$=U(),Y=R(),G=L(),J=z(),Q=q(),W=B(),X=!Object(c.isEmpty)(H)&&H.hasOwnProperty("id")?M(H.id):{},Z=X.id,K=void 0===Z?0:Z,ee=X.stepId,te=void 0===ee?0:ee,ne=X.data,ae=(void 0===ne?{}:ne).sidebarValues,re=function(){var e=Nt(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p()({path:Object(d.m)("/fields/?type=7&all=true"),method:"GET"}).then((function(e){200===e.code&&(Object(c.isEmpty)(e.result)||i(e.result),j(!1))}));case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){Object(d.nb)()&&re(),n({})}),[]);var ce=!Object(c.isEmpty)(H)&&H.hasOwnProperty("data")?H.data:{},oe=!Object(c.isEmpty)(ce)&&ce.hasOwnProperty("sidebarValues")?ce.sidebarValues:{},ie=kt(Object(a.useState)(1),2),le=ie[0],se=ie[1],ue=kt(Object(a.useState)({day_delay:{unit:"min",text:"0"}}),2),be=ue[0],fe=ue[1];Object(a.useEffect)((function(){oe.hasOwnProperty("type")&&[1,2,3,4].includes(parseInt(oe.type))&&se(parseInt(oe.type)),oe.hasOwnProperty("data")&&!Object(c.isEmpty)(oe.data)&&fe(oe.data)}),[oe]),Object(a.useEffect)((function(){if(!O){var e=Et(Et({},oe),{},{type:le,data:be});Object(c.isEqual)(ae,e)||Object(c.isEmpty)(ae)?v(!1):v(!0)}}),[le,be]);var pe=function(e){var t=e.type,a=void 0===t?0:t,r=e.data,o=void 0===r?{}:r,i={};switch(parseInt(a)){case 1:var s=o.day_delay,u=void 0===s?{}:s,m=o.enable_time_delay,b=void 0!==m&&m,d=o.time_delay,f=void 0===d?{}:d,p=o.enable_week_delay,O=void 0!==p&&p,j=o.week_delay,y=void 0===j?[]:j;(Object(c.isEmpty)(u)||u.hasOwnProperty("text")&&""==u.text)&&(i.day_delay=Object(l.__)("Select a specific period.","wp-marketing-automations")),b?(Object(c.isEmpty)(f)||f.hasOwnProperty("time")&&Object(c.isEmpty)(f.time))&&(i.time_delay=Object(l.__)("Select a specific time of day.","wp-marketing-automations")):o.time_delay={},O?Object(c.isEmpty)(y)&&(i.week_delay=Object(l.__)("Select a specific day of the week.","wp-marketing-automations")):o.week_delay=[];break;case 2:var w=o.date,v=void 0===w?"":w,g=o.time_delay,E=void 0===g?{time:""}:g,h=o.enable_step_skip,_=void 0!==h&&h,N=o.skip_to_step,k=void 0===N?{}:N;Object(c.isEmpty)(v)&&(i.specific_date=Object(l.__)("Select a specific date.","wp-marketing-automations")),Object(c.isEmpty)(E.time)&&(i.specific_time=Object(l.__)("Select a specific time.","wp-marketing-automations")),!_||k.hasOwnProperty("step")&&""!=k.step||(i.specific_date_time_step=Object(l.__)("Please choose the target step if time passes.","wp-marketing-automations"));break;case 3:var C=o.custom_field,P=void 0===C?{}:C,S=o.enable_step_skip,A=void 0!==S&&S,x=o.skip_to_step,D=void 0===x?{}:x;if(!P.hasOwnProperty("field")||0==parseInt(P.field)||isNaN(parseInt(P.field))){i.custom_field=Object(l.__)("Please select custom field.","wp-marketing-automations");break}!A||D.hasOwnProperty("step")&&""!=D.step||(i.custom_field=Object(l.__)("Please choose the target step if time passes.","wp-marketing-automations"));break;case 4:var I=o.variable_field,T=void 0===I?{}:I,M=o.enable_step_skip,F=void 0!==M&&M,L=o.skip_to_step,R=void 0===L?{}:L;if(!T.hasOwnProperty("variable")||""==T.variable){i.variable=Object(l.__)("Please select a delay variable.","wp-marketing-automations");break}!F||R.hasOwnProperty("step")&&""!=R.step||(i.variable=Object(l.__)("Please choose the target step if time passes.","wp-marketing-automations"))}return!!Object(c.isEmpty)(i)||(n(i),!1)},Oe=function(){var e=Nt(regeneratorRuntime.mark((function e(){var t,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!1,n=Et(Et({},oe),{},{type:le,data:be}),pe(n)){e.next=4;break}return e.abrupt("return");case 4:if(!Object(c.isEqual)(ae,n)){e.next=7;break}return k(!1),e.abrupt("return");case 7:return Object(c.isEmpty)(ae)||(t=!0),D(!0),a={data:{data:{sidebarData:n}},steps:Object(c.cloneDeep)(Y).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:G,count:J,optionUpdated:t,actionType:1},e.prev=10,e.next=13,p()({path:Object(d.m)("/automation/".concat(V,"/step/").concat(te)),method:"POST",data:a}).then((function(e){if(200!==e.code)throw Error(Object(d.j)(null==e?void 0:e.message));_(e.message),C(H.id,Et(Et({},ce),{},{sidebarValues:n}),{step_status:1}),setTimeout((function(){k(!1)}),100),D(!1)})).catch((function(e){throw Error(Object(d.j)(null==e?void 0:e.message))}));case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(10),P("modalData",{status:!0,modalTitle:"Update Delay",error:null===e.t0||void 0===e.t0?void 0:e.t0.message}),D(!1);case 19:Object(d.gb)(_,1e3);case 20:case"end":return e.stop()}}),e,null,[[10,15]])})));return function(){return e.apply(this,arguments)}}(),je=[{value:1,label:Object(l.__)("Delay for a specific period","wp-marketing-automations"),desc:Object(l.__)("Wait for a specified number of hours, days, or week before continuing","wp-marketing-automations"),isProFeature:!1},{value:2,label:Object(l.__)("Delay until a specific date and time","wp-marketing-automations"),desc:Object(l.__)("Set a specific date and time","wp-marketing-automations"),isProFeature:!0},{value:3,label:Object(l.__)("Delay until a custom field date","wp-marketing-automations"),desc:Object(l.__)("Choose from contacts custom field","wp-marketing-automations"),isProFeature:!0}];Object(c.isEmpty)($)||je.push({value:4,label:Object(l.__)("Delay with events variable","wp-marketing-automations"),desc:Object(l.__)("Choose from event field value","wp-marketing-automations"),isProFeature:!0});var ye=[{value:"1",label:"S"},{value:"2",label:"M"},{value:"3",label:"T"},{value:"4",label:"W"},{value:"5",label:"TH"},{value:"6",label:"F"},{value:"7",label:"SA"}],we=function(e){return t.hasOwnProperty(e)},ve={1:Object(l.__)("Sun","wp-marketing-automations"),2:Object(l.__)("Mon","wp-marketing-automations"),3:Object(l.__)("Tue","wp-marketing-automations"),4:Object(l.__)("Wed","wp-marketing-automations"),5:Object(l.__)("Thu","wp-marketing-automations"),6:Object(l.__)("Fri","wp-marketing-automations"),7:Object(l.__)("Sat","wp-marketing-automations")},ge=function(){var e=be.day_delay,t=void 0===e?{}:e,n=be.enable_time_delay,a=void 0!==n&&n,r=be.enable_week_delay,o=void 0!==r&&r,i=be.time_delay,s=void 0===i?{time:""}:i,u=be.week_delay,m=void 0===u?[]:u;if(!Object(c.isEmpty)(t)&&t.hasOwnProperty("unit")&&t.hasOwnProperty("text")&&!Object(c.isEmpty)(t.unit)&&!Object(c.isEmpty)(t.text)){var b=t.text+" "+function(e,t){switch(e){case"min":return parseInt(t)>1?Object(l.__)("Minutes","wp-marketing-automations"):Object(l.__)("Minute","wp-marketing-automations");case"hours":return parseInt(t)>1?Object(l.__)("Hours","wp-marketing-automations"):Object(l.__)("Hour","wp-marketing-automations");case"days":return parseInt(t)>1?Object(l.__)("Days","wp-marketing-automations"):Object(l.__)("Day","wp-marketing-automations");case"weeks":return parseInt(t)>1?Object(l.__)("Weeks","wp-marketing-automations"):Object(l.__)("Week","wp-marketing-automations");case"months":return parseInt(t)>1?Object(l.__)("Months","wp-marketing-automations"):Object(l.__)("Month","wp-marketing-automations");default:return""}}(t.unit,t.text),d=[];return o&&!Object(c.isEmpty)(m)&&m.map((function(e){ve.hasOwnProperty(e)&&d.push(ve[e])})),a&&s.hasOwnProperty("time")&&!Object(c.isEmpty)(s.time)?(b+=" till "+Object(me.format)(bwfcrm_contacts_data.time_format,de()(s.time,"HH:mm:ss")),Object(c.isEmpty)(d)||(b+="  "+d.join("/")),s.hasOwnProperty("in_contact_timezone")&&s.in_contact_timezone?b+=" in Contact's Timezone.":b+="."):Object(c.isEmpty)(d)||(b+="  "+d.join("/")),"Delay of "+b+"."}return""},Ee=function(){var e=be.custom_field,t=void 0===e?{field:"",time:"",in_contact_timezone:!1,custom_field_label:""}:e,n=be.enable_time_delay,a=void 0!==n&&n,r=be.time_delay,o=void 0===r?{duration:0,type:"days",timing:"after"}:r,i=be.enable_step_skip,l=void 0!==i&&i,s=be.skip_to_step,u=void 0===s?{step:0,name:""}:s;if(t.hasOwnProperty("field")&&""!==t.field){var m="Delay ";return a?o.hasOwnProperty("duration")&&(m+="of ".concat(o.duration," ").concat(o.type," ").concat(o.timing," ")):m+="till ",t.hasOwnProperty("custom_field_label")&&""!==t.custom_field_label?m+="'".concat(t.custom_field_label,"' field "):m+="Custom Field ( ".concat(t.field," )"),t.hasOwnProperty("time")&&""!==t.time&&(m+=" till ".concat(Object(me.format)(bwfcrm_contacts_data.time_format,de()(t.time,"HH:mm:ss")))),t.hasOwnProperty("in_contact_timezone")&&t.in_contact_timezone?m+=" in Contact's Timezone. ":m+=". ",l&&!Object(c.isEmpty)(u)&&u.hasOwnProperty("step")&&""!=u.step&&u.hasOwnProperty("name")&&""!=u.name&&(m+=" Jump to ".concat(u.name,".")),m}return""},he=function(){var e=be.date,t=void 0===e?"":e,n=be.time_delay,a=void 0===n?{time:"",in_contact_timezone:!1}:n,r=be.enable_step_skip,o=void 0!==r&&r,i=be.skip_to_step,l=void 0===i?{step:0,name:""}:i;if(!Object(c.isEmpty)(t)&&a.hasOwnProperty("time")&&!Object(c.isEmpty)(a.time)){var s="Delay till ";return s+=Object(d.N)(t,!0,!1)+" ",a.hasOwnProperty("time")&&""!==a.time&&(s+="at ".concat(Object(me.format)(bwfcrm_contacts_data.time_format,de()(a.time,"HH:mm:ss"))," ")),a.hasOwnProperty("in_contact_timezone")&&a.in_contact_timezone?s+="in Contact's Timezone. ":s+=". ",o&&!Object(c.isEmpty)(l)&&l.hasOwnProperty("step")&&""!=l.step&&l.hasOwnProperty("name")&&""!=l.name&&(s+="Jump to ".concat(l.name)),s}return""},_e={action:Object(l.__)("Action","wp-marketing-automations"),wait:Object(l.__)("Delay","wp-marketing-automations"),conditional:Object(l.__)("Conditional","wp-marketing-automations"),exit:Object(l.__)("Exit","wp-marketing-automations"),benchmark:Object(l.__)("Goal","wp-marketing-automations")},Ne=function(){var e=S(K);e=e.filter((function(e,t,n){return n.indexOf(e)===t}));var t={stepsOptArr:[],stepsOptions:[{value:"",label:Object(l.__)("Select Step","wp-marketing-automations")}]};return Object(c.isEmpty)(e)||(e.map((function(e){var n=M(e),a=n.stepId,r=void 0===a?0:a,c=n.id,o=void 0===c?0:c;if(!["yesNoNode","end","jump"].includes(n.type)&&!t.stepsOptArr.hasOwnProperty(e)){var i=["Step"];i.push(o),_e.hasOwnProperty(n.type)&&i.push(" : "+_e[n.type]),"action"==n.type&&n.hasOwnProperty("data")&&Q.list.hasOwnProperty(n.data.selected)&&Q.list[n.data.selected].hasOwnProperty("action_name")&&(Q.list[n.data.selected].hasOwnProperty("integration_nicename")?i.push(" - "+Q.list[n.data.selected].integration_nicename+" : "):i.push(" - "),i.push(Q.list[n.data.selected].action_name)),"benchmark"==n.type&&n.hasOwnProperty("data")&&W.list.hasOwnProperty(n.data.benchmark)&&W.list[n.data.benchmark].hasOwnProperty("event_name")&&(W.list[n.data.benchmark].hasOwnProperty("source_label")&&i.push(W.list[n.data.benchmark].source_label+" : "),i.push(W.list[n.data.benchmark].event_name)),t.stepsOptArr[r]=i.join(" "),t.stepsOptions.push({value:r,label:i.join(" ")})}})),t.stepsOptArr.end="End Automation",t.stepsOptions.push({value:"end",label:"End Automation"})),t},ke=kt(Object(a.useState)(!1),2),Ce=ke[0],Pe=ke[1],Se=kt(Object(a.useState)(!1),2),Ae=Se[0],xe=Se[1],De=function(){var e=be.day_delay,n=void 0===e?{unit:"min",text:"0"}:e,r=be.enable_time_delay,o=void 0!==r&&r,i=be.time_delay,m=void 0===i?{time:"",in_contact_timezone:!1}:i,b=be.enable_week_delay,f=void 0!==b&&b,p=be.week_delay,O=void 0===p?["sunday"]:p;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-delay-field "+(we("day_delay")?"has-error":"")},Object(a.createElement)(ot.a,{units:[{value:"min",label:Object(l.__)("Minutes","wp-marketing-automations")},{value:"hours",label:Object(l.__)("Hours","wp-marketing-automations")},{value:"days",label:Object(l.__)("Days","wp-marketing-automations")},{value:"weeks",label:Object(l.__)("Weeks","wp-marketing-automations")},{value:"months",label:Object(l.__)("Months","wp-marketing-automations")}],onChange:function(e){fe(Et(Et({},be),{},{day_delay:e}))},value:n}),we("day_delay")&&Object(a.createElement)("div",{className:"has-bwfan-error"},t.day_delay)),Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(d.nb)()?Object(a.createElement)(a.Fragment,null,Object(a.createElement)(u.CheckboxControl,{checked:o,label:Object(l.__)("Delay until a specific time of day","wp-marketing-automations"),onChange:function(e){return fe(Et(Et({},be),{},{enable_time_delay:e}))}}),o&&Object(a.createElement)("div",{className:"bwf-delay-field "+(we("time_delay")?"has-error":"")},Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-p-20 bwf-pt-0 bwf-pb-0"},Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(a.createElement)("input",{type:"time",value:m.time,className:"bwf-w-150 bwf-h-36",onChange:function(e){fe(Et(Et({},be),{},{time_delay:Et(Et({},be.time_delay),{},{time:e.target.value})}))}}),Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-display-flex "+(Object(d.nb)()?"":"bwf-delay-no-pro")},Object(d.nb)()?Object(a.createElement)(u.CheckboxControl,{checked:m.in_contact_timezone,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(e){fe(Et(Et({},be),{},{time_delay:Et(Et({},be.time_delay),{},{in_contact_timezone:e})}))}}):Object(a.createElement)("div",{className:"bwf-cursor-pointer no-color",onClick:function(){return P("showProModal",!0)}},"In Contact Timezone"),!Object(d.nb)()&&Object(a.createElement)(s.a,{icon:"lock",size:16})))),we("time_delay")&&Object(a.createElement)("div",{className:"has-bwfan-error"},t.time_delay))):Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start"},Object(a.createElement)(s.a,{icon:"lock"}),Object(l.__)("Delay until a specific time of day","wp-marketing-automations"),Object(a.createElement)("a",{onClick:function(){return Pe(!Ce)},className:"bwf-no-underline bwf-cursor-pointer"},"Explore")),Ce&&Object(a.createElement)("div",{className:"bwf-p-15 bwf-mtb-10 bwf-lite-restrict-section"},Object(a.createElement)(u.CheckboxControl,{checked:!1,disabled:!0,label:Object(l.__)("Delay until a specific time of day","wp-marketing-automations")}),Object(a.createElement)("div",{className:"bwf-delay-field "},Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-p-20 bwf-pt-0 bwf-pb-0"},Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(a.createElement)("input",{type:"time",value:"",disabled:!0,className:"bwf-w-150 bwf-h-36",onChange:function(){}}),Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-display-flex "},Object(a.createElement)(u.CheckboxControl,{checked:!1,disabled:!0,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(){}}))))),Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-single-automation-notice is-info no-icon"},Object(a.createElement)("b",null,Object(l.__)("This feature is only for licensed Pro users.","wp-marketing-automations"))," ",Object(a.createElement)("a",{target:"__blank",className:"bwf-a-no-underline",href:Object(d.L)("upgrade",{utm_medium:"Get+PRO+Delay+Step"})},Object(l.__)("Learn More","wp-marketing-automations"))))),Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(d.nb)()?Object(a.createElement)(a.Fragment,null,Object(a.createElement)(u.CheckboxControl,{checked:f,label:Object(l.__)("Delay until a specific day(s) of the week","wp-marketing-automations"),onChange:function(e){return fe(Et(Et({},be),{},{enable_week_delay:e}))}}),f&&Object(a.createElement)("div",{className:"bwf-delay-field "+(we("week_delay")?"has-error":"")},Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)(u.ButtonGroup,null,ye.map((function(e,t){return Object(a.createElement)(u.Button,{key:t,isPrimary:O.includes(e.value),isSecondary:!O.includes(e.value),onClick:function(){var t=vt(O);t.includes(e.value)?t=t.filter((function(t){return t!==e.value})):t.push(e.value),fe(Et(Et({},be),{},{week_delay:t}))}},e.label)}))),we("week_delay")&&Object(a.createElement)("div",{className:"has-bwfan-error"},t.week_delay),Object(a.createElement)("div",{className:"bwf_clear_10"}))):Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start"},Object(a.createElement)(s.a,{icon:"lock"}),Object(l.__)("Delay until a specific day(s) of the week","wp-marketing-automations"),Object(a.createElement)("a",{onClick:function(){return xe(!Ae)},className:"bwf-no-underline bwf-cursor-pointer"},Object(l.__)("Explore","wp-marketing-automations"))),Ae&&Object(a.createElement)("div",{className:"bwf-p-15 bwf-mtb-10 bwf-lite-restrict-section"},Object(a.createElement)(u.CheckboxControl,{checked:!1,disabled:!0,label:Object(l.__)("Delay until a specific day(s) of the week","wp-marketing-automations"),onChange:function(){}}),Object(a.createElement)("div",{className:"bwf-delay-field "},Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)(u.ButtonGroup,null,ye.map((function(e,t){return Object(a.createElement)(u.Button,{key:t,isPrimary:!1,isSecondary:!0,onClick:function(){},disabled:!0},e.label)})))),Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-single-automation-notice is-info no-icon"},Object(a.createElement)("b",null,Object(l.__)("This feature is only for licensed Pro users.","wp-marketing-automations"))," ",Object(a.createElement)("a",{target:"__blank",className:"bwf-a-no-underline",href:Object(d.L)("upgrade",{utm_medium:"Get+PRO+Delay+Step"})},Object(l.__)("Learn More","wp-marketing-automations"))))),!Object(c.isEmpty)(ge())&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-single-automation-notice is-info"},ge())))},Ie=function(){return Object(a.createElement)("div",{className:"bwf-custom-date-delay"},Object(a.createElement)("div",{className:"bwf-delay-field "},O?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf_w_full bwf-h-15"}):function(){var e=be.custom_field,t=void 0===e?{field:0,time:"",in_contact_timezone:!1,custom_field_label:""}:e,n=be.enable_time_delay,r=void 0!==n&&n,i=be.time_delay,s=void 0===i?{duration:0,type:"days",timing:"after"}:i,m=be.occurrence,b=void 0===m?"daymonth":m,f=be.enable_step_skip,p=void 0!==f&&f,O=be.skip_to_step,j=void 0===O?{step:0,name:""}:O,y=Ne(),w=y.stepsOptArr,v=y.stepsOptions;if(Object(c.isEmpty)(o))return Object(a.createElement)(a.Fragment,null,Object(l.__)("No Custom Field with type Date found","wp-marketing-automations"));var g=[{value:"",label:Object(l.__)("Select Type","wp-marketing-automations")}];Object.keys(o).map((function(e){g.push({label:o[e].hasOwnProperty("name")?o[e].name:"",value:e})}));var E=Ee();return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-delay-field bwf-delay-select-field-wrap"},Object(a.createElement)("div",{className:"bwf-pt-0 bwf-pb-0"},Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full align-start"},Object(a.createElement)("div",{className:"bwf-delay-field-select bwf-w-210 "+(we("custom_field")&&""==t.field?"has-error":"")},Object(a.createElement)(u.SelectControl,{value:t.field,className:"bwf_W_full",options:g,onChange:function(e){return fe(Et(Et({},be),{},{custom_field:Et(Et({},be.custom_field),{},{field:e,custom_field_label:o[e].name})}))}}),we("custom_field")&&""==t.field&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("Please select a custom field.","wp-marketing-automations")))),Object(a.createElement)("div",{className:"bwf-delay-occurrence bwf-delay-field "+(we("custom_field")&&""==b?"has-error":"")},Object(a.createElement)(u.SelectControl,{value:b,className:"bwf_w_full",options:[{value:"daymonth",label:Object(l.__)("Use Day & Month","wp-marketing-automations")},{value:"daymonthyear",label:Object(l.__)("Use Full Date","wp-marketing-automations")}],onChange:function(e){return fe(Et(Et({},be),{},{occurrence:e}))}}))),Object(a.createElement)("div",{className:"bwf-sidebar-hint"},Object(l.__)("Note: Contact would not pass this step if the value of custom field is blank.","wp-marketing-automations"),"daymonth"===b&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("br",null),Object(l.__)("It will pick the day and month from the selected field value and if the time is older than the current time it will increase by one year.","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(a.createElement)("div",{className:"bwf-delay-select-field-time bwf-w-210"},Object(a.createElement)("input",{type:"time",value:t.time,className:"bwf-w-210 bwf-h-36",onChange:function(e){fe(Et(Et({},be),{},{custom_field:Et(Et({},be.custom_field),{},{time:e.target.value})}))}})),Object(a.createElement)("div",{className:"bwf-delay-select-field-timezone bwf-w-210"},Object(a.createElement)(u.CheckboxControl,{checked:t.in_contact_timezone,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(e){fe(Et(Et({},be),{},{custom_field:Et(Et({},be.custom_field),{},{in_contact_timezone:e})}))}}))))),Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)("div",{className:"bwf-delay-field bwf-delay-sidebar-custom-field"},Object(a.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(a.createElement)("div",{className:"bwf-specific-date "+(Object(d.nb)()?"":"bwf-delay-no-pro")},Object(a.createElement)(u.CheckboxControl,{checked:r,label:Object(l.__)("Delay for certain days from field date","wp-marketing-automations"),onChange:function(e){Object(d.nb)()?fe(Et(Et({},be),{},{enable_time_delay:e})):P("showProModal",!0)}}))),r&&Object(a.createElement)("div",{className:"bwf-pt-0 bwf-pb-0 bwf-delay-sidebar-custom-delay-wrap"},Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(a.createElement)("div",{className:"bwf-delay-duration bwf-w-210 "+(we("custom_field")&&parseInt(s.duration)<0?"has-error":"")},Object(a.createElement)(u.TextControl,{className:"bwf-h-36",type:"number",value:s.duration,onChange:function(e){return fe(Et(Et({},be),{},{time_delay:Et(Et({},be.time_delay),{},{duration:e})}))},min:1,placeholder:Object(l.__)("2","wp-marketing-automations")})),Object(a.createElement)("div",{className:"bwf-delay-type bwf-w-210"},Object(a.createElement)(u.SelectControl,{value:s.type,className:"bwf_w_full",options:[{value:"days",label:Object(l.__)("Days","wp-marketing-automations")},{value:"weeks",label:Object(l.__)("Weeks","wp-marketing-automations")}],onChange:function(e){return fe(Et(Et({},be),{},{time_delay:Et(Et({},be.time_delay),{},{type:e})}))}})),Object(a.createElement)("div",{className:"bwf-delay-timing bwf-w-170"},Object(a.createElement)(u.SelectControl,{value:s.timing,className:"bwf_w_full",options:[{value:"before",label:Object(l.__)("Before","wp-marketing-automations")},{value:"after",label:Object(l.__)("After","wp-marketing-automations")}],onChange:function(e){return fe(Et(Et({},be),{},{time_delay:Et(Et({},be.time_delay),{},{timing:e})}))}}))))),Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(a.createElement)("div",{className:"bwf-specific-date "+(Object(d.nb)()?"":"bwf-delay-no-pro")},Object(a.createElement)(u.CheckboxControl,{checked:p,label:Object(l.__)("Jump to step if time has passed","wp-marketing-automations"),onChange:function(e){Object(d.nb)()?fe(Et(Et({},be),{},{enable_step_skip:e})):P("showProModal",!0)}}))),p&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)("div",{className:"bwf-delay-skip-step-select bwf-specific-date "+(we("custom_field")&&""==j.step?"has-error":"")},Object(a.createElement)(u.SelectControl,{value:j.step,className:"bwf_w_full",options:v,onChange:function(e){return fe(Et(Et({},be),{},{skip_to_step:Et(Et({},be.skip_to_step),{},{step:e,name:w[e]})}))}}),we("custom_field")&&""==j.step&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("Please choose the target step if time passes.","wp-marketing-automations"))))),""!==E&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-single-automation-notice is-info"},E)))}()))},Te=function(){var e=be.date,n=void 0===e?"":e,r=be.time_delay,o=void 0===r?{time:"",in_contact_timezone:!1}:r,i=be.enable_step_skip,m=void 0!==i&&i,b=be.skip_to_step,f=void 0===b?{step:0,name:""}:b,p=Ne(),O=p.stepsOptArr,j=p.stepsOptions;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-specific-date-time-delay"},Object(a.createElement)("div",{className:"bwf-specific-date bwf_w_full bwf-h-36 bwf-mt-10"},Object(a.createElement)("div",{className:"bwf-delay-field "+(we("specific_date")?"has-error":"")},Object(a.createElement)(it.a,{date:Object(c.isEmpty)(n)?null:de()(n),dateFormat:"MM/DD/YYYY",onUpdate:function(e){var t,n;t=e.text,n=de()().format("MM/DD/YYYY"),de()(n).isSameOrBefore(de()(t))?fe(Et(Et({},be),{},{date:e.text})):(_(Object(l.__)("Invalid Date selected","wp-marketing-automations")),Object(d.gb)(_,1e3))},text:n,iconRight:!0}),we("specific_date")&&Object(a.createElement)("div",{className:"has-bwfan-error"},t.specific_date))),Object(a.createElement)("div",{className:"bwf-specific-time bwf_w_full"},Object(a.createElement)("div",{className:"bwf-delay-field "+(we("specific_time")?"has-error":"")},Object(a.createElement)("input",{type:"time",value:o.time,onChange:function(e){fe(Et(Et({},be),{},{time_delay:Et(Et({},be.time_delay),{},{time:e.target.value})}))},className:"bwf-h-36"}),we("specific_time")&&Object(a.createElement)("div",{className:"has-bwfan-error"},t.specific_time))),Object(a.createElement)("div",{className:"bwf-specific-date bwf-w-210 "+(Object(d.nb)()?"":"bwf-delay-no-pro")},Object(d.nb)()?Object(a.createElement)(u.CheckboxControl,{checked:o.in_contact_timezone,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(e){fe(Et(Et({},be),{},{time_delay:Et(Et({},be.time_delay),{},{in_contact_timezone:e})}))}}):Object(a.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){return P("showProModal",!0)}},"In Contact TimeZone"),!Object(d.nb)()&&Object(a.createElement)(s.a,{icon:"lock",size:16}))),Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)("div",{className:"bwf-specific-date"},Object(a.createElement)("div",{className:"bwf-specific-date "+(Object(d.nb)()?"":"bwf-delay-no-pro")},Object(a.createElement)(u.CheckboxControl,{checked:m,label:Object(l.__)("Jump to step if time has passed","wp-marketing-automations"),onChange:function(e){Object(d.nb)()?fe(Et(Et({},be),{},{enable_step_skip:e})):P("showProModal",!0)}}))),m&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)("div",{className:"bwf-specific-date "+(we("specific_date_time_step")?"has-error":"")},Object(a.createElement)(u.SelectControl,{value:f.step,className:"bwf_w_full",options:j,onChange:function(e){return fe(Et(Et({},be),{},{skip_to_step:Et(Et({},be.skip_to_step),{},{step:e,name:O[e]})}))}}),we("specific_date_time_step")&&Object(a.createElement)("div",{className:"has-bwfan-error"},t.specific_date_time_step))),!Object(c.isEmpty)(he())&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-single-automation-notice is-info"},he())))};return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"wr_header"},Object(a.createElement)("div",{className:"bwf-node-icon icon-delay"},Object(a.createElement)(s.a,{size:28,icon:"time-left"})),Object(a.createElement)("div",{className:"wr_event_title"},Object(a.createElement)("span",null,Object(l.__)("Delay","wp-marketing-automations"))),Object(a.createElement)("div",{className:"wr_event_variant"}),Object(a.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){k(!1)}},Object(a.createElement)(s.a,{icon:"close"}))),Object(a.createElement)("div",{className:"wr_content"},Object(a.createElement)("div",{className:"bwf-delay-wrap"},Object(a.createElement)(ct,{selected:le,setSelected:function(e){Object(d.nb)()||![2,3].includes(parseInt(e))?(fe(function(e){switch(e){case 1:return{day_delay:{unit:"min",text:""},enable_time_delay:!1,time_delay:{time:"",in_contact_timezone:!1},enable_week_delay:!1,week_delay:[]};case 2:return{date:"",time_delay:{time:"",in_contact_timezone:!1},enable_step_skip:!1,skip_to_step:{step:0,name:""}};case 3:return{custom_field:{field:"",time:"",in_contact_timezone:!1,custom_field_label:""},time_delay:{duration:0,type:"days",timing:"before"},occurrence:"daymonth",enable_step_skip:!1,skip_to_step:{step:0,name:""}};case 4:return{variable_field:{variable:"",time:"",in_contact_timezone:!1},time_delay:{duration:0,type:"days",timing:"before"},occurrence:"daymonthyear",enable_step_skip:!1,skip_to_step:{step:0,name:""}};default:return{}}}(parseInt(e))),se(e)):P("showProModal",!0)},options:je,selectedContent:function(){switch(parseInt(le)){case 1:return Object(a.createElement)(a.Fragment,null,De());case 2:return Object(a.createElement)(a.Fragment,null,Object(d.nb)()?Te():Object(a.createElement)(a.Fragment,null));case 3:return Object(a.createElement)(a.Fragment,null,Object(d.nb)()?Ie():Object(a.createElement)(a.Fragment,null));case 4:return Object(a.createElement)(a.Fragment,null,Object(d.nb)()?(e=be.variable_field,t=void 0===e?{variable:"",time:"",in_contact_timezone:!1}:e,n=be.enable_time_delay,r=void 0!==n&&n,c=be.time_delay,o=void 0===c?{duration:0,type:"days",timing:"after"}:c,i=be.occurrence,s=void 0===i?"daymonthyear":i,m=be.enable_step_skip,b=void 0!==m&&m,f=be.skip_to_step,p=void 0===f?{step:0,name:""}:f,O=Ne(),j=O.stepsOptArr,y=O.stepsOptions,w=Ee(),Object(a.createElement)(a.Fragment,null,Object(a.createElement)(wt,{isOpen:E,onRequestClose:h,automationID:V,onSelect:function(e){fe(Et(Et({},be),{},{variable_field:Et(Et({},be.variable_field),{},{variable:e})}))}}),Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-delay-field bwf-delay-select-field-wrap"},Object(a.createElement)("div",{className:"bwf-pt-0 bwf-pb-0"},Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full align-start"},Object(a.createElement)("div",{className:"bwf-delay-field-select bwf-w-300 "+(we("variable")&&""==t.variable?"has-error":""),onClick:function(){return h(!0)}},Object(a.createElement)(u.TextControl,{value:t.variable,disabled:!0}),we("variable")&&""==t.variable&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("Please select a variable.","wp-marketing-automations")))),Object(a.createElement)("div",{className:"bwf-delay-occurrence bwf-delay-field ",onClick:function(){return h(!0)}},Object(a.createElement)(u.Button,{isSecondary:!0},"Select")),Object(a.createElement)("div",{className:"bwf-delay-occurrence bwf-delay-field "},Object(a.createElement)("div",{className:"bwf-delay-occurrence bwf-delay-field "+(we("variable")&&""==s?"has-error":"")},Object(a.createElement)(u.SelectControl,{value:s,className:"bwf_w_full",options:[{value:"daymonth",label:Object(l.__)("Use Day & Month","wp-marketing-automations")},{value:"daymonthyear",label:Object(l.__)("Use Full Date","wp-marketing-automations")}],onChange:function(e){return fe(Et(Et({},be),{},{occurrence:e}))}})))),Object(a.createElement)("div",{className:"bwf-sidebar-hint"},Object(l.__)("Note: If key value is not present it will run immediately.","wp-marketing-automations"),"daymonth"===s&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("br",null),Object(l.__)("It will pick the day and month from the selected field value and if the time is older than the current time it will increase by one year.","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(a.createElement)("div",{className:"bwf-delay-select-field-time bwf-w-210"},Object(a.createElement)("input",{type:"time",value:t.time,className:"bwf-w-210 bwf-h-36",onChange:function(e){fe(Et(Et({},be),{},{variable_field:Et(Et({},be.variable_field),{},{time:e.target.value})}))}})),Object(a.createElement)("div",{className:"bwf-delay-select-field-timezone bwf-w-210"},Object(a.createElement)(u.CheckboxControl,{checked:t.in_contact_timezone,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(e){fe(Et(Et({},be),{},{variable_field:Et(Et({},be.variable_field),{},{in_contact_timezone:e})}))}}))))),Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)("div",{className:"bwf-delay-field bwf-delay-sidebar-custom-field"},Object(a.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(a.createElement)("div",{className:"bwf-specific-date "+(Object(d.nb)()?"":"bwf-delay-no-pro")},Object(a.createElement)(u.CheckboxControl,{checked:r,label:Object(l.__)("Delay for certain days from field date","wp-marketing-automations"),onChange:function(e){Object(d.nb)()?fe(Et(Et({},be),{},{enable_time_delay:e})):P("showProModal",!0)}}))),r&&Object(a.createElement)("div",{className:"bwf-pt-0 bwf-pb-0 bwf-delay-sidebar-custom-delay-wrap"},Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(a.createElement)("div",{className:"bwf-delay-duration bwf-w-210 "+(we("custom_field")&&parseInt(o.duration)<0?"has-error":"")},Object(a.createElement)(u.TextControl,{className:"bwf-h-36",type:"number",value:o.duration,onChange:function(e){return fe(Et(Et({},be),{},{time_delay:Et(Et({},be.time_delay),{},{duration:e})}))},min:1,placeholder:Object(l.__)("2","wp-marketing-automations")})),Object(a.createElement)("div",{className:"bwf-delay-type bwf-w-210"},Object(a.createElement)(u.SelectControl,{value:o.type,className:"bwf_w_full",options:[{value:"days",label:Object(l.__)("Days","wp-marketing-automations")},{value:"weeks",label:Object(l.__)("Weeks","wp-marketing-automations")}],onChange:function(e){return fe(Et(Et({},be),{},{time_delay:Et(Et({},be.time_delay),{},{type:e})}))}})),Object(a.createElement)("div",{className:"bwf-delay-timing bwf-w-170"},Object(a.createElement)(u.SelectControl,{value:o.timing,className:"bwf_w_full",options:[{value:"before",label:Object(l.__)("Before","wp-marketing-automations")},{value:"after",label:Object(l.__)("After","wp-marketing-automations")}],onChange:function(e){return fe(Et(Et({},be),{},{time_delay:Et(Et({},be.time_delay),{},{timing:e})}))}}))))),Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(a.createElement)("div",{className:"bwf-specific-date "+(Object(d.nb)()?"":"bwf-delay-no-pro")},Object(a.createElement)(u.CheckboxControl,{checked:b,label:Object(l.__)("Jump to step if time has passed","wp-marketing-automations"),onChange:function(e){Object(d.nb)()?fe(Et(Et({},be),{},{enable_step_skip:e})):P("showProModal",!0)}}))),b&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)("div",{className:"bwf-delay-skip-step-select bwf-delay-field "+(we("variable")&&""==p.step?"has-error":"")},Object(a.createElement)(u.SelectControl,{value:p.step,className:"bwf_w_full",options:y,onChange:function(e){return fe(Et(Et({},be),{},{skip_to_step:Et(Et({},be.skip_to_step),{},{step:e,name:j[e]})}))}}),we("variable")&&""==p.step&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("Please choose the target step if time passes.","wp-marketing-automations"))))),""!==w&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-single-automation-notice is-info"},w)))):Object(a.createElement)(a.Fragment,null));default:return Object(a.createElement)(a.Fragment,null)}var e,t,n,r,c,o,i,s,m,b,f,p,O,j,y,w}(),liteDummyData:{2:Object(a.createElement)("div",{className:"bwf-pl-30 bwf-lite-restrict-section"},Object(a.createElement)("div",{className:"bwf-specific-date-time-delay"},Object(a.createElement)("div",{className:"bwf-specific-date bwf_w_full bwf-h-36 bwf-mt-10"},Object(a.createElement)("div",{className:"bwf-delay-field ",style:{pointerEvents:"none"}},Object(a.createElement)(it.a,{date:null,dateFormat:"MM/DD/YYYY",onUpdate:function(){},text:"",iconRight:!0,disabled:!0}))),Object(a.createElement)("div",{className:"bwf-specific-time bwf_w_full"},Object(a.createElement)("div",{className:"bwf-delay-field "},Object(a.createElement)("input",{type:"time",value:"",disabled:!0,onChange:function(){},className:"bwf-h-36"}))),Object(a.createElement)("div",{className:"bwf-specific-date bwf-w-210 "},Object(a.createElement)(u.CheckboxControl,{checked:!1,disabled:!0,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(){}}))),Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)("div",{className:"bwf-specific-date"},Object(a.createElement)("div",{className:"bwf-specific-date "},Object(a.createElement)(u.CheckboxControl,{checked:!1,disabled:!0,label:Object(l.__)("Jump to step if time has passed","wp-marketing-automations"),onChange:function(){}}))),Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)("div",{className:"bwf-specific-date "},Object(a.createElement)(u.SelectControl,{value:"",disabled:!0,className:"bwf_w_full",options:[],onChange:function(){}})),Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-single-automation-notice is-info no-icon"},Object(a.createElement)("b",null,Object(l.__)("This feature is only for licensed Pro users.","wp-marketing-automations"))," ",Object(a.createElement)("a",{target:"__blank",className:"bwf-a-no-underline",href:Object(d.L)("upgrade",{utm_medium:"Get+PRO+Delay+Step"})},Object(l.__)("Learn More","wp-marketing-automations")))),3:Object(a.createElement)("div",{className:"bwf-pl-30 bwf-lite-restrict-section"},Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-delay-field bwf-delay-select-field-wrap"},Object(a.createElement)("div",{className:"bwf-pt-0 bwf-pb-0"},Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full align-start"},Object(a.createElement)("div",{className:"bwf-delay-field-select bwf-w-210 "},Object(a.createElement)(u.SelectControl,{value:"",className:"bwf_W_full",options:[{label:Object(l.__)("Select","wp-marketing-automations"),value:""}],onChange:function(){},disabled:!0})),Object(a.createElement)("div",{className:"bwf-delay-occurrence bwf-delay-field bwf-w-210 "},Object(a.createElement)(u.SelectControl,{value:"",className:"bwf_w_full",options:[{label:Object(l.__)("Select","wp-marketing-automations"),value:""}],onChange:function(){},disabled:!0}))),Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(a.createElement)("div",{className:"bwf-delay-select-field-time bwf-w-210"},Object(a.createElement)("input",{type:"time",value:"",disabled:!0,className:"bwf-w-210 bwf-h-36",onChange:function(){}})),Object(a.createElement)("div",{className:"bwf-delay-select-field-timezone bwf-w-210"},Object(a.createElement)(u.CheckboxControl,{checked:!1,disabled:!0,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(){}}))))),Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)("div",{className:"bwf-delay-field bwf-delay-sidebar-custom-field"},Object(a.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(a.createElement)("div",{className:"bwf-specific-date "},Object(a.createElement)(u.CheckboxControl,{checked:!1,label:Object(l.__)("Delay for certain days from field date","wp-marketing-automations"),onChange:function(){},disabled:!0}))),Object(a.createElement)("div",{className:"bwf-pt-0 bwf-pb-0 bwf-delay-sidebar-custom-delay-wrap"},Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(a.createElement)("div",{className:"bwf-delay-duration bwf-w-210 "},Object(a.createElement)(u.TextControl,{className:"bwf-h-36",type:"number",disabled:!0,value:"",onChange:function(){},min:1,placeholder:Object(l.__)("Enter","wp-marketing-automations")})),Object(a.createElement)("div",{className:"bwf-delay-type bwf-w-210"},Object(a.createElement)(u.SelectControl,{value:"",className:"bwf_w_full",options:[{label:Object(l.__)("Select","wp-marketing-automations"),value:""}],onChange:function(){},disabled:!0})),Object(a.createElement)("div",{className:"bwf-delay-timing bwf-w-170"},Object(a.createElement)(u.SelectControl,{value:"",disabled:!0,className:"bwf_w_full",options:[],onChange:function(){}}))))),Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(a.createElement)("div",{className:"bwf-specific-date "},Object(a.createElement)(u.CheckboxControl,{checked:!1,label:Object(l.__)("Jump to step if time has passed","wp-marketing-automations"),disabled:!0,onChange:function(){}}))),Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-single-automation-notice is-info no-icon"},Object(a.createElement)("b",null,Object(l.__)("This feature is only for licensed Pro users.","wp-marketing-automations"))," ",Object(a.createElement)("a",{target:"__blank",className:"bwf-a-no-underline",href:Object(d.L)("upgrade",{utm_medium:"Get+PRO+Delay+Step"})},Object(l.__)("Learn More","wp-marketing-automations"))))}}),w&&Object(a.createElement)("div",{className:"bwf-single-automation-notice"},Object(l.__)("There can be contacts queued at this step, new settings will apply to all of them.","wp-marketing-automations")))),Object(a.createElement)("div",{className:"wr_footer"},Object(a.createElement)(u.Button,{isTertiary:!0,onClick:function(){return k(!1)}},Object(l.__)("Cancel","wp-marketing-automations")),Object(a.createElement)(u.Button,{isPrimary:!0,onClick:Oe,isBusy:x},Object(l.__)("Save","wp-marketing-automations"))))};n(1106);function At(){return(At=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var xt=function(e){var t=e.type,n=void 0===t?"text":t,r=e.value,c=e.onFilterChange,o=e.extraProps,i=void 0===o?{}:o,l=Object(a.useContext)(d.b),s=function(){return!!(l&&l.hasOwnProperty("errorList")&&l.errorList&&""==r)};return Object(a.createElement)("div",{className:"bwf-filters-type bwf-filters-type-text "+(s()?"has-error ":"")},Object(a.createElement)(u.TextControl,At({type:n,className:"bwf-filters-text-input",onChange:c,value:r},i)),s()&&Object(a.createElement)("div",{className:"has-bwfan-error"},"This is a required field"))},Dt=function(e){var t=e.value,n=e.onFilterChange,r=e.options,c=Object(a.useContext)(d.b),o=function(){return!!(c&&c.hasOwnProperty("errorList")&&c.errorList&&""==t)};return Object(a.createElement)("div",{className:"bwf-filters-type bwf-filters-type-text "+(o()?"has-error ":"")},Object(a.createElement)(u.SelectControl,{classname:"bwf-filters-select-input",onChange:n,options:r,value:t}),o()&&Object(a.createElement)("div",{className:"has-bwfan-error"},"This is a required field"))};function It(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?It(Object(n),!0).forEach((function(t){Mt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):It(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Mt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ft(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Lt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Lt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Rt=function(e){var t=e.value,n=e.onFilterChange,r=e.rule,o=Object(a.useContext)(d.b),i=Ft(Object(a.useState)(!1),2),l=i[0],s=i[1],u=function(e){n(e)};Object(a.useEffect)((function(){s(!0)}),[]),Object(a.useEffect)((function(){l&&n("between"===r?{to:"",from:""}:"")}),[r]);var m=function(){return!!(o&&o.hasOwnProperty("errorList")&&o.errorList&&("between"!==r&&""==t||"between"===r&&(""==t.to||""==t.from)))};return Object(a.createElement)("div",{className:"bwf-filters-type bwf-filters-type-date bwf-rule-"+r+"  "+("between"!==r&&m()?"has-error ":"")},"between"==r?Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:m()&&""==t.from?"has-error ":""},Object(a.createElement)(it.a,{className:"bwf-filters-date-input",date:Object(c.isEmpty)(t)||!t.hasOwnProperty("from")||Object(c.isEmpty)(t.from)?"":de()(t.from),dateFormat:"MM/DD/YYYY",onUpdate:function(e){return u(Tt(Tt({},t),{},{from:e.text}))},text:t.hasOwnProperty("from")?t.from:"",iconRight:!0}),m()&&""==t.from&&Object(a.createElement)("div",{className:"has-bwfan-error"},"This is a required field")),Object(a.createElement)("span",null,"and"),Object(a.createElement)("div",{className:m()&&""==t.to?"has-error ":""},Object(a.createElement)(it.a,{className:"bwf-filters-date-input",date:Object(c.isEmpty)(t)||!t.hasOwnProperty("to")||Object(c.isEmpty)(t.to)?"":de()(t.to),dateFormat:"MM/DD/YYYY",onUpdate:function(e){return u(Tt(Tt({},t),{},{to:e.text}))},text:t.hasOwnProperty("to")?t.to:"",iconRight:!0}),m()&&""==t.to&&Object(a.createElement)("div",{className:"has-bwfan-error"},"This is a required field"))):Object(a.createElement)(a.Fragment,null,Object(a.createElement)(it.a,{className:"bwf-filters-date-input",date:Object(c.isEmpty)(t)?"":de()(t),dateFormat:"MM/DD/YYYY",onUpdate:function(e){return u(e.text)},text:t,iconRight:!0}),m()&&Object(a.createElement)("div",{className:"has-bwfan-error"},"This is a required field")))},zt=n(27);function qt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Bt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Ut=function(e){var t=e.type,n=e.value,r=void 0===n?[]:n,o=e.onFilterChange,i=e.emptySearch,l=void 0!==i&&i,s=e.rule,u=void 0===s?"":s,m=Object(a.useContext)(d.b),b=qt(Object(a.useState)(u),2),f=b[0],p=b[1];Object(a.useEffect)((function(){["contains","not_contains"].includes(u)!==["contains","not_contains"].includes(f)&&o([]),p(u)}),[u]);var O=function(){return!!(m&&m.hasOwnProperty("errorList")&&m.errorList&&(""==r||Array.isArray(r)&&Object(c.isEmpty)(r)))};return Object(a.createElement)("div",{className:"bwf-filters-type "+(O()?"has-error ":"")},Object(a.createElement)(zt.a,{className:"bwf-filters-search-input",onChange:o,autocompleter:t,placeholder:"Search",onRemoveTag:function(e,t){var n=r.filter((function(n){return!(n.key==e&&n.label==t)}));o(n)},selected:r,inlineTags:!1,showClearButton:!0,bwfEnableEmptySearch:l,allowFreeTextSearch:["contains","not_contains"].includes(u)}),O()&&Object(a.createElement)("div",{className:"has-bwfan-error"},"This is a required field"))};function Ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ht(Object(n),!0).forEach((function(t){$t(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Yt=function(e){var t=e.type,n=e.value,r=void 0===n?{}:n,o=e.value,i=e.onFilterChange,l=r.search,s=void 0===l?[]:l,m=r.qty,b=void 0===m?0:m,f=Object(a.useContext)(d.b);Object(a.useEffect)((function(){i(o)}),[]);var p=function(e){if(f&&f.hasOwnProperty("errorList")&&f.errorList)switch(e){case"qty":if(!o.hasOwnProperty(e)||!parseInt(o.qty)>0)return!0;break;case"search":if(!o.hasOwnProperty(e)||""==o[e]||Array.isArray(o[e])&&Object(c.isEmpty)(o[e])||null==o[e]||Object(c.isEmpty)(o[e]))return!0}return!1};return Object(a.createElement)("div",{className:"bwf-product-qty-wrapper"},Object(a.createElement)("div",{className:"bwf-filters-type "+(p("qty")?"has-error ":"")},Object(a.createElement)(u.TextControl,{type:"number",value:b,onChange:function(e){return i(Vt(Vt({},o),{},{qty:e}))},className:"bwf-product-qty-text",min:1}),p("qty")&&Object(a.createElement)("div",{className:"has-bwfan-error"},"This is a required field")),Object(a.createElement)("div",{className:"bwf-filters-type "+(p("search")?"has-error ":"")},Object(a.createElement)(zt.a,{className:"bwf-filters-search-input",onChange:function(e){return i(Vt(Vt({},o),{},{search:e}))},autocompleter:t,placeholder:"Search",onRemoveTag:function(e){var t=o.search.filter((function(t){return t.key!=e}));i(Vt(Vt({},o),{},{search:t}))},selected:s,inlineTags:!0,showClearButton:!0,bwfMaintainSingleTerm:!0}),!p("qty")&&p("search")&&Object(a.createElement)("div",{className:"has-bwfan-error"},"This is a required field")))};function Gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Jt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gt(Object(n),!0).forEach((function(t){Qt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Wt=function(e){var t=e.value,n=void 0===t?[]:t,r=e.onFilterChange,o=e.options,i=void 0===o?[]:o,l=e.rule,s=e.rules,m=e.setFilterData,b=e.label,f=e.fieldData,p=Object(a.useContext)(d.b),O=function(e){return!!(p&&p.hasOwnProperty("errorList")&&p.errorList&&(!n.hasOwnProperty(e)||""==n[e]||Array.isArray(n[e])&&Object(c.isEmpty)(n[e])||null==n[e]||Object(c.isEmpty)(n[e])))};return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-custom-filter-rules"},Object(a.createElement)("div",{className:"bwf-custom-filter-label"},Object(a.createElement)("b",null," ",b," ")),Object(a.createElement)("div",{className:"bwf-filters-type "+(O(0)?"has-error ":"")},Array.isArray(i)&&i.length>0?Object(a.createElement)(u.SelectControl,{className:"bwf-key-value-key-select",options:i,onChange:function(e){return r([e,n[1]])},value:n.length?n[0]:""}):Object(a.createElement)(u.TextControl,{type:"text",onChange:function(e){return r([e,n[1]])},className:"bwf-key-value-key-text",value:n.length?n[0]:""}),O(0)&&Object(a.createElement)("div",{className:"has-bwfan-error"},"This is a required field"))),Object(a.createElement)("div",{className:"bwf-custom-filter-input"},Object(a.createElement)("div",{className:"bwf-custom-filter-label"},Object(a.createElement)("b",null,"Operator"),!["is_blank","is_not_blank"].includes(l)&&Object(a.createElement)("b",null,"Value")),Object(a.createElement)("div",{className:"bwf-product-qty-wrapper "},Object(a.createElement)(u.SelectControl,{className:"bwf-custom-filter-rule-select",options:s,value:l||"",onChange:function(e){m(Jt(Jt({},f),{},{rule:e}))}}),["is_blank","is_not_blank"].includes(l)?Object(a.createElement)("div",null):Object(a.createElement)("div",{className:"bwf-filters-type "+(O(1)?"has-error ":"")},Object(a.createElement)(u.TextControl,{type:"text",onChange:function(e){return r([n[0],e])},className:"bwf-key-value-value-text",value:n.length&&n.length>1?n[1]:""}),!O(0)&&O(1)&&Object(a.createElement)("div",{className:"has-bwfan-error"},"This is a required field")))))},Xt=n(49);function Zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zt(Object(n),!0).forEach((function(t){en(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function en(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return nn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var an=function(e){var t=e.value,n=e.onFilterChange,r=e.rule,o=Object(a.useContext)(d.b),i=tn(Object(a.useState)(!1),2),l=i[0],s=i[1],u=function(e){n(e)};Object(a.useEffect)((function(){s(!0)}),[]),Object(a.useEffect)((function(){l&&n("between"===r?{to:"",from:""}:"")}),[r]);var m=function(){return!!(o&&o.hasOwnProperty("errorList")&&o.errorList&&("between"!==r&&""==t||"between"===r&&(""==t.to||""==t.from)))};return Object(a.createElement)("div",{className:"bwf-filters-type bwf-filters-type-days bwf-rule-"+r+"  "+("between"!==r&&m()?"has-error ":"")},"between"==r?Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:m()&&""==t.from?"has-error ":""},Object(a.createElement)(Xt.a,{className:"bwf-filters-day-input",value:Object(c.isEmpty)(t)||!t.hasOwnProperty("from")||Object(c.isEmpty)(t.from)?"":t.from,type:"number",suffix:"days",onChange:function(e){return u(Kt(Kt({},t),{},{from:e}))}}),m()&&""==t.from&&Object(a.createElement)("div",{className:"has-bwfan-error"},"This is a required field")),Object(a.createElement)("span",null,"to"),Object(a.createElement)("div",{className:m()&&""==t.to?"has-error ":""},Object(a.createElement)(Xt.a,{className:"bwf-filters-day-input",value:Object(c.isEmpty)(t)||!t.hasOwnProperty("to")||Object(c.isEmpty)(t.to)?"":t.to,type:"number",suffix:"days",onChange:function(e){return u(Kt(Kt({},t),{},{to:e}))}}),m()&&""==t.to&&Object(a.createElement)("div",{className:"has-bwfan-error"},"This is a required field"))):Object(a.createElement)(a.Fragment,null,Object(a.createElement)(Xt.a,{className:"bwf-filters-day-input",value:Object(c.isEmpty)(t)?"":t,type:"number",suffix:"days",onChange:function(e){return u(e)}}),m()&&Object(a.createElement)("div",{className:"has-bwfan-error"},"This is a required field")))},rn=n(19),cn=(n(1107),n(44)),on=n(51);function ln(e){return function(e){if(Array.isArray(e))return mn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||un(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||un(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function un(e,t){if(e){if("string"==typeof e)return mn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mn(e,t):void 0}}function mn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function bn(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var dn=null,fn=Object(rn.compose)([rn.withInstanceId])((function(e){e.label;var t=e.className,n=e.selected,r=void 0===n?[]:n,o=e.options,m=void 0===o?[]:o,b=e.multiple,f=void 0!==b&&b,p=e.onBlur,O=(void 0===p&&c.noop,e.onChange),j=void 0===O?c.noop:O,y=e.onSearch,w=void 0===y?c.noop:y,v=e.onFocus,g=(void 0===v&&c.noop,e.optionKey,e.isLoading),E=void 0===g||g,h=(e.optionLabel,e.placeholder),_=void 0===h?Object(l.__)("Select"):h,N=e.searchPlaceholder,k=void 0===N?Object(l.__)("Search…"):N,C=bn(e,["label","className","selected","options","multiple","onBlur","onChange","onSearch","onFocus","optionKey","isLoading","optionLabel","placeholder","searchPlaceholder"]),P=sn(Object(a.useState)(!1),2),S=P[0],A=P[1],x=sn(Object(a.useState)(""),2),D=x[0],I=x[1],T=sn(Object(a.useState)({}),2),M=T[0],F=T[1],L=C.instanceId,R="inspector-searchlist-".concat(L),z=Object(a.useRef)(),q=i()("bwf-searchlist-component",t);Object(d.Lb)(z,(function(){return A(!1)})),Object(a.useEffect)((function(){clearTimeout(dn),dn=setTimeout((function(){w(D)}),400)}),[D]),Object(a.useEffect)((function(){return(z.current.closest(".components-modal__screen-overlay")||z.current.closest(".wr-expanded "))&&(U(),window.addEventListener("resize",B),window.addEventListener("scroll",B)),function(){window.removeEventListener("resize",B),window.removeEventListener("scroll",B)}}),[]);var B=function(){var e;clearTimeout(e),e=setTimeout((function(){U()}),0)},U=function(){var e,t,n=0,a="350px",r="unset";if(z&&z.current){var c=z.current.getBoundingClientRect(),o=c.x,i=c.bottom,l=c.width,s=c.y;if(0>i)return void F({});var u=window.innerHeight,m=u-i-10;t="".concat(o,"px"),n="".concat(l,"px"),e="".concat(i+6,"px"),250<m?a=350<m?"350px":"".concat(m,"px"):(a=350<s?"330px":"".concat(s-30,"px"),e="unset",r="".concat(u-s+20,"px"))}F({top:e,left:t,bottom:r,width:n,maxHeight:a,position:"fixed",right:"unset",zIndex:1e8,overflowY:"auto"})},H=function(e){var t=Object(c.findIndex)(r,{id:e});j([].concat(ln(r.slice(0,t)),ln(r.slice(t+1))))},V=Object(a.useCallback)((function(){var e="";return Object(a.createElement)(a.Fragment,null,m.map((function(t,n){var o=t.id,i=t.name,l=t.title;if(-1!==Object(c.findIndex)(r,{id:o}))return Object(a.createElement)("span",{key:n});var s=e!==l;return e=l,Object(a.createElement)("div",{className:"bwf-searchlist-option",key:n},l&&s&&Object(a.createElement)("div",{className:"bwf-searchlist-option-parent"},l),Object(a.createElement)("div",{className:"bwf-searchlist-option-label",onClick:function(){return function(e){if(A(!1),e.hasOwnProperty("id")&&e.hasOwnProperty("name")){var t=ln(r);f?t.push({id:e.id,name:e.name}):t=[{id:e.id,name:e.name}],j(t)}}(t)}},i))})))}),[m]);return Object(a.createElement)(u.BaseControl,{className:q,id:R},Object(a.createElement)("div",{className:"bwf-searchlist-field",ref:z},Object(a.createElement)("div",{className:i()("bwf-searchlist-controller"),onClick:function(){return A(!0)}},Object(a.createElement)("span",{className:"bwf-searchlist-selected"},_),Object(a.createElement)(s.a,{icon:S?"tailless-arrow-up":"tailless-arrow-down",width:"20",height:"20"})),!Object(c.isEmpty)(r)&&Object(a.createElement)("div",{className:"bwf-searchlist-values"},Object(a.createElement)(a.Fragment,null,r.map((function(e,t){return Object(a.createElement)(on.a,{key:t,id:e.id,label:e.name,remove:H})})))),S&&Object(a.createElement)("div",{className:"bwf-searchlist-popup",style:M},Object(a.createElement)("div",{className:"bwf-searchlist-search-field"},Object(a.createElement)(s.a,{icon:"search",size:18}),Object(a.createElement)("input",{className:"bwf-searchlist-search-field__input",type:"search",placeholder:k,onChange:function(e){return I(e.target.value)},autoComplete:"off",value:D||""})),Object(a.createElement)("div",{className:"bwf-searchlist-options"},E?Object(a.createElement)(cn.a,{size:"xl"}):Object(c.isEmpty)(m)?Object(a.createElement)("div",{className:"bwf-searchlist-option-none"},Object(c.isEmpty)(D)||E?"":Object(l.__)("Not Found")):Object(a.createElement)("div",{className:"bwf-searchlist-option-item"},V())))))}));function pn(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function On(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return jn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var yn=function(e){var t=e.value,n=void 0===t?[]:t,r=e.onFilterChange,o=(e.rule,e.input),i=On(Object(a.useState)(!1),2),l=i[0],s=i[1],u=On(Object(a.useState)([]),2),m=u[0],b=u[1],f=o.apiPath,O=void 0===f?"":f,j=o.multiple,y=void 0!==j&&j,w=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,n,a,r=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:"",e.prev=1,s(!0),n="",Object(c.isEmpty)(t)||(n=t),e.next=7,p()({path:Object(d.m)("/automation/rules/".concat(O,"/suggestions?search=")+n),method:"GET"});case 7:a=e.sent,s(!1),Object(c.isEmpty)(a)||!a.hasOwnProperty("result")||Object(c.isEmpty)(a.result)?b([]):b(a.result),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),s(!1),console.log("Failed to load:",e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){pn(c,a,r,o,i,"next",e)}function i(e){pn(c,a,r,o,i,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}();return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(fn,{selected:n,onChange:r,onSearch:w,multiple:y,isLoading:l,options:m}))};function wn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function vn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wn(Object(n),!0).forEach((function(t){gn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var En=function(e){var t=e.filter,n=e.value,r=e.setFilterData,o=e.removeFilter,i=t.rules,l=void 0===i?[]:i,m=t.labels,b=t.input,d=m.label,f=void 0===d?"":d,p=m.valueLabel,O=void 0===p?"":p,j=n.rule,y=void 0===j?"":j,w=n.data,v=void 0===w?"":w,g=function(e){r(vn(vn({},n),{},{data:e}))};Object(a.useEffect)((function(){var e={};n.hasOwnProperty("data")&&Object(c.isEmpty)(n.data)&&(b.hasOwnProperty("default")&&""!==b.default&&(e.data=b.default),"product-qty"==b.component.toLowerCase()&&(e.data={search:[],qty:1}),["key-value","selectcontrol"].includes(b.component.toLowerCase())&&b.hasOwnProperty("options")&&!Object(c.isEmpty)(b.options)&&Array.isArray(b.options)&&b.options.length>0&&b.options[0].hasOwnProperty("value")&&Object(c.isEmpty)(e.data)&&("key-value"==b.component.toLowerCase()?e.data=[b.options[0].value,""]:e.data=b.options[0].value),Object(c.isEmpty)(y)&&!Object(c.isEmpty)(l)&&(e.rule=l[0].value)),Object(c.isEmpty)(e)||r(vn(vn({},n),e))}),[]);var E=function(){if(["is_blank","is_not_blank"].includes(y)&&"key-value"!==b.component.toLowerCase())return Object(a.createElement)(a.Fragment,null);switch(b.component.toLowerCase()){case"text":return Object(a.createElement)(xt,{value:v,onFilterChange:g,extraProps:b.extraProps});case"number":return Object(a.createElement)(xt,{type:"number",value:v,onFilterChange:g,extraProps:b.extraProps});case"selectcontrol":return Object(a.createElement)(Dt,{value:v,options:b.options,onFilterChange:g});case"key-value":return Object(a.createElement)(Wt,{value:v,fieldData:n,options:b.options?b.options:[],onFilterChange:g,setFilterData:r,rules:l,rule:y,label:f});case"date":return Object(a.createElement)(Rt,{value:v,onFilterChange:g,rule:y,input:b});case"search":return Object(a.createElement)(Ut,{type:b.type,value:Object(c.isEmpty)(v)?[]:v,onFilterChange:g,emptySearch:!!b.emptySearch,rule:y});case"product-qty":return Object(a.createElement)(Yt,{type:b.type,value:Object(c.isEmpty)(v)?{}:v,onFilterChange:g});case"days":return Object(a.createElement)(an,{value:v,onFilterChange:g,rule:y});case"search-list":return Object(a.createElement)(yn,{value:v,onFilterChange:g,rule:y,input:b});default:return Object(a.createElement)(a.Fragment,null,"No input")}};return Object(a.createElement)("div",{className:"bwf-custom-advance-filter-item"},!Object(c.isEmpty)(l)&&"key-value"!==b.component.toLowerCase()&&Object(a.createElement)("div",{className:"bwf-custom-filter-rules"},Object(a.createElement)("div",{className:"bwf-custom-filter-label"},Object(a.createElement)("b",null,f)),Object(a.createElement)(u.SelectControl,{className:"bwf-custom-filter-rule-select",options:l,value:y,onChange:function(e){r(vn(vn({},n),{},{rule:e}))}})),"key-value"!==b.component.toLowerCase()?Object(a.createElement)("div",{className:"bwf-custom-filter-input"},Object(a.createElement)("div",{className:"bwf-custom-filter-label"},"product-qty"===b.component.toLowerCase()&&Object(a.createElement)("b",null,"Quantity"),!["is_blank","is_not_blank"].includes(y)&&Object(a.createElement)("b",null," ",Object(c.isEmpty)(l)?f:O)),E()):E(),Object(a.createElement)("div",{className:"bwf-filter-action-buttons"},Object(a.createElement)("div",{className:"bwf-custom-filter-remove",onClick:o},Object(a.createElement)(s.a,{icon:"trash",color:"#353030"}))))};function hn(e){return function(e){if(Array.isArray(e))return kn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Nn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||Nn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nn(e,t){if(e){if("string"==typeof e)return kn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kn(e,t):void 0}}function kn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Cn=function(e){var t=e.filters,n=void 0===t?{}:t,r=e.value,o=void 0===r?[]:r,i=e.setValue,s=e.groupingEnabled,m=void 0!==s&&s,b=_n(Object(a.useState)(""),2),d=b[0],f=b[1];if(Object(c.isEmpty)(n))return Object(a.createElement)(a.Fragment,null);var p=function(){return Object(a.createElement)("ul",{className:"bwf-popover-container bwf-group"},Object(a.createElement)("li",{className:"list-label"},Object(l.__)("Select Group","wp-marketing-automations")),function(){var e=[],t=[];Object.entries(n).map((function(n){var a=_n(n,2),r=(a[0],a[1]);e.includes(r.group)||(e.push(r.group),t.push({priority:r.priority?r.priority:0,key:r.group,label:r.groupLabel}))}));return t.sort((function(e,t){return e.priority-t.priority})),t}().map((function(e,t){return Object(a.createElement)("li",{className:"list-values has-pointer",onClick:function(){return f(e.key)},key:t},e.label)})))},O=function(e){var t,r=e.onToggle;return Object(a.createElement)("ul",{className:"bwf-popover-container bwf-filters"},Object(a.createElement)("li",{className:"list-label list-values has-pointer is-back-button",onClick:function(){return f("")}},Object(l.__)("Back")),(t=[],Object.entries(n).map((function(e){var n=_n(e,2),a=n[0],r=n[1];(Object(c.isEmpty)(d)||d===r.group)&&t.push({key:a,label:r.labels.add})})),t).map((function(e,t){return Object(a.createElement)("li",{className:"list-values has-pointer",onClick:function(){var t=hn(o);t.push({filter:e.key,rule:"",data:""}),i(t),r()},key:t},e.label)})))};return Object(a.createElement)("div",{className:"bwf-custom-advance-filter-wrapper"},!Object(c.isEmpty)(o)&&Object(a.createElement)("div",{className:"bwf-advance-filter-value-section"},o.map((function(e,t){return!!n.hasOwnProperty(e.filter)&&Object(a.createElement)("div",{key:t},Object(a.createElement)(En,{filter:n[e.filter],value:e,setFilterData:function(e){var n=hn(o);n[t]=e,i(n)},removeFilter:function(){var e=hn(o);e.splice(t,1),i(e)},keyIndex:t}))}))),Object(a.createElement)(F.a,{className:"bwf-advance-filter-add-dropdown",position:"bottom center",focusOnMount:!0,renderToggle:function(e){var t=e.onToggle;return Object(a.createElement)("div",{className:"bwf-advance-filter-add-button",onClick:function(){f(""),t()}},Object(a.createElement)(u.Button,{className:"bwf-conditional-btn conditional-and",isSecondary:!0},Object(l.__)("AND","wp-marketing-automations")))},renderContent:function(e){return Object(a.createElement)(a.Fragment,null,m&&Object(c.isEmpty)(d)?p():O(e))}}))},Pn=n(70);function Sn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function An(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sn(Object(n),!0).forEach((function(t){xn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dn(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function In(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Tn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Tn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Mn=function(){var e=Object(a.useContext)(d.d),t=In(Object(a.useState)(""),2),n=(t[0],t[1]),r=In(Object(a.useState)(!1),2),o=r[0],i=r[1],f=In(Object(a.useState)(!1),2),O=f[0],j=f[1],y=In(Object(a.useState)(!1),2),w=y[0],v=y[1],g=In(Object(a.useState)(""),2),E=g[0],h=g[1];Object(a.useEffect)((function(){i(!1)}),[]);var _,N,k=Object(m.a)(),C=k.showSidebar,P=k.setNodeDatabyId,S=k.setAutomationData,A=Object(b.a)(),x=A.getSidebarNodeData,D=A.getAutomationId,I=A.getNodeDataByID,T=A.getAutomationLinks,M=A.getAutomationSteps,F=A.getCount,L=A.getAutomationData,R=M(),z=T(),q=F(),U=x(),H=D(),V=L(),$=V&&V.event?V.event:"",Y=Object(B.a)($,parseInt(H)),G=(Y.isLoading,Y.error,Y.rules),J=!Object(c.isEmpty)(U)&&U.hasOwnProperty("data")?U.data:{},Q=!Object(c.isEmpty)(J)&&J.hasOwnProperty("sidebarValues")?(_=J.sidebarValues,N=[],Object(c.isEmpty)(_)?[]:(Object.keys(_).map((function(e){var t=_[e],n=[];t.map((function(e){G.hasOwnProperty(e.filter)&&n.push(e)})),Object(c.isEmpty)(n)||N.push(n)})),N)):[],W=!Object(c.isEmpty)(U)&&U.hasOwnProperty("id")?I(U.id):{},X=W.stepId,Z=void 0===X?0:X,K=W.data,ee=(void 0===K?{}:K).sidebarValues,te=function(){var t,a=(t=regeneratorRuntime.mark((function t(){var a,r,o,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=Object(c.cloneDeep)(J.sidebarValues),r=[],o=!1,Object(c.isEmpty)(a)||a.map((function(e){Object(c.isEmpty)(e)||(r.push(e),e.map((function(e){var t;(t=e).hasOwnProperty("rule")&&["is_blank","is_not_blank"].includes(t.rule)||!(!t.hasOwnProperty("data")||""==t.data||null==t.data||Array.isArray(t.data)&&Object(c.isEmpty)(t.data)||G&&G.hasOwnProperty(t.filter)&&"key-value"==G[t.filter].input.component&&(""==t.data[0]||null==t.data[0]||Array.isArray(t.data[1])&&Object(c.isEmpty)(t.data[1])||""==t.data[1]||null==t.data[1]||Array.isArray(t.data[1])&&Object(c.isEmpty)(t.data[1]))||G&&G.hasOwnProperty(t.filter)&&["Date","Days"].includes(G[t.filter].input.component)&&"between"===t.rule&&(!t.data.hasOwnProperty("to")||!t.data.hasOwnProperty("from")||Object(c.isEmpty)(t.data.to)||Object(c.isEmpty)(t.data.from)))||(i(!0),o=!0,n("Some condition(s) are empty please remove them or fill them."))})))})),Object(c.isEmpty)(r)||o){t.next=23;break}if(!Object(c.isEqual)(ee,r)){t.next=9;break}return C(!1),j(!1),t.abrupt("return");case 9:return j(!0),l={data:{data:{sidebarData:r}},steps:Object(c.cloneDeep)(R).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:z,count:q},t.prev=11,t.next=14,p()({path:Object(d.m)("/automation/".concat(H,"/step/").concat(Z)),method:"POST",data:l}).then((function(t){if(200!==t.code)throw Error(Object(d.j)(null==t?void 0:t.message));e(t.message),J.sidebarValues=r,P(U.id,J,{step_status:1}),setTimeout((function(){C(!1)}),100),j(!1)})).catch((function(e){throw Error(Object(d.j)(null==e?void 0:e.message))}));case 14:t.next=20;break;case 16:t.prev=16,t.t0=t.catch(11),S("modalData",{status:!0,modalTitle:"Update Condition",error:null===t.t0||void 0===t.t0?void 0:t.t0.message}),j(!1);case 20:Object(d.gb)(e,1e3),t.next=24;break;case 23:!o&&n("Please select conditions to save.");case 24:case"end":return t.stop()}}),t,null,[[11,16]])})),function(){var e=this,n=arguments;return new Promise((function(a,r){var c=t.apply(e,n);function o(e){Dn(c,a,r,o,i,"next",e)}function i(e){Dn(c,a,r,o,i,"throw",e)}o(void 0)}))});return function(){return a.apply(this,arguments)}}(),ne=Object(a.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Object.keys(Q).length,n=Object(c.cloneDeep)(Q);n[t]=[e];var a=An(An({},U),{},{data:An(An({},J),{},{sidebarValues:n})});S("sidebarNodeData",a),setTimeout((function(){h(""),v(!1)}),1)}),[Q]),ae=(Object(a.useCallback)((function(e){var t=An({},Q);delete t[e];var n=An(An({},U),{},{data:An(An({},J),{},{sidebarValues:t})});S("sidebarNodeData",n)}),[Q]),function(){return Object(a.createElement)("ul",{className:"bwf-popover-container bwf-group"},Object(a.createElement)("li",{className:"list-label"}," ",Object(l.__)("Select Group")),function(){var e=[],t=[];Object.entries(G).map((function(n){var a=In(n,2),r=(a[0],a[1]);e.includes(r.group)||(e.push(r.group),t.push({priority:r.priority?r.priority:0,key:r.group,label:r.groupLabel}))}));return t.sort((function(e,t){return e.priority-t.priority})),t}().map((function(e,t){return Object(a.createElement)("li",{className:"list-values has-pointer",onClick:function(){return h(e.key)},key:t},e.label)})))}),re=function(){return Object(a.createElement)("ul",{className:"bwf-popover-container bwf-filters"},Object(a.createElement)("li",{className:"list-label list-values has-pointer is-back-button",onClick:function(){return h("")}},Object(l.__)("Back")),(e=[],Object.entries(G).map((function(t){var n=In(t,2),a=n[0],r=n[1];(Object(c.isEmpty)(E)||E===r.group)&&e.push({key:a,label:r.labels.add})})),e).map((function(e,t){return Object(a.createElement)("li",{className:"list-values has-pointer",onClick:function(){ne({filter:e.key,rule:"",data:""})},key:t},e.label)})));var e},ce=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=e?"bwf-sidebar-empty-placeholder ":"";return Object(a.createElement)("div",{className:t},e&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-main-icon"},Object(a.createElement)(s.a,{icon:"conditional-placeholder",size:90})),Object(a.createElement)("div",{className:"bwf-h2"},Object(l.__)("No Condition","wp-marketing-automations-crm")),Object(a.createElement)("div",{className:"bwf-h4 bwf-h4-grey"},Object(l.__)("Add a condition to segment and make contacts flow to different branches","wp-marketing-automations-crm"))),e&&Object(a.createElement)("div",{className:"bwf_clear_20"}),!Object(c.isEmpty)(G)&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)(u.Button,{isPrimary:!0,className:e?"":"bwf-conditional-btn conditional-or",onClick:function(){return v(!0)},style:e?{}:{margin:"-38px 0px 0px 62px",position:"absolute"}},e?Object(l.__)("Add New Condition","wp-marketing-automations-crm"):Object(l.__)("OR","wp-marketing-automations-crm"),w&&Object(a.createElement)(Pn.a,{className:"bwf-conditioal-group-popup "+(e?"":"bwf-conditional-or"),focusOnMount:!0,onFocusOutside:function(){return v(!1)},onClose:function(){return v(!1)}},Object(c.isEmpty)(E)?ae():re())),e&&Object(a.createElement)("div",{className:"bwf_clear_20"})))};return Object(a.createElement)(d.b.Provider,{value:{errorList:o,setErrorList:i,stepId:Z}},Object(a.createElement)("div",{className:"wr_header"},Object(a.createElement)("div",{className:"bwf-node-icon"},Object(a.createElement)(s.a,{size:26,icon:"condition"})),Object(a.createElement)("div",{className:"wr_event_title"},Object(l.__)("Condition","wp-marketing-automations-crm")),Object(a.createElement)("div",{className:"wr_event_variant"}),Object(a.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){C(!1)}},Object(a.createElement)(s.a,{icon:"close"}))),Object(a.createElement)("div",{className:"wr_content wr-conditioal-sidebar"},Object(c.isEmpty)(Q)||Object(c.isEmpty)(G)?Object(a.createElement)(a.Fragment,null,ce()):Object(a.createElement)(a.Fragment,null,Object.keys(Q).map((function(e,t){return Object(a.createElement)("div",{className:"bwf-conditional-wrap",key:t},Object(a.createElement)(Cn,{key:e,filters:G,groupingEnabled:!0,value:Q[e],setValue:function(t){var n=Object(c.cloneDeep)(Q);n[e]=t,n=n.filter((function(e){return 0!==Object.keys(e).length}));var a=An(An({},U),{},{data:An(An({},J),{},{sidebarValues:n})});S("sidebarNodeData",a)}}),t+1!==Object.keys(Q).length&&Object(a.createElement)("div",{className:"bwf-conditional-rules-label-or"},Object(a.createElement)("span",{className:"bwf-line"}),Object(a.createElement)("span",{className:"bwf-rule-text"},Object(l.__)("OR","wp-marketing-automations-crm"))))})),ce(!1))),Object(a.createElement)("div",{className:"wr_footer"},Object(a.createElement)(u.Button,{isTertiary:!0,onClick:function(){return C(!1)}},Object(l.__)("Cancel")),Object(a.createElement)(u.Button,{isPrimary:!0,onClick:te,isBusy:O},Object(l.__)("Save"))))};function Fn(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function Ln(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ln(Object(n),!0).forEach((function(t){zn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ln(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Bn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Un=function(){var e=Object(a.useContext)(d.d),t=qn(Object(a.useState)(!1),2),n=t[0],r=t[1],o=qn(Object(a.useState)(!1),2),f=o[0],O=o[1],j=qn(Object(a.useState)(!1),2),y=j[0],w=j[1],v=Object(b.a)(),g=v.getSidebarNodeData,E=v.getNodeDataByID,h=v.getAutomationSteps,_=v.getAutomationLinks,N=v.getCount,k=v.getAutomationId,C=v.getGoals,P=Object(m.a)(),S=P.showSidebar,A=P.setNodeDatabyId,x=P.setAutomationData,D=Object(a.useRef)(null),I=qn(Object(a.useState)([]),2),T=I[0],M=I[1],F=g(),L=C().list,R=void 0===L?{}:L,z=F.data,q=F&&F.data&&F.data.benchmark&&R.hasOwnProperty(F.data.benchmark)?R[F.data.benchmark]:{},B=F&&F.data&&F.data.benchmark?F.data.benchmark:"",U=!Object(c.isEmpty)(F.data)&&F.data.hasOwnProperty("sidebarValues")?F.data.sidebarValues:{},H=q.fields,V=void 0===H?[]:H,$=q.default_values,Y=void 0===$?{}:$,G=k(),J=h(),Q=_(),W=N(),X=!Object(c.isEmpty)(F)&&F.hasOwnProperty("id")?E(F.id):{},Z=X.stepId,K=void 0===Z?0:Z,ee=X.data,te=(void 0===ee?{}:ee).sidebarValues;Object(a.useEffect)((function(){M([])}),[]);var ne=Rn(Rn({},Y),U),ae=function(e,t,n){var a=!1,r=t.fields,c=t.relation,o=void 0===c?"OR":c;o=o.toUpperCase();try{var i=null;if("OR"===o){if(r&&Array.isArray(r))for(var l=0;l<r.length;l++){i=e[r[l].id];var s=void 0===r[l].value||r[l].value;if(Array.isArray(s)&&s.includes(i))return!0;if(""!=s&&i==s||""==s&&""!=i&&null!=i)return!0}}else"AND"==o&&r&&Array.isArray(r)&&(a=r.every((function(t){i=e[t.id];var n=void 0===t.value||t.value;return!(!Array.isArray(n)||!n.includes(i))||(""===n||i==n)&&(""!=n||""!=i&&null!=i)})))}catch(e){console.log(e)}return a},re=function(){var t,n=(t=regeneratorRuntime.mark((function t(n){var a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Object(c.isEmpty)(oe(n))){t.next=17;break}if(!Object(c.isEqual)(te,n)){t.next=4;break}return S(!1),t.abrupt("return");case 4:return z.sidebarValues=n,r(!0),a={data:{data:{sidebarData:n}},steps:Object(c.cloneDeep)(J).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:Q,count:W,optionUpdated:f,actionType:3},t.prev=7,t.next=10,p()({path:Object(d.m)("/automation/".concat(G,"/step/").concat(K)),method:"POST",data:a}).then((function(t){if(200!==t.code)throw Error(Object(d.j)(null==t?void 0:t.message));e(t.message);var n="";t.hasOwnProperty("result")&&t.result.hasOwnProperty("desc_text")&&!Object(c.isEmpty)(t.result.desc_text)&&(n=t.result.desc_text),A(F.id,Rn(Rn({},z),{},{desc_text:n}),{step_status:1}),setTimeout((function(){S(!1)}),100),r(!1)})).catch((function(e){throw Error(Object(d.j)(null==e?void 0:e.message))}));case 10:t.next=16;break;case 12:t.prev=12,t.t0=t.catch(7),x("modalData",{status:!0,modalTitle:"Update Goal",error:null===t.t0||void 0===t.t0?void 0:t.t0.message}),r(!1);case 16:Object(d.gb)(e,1e3);case 17:case"end":return t.stop()}}),t,null,[[7,12]])})),function(){var e=this,n=arguments;return new Promise((function(a,r){var c=t.apply(e,n);function o(e){Fn(c,a,r,o,i,"next",e)}function i(e){Fn(c,a,r,o,i,"throw",e)}o(void 0)}))});return function(e){return n.apply(this,arguments)}}(),ce=[];Object(c.isEmpty)(V)||V.forEach((function(e){e.hasOwnProperty("required")&&e.required&&ce.push(e)}));var oe=function(e){var t={};return ce.map((function(n){(!n.hasOwnProperty("toggler")||Object(c.isEmpty)(n.toggler)||ae(e,n.toggler))&&(Array.isArray(e[n.id])&&0===e[n.id].length||""===e[n.id]||void 0===e[n.id])&&(t[n.id]=n.hasOwnProperty("errorMsg")?n.errorMsg:Object(l.__)("This is required field.","wp-marketing-automations")),"bwfan_email_data"===n.id&&(!e.hasOwnProperty("bwfan_email_data")||e.bwfan_email_data.hasOwnProperty("subject")&&Object(c.isEmpty)(e.bwfan_email_data.subject))&&(t[n.id]="error")})),M(t),t};return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"wr_header"},Object(a.createElement)("div",{className:"bwf-node-icon icon-goal"},Object(a.createElement)(s.a,{size:26,icon:"goal"})),Object(a.createElement)("div",{className:"wr_event_title"},q.event_name),Object(a.createElement)("div",{className:"wr_event_variant"},Object(d.nb)()&&!Object(c.isEmpty)(B)&&"crm_link_trigger"===B&&Object(a.createElement)(De.a,{canCreate:!0,isLinkTriggerOpen:y,setLinkTriggerOpen:w,hideButton:!1})),Object(a.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){return S(!1)}},Object(a.createElement)(s.a,{icon:"close"}))),Object(a.createElement)(d.b.Provider,{value:{errorList:T,setErrorList:M,stepId:K}},Object(a.createElement)(Ae.a,{onSubmit:function(e){re(e)},initialValues:ne,validate:function(e){return O(function(e){var t=z.sidebarValues,n=void 0===t?{}:t;if(Object(c.isEmpty)(n))return!1;var a=ne.bwfan_goal_run,r=void 0===a?"":a,o=e.bwfan_goal_run;return r!==(void 0===o?"":o)&&"wait"===r}(e)),!1}},(function(e){var t=e.getInputProps,r=e.values,o=e.errors,s=e.handleSubmit;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"wr_content",ref:D},Object(a.createElement)("fieldset",null,V.map((function(e,n){return Object(a.createElement)(a.Fragment,{key:n},(Object(c.isEmpty)(e.toggler)||ae(r,e.toggler))&&e.wrap_before&&Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_before}}),e.type?Object(a.createElement)(a.Fragment,null,!1!==e.show&&(Object(c.isEmpty)(e.toggler)||ae(r,e.toggler))&&Object(a.createElement)(xe.a,{input:e,formProps:t(e.id),values:r})):e.hint?Object(a.createElement)(a.Fragment,{dangerouslySetInnerHTML:{__html:e.hint},className:i()(e.class)}):null,(Object(c.isEmpty)(e.toggler)||ae(r,e.toggler))&&e.wrap_after&&Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_after}}))}))),f&&Object(a.createElement)("div",{className:"bwf-single-automation-notice"},"There can be contacts queued at this step, new settings will apply to all of them.")),Object(a.createElement)("div",{className:"wr_footer"},Object(a.createElement)(u.Button,{isTertiary:!0,onClick:function(){return S(!1)}},Object(l.__)("Cancel")),Object(a.createElement)(u.Button,{isPrimary:!0,onClick:function(){s()},isBusy:n,disabled:Object.keys(o).length},Object(l.__)("Save"))))}))))},Hn=n(151);function Vn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function $n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vn(Object(n),!0).forEach((function(t){Yn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Yn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gn(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function Jn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Qn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Wn=function(){var e=Object(a.useContext)(d.d),t=Jn(Object(a.useState)(!1),2),n=t[0],r=t[1],o=Object(b.a)(),f=o.getSelectedEventData,O=o.getAutomationId,j=o.getautomationMeta,y=Object(m.a)(),w=y.showSidebar,v=y.setAutomationData,g=O(),E=Object(a.useRef)(null),h=Jn(Object(a.useState)(!1),2),_=h[0],N=h[1],k=Jn(Object(a.useState)([]),2),C=k[0],P=k[1],S=j(),A=f(),x=!Object(c.isEmpty)(S)&&S.hasOwnProperty("event_meta")?S.event_meta:{},D=Object(c.isEmpty)(A)?{}:A,I=D.fields,T=void 0===I?[]:I,M=D.default_values,F=void 0===M?{}:M,L=D.need_unique_key,R=void 0!==L&&L;Object(a.useEffect)((function(){P([]),N(!1)}),[]);var z=function(e,t,n){var a=!1,r=t.fields,c=t.relation,o=void 0===c?"OR":c;o=o.toUpperCase();try{var i=null;if("OR"===o){if(r&&Array.isArray(r))for(var l=0;l<r.length;l++){i=e[r[l].id];var s=void 0===r[l].value||r[l].value;if(Array.isArray(s)&&s.includes(i))return!0;if(""!=s&&i==s||""==s&&""!=i&&null!=i)return!0}}else"AND"==o&&r&&Array.isArray(r)&&(a=r.every((function(t){i=e[t.id];var n=void 0===t.value||t.value;return!(!Array.isArray(n)||!n.includes(i))||(""===n||i==n)&&(""!=n||""!=i&&null!=i)})))}catch(e){console.log(e)}return a},q=function(){var t,n=(t=regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Object(c.isEmpty)(U(n))){t.next=15;break}if(!Object(c.isEqual)(x,n)){t.next=4;break}return w(!1),t.abrupt("return");case 4:return r(!0),t.prev=5,t.next=8,p()({path:Object(d.m)("/automation/".concat(g,"/")),method:"POST",data:{data:{meta:{event_meta:n},isWebhook:R}}}).then((function(t){if(200!==t.code)throw Error(Object(d.j)(null==t?void 0:t.message));e(t.message);var a=$n({},n);R&&x.hasOwnProperty("webhook_data")&&(a.webhook_data=x.webhook_data),v("meta",$n($n({},S),{},{event_meta:a})),setTimeout((function(){w(!1)}),100),r(!1)})).catch((function(e){throw Error(Object(d.j)(null==e?void 0:e.message))}));case 8:t.next=14;break;case 10:t.prev=10,t.t0=t.catch(5),v("modalData",{status:!0,modalTitle:"Update Event",error:null===t.t0||void 0===t.t0?void 0:t.t0.message}),r(!1);case 14:Object(d.gb)(e,1e3);case 15:case"end":return t.stop()}}),t,null,[[5,10]])})),function(){var e=this,n=arguments;return new Promise((function(a,r){var c=t.apply(e,n);function o(e){Gn(c,a,r,o,i,"next",e)}function i(e){Gn(c,a,r,o,i,"throw",e)}o(void 0)}))});return function(e){return n.apply(this,arguments)}}(),B=[];Object(c.isEmpty)(T)||T.forEach((function(e){e.hasOwnProperty("required")&&e.required&&B.push(e)}));var U=function(e){var t={};return B.map((function(n){(!n.hasOwnProperty("toggler")||Object(c.isEmpty)(n.toggler)||z(e,n.toggler))&&(Array.isArray(e[n.id])&&0===e[n.id].length||""===e[n.id]||void 0===e[n.id])&&(t[n.id]=n.hasOwnProperty("errorMsg")?n.errorMsg:Object(l.__)("This is required field.","wp-marketing-automations")),"bwfan_email_data"===n.id&&(!e.hasOwnProperty("bwfan_email_data")||e.bwfan_email_data.hasOwnProperty("subject")&&Object(c.isEmpty)(e.bwfan_email_data.subject))&&(t[n.id]="error"),"bwf_form_submit"===n.type&&(e.hasOwnProperty("bwfan-form-field-map")&&e["bwfan-form-field-map"].hasOwnProperty("bwfan_email_field_map")&&""!==e["bwfan-form-field-map"].bwfan_email_field_map||(t["bwfan-form-email-field-map"]="error"))})),P(t),t};return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"wr_header"},Object(a.createElement)("div",{className:"bwf-node-icon icon-start"},Object(a.createElement)(s.a,{size:22,icon:"rocket"})),Object(a.createElement)("div",{className:"wr_event_title"},A.hasOwnProperty("event_name")?A.event_name:""),Object(a.createElement)("div",{className:"wr_event_variant"}),Object(a.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){return w(!1)}},Object(a.createElement)(s.a,{icon:"close"}))),Object(a.createElement)(d.b.Provider,{value:{errorList:C,setErrorList:P}},Object(a.createElement)(Ae.a,{onSubmit:function(e){q(e)},initialValues:$n($n({},F),x),validate:function(){return!1}},(function(e){var t=e.getInputProps,r=e.values,o=e.errors,s=e.handleSubmit;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"wr_content",ref:E},Object(a.createElement)("fieldset",null,T.map((function(e,n){return Object(a.createElement)(a.Fragment,{key:n},(Object(c.isEmpty)(e.toggler)||z(r,e.toggler))&&e.wrap_before&&Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_before}}),e.type?Object(a.createElement)(a.Fragment,null,!1!==e.show&&(Object(c.isEmpty)(e.toggler)||z(r,e.toggler))&&Object(a.createElement)(xe.a,{input:e,formProps:t(e.id),values:r})):e.hint?Object(a.createElement)(a.Fragment,{dangerouslySetInnerHTML:{__html:e.hint},className:i()(e.class)}):null,(Object(c.isEmpty)(e.toggler)||z(r,e.toggler))&&e.wrap_after&&Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_after}}))})))),Object(a.createElement)("div",{className:"wr_footer"},Object(a.createElement)(u.Button,{isTertiary:!0,onClick:function(){return w(!1)}},Object(l.__)("Cancel")),Object(a.createElement)(u.Button,{isPrimary:!0,onClick:function(){s()},isBusy:n,disabled:Object.keys(o).length},Object(l.__)("Save"))))}))),Object(d.nb)()&&Object(a.createElement)(Hn.a,{isOpen:_,setOpenTags:N}))};function Xn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Zn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xn(Object(n),!0).forEach((function(t){Kn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Kn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ea(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function ta(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return na(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return na(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function na(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var aa=function(){var e=ta(Object(a.useState)(!1),2),t=e[0],n=e[1],r=ta(Object(a.useState)(!1),2),o=r[0],i=r[1],f=ta(Object(a.useState)({step:"",name:""}),2),O=f[0],j=f[1],y=Object(a.useContext)(d.d),w=Object(m.a)(),v=w.showSidebar,g=w.setNodeDatabyId,E=w.getElementsAfterStep,h=w.setAutomationData,_=Object(b.a)(),N=_.getSidebarNodeData,k=_.getNodeDataByID,C=_.getAutomationId,P=_.getAutomationLinks,S=_.getAutomationSteps,A=_.getCount,x=_.getActionsList,D=_.getGoals,I=N(),T=C(),M=S(),F=P(),L=A(),R=x(),z=D(),q=!Object(c.isEmpty)(I)&&I.hasOwnProperty("id")?k(I.id):{},B=(q.id,q.stepId),U=void 0===B?0:B,H=q.data,V=(void 0===H?{}:H).sidebarValues;Object(a.useEffect)((function(){n({}),n(!1)}),[]);var $=!Object(c.isEmpty)(I)&&I.hasOwnProperty("data")?I.data:{},Y=!Object(c.isEmpty)($)&&$.hasOwnProperty("sidebarValues")?$.sidebarValues:{};Object(a.useEffect)((function(){Y.hasOwnProperty("jump_to")&&!Object(c.isEmpty)(Y.jump_to)&&j(Y.jump_to)}),[Y]);var G={action:"Action",wait:"Delay",conditional:"Conditional",exit:"Exit",benchmark:"Goal"},J=function(){var e=E("start");e=e.filter((function(e,t,n){return n.indexOf(e)===t}));var t={stepsOptArr:[],stepsOptions:[{value:"",label:Object(l.__)("Select Step","wp-marketing-automations")}]};return Object(c.isEmpty)(e)||(e.map((function(e){var n=k(e),a=n.stepId,r=void 0===a?0:a,c=n.id,o=void 0===c?0:c;if(!["yesNoNode","end","exit","jump"].includes(n.type)&&!t.stepsOptArr.hasOwnProperty(e)){var i=["Step"];i.push(o),G.hasOwnProperty(n.type)&&i.push(" : "+G[n.type]),"action"==n.type&&n.hasOwnProperty("data")&&R.list.hasOwnProperty(n.data.selected)&&R.list[n.data.selected].hasOwnProperty("action_name")&&(R.list[n.data.selected].hasOwnProperty("integration_nicename")?i.push(" - "+R.list[n.data.selected].integration_nicename+" : "):i.push(" - "),i.push(R.list[n.data.selected].action_name)),"benchmark"==n.type&&n.hasOwnProperty("data")&&z.list.hasOwnProperty(n.data.benchmark)&&z.list[n.data.benchmark].hasOwnProperty("event_name")&&(z.list[n.data.benchmark].hasOwnProperty("source_label")&&i.push(z.list[n.data.benchmark].source_label+" : "),i.push(z.list[n.data.benchmark].event_name)),t.stepsOptArr[r]=i.join(" "),t.stepsOptions.push({value:r,label:i.join(" ")})}})),t.stepsOptArr.end="End Automation",t.stepsOptions.push({value:"end",label:"End Automation"})),t}(),Q=J.stepsOptArr,W=J.stepsOptions,X=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O.hasOwnProperty("step")&&""!=O.step&&O.hasOwnProperty("name")&&""!=O.name){e.next=5;break}return n(!0),e.abrupt("return");case 5:n(!1);case 6:if(t=Zn(Zn({},Y),{},{jump_to:O}),!Object(c.isEqual)(V,t)){e.next=10;break}return v(!1),e.abrupt("return");case 10:return e.prev=10,i(!0),a={data:{data:{sidebarData:t}},steps:Object(c.cloneDeep)(M).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:F,count:L},e.next=15,p()({path:Object(d.m)("/automation/".concat(T,"/step/").concat(U)),method:"POST",data:a}).then((function(e){if(200!==e.code)throw Error(Object(d.j)(null==e?void 0:e.message));y(e.message),g(I.id,Zn(Zn({},$),{},{sidebarValues:t}),{step_status:1}),setTimeout((function(){v(!1)}),100),i(!1)})).catch((function(e){throw Error(Object(d.j)(null==e?void 0:e.message))}));case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(10),h("modalData",{status:!0,modalTitle:"Update Jump",error:null===e.t0||void 0===e.t0?void 0:e.t0.message}),i(!1);case 21:Object(d.gb)(y,1e3);case 22:case"end":return e.stop()}}),e,null,[[10,17]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){ea(c,a,r,o,i,"next",e)}function i(e){ea(c,a,r,o,i,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}();return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"wr_header"},Object(a.createElement)("div",{className:"bwf-node-icon icon-jump"},Object(a.createElement)(s.a,{size:28,icon:"jump"})),Object(a.createElement)("div",{className:"wr_event_title"},Object(a.createElement)("span",null,Object(l.__)("Jump","wp-marketing-automations"))),Object(a.createElement)("div",{className:"wr_event_variant"}),Object(a.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){v(!1)}},Object(a.createElement)(s.a,{icon:"close"}))),Object(a.createElement)("div",{className:"wr_content"},Object(a.createElement)("div",{className:"bwf-jump-wrap"},Object(a.createElement)("div",{className:"bwf-jump-skip-step-select "+(t?"has-error":"")},Object(a.createElement)("div",{className:"bwf-w-120 bwf_bold bwf-mb-8"},Object(l.__)("Jump To","wp-marketing-automations")),Object(a.createElement)(u.SelectControl,{value:O.step,className:"bwf_w_full",options:W,onChange:function(e){j({step:e,name:e?Q[e]:""})}}),t&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"has-bwfan-error"},"This is a required field."))))),Object(a.createElement)("div",{className:"wr_footer"},Object(a.createElement)(u.Button,{isTertiary:!0,onClick:function(){return v(!1)}},Object(l.__)("Cancel")),Object(a.createElement)(u.Button,{isPrimary:!0,onClick:X,isBusy:o},Object(l.__)("Save"))))},ra=function(){var e=Object(b.a)(),t=e.openSidebar,n=e.getSidebarNodeData,r=t(),c=n(),o=c.type,i=void 0===o?"":o,s=c.data,u=(void 0===s?{}:s).selected,m=void 0===u?"":u;return r?Object(a.createElement)("div",{className:"bwf-wl-wrap"},Object(a.createElement)("div",{className:"wl-sidebar-overlay step-"+i+"-wrap ",onClick:function(e){return e.preventDefault()}}),Object(a.createElement)("div",{className:"wr wr-expanded step-"+i+"-wrap-content "+("wp_sendemail"==m?"bwf-mail-action":"")},function(){switch(i){case"start":return Object(a.createElement)(Wn,null);case"action":return Object(a.createElement)(et,null);case"conditional":return Object(a.createElement)(Mn,null);case"wait":return Object(a.createElement)(St,null);case"benchmark":return Object(a.createElement)(Un,null);case"jump":return Object(a.createElement)(aa,null);default:return Object(a.createElement)(a.Fragment,null,Object(l.__)("Node Type not registered","wp-marketing-automations-crm"))}}())):Object(a.createElement)(a.Fragment,null)},ca=n(134),oa=n(802),ia=n(888);function la(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function sa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?la(Object(n),!0).forEach((function(t){ua(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):la(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ua(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ma(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function ba(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return da(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return da(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function da(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var fa=function(e){!function(e){if(null==e)throw new TypeError("Cannot destructure undefined")}(e);var t=Object(a.useContext)(d.d),n=ba(Object(a.useState)(!1),2),r=n[0],o=n[1],i=ba(Object(a.useState)(""),2),f=i[0],O=i[1],j=ba(Object(a.useState)(""),2),y=j[0],w=j[1],v=ba(Object(a.useState)(!1),2),g=v[0],E=v[1],h=Object(m.a)().setAutomationData,_=(0,Object(b.a)().getAutomationData)(),N=_.ID,k=_.title;Object(a.useEffect)((function(){E(!1),O(k)}),[r]);var C=function(){var e,n=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(c.isEmpty)(f)&&f!=k){e.next=4;break}w(Object(c.isEmpty)(f)?Object(l.__)("Name is required.","wp-marketing-automations-crm"):Object(l.__)("Please change name to update.","wp-marketing-automations-crm")),e.next=14;break;case 4:return E(!0),e.prev=5,e.next=8,p()({path:Object(d.m)("/automation/".concat(N)),method:"POST",data:{data:{data:{title:f}}}}).then((function(e){if(200!==e.code)throw Error(Object(d.j)(null==e?void 0:e.message));t("Title Updated"),h("data",sa(sa({},_),{},{title:f})),o(!1)})).catch((function(e){throw Error(Object(d.j)(null==e?void 0:e.message))}));case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(5),E(!1),w(e.t0.message);case 14:Object(d.gb)(t,2e3);case 15:case"end":return e.stop()}}),e,null,[[5,10]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){ma(c,a,r,o,i,"next",e)}function i(e){ma(c,a,r,o,i,"throw",e)}o(void 0)}))});return function(){return n.apply(this,arguments)}}();return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("span",{onClick:function(){return o(!0)},style:{cursor:"pointer",lineHeight:0,marginLeft:"5px"},className:"bwf-hover-primary"},Object(a.createElement)(s.a,{icon:"edit",size:16,color:"#353030"})),r&&Object(a.createElement)(u.Modal,{onRequestClose:function(){return o(!1)},className:"bwf-admin-modal bwf-admin-modal-squeezy bwf-h--core-header"},Object(a.createElement)("div",{className:"bwf-modal-header"},Object(a.createElement)("div",{className:"bwf-modal-heading"},Object(l.__)("Edit Automation","wp-marketing-automations")),Object(a.createElement)("span",{onClick:function(){return o(!1)},className:"bwf-modal-close"},Object(a.createElement)(s.a,{icon:"close",color:"#353030"}))),Object(a.createElement)("div",{onKeyPress:function(e){"Enter"===e.key&&(Object(c.isEmpty)(f)?w(!0):C())}},y&&Object(a.createElement)(u.Notice,{status:"error",onRemove:function(){return w("")}},y),Object(a.createElement)(u.TextControl,{type:"text",value:f,label:Object(l.__)("Name","wp-marketing-automations"),autoFocus:!0,placeholder:Object(l.__)("Enter Automation Name","wp-marketing-automations-crm"),disabled:g,onChange:function(e){O(e),Object(c.isEmpty)(e)?w(Object(l.__)("Name is required","wp-marketing-automations-crm")):w("")}}),Object(a.createElement)("div",{className:"bwf_text_right bwf-form-buttons"},Object(a.createElement)(u.Button,{className:"bwf-cancel-btn",onClick:function(){return o(!1)},disabled:g},Object(l.__)("Cancel","wp-marketing-automations-crm")),Object(a.createElement)(u.Button,{isPrimary:!0,onClick:function(){Object(c.isEmpty)(f)?w(Object(l.__)("Name is required","wp-marketing-automations-crm")):C()},isBusy:g},Object(l.__)("Save","wp-marketing-automations-crm"))))))};function pa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Oa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pa(Object(n),!0).forEach((function(t){ja(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ja(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ya(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function wa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return va(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return va(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function va(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ga=function(){var e=Object(a.useContext)(d.d),t=wa(Object(a.useState)({loading:!1,status:!1}),2),n=t[0],r=t[1],c=Object(m.a)().setAutomationData,o=(0,Object(b.a)().getAutomationData)(),i=o.ID,s=o.status,f=function(){var t,n=(t=regeneratorRuntime.mark((function t(n){var a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n?1:2,t.prev=1,e("Updating..."),t.next=5,p()({path:Object(d.m)("/automations/toggle-state"),method:"POST",data:{state:a,automation_id:i}}).then((function(t){if(200!==t.code)throw Error(Object(d.j)(null==t?void 0:t.message));e(t.message),c("data",Oa(Oa({},o),{},{status:a})),Object(d.gb)(e,1e3)}));case 5:t.next=11;break;case 7:t.prev=7,t.t0=t.catch(1),Object(d.gb)(e,1e3),setTimeout((function(){r({status:!0,error:t.t0.message})}),[1500]);case 11:case"end":return t.stop()}}),t,null,[[1,7]])})),function(){var e=this,n=arguments;return new Promise((function(a,r){var c=t.apply(e,n);function o(e){ya(c,a,r,o,i,"next",e)}function i(e){ya(c,a,r,o,i,"throw",e)}o(void 0)}))});return function(e){return n.apply(this,arguments)}}();return Object(a.createElement)("div",{className:"bwf-automation-status-section"},Object(a.createElement)(u.ToggleControl,{label:1===parseInt(s)?Object(l.__)("Active",""):Object(l.__)("Inactive",""),className:"bwf-tooglecontrol-advance",onChange:f,checked:1===parseInt(s)}),Object(a.createElement)(O.a,{modalTitle:"Automation Status Update",errorMessage:n.error,onRequestClose:function(){return r({status:!1})},isOpen:n.status}))};n(848),n(1108);function Ea(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ha(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ha(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ha(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var _a=function(e){var t=e.id,n=e.sourceX,c=e.sourceY,o=e.targetX,i=e.targetY,l=e.sourcePosition,s=e.targetPosition,u=e.style,d=void 0===u?{}:u,f=(e.data,e.arrowHeadType),p=e.markerEndId,O=e.source,j=e.sourceHandleId,y=Object(r.g)({sourceX:n,sourceY:c,sourcePosition:l,targetX:o,targetY:i,targetPosition:s}),w=Object(r.i)(f,p),v=Ea(Object(r.h)({sourceX:n,sourceY:c,targetX:o,targetY:i}),2),g=v[0],E=v[1],h=Object(m.a)(),_=h.setNodeForAdd,N=h.copyNodeHere,k=h.setOpenStepModal,C=h.setModalAnchorNode,P=Object(b.a)(),S=P.getEnableCopy,A=P.getEnableMove,x=P.getNodeDataByID,D=S(),I=A(),T=x(O);return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("path",{id:t,style:d,className:"react-flow__edge-path",d:y,markerEnd:w}),Object(a.createElement)("foreignObject",{width:23,height:23,x:g-11.5,y:E-11.5,className:"edgebutton-foreignobject",requiredExtensions:"http://www.w3.org/1999/xhtml"},Object(a.createElement)("div",{className:"bwf-edge-body"},D||I?Object(a.createElement)("div",{className:"bwf-drag-area",onClick:function(){return N(T,"after",j||"")}},Object(a.createElement)("div",{className:"bwf-drag-node is-edge"},Object(a.createElement)("div",{className:"bwf-node-add"})),Object(a.createElement)("div",{className:"bwf-paste-label"},"Paste Here")):Object(a.createElement)("div",{className:"bwf-node-add",onClick:function(e){_(O,{option:j}),k(!0),C(e.target)}}))))},Na=n(248),ka=(n(1109),n(38));function Ca(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Pa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pa(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Sa=function(){var e=Object(b.a)(),t=e.getShowContactModalId,n=e.getAutomationData,r=e.getShowContactModalType,o=t(),f=r(),O=n().ID,j=Object(m.a)().setAutomationData,y=Ca(Object(a.useState)(!0),2),w=y[0],v=y[1],g=Ca(Object(a.useState)({}),2),E=g[0],h=g[1],_=Ca(Object(a.useState)(10),2),N=_[0],k=_[1],C=Ca(Object(a.useState)(0),2),P=C[0],S=C[1],A=Object(a.useRef)(new AbortController);Object(a.useEffect)((function(){return function(){A.current.abort()}}),[]),Object(a.useEffect)((function(){v(!0),h({}),function(){try{var e=Object(G.stringify)({limit:N,offset:P,type:f}),t="string"!=typeof o?parseInt(o):0;p()({path:Object(d.m)("/automation/".concat(O,"/step/").concat(t,"/contacts?").concat(e)),method:"GET",signal:A.current.signal}).then((function(e){200===e.code&&(Object(c.isEmpty)(e.result)||h(e.result)),v(!1)}))}catch(e){v(!1)}}()}),[o,P,N]);var x,D,I,T,M,F=i()("bwfcrm-contacts-list",{"has-search":!1}),L=[{key:"name",label:Object(l.__)("Name","wp-marketing-automations"),isLeftAligned:!0,required:!0,cellClassName:"bwf-w-150"},{key:"email",label:Object(l.__)("Email","wp-marketing-automations"),isLeftAligned:!0},{key:"date",label:function(){switch(f){case"completed":return Object(l.__)("Completed on","wp-marketing-automations");case"queued":return Object(l.__)("Queued on","wp-marketing-automations");case"active":return Object(l.__)("Started on","wp-marketing-automations");default:return Object(l.__)("Date","wp-marketing-automations")}}(),isLeftAligned:!0,cellClassName:"bwf-w-150"},{key:"traillink",label:"",isLeftAligned:!0,cellClassName:"bwf-w-120"}],R=function(e){return Object(a.createElement)(ka.a,{href:"admin.php?page=autonami&path=/contact/"+e.id,type:"bwf-crm",className:"bwf-cursor-pointer bwf-a-no-underline",style:{color:"#0073aa"},key:e.id},e.hasOwnProperty("name")&&""!==e.name?e.name:"-")},z=function(e){var t=[];return Object(c.isEmpty)(e)||e.map((function(e){t.push([{display:R(e),value:""},{display:e.email,value:""},{display:e.hasOwnProperty("time")&&""!==e.time?Object(d.N)(de.a.unix(e.time).format("MM/DD/YYYY HH:mm:ss")):"-",value:""},{display:e.hasOwnProperty("trail")&&""!==e.trail?Object(a.createElement)("div",{onClick:function(){j("customerSelected",e),j("showContactModalId",0),j("showContactModalType","")},className:"bwf-cursor-pointer",style:{color:"#0073aa"}},Object(l.__)("View Journey","wp-marketing-automations")):"-",value:""}])})),t},q=function(e){S((e-1)*N)},B=function(e){return"per_page"!==e?function(){}:U},U=function(e){e!==N&&k(e)},H=E.hasOwnProperty("total")&&parseInt(E.total)>0?parseInt(E.total):0;return Object(a.createElement)(u.Modal,{onRequestClose:function(){j("showContactModalId",0),j("showContactModalType","")},className:"bwf-admin-modal bwf-admin-modal-large bwf-single-automation-contact-modal bwf-h--core-header",shouldCloseOnClickOutside:!1},Object(a.createElement)("div",{className:"bwf-modal-header"},Object(a.createElement)("div",{className:"bwf-modal-heading"},function(){var e="";switch(f){case"completed":e="Completed Contacts";break;case"queued":e="Queued Contacts";break;default:e="Active Contacts"}return e+" "+(H>0?"("+H+")":"")}()),Object(a.createElement)("span",{onClick:function(){j("showContactModalId",0),j("showContactModalType","")},className:"bwf-modal-close"},Object(a.createElement)(s.a,{icon:"close",color:"#353030"}))),(x=E.data,D=void 0===x?[]:x,I=E.total,T=void 0===I?0:I,M=parseInt(P)/parseInt(N)+1,Object(a.createElement)(a.Fragment,null,Object(a.createElement)(Na.a,{className:F,title:"",rows:w?[]:z(D),headers:L,query:{paged:M},rowsPerPage:N,totalRows:T,isLoading:w,onPageChange:q,onQueryChange:B,showMenu:!1,emptyMessage:Object(l.__)("No contacts found","wp-marketing-automations")}))))};function Aa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function xa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Aa(Object(n),!0).forEach((function(t){Da(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Aa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Da(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ia(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function Ta(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ma(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ma(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ma(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Fa=function(e){var t=e.isProActive,n=void 0!==t&&t,r=Object(m.a)(),c=r.addNewStep,o=r.unsetCurrentNode,i=r.setOpenStepModal,f=r.setAutomationData,p=Object(b.a)(),O=p.getCurrentNode,j=p.getCurrentNodeAction,y=p.getOpenStepModal,w=p.getModalAnchorNode,v=Ta(Object(a.useState)(!1),2),g=v[0],E=v[1],h=O(),_=j(),N=y(),k=w(),C=Object(a.useContext)(d.d),P=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,n,a,r,l=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:"action",E(!0),n=_.data&&_.data.option?_.data.option:"",a=_.data&&_.data.position?_.data.position:"after",r=xa(xa({},h),{},{xPos:h.position.x,yPos:h.position.y}),e.next=7,c(t,r,n,a,{}).then((function(){Object(d.gb)(C,1e3),o(),E(!1),i(!1)}));case 7:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){Ia(c,a,r,o,i,"next",e)}function i(e){Ia(c,a,r,o,i,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}();return N&&Object(a.createElement)(Pn.a,{onFocusOutside:function(){o(),i(!1)},position:"center",className:"bwf-type-select-modal",onClick:function(e){return e.stopPropagation()},anchorRef:k},!g&&Object(a.createElement)("div",{className:"bwf-title-wrap"},Object(a.createElement)("div",{className:"bwf-title bwf_w_full"},"Add Step"),Object(a.createElement)("div",{className:"bwf-cross bwf-cursor-pointer",onClick:function(){return i(!1)}},Object(a.createElement)(s.a,{icon:"cross",size:12})," ")),Object(a.createElement)("div",{className:"bwf-type-select-wrapper "+(g?"is-loading":"")},g?Object(a.createElement)("div",{className:"bwf-display-flex-column set-center is-loading"},Object(a.createElement)(cn.a,{spaceClass:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-h3"},"Please Wait..."),Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-p"},"We are adding step in the flow")):Object(a.createElement)(a.Fragment,null,Object(a.createElement)(u.Button,{isSecondary:!0,onClick:function(){P("action")}},Object(a.createElement)("span",{className:"bwf-type-select-icons"},Object(a.createElement)(s.a,{icon:"charge"})),Object(l.__)("Action","wp-marketing-automations")),Object(a.createElement)(u.Button,{isSecondary:!0,onClick:function(){P("wait")}},Object(a.createElement)("span",{className:"bwf-type-select-icons"},Object(a.createElement)(s.a,{icon:"time-left"})),Object(l.__)("Delay","wp-marketing-automations")),Object(a.createElement)(u.Button,{isSecondary:!0,onClick:function(){n?P("conditional"):f("showProModal",!0)},style:{width:"100%"}},Object(a.createElement)("span",{className:"bwf-type-select-icons"},Object(a.createElement)(s.a,{icon:"condition"})),Object(l.__)("Condition","wp-marketing-automations"),!n&&Object(a.createElement)("span",{className:"bwf-flex",style:{marginLeft:"auto"}},Object(a.createElement)(s.a,{icon:"lock",size:16}))),Object(a.createElement)(u.Button,{isSecondary:!0,style:{width:"100%"},onClick:function(){n?P("benchmark"):f("showProModal",!0)}},Object(a.createElement)("span",{className:"bwf-type-select-icons"},Object(a.createElement)(s.a,{icon:"goal"})),Object(l.__)("Goal","wp-marketing-automations"),!n&&Object(a.createElement)("span",{className:"bwf-flex",style:{marginLeft:"auto"}},Object(a.createElement)(s.a,{icon:"lock",size:16}))),Object(a.createElement)(u.Button,{isSecondary:!0,style:{width:"100%"},onClick:function(){n?P("jump"):f("showProModal",!0)}},Object(a.createElement)("span",{className:"bwf-type-select-icons"},Object(a.createElement)(s.a,{icon:"jump"})),Object(l.__)("Jump","wp-marketing-automations"),!n&&Object(a.createElement)("span",{className:"bwf-flex",style:{marginLeft:"auto"}},Object(a.createElement)(s.a,{icon:"lock",size:16}))),Object(a.createElement)(u.Button,{isSecondary:!0,style:{width:"100%"},onClick:function(){n?P("exit"):f("showProModal",!0)}},Object(a.createElement)("span",{className:"bwf-type-select-icons"},Object(a.createElement)(s.a,{icon:"exit"})),Object(l.__)("Exit","wp-marketing-automations"),!n&&Object(a.createElement)("span",{className:"bwf-flex",style:{marginLeft:"auto"}},Object(a.createElement)(s.a,{icon:"lock",size:16}))))))},La=n(67),Ra=(n(874),n(31)),za=n.n(Ra),qa=n(32),Ba=n.n(qa);function Ua(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ha(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ha(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ha(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Va(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function $a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Va(Object(n),!0).forEach((function(t){Ya(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Va(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ya(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ga(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}var Ja=function(e){return{name:"contact-journey",className:"bwf-search-bwf-tags-result",options:function(t){return(n=regeneratorRuntime.mark((function t(n){var a,r,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={search:n,limit:10,offset:0},t.next=3,p()({path:Object(d.m)("/automation/".concat(e,"/contacts/journey?")+Object(G.stringify)(a)),method:"GET"});case 3:return r=t.sent,c=[],za()(r,"result")&&!Ba()(r.result)&&(c=r.result.map((function(e){return $a($a({},e),{},{key:String(e.trail),label:Ba()(e.f_name)&&Ba()(e.l_name)?e.email:e.f_name+" "+e.l_name})}))),t.abrupt("return",c);case 7:case"end":return t.stop()}}),t)})),a=function(){var e=this,t=arguments;return new Promise((function(a,r){var c=n.apply(e,t);function o(e){Ga(c,a,r,o,i,"next",e)}function i(e){Ga(c,a,r,o,i,"throw",e)}o(void 0)}))},function(e){return a.apply(this,arguments)})(t);var n,a},isDebounced:!0,getOptionIdentifier:function(e){return e.key},getOptionKeywords:function(e){return[e.label]},getOptionLabel:function(e,t){return Object(a.createElement)("span",{key:"name",className:"bwf-customer-journey-search-result-name","aria-label":e.label},Object(a.createElement)("div",{className:"bwf-search-wrap"},Object(a.createElement)("div",{className:"bwf-search-label"},e.label),Object(a.createElement)("div",{className:"bwf-search-date"},"On:"," ",e.hasOwnProperty("c_date")?Object(d.N)(e.c_date):"")))},getOptionCompletion:function(e){return e}}},Qa=function(e){var t=Ua(Object(a.useState)(!1),2),n=t[0],r=t[1],o=e.automationId,i=Object(m.a)().setAutomationData,u=(0,Object(b.a)().getCustomerSelected)(),f=function(e){if(Object(c.isArray)(e)&&!Ba()(e)){if(!Ba()(e)){var t=e[e.length-1];(e=[])[0]=t}var n=e.find((function(e){return za()(e,"key")}));i("customerSelected",n),r(!1)}else i("customerSelected",{})};return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{dangerouslySetInnerHTML:{__html:"<style>body{overflow-y: hidden !important;}</style>"}}),Object(a.createElement)("div",{className:"bwf-automation-customer-journey-wrap"},Object(a.createElement)("div",{className:"bwf-automation-customer-journey"},Object(d.nb)()?Object(a.createElement)("div",{className:"bwf-customer-journey-header"},Object(a.createElement)("div",{className:"bwf-customer-journey-label"}),Object(a.createElement)("div",{className:"bwf-customer-journey-search",onClick:function(){!n&&Ba()(u)&&r(!0)}},Object(a.createElement)(s.a,{icon:"split-path",width:16,height:18}),Object(a.createElement)("span",null,Object(l.__)("View Contact Journey")))):Object(a.createElement)("div",{className:"bwf-section-header",onClick:function(){i("showProModal",!0)}},Object(a.createElement)("div",{className:"bwf-customer-journey-label"}),Object(a.createElement)("div",{className:"bwf-customer-journey-search"},Object(a.createElement)(s.a,{icon:"lock",width:16,height:18}),Object(a.createElement)("span",null,Object(l.__)("View Contact Journey")))),Object(d.nb)()&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-customer-journey-popover-wrap"},n&&Object(a.createElement)(Pn.a,{onFocusOutside:function(){return r(!1)},className:"bwf-customer-journey-popover",placement:"bottom"},Object(a.createElement)("div",{className:"bwf-customer-journey-popover-content"},Object(a.createElement)(zt.a,{autocompleter:Ja(o),className:"bwf-customer-journey-search",placeholder:Object(l.__)("Search by Name, Email and Phone"),multiple:!1,inlineTags:!1,selected:[],onChange:f,bwfEnableEmptySearch:!0})))))),!Ba()(u)&&Object(a.createElement)("div",{className:"bwf-customer-selected"},Object(a.createElement)(on.a,{id:u.trail,label:u.hasOwnProperty("label")&&!Ba()(u.label.trim())?u.label:u.email,remove:function(){return i("customerSelected",{})}}))))},Wa=n(852),Xa=n(92);function Za(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function Ka(e){return function(e){if(Array.isArray(e))return nr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||tr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function er(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||tr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tr(e,t){if(e){if("string"==typeof e)return nr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nr(e,t):void 0}}function nr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function ar(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function rr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ar(Object(n),!0).forEach((function(t){cr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ar(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function cr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var or=function(e){var t=e.id,n=Object(ca.a)(),o=n.setL2Title,u=n.setBackLinkRightContent,f=Object(r.n)().setCenter,j=Object(r.l)(),y=Object(r.m)((function(e){return e.setSelectedElements})),w=Object(qe.b)(),v=w.mergeTag,g=w.setMergeTag,E=w.reset,h=w.identifier,_=w.setIdentifier,N=Object(b.a)(),k=N.getLoading,C=N.getAutomationSteps,P=N.getAutomationLinks,S=N.getEnableCopy,A=N.getEnableMove,x=N.getAutomationData,D=N.getError,I=N.getShowContactModalId,T=N.getOpenStartSidebar,F=N.getCustomerSelected,L=N.isProModal,R=N.getautomationMeta,z=N.getListData,q=(0,N.getModalData)(),B=Object(m.a)(),U=B.setAutomationData,H=B.fetchAutomationStat,V=P(),$=C(),G=S(),J=A(),Q=k(),W=D(),X=x(),Z=I(),K=X.title,ee=void 0===K?"":K,te=T(),ne=F(),ae=L(),re=R(),ie=re.tips,le=void 0===ie?[]:ie,se=z();Object(oa.a)("workflow",ee,"admin.php?page=autonami&path=/automations",!1,null,t,!1,!0,!1),Object(a.useEffect)((function(){o(Object(a.createElement)("div",{className:"bwf-display-flex"},Object(a.createElement)("span",null,""!==ee?ee:""!==se?se:Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-h-15 bwf-w-90"})),""!=ee&&Object(a.createElement)(fa,null))),u(Object(a.createElement)(ga,null)),U("isNewAutomation",0)}),[X]);var me=Object(a.useRef)();Object(a.useEffect)((function(){return window.addEventListener("keyup",(function(e){"Escape"!==e.key&&"27"!==e.keyCode||null!==document.querySelector(".bwf-escape-note")&&(U("enableCopy",!1),U("enableMove",!1),U("copyData",{}))})),U("enableCopy",!1),U("enableMove",!1),U("copyData",{}),function(){document.body.style.overflow="",o(""),U("listData",""),U("data",{})}}),[]),Object(a.useEffect)((function(){Object(c.isNull)(document.querySelector("#bwf-single-automation-wrap"))||(me.current=document.querySelector("#bwf-single-automation-wrap").getBoundingClientRect()),Q||H()}),[Q]);var be={start:M,action:ce,conditional:Y,end:oe,benchmark:ue,wait:we,yesNoNode:ve,exit:_e,jump:Se},de={"bwf-default":_a},fe=V.map((function(e){return e.id&&(e.id.includes("yesedge")||e.id.includes("noedge"))?e:rr(rr({},e),{},{type:"bwf-default"})})),pe=er(Object(a.useState)([]),2),Oe=pe[0],je=pe[1],ye=er(Object(a.useState)(!1),2),ge=ye[0],Ee=ye[1],he=er(Object(a.useState)("bwf-automation-wrap"),2),Ne=he[0],ke=he[1],Ce=er(Object(a.useState)(!1),2),Pe=Ce[0],Ae=Ce[1];if(Object(a.useEffect)((function(){if(!ge){var e=0,t=0,n=j.getState(),a=n.nodes,r=n.selectedElements;if((Object(c.isEmpty)(r)||te)&&(U("openStartSidebar",!1),a.length&&me.current)){var o=a[0];o.hasOwnProperty("__rf")?(e=o.__rf.position.x+140,t=o.__rf.position.y):(e=o.position.x+140,t=o.position.y),t=parseFloat(t)+parseFloat(me.current.height)*(Pe?.5:.4),Ee(!0),f(e,t,1)}}}),[Oe,ge]),Object(a.useEffect)((function(){Ee(!1),$.length>1?je(Object(ia.a)([].concat(Ka($),Ka(fe)),!0,G||J?20:0)):je($)}),[$,Q,Pe,ne,G,J]),Object(a.useEffect)((function(){y([])}),[ne]),Q)return Object(a.createElement)(cn.a,null);var xe=function(){var e,n=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p()({path:Object(d.m)("/automation/".concat(t,"/delete_meta")),method:"DELETE",data:{meta_key:"tips"}}).then((function(e){200===e.code&&U("meta",rr(rr({},re),{},{tips:[]}))}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){Za(c,a,r,o,i,"next",e)}function i(e){Za(c,a,r,o,i,"throw",e)}o(void 0)}))});return function(){return n.apply(this,arguments)}}();return Object(a.createElement)(qe.a.Provider,{value:{selectedMergeTag:v,setSelectedMergeTag:g,resetSelection:E,selectedIdentifier:h,setSelectedIdentifier:_}},Object(c.isEmpty)(W)?Object(a.createElement)(a.Fragment,null,Object(a.createElement)(La.a,null),Object(a.createElement)("div",{className:i()(Ne,{"full-screen":Pe}),id:"bwf-single-automation-wrap"},Object(a.createElement)("div",{className:"automation-title"}," ",ee," "),Object(a.createElement)(Qa,{automationId:t}),(G||J)&&Object(a.createElement)("div",{className:"bwf-escape-note"},Object(l.__)("Press ESC to skip paste step")),Object(c.isEmpty)(ne)?Object(a.createElement)(r.f,{defaultZoom:1,minZoom:.5,maxZoom:4,nodeTypes:be,nodesConnectable:!1,nodesDraggable:!1,zoomOnScroll:!1,zoomOnDoubleClick:!1,paneMoveable:!0,panOnScroll:!0,elements:Oe,edgeTypes:de,onSelectionChange:function(e){if(!Object(c.isNull)(e)&&e.length>0){var t=e[0];if(Object(r.k)(t))return void ke("bwf-automation-wrap bwf-node-selected");if(Object(r.j)(t))return void ke("bwf-automation-wrap bwf-edge-selected");ke("bwf-automation-wrap")}}},Object(a.createElement)(Fa,{isProActive:Object(d.nb)()}),Object(a.createElement)(r.c,{showInteractive:!1},Object(a.createElement)(r.b,{onClick:function(){Ae(!Pe),document.body.style.overflow=Pe?"":"hidden",y([])}},Pe?Object(a.createElement)("span",{className:"dashicons dashicons-fullscreen-exit-alt custom-control-icon"}):Object(a.createElement)("span",{className:"dashicons dashicons-fullscreen-alt custom-control-icon"}))),Object(a.createElement)(r.a,null)):Object(a.createElement)(Wa.a,{setFullScreen:Ae,fullScreen:Pe}),!Object(c.isEmpty)(le)&&Object(a.createElement)("div",{className:"bwfan-automation-tips"},Object(a.createElement)("span",{className:"bwf-close-tip",onClick:xe},Object(a.createElement)(s.a,{icon:"close",size:12})),le.map((function(e,t){return Object(a.createElement)("div",{className:"bwfan-automation-tip",key:t},Object(a.createElement)("div",null,Object(a.createElement)(s.a,{icon:"tip"}),Object(a.createElement)("strong",null,"Tip")),Object(a.createElement)("div",null,e))})))),Object(a.createElement)(ra,null),""!==Z&&0!==Z&&Object(a.createElement)(Sa,null)):Object(a.createElement)(a.Fragment,null,Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-h3"},"Some error in automation"))),!Object(d.nb)()&&Object(a.createElement)(Xa.a,{isOpen:ae,onRequestClose:function(){return U("showProModal",!1)}}),Object(a.createElement)(O.a,{modalTitle:q.modalTitle,deleteEntityName:q.deleteEntityName,confirmText:q.confirmText,confirmButtonText:q.buttonConfirm,cancelButtonText:q.buttonCancel,onConfirm:q.onConfirm,isLoading:q.loading,successMessage:q.success,errorMessage:q.error,content:q.content,onRequestClose:function(){U("modalData",{loading:!1,status:!1})},confirmDescription:q.hasOwnProperty("confirmDescription")?q.confirmDescription:"",isOpen:q.status,isDelete:q.isDelete}))};t.default=function(e){var t=e.match.params.id;Object(d.g)("Automation #"+t);var n=Object(m.a)(),c=n.fetchAutomation,o=n.setAutomationData,i=n.clearAutomationError;return Object(a.useEffect)((function(){o("statLoading",!0),o("statData",[]),o("isLoading",!0),i(),c(t)}),[t]),Object(a.createElement)(a.Fragment,null,Object(a.createElement)(r.e,null,Object(a.createElement)(or,{id:t})))}},802:function(e,t,n){"use strict";var a=n(0),r=n(134),c=n(2),o=n(5),i=n(51),l=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={workflow:{name:Object(c.__)("Workflow","wp-marketing-automations"),link:t?"admin.php?page=autonami&path=/automation/".concat(e):"admin.php?page=autonami-automations&edit=".concat(e)}};return t&&(n.analytics={name:Object(c.__)("Analytics","wp-marketing-automations"),link:t?"admin.php?page=autonami&path=/automation/".concat(e,"/analytics"):"admin.php?page=autonami&path=/automation-v1/".concat(e,"/analytics"),isProFeature:!0,showOnClick:!0},n.contacts={name:Object(c.__)("Contacts","wp-marketing-automations"),link:"admin.php?page=autonami&path=/automation/".concat(e,"/contacts"),isProFeature:!0,showOnClick:!0}),n.engagement={name:Object(c.__)("Engagements","wp-marketing-automations"),link:t?"admin.php?page=autonami&path=/automation/".concat(e,"/engagements"):"admin.php?page=autonami&path=/automation-v1/".concat(e,"/engagements"),isProFeature:!0,showOnClick:!0},Object(o.yb)()&&(n.orders={name:Object(c.__)("Orders","wp-marketing-automations"),link:t?"admin.php?page=autonami&path=/automation/".concat(e,"/orders"):"admin.php?page=autonami&path=/automation-v1/".concat(e,"/orders"),isProFeature:!0,showOnClick:!0}),n};t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,m=arguments.length>6&&void 0!==arguments[6]&&arguments[6],b=arguments.length>7&&void 0!==arguments[7]&&arguments[7],d=arguments.length>8&&void 0!==arguments[8]&&arguments[8],f=bwfcrm_contacts_data&&bwfcrm_contacts_data.header_data?bwfcrm_contacts_data.header_data:{},p=f.automation_nav,O=f.automationv2_nav,j=Object(r.a)(),y=j.setActiveMultiple,w=j.resetHeaderMenu,v=j.setL2NavType,g=j.setL2Nav,E=j.setBackLink,h=j.setL2Title,_=j.setL2Content,N=j.setBackLinkLabel,k=j.setL2NavAlign,C=j.setPageHeader;return Object(a.useEffect)((function(){w(),!o&&v("menu"),d||g(u?l(u,b):b?O:p),y({leftNav:b?"automations-v2":"automations-v1",rightNav:e}),n&&E(n),u&&E(n&&!b?"admin.php?page=autonami&path=/automations-v1":"admin.php?page=autonami&path=/automations"),o||b&&u&&N(Object(c.__)("All Automations","wp-marketing-automations-crm")),!b&&u&&N(Object(c.__)("All Automations","wp-marketing-automations")),u&&k("left"),t&&h(t),!n&&s&&_(s),C(b?"Automations":Object(a.createElement)(a.Fragment,null,"Automations",Object(a.createElement)(i.a,{label:"Legacy"}))),m&&g({})}),[e,b,d]),!0}},850:function(e,t,n){},874:function(e,t,n){}}]);
(function(){var t=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};!function(t,e){"undefined"!=typeof module&&null!==module?module.exports=e():"function"==typeof define&&"object"==typeof define.amd?define(t,e):this[t]=e()}("payform",function(){var e,n,r,a,u,l,i,o,c,g,h,f,s,d,v,p,m,y,C,D,$,w,S;return n=function(t){var e,n,r;return null!=t.selectionStart?t.selectionStart:null!=document.selection?(t.focus(),e=document.selection.createRange(),n=(r=t.createTextRange()).duplicate(),r.moveToBookmark(e.getBookmark()),n.setEndPoint("EndToStart",r),n.text.length):void 0},e=function(t){return function(e){return null==e&&(e=window.event),e.target=e.target||e.srcElement,e.which=e.which||e.keyCode,null==e.preventDefault&&(e.preventDefault=function(){return this.returnValue=!1}),t(e)}},r=function(t,n,r){return r=e(r),null!=t.addEventListener?t.addEventListener(n,r,!1):t.attachEvent("on"+n,r)},(v={}).cards=[{type:"visaelectron",pattern:/^4(026|17500|405|508|844|91[37])/,format:l=/(\d{1,4})/g,length:[16],cvcLength:[3],luhn:!0},{type:"maestro",pattern:/^(5(018|0[23]|[68])|6(39|7))/,format:l,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"forbrugsforeningen",pattern:/^600/,format:l,length:[16],cvcLength:[3],luhn:!0},{type:"dankort",pattern:/^5019/,format:l,length:[16],cvcLength:[3],luhn:!0},{type:"visa",pattern:/^4/,format:l,length:[13,16],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^(5[1-5]|2[2-7])/,format:l,length:[16],cvcLength:[3],luhn:!0},{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:!0},{type:"dinersclub",pattern:/^3[0689]/,format:/(\d{1,4})(\d{1,4})?(\d{1,4})?(\d{1,2})?/,length:[14],cvcLength:[3],luhn:!0},{type:"discover",pattern:/^6([045]|22)/,format:l,length:[16],cvcLength:[3],luhn:!0},{type:"world",pattern:/^22/,format:l,length:[13,16,19],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^(62|88)/,format:l,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"jcb",pattern:/^35/,format:l,length:[16],cvcLength:[3],luhn:!0}],a=function(t){var e,n,r,a;for(t=(t+"").replace(/\D/g,""),n=0,r=(a=v.cards).length;n<r;n++)if((e=a[n]).pattern.test(t))return e},u=function(t){var e,n,r,a;for(n=0,r=(a=v.cards).length;n<r;n++)if((e=a[n]).type===t)return e},d=function(t){var e,n,r,a,u,l;for(u=!0,l=0,r=0,a=(n=(t+"").split("").reverse()).length;r<a;r++)e=n[r],e=parseInt(e,10),(u=!u)&&(e*=2),e>9&&(e-=9),l+=e;return l%10==0},s=function(t){var e;return!(null==("undefined"!=typeof document&&null!==document&&null!=(e=document.selection)?e.createRange:void 0)||!document.selection.createRange().text)||null!=t.selectionStart&&t.selectionStart!==t.selectionEnd},C=function(t){var e,n,r,a,u,l,i,o;for(null==t&&(t=""),r="０１２３４５６７８９",a="0123456789",o="",u=0,i=(n=t.split("")).length;u<i;u++)e=n[u],(l=r.indexOf(e))>-1&&(e=a[l]),o+=e;return o},m=function(t){var e;if(e=n(t.target),t.target.value=v.formatCardNumber(t.target.value),null!=e&&"change"!==t.type)return t.target.setSelectionRange(e,e)},g=function(t){var e,r,u,l,i,o,c;if(u=String.fromCharCode(t.which),/^\d+$/.test(u)&&(c=t.target.value,e=a(c+u),l=(c.replace(/\D/g,"")+u).length,o=16,e&&(o=e.length[e.length.length-1]),!(l>=o||(r=n(t.target))&&r!==c.length)))return(i=e&&"amex"===e.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/).test(c)?(t.preventDefault(),setTimeout(function(){return t.target.value=c+" "+u})):i.test(c+u)?(t.preventDefault(),setTimeout(function(){return t.target.value=c+u+" "})):void 0},i=function(t){var e,r;if(r=t.target.value,8===t.which&&(!(e=n(t.target))||e===r.length))return/\d\s$/.test(r)?(t.preventDefault(),setTimeout(function(){return t.target.value=r.replace(/\d\s$/,"")})):/\s\d?$/.test(r)?(t.preventDefault(),setTimeout(function(){return t.target.value=r.replace(/\d$/,"")})):void 0},y=function(t){var e;if(e=n(t.target),t.target.value=v.formatCardExpiry(t.target.value),null!=e&&"change"!==t.type)return t.target.setSelectionRange(e,e)},c=function(t){var e,n;if(e=String.fromCharCode(t.which),/^\d+$/.test(e))return n=t.target.value+e,/^\d$/.test(n)&&"0"!==n&&"1"!==n?(t.preventDefault(),setTimeout(function(){return t.target.value="0"+n+" / "})):/^\d\d$/.test(n)?(t.preventDefault(),setTimeout(function(){return t.target.value=n+" / "})):void 0},h=function(t){var e,n;if(e=String.fromCharCode(t.which),/^\d+$/.test(e))return n=t.target.value,/^\d\d$/.test(n)?t.target.value=n+" / ":void 0},f=function(t){var e,n;if("/"===(n=String.fromCharCode(t.which))||" "===n)return e=t.target.value,/^\d$/.test(e)&&"0"!==e?t.target.value="0"+e+" / ":void 0},o=function(t){var e,r;if(r=t.target.value,8===t.which&&(!(e=n(t.target))||e===r.length))return/\d\s\/\s$/.test(r)?(t.preventDefault(),setTimeout(function(){return t.target.value=r.replace(/\d\s\/\s$/,"")})):void 0},p=function(t){var e;if(e=n(t.target),t.target.value=C(t.target.value).replace(/\D/g,"").slice(0,4),null!=e&&"change"!==t.type)return t.target.setSelectionRange(e,e)},S=function(t){var e;if(!(t.metaKey||t.ctrlKey||0===t.which||t.which<33))return e=String.fromCharCode(t.which),/^\d+$/.test(e)?void 0:t.preventDefault()},$=function(t){var e,n,r;if(n=String.fromCharCode(t.which),/^\d+$/.test(n)&&!s(t.target))return r=(t.target.value+n).replace(/\D/g,""),(e=a(r))&&r.length>e.length[e.length.length-1]?t.preventDefault():r.length>16?t.preventDefault():void 0},w=function(t){var e;if(e=String.fromCharCode(t.which),/^\d+$/.test(e)&&!s(t.target))return(t.target.value+e).replace(/\D/g,"").length>6?t.preventDefault():void 0},D=function(t){var e;if(e=String.fromCharCode(t.which),/^\d+$/.test(e)&&!s(t.target))return(t.target.value+e).length>4?t.preventDefault():void 0},v.cvcInput=function(t){return r(t,"keypress",S),r(t,"keypress",D),r(t,"paste",p),r(t,"change",p),r(t,"input",p)},v.expiryInput=function(t){return r(t,"keypress",S),r(t,"keypress",w),r(t,"keypress",c),r(t,"keypress",f),r(t,"keypress",h),r(t,"keydown",o),r(t,"change",y),r(t,"input",y)},v.cardNumberInput=function(t){return r(t,"keypress",S),r(t,"keypress",$),r(t,"keypress",g),r(t,"keydown",i),r(t,"paste",m),r(t,"change",m),r(t,"input",m)},v.numericInput=function(t){return r(t,"keypress",S),r(t,"paste",S),r(t,"change",S),r(t,"input",S)},v.parseCardExpiry=function(t){var e,n,r;return e=(n=(t=t.replace(/\s/g,"")).split("/",2))[0],2===(null!=(r=n[1])?r.length:void 0)&&/^\d+$/.test(r)&&(r=(new Date).getFullYear().toString().slice(0,2)+r),{month:e=parseInt(e,10),year:r=parseInt(r,10)}},v.validateCardNumber=function(e){var n,r;return e=(e+"").replace(/\s+|-/g,""),!!/^\d+$/.test(e)&&(!!(n=a(e))&&(r=e.length,t.call(n.length,r)>=0&&(!1===n.luhn||d(e))))},v.validateCardExpiry=function(t,e){var n,r,a;return"object"==typeof t&&"month"in t&&(t=(a=t).month,e=a.year),!(!t||!e)&&(t=String(t).trim(),e=String(e).trim(),!!/^\d+$/.test(t)&&(!!/^\d+$/.test(e)&&(1<=t&&t<=12&&(2===e.length&&(e=e<70?"20"+e:"19"+e),4===e.length&&(r=new Date(e,t),n=new Date,r.setMonth(r.getMonth()-1),r.setMonth(r.getMonth()+1,1),r>n)))))},v.validateCardCVC=function(e,n){var r,a;return e=String(e).trim(),!!/^\d+$/.test(e)&&(null!=(r=u(n))?(a=e.length,t.call(r.cvcLength,a)>=0):e.length>=3&&e.length<=4)},v.parseCardType=function(t){var e;return t&&(null!=(e=a(t))?e.type:void 0)||null},v.formatCardNumber=function(t){var e,n,r,u;return t=(t=C(t)).replace(/\D/g,""),(e=a(t))?(u=e.length[e.length.length-1],t=t.slice(0,u),e.format.global?null!=(r=t.match(e.format))?r.join(" "):void 0:null!=(n=e.format.exec(t))?(n.shift(),(n=n.filter(Boolean)).join(" ")):void 0):t},v.formatCardExpiry=function(t){var e,n,r,a;return(n=(t=C(t)).match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/))?(e=n[1]||"",r=n[2]||"",(a=n[3]||"").length>0?r=" / ":" /"===r?(e=e.substring(0,1),r=""):2===e.length||r.length>0?r=" / ":1===e.length&&"0"!==e&&"1"!==e&&(e="0"+e,r=" / "),e+r+a):""},v})}).call(this);
!function(s,t){s(".composite_data").on("wc-composite-initializing",function(i,o){(new function(){function e(i){return new(t.Model.extend({initialize:function(i){o.actions.add_action("active_scenarios_updated",this.component_selection_changed_handler,20,this);this.set({active_scenarios:[]})},component_selection_changed_handler:function(i){var e=_.intersection(o.scenarios.get_scenarios_by_type("overlay_image"),o.scenarios.get_active_scenarios_by_type("overlay_image"));this.set({active_scenarios:e})}}))(i)}function n(i){return new(t.View.extend({$main_image_container:!1,$main_image:!1,initialize:function(i){var e;this.$main_image_container=this.$el.find(".woocommerce-product-gallery__image").first(),0<this.$main_image_container.length?this.$main_image=this.$main_image_container.find("a img").first():(this.$main_image_container=this.$el.find(".woocommerce-product-gallery__image--placeholder").first(),0<this.$main_image_container.length&&(this.$main_image=this.$main_image_container.find("img").first())),this.$main_image&&(this.listenTo(this.model,"change:active_scenarios",this.render),e=this,$wc_cp_window.resize(function(){return!!o.is_initialized&&void e.handle_resize()}),this.$main_image.get(0).complete?setTimeout(function(){e.handle_resize()},100):this.$main_image.one("load",function(){setTimeout(function(){e.handle_resize()},100)}))},render:function(){var i=this.model.get("active_scenarios"),e={width:this.$main_image.width(),position:"absolute","z-index":1};this.$main_image_container.find(".wc-cp-overlay-image").remove();for(var n=i.length-1;0<=n;n--){var t=i[n],a=o.scenarios.get_scenario_data().scenario_settings.overlay_image[t];a&&(t=s(a).css(e),a&&(this.$main_image_container.prepend(t),e["z-index"]++))}},handle_resize:function(){var i={width:this.$main_image.width()};this.$main_image_container.find(".wc-cp-overlay-image").css(i)}}))(i)}this.initialize=function(){var i=s(".woocommerce-product-gallery__wrapper").first();0<i.length&&(this.model=new e,this.view=new n({model:this.model,el:i}))}}).initialize()})}(jQuery,(window,document,Backbone));
(()=>{"use strict";var e={n:t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.blocks,o=window.wp.element,n=window.wp.components,l=window.wp.i18n,s=window.wp.blockEditor;function r({numberOfItems:e,order:t,orderBy:s,offset:r,ignoreStickyPosts:a,maxItems:c=100,minItems:d=1,showAllPosts:p,postType:i,onNumberOfItemsChange:u,onOrderChange:m,onOrderByChange:b,onOffsetChange:g,onIgnoreStickyPostsChange:h,onshowAllPostsChange:y}){const _=[{label:(0,l.__)("Date","advanced-posts-blocks"),value:"date"},{label:(0,l.__)("Title","advanced-posts-blocks"),value:"title"}];return[b&&(0,o.createElement)(n.SelectControl,{key:"query-controls-order-by-select",label:(0,l.__)("Order by","advanced-posts-blocks"),value:s,options:i?.supports?.["page-attributes"]?[..._,{label:(0,l.__)("Page Order","advanced-posts-blocks"),value:"menu_order"}]:_,onChange:e=>{e!==s&&b(e)}}),m&&(0,o.createElement)(n.SelectControl,{key:"query-controls-order-select",label:(0,l.__)("Order","advanced-posts-blocks"),value:t,options:[{label:(0,l.__)("DESC","advanced-posts-blocks"),value:"desc"},{label:(0,l.__)("ASC","advanced-posts-blocks"),value:"asc"}],onChange:e=>{e!==t&&m(e)}}),!p&&u&&(0,o.createElement)(n.RangeControl,{key:"query-controls-range-control",label:(0,l.__)("Number of items","advanced-posts-blocks"),value:e,onChange:u,min:d,max:c}),h&&(0,o.createElement)(n.CheckboxControl,{key:"query-controls-nopaging-control",label:(0,l.__)("Show all posts","advanced-posts-blocks"),checked:p,onChange:y}),g&&(0,o.createElement)(n.RangeControl,{key:"query-controls-offset-control",label:(0,l.__)("Offset","advanced-posts-blocks"),value:r,onChange:g,min:0,max:c}),h&&(0,o.createElement)(n.CheckboxControl,{key:"query-controls-ignore-sticky-posts-control",label:(0,l.__)("Ignore sticky posts","advanced-posts-blocks"),checked:a,onChange:h})]}const a=window.lodash,c=window.wp.data,d=({onChange:e,value:t,filter:s=(()=>!0)})=>{const r=(0,c.useSelect)((e=>e("core").getPostTypes({per_page:-1})||[]),[]).filter((e=>!["attachment","wp_block"].includes(e.slug))).filter(s);return(0,o.createElement)(n.SelectControl,{label:(0,l.__)("Post Type","advanced-posts-blocks"),value:t.slug,options:r.map((e=>({label:e.name,value:e.slug}))),onChange:t=>{const o=r.find((e=>e.slug===t));e(o)}})},p=JSON.parse('{"name":"advanced-posts-blocks/children","title":"Child Posts","icon":"networking","Y4":{"Xo":{"Z":"title"}},"supports":{"align":["center","wide","full"],"html":false},"category":"widgets"}'),i=window.wp.serverSideRender;var u=e.n(i);function m({title:e,children:t}){return(0,o.createElement)(n.Placeholder,{label:e},t)}const b=(0,o.memo)((({name:e,attributes:t,title:l,emptyResponseLabel:s})=>(0,o.createElement)(u(),{block:e,attributes:t,LoadingResponsePlaceholder:()=>(0,o.createElement)(m,null,(0,o.createElement)(n.Spinner,null)),EmptyResponsePlaceholder:()=>(0,o.createElement)(m,{title:l},s)}))),g=b,{name:h,title:y}=p,{name:_,supports:k,category:v,icon:w}=p,C=(0,l.__)("Child Posts","advanced-posts-blocks");(0,t.registerBlockType)(_,{supports:k,category:v,title:`${C} (Advanced Posts Blocks)`,description:(0,l.__)("Display children of selected post.","advanced-posts-blocks"),keywords:["child posts","children",(0,l.__)("children posts","advanced-posts-blocks")],icon:w,edit:({attributes:e,setAttributes:i})=>{const{postId:u,postsToShow:m,order:b,orderBy:_,postType:k,className:v}=e,w=(0,c.useSelect)((e=>e("core/editor").getCurrentPostType()),[]),C=(f=k||w,(0,c.useSelect)((e=>e("core").getPostType(f)||{}),[f]));var f;const E=((e,t)=>(0,c.useSelect)((o=>""===t.search?[]:o("core").getEntityRecords("postType",e.slug,t)||[]),[e.slug,t]))(C,{orderby:_,per_page:-1}),P=C.labels||{},O=function(e){const t=e.map((e=>({children:[],parent:0,...e}))),o=(0,a.groupBy)(t,"parent");if(o.null&&o.null.length)return t;const n=e=>e.map((e=>{const t=o[e.id];return{...e,children:t&&t.length?n(t):[]}}));return n(o[0]||[])}(E.map((e=>({id:e.id,parent:e.parent,name:e.title.raw?e.title.raw:`#${e.id} ${(0,l.__)("(no title)","advanced-posts-blocks")}`})))),S=e=>e.map((e=>e.children.length>0?{...e,children:S(e.children)}:null)).filter((e=>e)),T=(0,o.createElement)(n.TreeSelect,{label:P.parent_item_colon,noOptionLabel:`${(0,l.__)("(This Page)","advanced-posts-blocks")}`,tree:S(O),selectedId:u,onChange:e=>{i({postId:e?parseInt(e):void 0})}}),B=(0,o.createElement)(s.InspectorControls,null,(0,o.createElement)(n.PanelBody,{title:(0,l.__)("Query setting","advanced-posts-blocks")},(0,o.createElement)(d,{value:C,filter:({supports:e})=>e["page-attributes"],onChange:e=>{i({postType:e.slug}),e?.supports["page-attributes"]||"menu_order"!==_||i({orderBy:p.Y4.Xo.Z})}}),T,(0,o.createElement)(r,{postType:C,showAllPosts:!0,order:b,orderBy:_,numberOfItems:m,onOrderChange:e=>i({order:e}),onOrderByChange:e=>i({orderBy:e}),onNumberOfItemsChange:e=>i({postsToShow:e})}))),I=(0,t.getBlockDefaultClassName)(h),N=((e,t=[])=>{const o=(e=>e.flatMap((e=>e?e.split(" "):[])))(t),{className:n}=e,l=n?n.split(" "):[];return{...e,className:l.filter((e=>!o.includes(e))).join(" ")}})((0,s.useBlockProps)(),[I,v]);return(0,o.createElement)("div",{...N},B,(0,o.createElement)(n.Disabled,null,(0,o.createElement)(g,{name:h,attributes:e,title:y,emptyResponseLabel:P.not_found})))},save:()=>null})})();
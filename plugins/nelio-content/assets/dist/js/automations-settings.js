(()=>{var e={4184:(e,t)=>{var n;!function(){"use strict";var o={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var r=typeof n;if("string"===r||"number"===r)e.push(n);else if(Array.isArray(n)){if(n.length){var a=i.apply(null,n);a&&e.push(a)}}else if("object"===r){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var s in n)o.call(n,s)&&n[s]&&e.push(s)}}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()},5779:(e,t)=>{"use strict";t.yR=function(e){return e}}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};(()=>{"use strict";n.r(o),n.d(o,{initPage:()=>Na});var e={};n.r(e),n.d(e,{areAuthorsValid:()=>R,getAutomationGroup:()=>y,getAutomationGroups:()=>g,getCustomFields:()=>C,getCustomPlaceholders:()=>O,getEditingTemplate:()=>S,getEditingTemplateErrors:()=>N,getEditingTemplateType:()=>A,getGroupTermsValidation:()=>M,getImportExportData:()=>L,getNetworkAutomationSettings:()=>x,getProfileAutomationSettings:()=>_,getProfileError:()=>G,getProfileFrequencies:()=>I,getTemplateErrors:()=>D,isDirty:()=>b,isEditingNetworkTemplate:()=>k,isEditingNewTemplate:()=>w,isEditingTemplate:()=>T,isGroupValid:()=>Z,isPostTypeValid:()=>P,isSaving:()=>E,isTemplateValid:()=>j});var t={};n.r(t),n.d(t,{addAutomationGroup:()=>V,addProfileSettings:()=>B,closeTemplateEditor:()=>F,closeTemplateImportExport:()=>$,deleteAutomationGroup:()=>z,deleteAutomationGroupTemplate:()=>W,initAutomationGroups:()=>K,markAsNetworkTemplate:()=>ne,markAsSaving:()=>oe,openTemplateEditor:()=>J,openTemplateExporter:()=>Y,openTemplateImporter:()=>H,receiveAutomationGroupTemplates:()=>X,receiveCustomFields:()=>Q,receiveCustomPlaceholders:()=>ee,setAutomationGroupValidation:()=>ie,setEditingTemplateAttributes:()=>re,setEditingTemplateErrors:()=>ae,setProfileFrequencies:()=>te,updateAutomationGroup:()=>q});var i={};n.r(i),n.d(i,{saveAutomationGroups:()=>_e});var r={};n.r(r),n.d(r,{getCustomFields:()=>Ie,getCustomPlaceholders:()=>Ce});const a=window.wp.element,s=window.wp.i18n,l=window.NelioContent.components,u=window.wp.data,c=window.lodash,d=window.NelioContent.utils;var p="nelio-content/automation-settings",m={automationGroups:{byId:{universal:{id:"universal",priority:100,publication:{type:"always"},profileSettings:{},networkSettings:{}}},allIds:["universal"]},validations:{universal:{areAuthorsValid:!0,areTermsValid:{},isPostTypeValid:!0,socialProfileErrors:{},templateErrors:{}}},frequencies:{},isSaving:!1,templateEditor:{attributes:void 0,isNew:!1,isNetwork:!1,customFields:{},customPlaceholders:{},errors:{author:!1,target:!1,content:!1,availability:!1,taxonomies:{}}},templateImportExport:void 0},f=function(){return f=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},f.apply(this,arguments)},h=function(e,t,n){if(n||2===arguments.length)for(var o,i=0,r=t.length;i<r;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))};function v(e){var t=e.automationGroups.byId;return f(f({},e),{automationGroups:f(f({},e.automationGroups),{byId:f({universal:(0,d.fixAttributesInGroup)(t.universal)},(0,c.mapValues)((0,c.omit)(t,"universal"),d.fixAttributesInGroup))})})}function g(e){return e.automationGroups.allIds}function y(e,t){return e.automationGroups.byId[t]}function _(e,t,n){var o;return(0,c.find)(null===(o=y(e,t))||void 0===o?void 0:o.profileSettings,{profileId:n})}function x(e,t,n){var o;return(0,c.find)(null===(o=y(e,t))||void 0===o?void 0:o.networkSettings,{name:n})}function b(e,t,n){var o=(0,c.values)(e.automationGroups.byId),i=t;return n.some((function(t){var n=e.frequencies[t.id];return(null==n?void 0:n.publication)!==Math.max(1,t.publicationFrequency)||(null==n?void 0:n.reshare)!==Math.max(1,t.reshareFrequency)}))||JSON.stringify(o)!==JSON.stringify(i)}function E(e){return!!e.isSaving}function T(e){return!!e.templateEditor.attributes}function w(e){return T(e)&&e.templateEditor.isNew}function k(e){return T(e)&&e.templateEditor.isNetwork}function S(e){var t=e.templateEditor.attributes;return t?(0,c.omit)(t,"type"):void 0}function N(e){return e.templateEditor.errors}function A(e){var t;return(null===(t=e.templateEditor.attributes)||void 0===t?void 0:t.type)||"publication"}function I(e,t){return e.frequencies[t]}function C(e){return e.templateEditor.customFields}function O(e){return e.templateEditor.customPlaceholders}function P(e,t){var n,o;return null===(o=null===(n=e.validations[t])||void 0===n?void 0:n.isPostTypeValid)||void 0===o||o}function R(e,t){var n,o;return null===(o=null===(n=e.validations[t])||void 0===n?void 0:n.areAuthorsValid)||void 0===o||o}function M(e,t){var n;return(null===(n=e.validations[t])||void 0===n?void 0:n.areTermsValid)||{}}function Z(e,t){var n,o=(0,c.values)(M(e,t)).every(Boolean);return P(e,t)&&R(e,t)&&o&&(0,c.keys)(null===(n=y(e,t))||void 0===n?void 0:n.profileSettings).every((function(n){return!G(e,t,n)}))}function G(e,t,n){var o,i=_(e,t,n);if(!i)return!1;var r=null===(o=e.validations[t])||void 0===o?void 0:o.socialProfileErrors[n];if(r)return r;var a=function(n){return!n.enabled||(0,c.map)(n.templates,"id").every((function(n){return j(e,t,n)}))};return a(i.publication)?!a(i.reshare)&&(0,s._x)("Please review reshare templates","text","nelio-content"):(0,s._x)("Please review publication templates","user","nelio-content")}function j(e,t,n){var o,i=null===(o=e.validations[t])||void 0===o?void 0:o.templateErrors[n];return(0,c.keys)((0,c.omit)(i,"taxonomies")).every((function(e){return!(null==i?void 0:i[e])}))&&(0,c.keys)(null==i?void 0:i.taxonomies).every((function(e){return!(null==i?void 0:i.taxonomies[e])}))}function D(e,t,n){var o;return null===(o=e.validations[t])||void 0===o?void 0:o.templateErrors[n]}function L(e){return e.templateImportExport}var U=function(){return U=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},U.apply(this,arguments)};function V(e){return{type:"ADD_AUTOMATION_GROUP",group:e}}function q(e,t){return{type:"UPDATE_AUTOMATION_GROUP",groupId:e,attrs:t}}function B(e,t){return{type:"ADD_PROFILE_SETTINGS",groupId:e,settings:t}}function F(){return{type:"CLOSE_TEMPLATE_EDITOR"}}function $(){return{type:"CLOSE_TEMPLATE_IMPORT_EXPORT"}}function z(e){return{type:"DELETE_AUTOMATION_GROUP",groupId:e}}function W(e){return{type:"DELETE_AUTOMATION_GROUP_TEMPLATE",template:e}}function K(e,t){return{type:"INIT_AUTOMATION_GROUPS",automationGroups:e,profiles:t}}function J(e,t,n){return{type:"OPEN_TEMPLATE_EDITOR",template:U(U({},t),{type:e}),isNew:"new"===n}}function H(e,t,n){return{type:"OPEN_TEMPLATE_IMPORTER",groupId:e,profileId:t,templateType:n}}function Y(e){return{type:"OPEN_TEMPLATE_EXPORTER",templates:(0,c.castArray)(e)}}function X(e,t){return{type:"RECEIVE_AUTOMATION_GROUP_TEMPLATES",templateType:e,templates:(0,c.castArray)(t)}}function Q(e){return{type:"RECEIVE_CUSTOM_FIELDS",customFields:e}}function ee(e){return{type:"RECEIVE_CUSTOM_PLACEHOLDERS",customPlaceholders:e}}function te(e,t){return{type:"SET_PROFILE_FREQUENCIES",profileId:e,frequencies:t}}function ne(e){return{type:"MARK_AS_NETWORK_TEMPLATE",isNetwork:e}}function oe(e){return{type:"MARK_AS_SAVING",isSaving:e}}function ie(e,t){return{type:"SET_AUTOMATION_GROUP_VALIDATION",groupId:e,validation:t}}function re(e){return{type:"SET_EDITING_TEMPLATE_ATTRIBUTES",attributes:e}}function ae(e){return{type:"SET_EDITING_TEMPLATE_ERRORS",errors:e}}const se=window.wp.apiFetch;var le=n.n(se);const ue=window.wp.coreData,ce=window.wp.notices,de=window.NelioContent.data;var pe,me,fe=function(){return fe=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},fe.apply(this,arguments)},he=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},ve=function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},ge=null!==(pe=null===ue.store||void 0===ue.store?void 0:ue.store.name)&&void 0!==pe?pe:"core",ye=null!==(me=null===ce.store||void 0===ce.store?void 0:ce.store.name)&&void 0!==me?me:"core/notices";function _e(){return he(this,void 0,void 0,(function(){var e,t,n,o,i,r,a,l,c;return ve(this,(function(m){switch(m.label){case 0:return(0,u.dispatch)(p).markAsSaving(!0),e=(0,u.select)(p),t=e.getAutomationGroup,n=e.getAutomationGroups,[4,Promise.all(n().map(t).filter(d.isDefined).map(Ee))];case 1:o=m.sent(),m.label=2;case 2:return m.trys.push([2,5,,6]),i=(0,u.select)(de.STORE_NAME).getSiteId(),r=(0,u.select)(de.STORE_NAME).getApiRoot(),a=(0,u.select)(de.STORE_NAME).getAuthenticationToken(),[4,xe()];case 3:return l=m.sent(),[4,le()({url:"".concat(r,"/site/").concat(i,"/automation-groups"),method:"PUT",credentials:"omit",mode:"cors",headers:{Authorization:"Bearer ".concat(a)},data:o})];case 4:return c=m.sent(),(0,u.dispatch)(p).initAutomationGroups(c,l),(0,u.dispatch)(de.STORE_NAME).resetAutomationGroups(c),[3,6];case 5:return f=m.sent(),(0,u.dispatch)(ye).createErrorNotice(f.message||(0,s._x)("Something went wrong","text","nelio-content")),[3,6];case 6:return(0,u.dispatch)(p).markAsSaving(!1),[2]}var f}))}))}var xe=function(){return he(void 0,void 0,void 0,(function(){return ve(this,(function(e){return[2,Promise.all((0,u.select)(de.STORE_NAME).getSocialProfiles().map((function(e){return he(void 0,void 0,void 0,(function(){var t,n,o,i,r;return ve(this,(function(a){switch(a.label){case 0:return be(e)&&(t=(0,u.select)(p).getProfileFrequencies(e.id))?(n=(0,u.select)(de.STORE_NAME).getSiteId(),o=(0,u.select)(de.STORE_NAME).getApiRoot(),i=(0,u.select)(de.STORE_NAME).getAuthenticationToken(),[4,le()({url:"".concat(o,"/site/").concat(n,"/profile/").concat(e.id),method:"PUT",credentials:"omit",mode:"cors",headers:{Authorization:"Bearer ".concat(i)},data:{publicationFrequency:t.publication,reshareFrequency:t.reshare}})]):[2,e];case 1:return r=a.sent(),(0,u.dispatch)(de.STORE_NAME).receiveSocialProfiles(r),[2,r]}}))}))})))]}))}))},be=function(e){var t=(0,u.select)(p).getProfileFrequencies(e.id);return(null==t?void 0:t.publication)!==e.publicationFrequency||(null==t?void 0:t.reshare)!==e.reshareFrequency},Ee=function(e){return he(void 0,void 0,void 0,(function(){var t,n,o;return ve(this,(function(i){switch(i.label){case 0:return(0,d.isUniversalGroup)(e)?[2,e]:[4,Se(e.postType)];case 1:return t=i.sent(),n=ke(e.postType),o=Te({taxonomies:t,supportsAuthors:n}),[2,fe(fe({},e),{authors:!1===n?[]:e.authors,taxonomies:(0,c.pick)(e.taxonomies,t),profileSettings:(0,c.mapValues)(e.profileSettings,o),networkSettings:(0,c.pickBy)((0,c.mapValues)(e.networkSettings,o),(function(e){return!(!e||!e.publication.templates.length&&!e.reshare.templates.length)}))})]}}))}))},Te=function(e){return function(t){var n=we(e);return fe(fe({},t),{publication:fe(fe({},t.publication),{templates:(0,c.map)(t.publication.templates,n)}),reshare:fe(fe({},t.reshare),{templates:(0,c.map)(t.reshare.templates,n)})})}},we=function(e){return function(t){return fe(fe({},t),{author:!1===e.supportsAuthors?void 0:t.author,taxonomies:(0,c.pick)(t.taxonomies,e.taxonomies)})}},ke=function(e){var t;return null===(t=(0,u.select)(de.STORE_NAME).getPostType(e))||void 0===t?void 0:t.supports.author},Se=function(e){return he(void 0,void 0,void 0,(function(){var t;return ve(this,(function(n){switch(n.label){case 0:return[4,(0,(0,u.resolveSelect)(ge).getTaxonomies)({per_page:-1})];case 1:return t=n.sent(),[2,(0,c.castArray)(t).filter((function(e){return!!e})).filter((function(t){return t.types.includes(e)})).map((function(e){return e.slug}))]}}))}))},Ne=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},Ae=function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};function Ie(){return Ne(this,void 0,void 0,(function(){var e;return Ae(this,(function(t){switch(t.label){case 0:return[4,le()({path:"/nelio-content/v1/custom-fields"})];case 1:return e=t.sent(),(0,u.dispatch)(p).receiveCustomFields(e),[2]}}))}))}function Ce(){return Ne(this,void 0,void 0,(function(){var e;return Ae(this,(function(t){switch(t.label){case 0:return[4,le()({path:"/nelio-content/v1/custom-placeholders"})];case 1:return e=t.sent(),(0,u.dispatch)(p).receiveCustomPlaceholders(e),[2]}}))}))}var Oe=function(){return Oe=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Oe.apply(this,arguments)},Pe=Oe(Oe({},t),i);(0,u.registerStore)(p,{reducer:function(e,t){var n;return void 0===e&&(e=m),null!==(n=function(e,t){var n,o,i,r,a,s,l;switch(t.type){case"ADD_AUTOMATION_GROUP":if(e.automationGroups.byId[t.group.id])return e;var u=f(f({},e.automationGroups.byId),((n={})[t.group.id]=t.group,n));return v(f(f({},e),{automationGroups:{byId:u,allIds:h(["universal"],(0,c.keys)(u).filter((function(e){return"universal"!==e})),!0)}}));case"UPDATE_AUTOMATION_GROUP":return e.automationGroups.byId[t.groupId]?"universal"===t.groupId?v(f(f({},e),{automationGroups:f(f({},e.automationGroups),{byId:f(f({},e.automationGroups.byId),{universal:f(f({},e.automationGroups.byId.universal),t.attrs)})})})):v(f(f({},e),{automationGroups:f(f({},e.automationGroups),{byId:f(f({},e.automationGroups.byId),(o={},o[t.groupId]=f(f({},e.automationGroups.byId[t.groupId]),t.attrs),o))})})):e;case"ADD_PROFILE_SETTINGS":var d=e.automationGroups.byId[t.groupId];if(!d)return e;var p=f(f({},d),{profileSettings:f(f({},d.profileSettings),(i={},i[t.settings.profileId]=t.settings,i))});return v(f(f({},e),{automationGroups:f(f({},e.automationGroups),{byId:f(f({},e.automationGroups.byId),(r={},r[p.id]=p,r))})}));case"CLOSE_TEMPLATE_EDITOR":return f(f({},e),{templateEditor:f(f({},e.templateEditor),{attributes:void 0,isNew:!1})});case"CLOSE_TEMPLATE_IMPORT_EXPORT":return f(f({},e),{templateImportExport:void 0});case"DELETE_AUTOMATION_GROUP":return e.automationGroups.allIds.includes(t.groupId)?f(f({},e),{automationGroups:{byId:(0,c.omit)(e.automationGroups.byId,t.groupId),allIds:h(["universal"],(0,c.without)((0,c.filter)(e.automationGroups.allIds,(function(e){return"universal"!==e})),t.groupId),!0)}}):e;case"DELETE_AUTOMATION_GROUP_TEMPLATE":return v(function(e,t){var n,o,i,r,a=e.automationGroups.byId[t.groupId];if(!a)return e;var s=t.profileId?"profileSettings":"networkSettings",l=null!==(r=t.profileId)&&void 0!==r?r:t.network,u=t.profileId?a.profileSettings[t.profileId]:a.networkSettings[t.network];return u?f(f({},e),{automationGroups:f(f({},e.automationGroups),{byId:f(f({},e.automationGroups.byId),(n={},n[t.groupId]=f(f({},a),(o={},o[s]=f(f({},a[s]),(i={},i[l]=f(f({},u),{publication:f(f({},u.publication),{templates:u.publication.templates.filter((function(e){return e.id!==t.id}))}),reshare:f(f({},u.reshare),{templates:u.reshare.templates.filter((function(e){return e.id!==t.id}))})}),i)),o)),n))})}):e}(e,t.template));case"INIT_AUTOMATION_GROUPS":return v(f(f({},e),{automationGroups:{byId:f({universal:e.automationGroups.byId.universal},(0,c.keyBy)(t.automationGroups,"id")),allIds:h(["universal"],(0,c.map)(t.automationGroups,"id").filter((function(e){return"universal"!==e})),!0)},frequencies:(0,c.mapValues)((0,c.keyBy)(t.profiles,"id"),(function(e){return{publication:Math.max(1,e.publicationFrequency),reshare:Math.max(1,e.reshareFrequency)}}))}));case"OPEN_TEMPLATE_EDITOR":return f(f({},e),{templateEditor:f(f({},e.templateEditor),{attributes:t.template,isNew:t.isNew,isNetwork:!t.isNew&&!t.template.profileId})});case"OPEN_TEMPLATE_IMPORTER":return f(f({},e),{templateImportExport:f({mode:"import"},(0,c.omit)(t,"type"))});case"OPEN_TEMPLATE_EXPORTER":return f(f({},e),{templateImportExport:f({mode:"export"},(0,c.omit)(t,"type"))});case"MARK_AS_NETWORK_TEMPLATE":return e.templateEditor.attributes&&e.templateEditor.isNew?f(f({},e),{templateEditor:f(f({},e.templateEditor),{isNetwork:t.isNetwork})}):e;case"MARK_AS_SAVING":return f(f({},e),{isSaving:t.isSaving});case"RECEIVE_AUTOMATION_GROUP_TEMPLATES":return(0,c.reduce)(t.templates,(l=t.templateType,function(e,t){var n,o,i,r,a,s,u=null!==(s=t.profileId)&&void 0!==s?s:t.network,d=e.automationGroups.byId[t.groupId];if(!d)return e;var p=t.profileId?d.profileSettings:d.networkSettings,m=p[u];if(!m)return e;var h=m[l].templates;return f(f({},e),{automationGroups:f(f({},e.automationGroups),{byId:f(f({},e.automationGroups.byId),(n={},n[t.groupId]=f(f({},d),(o={},o[t.profileId?"profileSettings":"networkSettings"]=f(f({},p),(i={},i[u]=f(f({},m),(r={},r[l]=f(f({},m[l]),{templates:(0,c.values)(f(f({},(0,c.keyBy)(h,"id")),(a={},a[t.id]=t,a)))}),r)),i)),o)),n))})})}),e);case"RECEIVE_CUSTOM_FIELDS":return f(f({},e),{templateEditor:f(f({},e.templateEditor),{customFields:t.customFields})});case"RECEIVE_CUSTOM_PLACEHOLDERS":return f(f({},e),{templateEditor:f(f({},e.templateEditor),{customPlaceholders:t.customPlaceholders})});case"SET_PROFILE_FREQUENCIES":var m=e.frequencies[t.profileId];return m?f(f({},e),{frequencies:f(f({},e.frequencies),(a={},a[t.profileId]=f(f({},m),t.frequencies),a))}):e;case"SET_AUTOMATION_GROUP_VALIDATION":return f(f({},e),{validations:f(f({},e.validations),(s={},s[t.groupId]=t.validation,s))});case"SET_EDITING_TEMPLATE_ATTRIBUTES":return e.templateEditor.attributes?f(f({},e),{templateEditor:f(f({},e.templateEditor),{attributes:f(f({},e.templateEditor.attributes),t.attributes)})}):e;case"SET_EDITING_TEMPLATE_ERRORS":return e.templateEditor.attributes?f(f({},e),{templateEditor:f(f({},e.templateEditor),{errors:t.errors})}):e}}(e,t))&&void 0!==n?n:e},controls:u.controls,actions:Pe,selectors:e,resolvers:r});var Re=[{title:(0,s._x)("Settings - Social Profiles","text","nelio-content"),intro:(0,s._x)("Welcome to the Social Automations Screen. Here you can customize which content from your site can be automatically shared by Nelio Content and where it should be shared.","user","nelio-content"),elementToClick:function(){return document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item")}},{title:(0,s._x)("Automation Groups","text","nelio-content"),intro:(0,s._x)("An Automation Group allows you to select some content from your WordPress site and customize where and how it should be shared.","user","nelio-content"),elementToClick:function(){return document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item")},element:function(){return document.querySelector(".nelio-content-automation-group:first-child")}},{title:(0,s._x)("Automation Groups","text","nelio-content"),intro:(0,s._x)("In general, the first section of an automation group lets you filter your WordPress content by its type, taxonomies, author, and publication date.","user","nelio-content"),elementToClick:function(){return document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item")},element:function(){return document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group-settings__section")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item")}},{title:(0,s._x)("Automation Groups","text","nelio-content"),intro:(0,s._x)("However, the Universal Group limits this selection to the publication date only.","user","nelio-content"),elementToClick:function(){return document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item")},element:function(){return document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group-settings__extra")}},{title:(0,s._x)("Automation Groups","text","nelio-content"),intro:(0,s._x)("Once you’ve established which content is shareable, you can select the social profiles where Nelio Content is allowed to share it.","user","nelio-content"),elementToClick:function(){return document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item")},element:function(){return document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group-settings__section + .nelio-content-automation-group-settings__section")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item")}},{title:(0,s._x)("Automation Groups","text","nelio-content"),intro:(0,s._x)("Click on each social profile to toggle it. If it’s selected, Nelio Content might use it to share content on your behalf.","user","nelio-content"),elementToClick:function(){return document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item")},element:function(){return document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group-settings__section + .nelio-content-automation-group-settings__section")}},{title:(0,s._x)("Social Profile Settings","text","nelio-content"),intro:(0,s._x)("Active social profiles will show up here. Click on any profile to further customize how Nelio Content should use it to share your content.","user","nelio-content"),elementToClick:function(){return document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)")},element:function(){return document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar")}},{title:(0,s._x)("Social Profile Settings","text","nelio-content"),intro:(0,s.sprintf)(/* translators: 1 -> a dashicon, 2 -> another dashicon */
(0,s._x)("In particular, you can customize if and how Nelio Content should share content on publication (%1$s) and on reshare (%2$s).","user","nelio-content"),'<span class="dashicons dashicons-megaphone"></span>','<span class="dashicons dashicons-share-alt"></span>'),elementToClick:function(){return document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)")},element:function(){return document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-profile-settings__tab-selector")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar")}},{title:(0,s._x)("Social Profile Settings","text","nelio-content"),intro:(0,s._x)("If you enable social automations for a profile, you’ll be able to specify how many social messages should be created by Nelio Content when sharing new content, as well as the Social Templates is should use to do so, thus setting the tone of your auto-publications. Please notice the number of messages you set in one automation group is actually shared across all your groups.","user","nelio-content"),elementToClick:function(){return document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)")},element:function(){return document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-templates")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-profile-settings")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-profile-settings")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)")||document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar")}},{title:(0,s._x)("Duplicate and Delete","text","nelio-content"),intro:(0,s._x)("You can easily duplicate an existing group or delete it using the actions here.","user","nelio-content"),elementToClick:function(){return document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)")},element:function(){return document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-actions")}},{title:(0,s._x)("Temporary Deactivation","text","nelio-content"),intro:(0,s._x)("If you want to disable a set of posts from being auto-shared, you can easily do so by toggling this button in the desired automation group.","user","nelio-content"),elementToClick:function(){return document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item:not(:first-child)")},element:function(){return document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__header-content-activation-toggle")}},{title:(0,s._x)("Save Changes","text","nelio-content"),intro:(0,s._x)("Once you’re happy with your setup, don’t forget to save your changes using this button!","user","nelio-content"),elementToClick:function(){return document.querySelector(".nelio-content-automation-group:first-child .nelio-content-automation-group__sidebar-item")},element:function(){return document.querySelector(".nelio-content-save-automation-groups")}}];const Me=window.wp.components;var Ze=n(4184),Ge=n.n(Ze),je=n(5779);const De=window.NelioContent.networks;var Le,Ue=function(e,t,n){if(n||2===arguments.length)for(var o,i=0,r=t.length;i<r;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))},Ve=null!==(Le=null===ue.store||void 0===ue.store?void 0:ue.store.name)&&void 0!==Le?Le:"core",qe=function(){return(0,u.useSelect)((function(e){var t=e(de.STORE_NAME),n=t.getAutomationGroup,o=t.getAutomationGroups,i=t.getSocialProfiles,r=o().map(n).filter(d.isDefined),a=i();return e(p).isDirty(r,a)}))};function Be(e){return(0,u.useSelect)((function(t){var n=t(p).getAutomationGroup;return e?n(e):void 0}))}var Fe=function(e,t){var n=Be(e),o=(0,u.useDispatch)(p).updateAutomationGroup;return[n?n[t]:void 0,function(i){var r;n&&o(e,((r={})[t]=i,r))}]},$e=function(e){var t=(0,c.map)(ze(e),"slug"),n=(0,u.useSelect)((function(e){var n=e(Ve),o=n.hasFinishedResolution,i=n.hasResolutionFailed,r=n.getEntityRecords,a=function(e,t){return o(e,t)||i(e,t)},s={per_page:10,context:"edit",search:"",page:1,exclude:[]},l={per_page:10,context:"view",search:"",page:1,exclude:[],who:"authors"};return t.forEach((function(e){return r("taxonomy",e,s)})),r("root","user",l),Ue(Ue([],t.map((function(e){return a("getEntityRecords",["taxonomy",e,s])})),!0),[a("getEntityRecords",["root","user",l])],!1)}));return n.every(Boolean)},ze=function(e){return ot()[e||"nc_any"]||[]},We=function(e){return!!it()[e||"nc_any"]},Ke=function(e,t){var n=it(),o=(0,c.mapValues)(ot(),(function(e){return(0,c.map)(e,"slug")})),i=et(t);return(0,u.useSelect)((function(r){var a=r(Ve),s=a.getEntityRecord,l=a.hasFinishedResolution,u=a.hasResolutionFailed,p=function(e,t,n){return!(n&&!s(e,t,n,{context:"user"===t?"view":"edit"})&&(o="getEntityRecord",i=[e,t,n,{context:"user"===t?"view":"edit"}],l(o,i)||u(o,i)));var o,i},m=function(e,t){return!t||!(null==e?void 0:e.length)||e.includes(t)};return e?(0,c.mapValues)((0,c.keyBy)((0,c.castArray)(t),"id"),(function(t){var r;return{target:!!t.profileId&&!!(0,De.doesNetworkSupport)("multi-target",t.network)&&!t.targetName&&(0,De.getTargetLabel)("selectTargetError",t.network),content:null!==(r=i[t.id])&&void 0!==r&&r,availability:!!t.availability&&rt(t.availability),author:lt({doesAuthorExist:p("root","user",t.author),isAuthorSupported:!!n[t.postType||"nc_any"],isGroupAuthor:(0,d.isUniversalGroup)(e)||m(e.authors,t.author)}),taxonomies:(0,c.pick)((0,c.mapValues)(t.taxonomies,(function(t,n){return ut({doesTermExist:p("taxonomy",n,t),isGroupTerm:(0,d.isUniversalGroup)(e)||m(e.taxonomies[n],t)})})),o[t.postType||"nc_any"]||[])}})):{}}),[JSON.stringify(n),JSON.stringify(o),JSON.stringify(i),JSON.stringify(t)])},Je=function(){return(0,u.useSelect)((function(e){return e(p).isSaving()}))},He=function(e){var t=(0,de.usePostTypes)();if(!e)return(0,s._x)("All Content","text","nelio-content");var n=t.find((function(t){return t.name===e}));return(null==n?void 0:n.labels.plural)||(0,s.sprintf)(/* translators: post type name */
(0,s._x)("Post type %s","text","nelio-content"),e)},Ye=function(e){var t=(0,u.useSelect)((function(t){var n=t("core").getEntityRecord;return e.map((function(e){var t;return null===(t=n("root","user",e,{context:"view"}))||void 0===t?void 0:t.name})).filter(d.isDefined)}));return t.length?(0,s.sprintf)(/* translators: author name(s) */
(0,s._x)("by %s","text","nelio-content"),(0,d.listify)("or",t)):""},Xe=function(e,t){var n,o,i,r,a,l,p,m,f=(0,c.map)(ze(e),"slug"),h=(0,c.keys)(t).filter((function(e){return f.includes(e)})),v=(0,u.useSelect)((function(e){var t=e("core").getTaxonomy,n=(0,c.map)(h,(function(e){var n;return null===(n=t(e))||void 0===n?void 0:n.labels.singular_name}));return(0,c.pickBy)((0,c.zipObject)(h,n),(function(e){return"string"==typeof e}))}),[JSON.stringify(h)]),g=(0,c.pick)(t,h),y=(0,u.useSelect)((function(e){var t=e("core").getEntityRecord;return(0,c.mapValues)(g,(function(e,n){return(0,c.map)(e,(function(e){var o;return null===(o=t("taxonomy",n,e,{context:"edit"}))||void 0===o?void 0:o.name})).filter(d.isDefined)}))}),[JSON.stringify(g)]),_=(0,c.keys)(v).filter((function(e){var t;return!!(null===(t=y[e])||void 0===t?void 0:t.length)})),x=!!(null===(n=y[d.CAT])||void 0===n?void 0:n.length)||!!(null===(o=y[d.PROD_CAT])||void 0===o?void 0:o.length),b=!!(null===(i=y[d.TAG])||void 0===i?void 0:i.length)||!!(null===(r=y[d.PROD_TAG])||void 0===r?void 0:r.length),E=[];x&&E.push((0,s.sprintf)(/* translators: category names */
(0,s._x)("in %s","text","nelio-content"),(0,d.listify)("or",null!==(l=null!==(a=y[d.CAT])&&void 0!==a?a:y[d.PROD_CAT])&&void 0!==l?l:[]))),b&&E.push((0,s.sprintf)(/* translators: tag names */
(0,s._x)("tagged as %s","text","nelio-content"),(0,d.listify)("or",null!==(m=null!==(p=y[d.TAG])&&void 0!==p?p:y[d.PROD_TAG])&&void 0!==m?m:[])));var T=_.filter((function(e){return![d.CAT,d.PROD_CAT,d.TAG,d.PROD_TAG].includes(e)})).map((function(e,t){var n,o;return t?(0,s.sprintf)(/* translators: 1 -> taxonomy name, 2 -> taxonomy terms */
(0,s._x)("%2$s in taxonomy %1$s","text","nelio-content"),v[e],(0,d.listify)("or",null!==(o=y[e])&&void 0!==o?o:[])):(0,s.sprintf)(/* translators: 1 -> taxonomy name, 2 -> taxonomy terms */
(0,s._x)("with %2$s in taxonomy %1$s","text","nelio-content"),v[e],(0,d.listify)("or",null!==(n=y[e])&&void 0!==n?n:[]))}));return(0,d.listify)("and",Ue(Ue([],E,!0),T,!0))},Qe=function(e){return"always"===e.type?"":{30:(0,s._x)("from last month","text","nelio-content"),60:(0,s._x)("from last two months","text","nelio-content"),90:(0,s._x)("from last three months","text","nelio-content"),180:(0,s._x)("from last six months","text","nelio-content"),365:(0,s._x)("from last year","text","nelio-content")}["".concat(e.days)]||(0,s.sprintf)(/* translators: number of days */
(0,s._x)("from last %d days","text","nelio-content"),e.days)},et=function(e){var t=(0,c.mapValues)(tt(),(function(e){return(0,c.map)(e,"key")})),n=(0,c.mapValues)(nt(),(function(e){return(0,c.map)(e,"key")})),o=it(),i=(0,c.mapValues)(ot(),(function(e){return(0,c.map)(e,"slug")})),r=(0,c.map)(e,(function(e){if(!(0,c.trim)(e.text).length)return(0,s._x)("Please create a template with some content","user","nelio-content");var r=/* translators: a placeholder name, like author or tags */
(0,s._x)("Unsupported %s placeholder found in template","text","nelio-content");if(!o[e.postType||"nc_any"]&&e.text.includes("{author}"))return(0,s.sprintf)(r,"{author}");var a=i[e.postType||"nc_any"]||[];if(!a.includes(d.CAT)&&!a.includes(d.PROD_CAT)&&e.text.includes("{categories}"))return(0,s.sprintf)(r,"{categories}");if(!a.includes(d.TAG)&&!a.includes(d.PROD_TAG)&&e.text.includes("{tags}"))return(0,s.sprintf)(r,"{tags}");for(var l=0,u=(0,c.map)(Array.from(e.text.matchAll(/{taxonomy:([^}]+)}/g)),1);l<u.length;l++){var p=u[l];if(!a.map(je.yR).includes(p))return(0,s.sprintf)(r,"{taxonomy:".concat(p,"}"))}for(var m=e.postType?t[e.postType]||[]:(0,c.values)(t).flatMap((function(e){return e})),f=0,h=(0,c.map)(Array.from(e.text.matchAll(/{field:([^}]+)}/g)),1);f<h.length;f++){var v=h[f];if(!m.map(je.yR).includes(v))return(0,s.sprintf)(r,"{field:".concat(v,"}"))}for(var g=e.postType?n[e.postType]||[]:(0,c.values)(n).flatMap((function(e){return e})),y=0,_=(0,c.map)(Array.from(e.text.matchAll(/{custom:([^}]+)}/g)),1);y<_.length;y++){var x=_[y];if(!g.map(je.yR).includes(x))return(0,s.sprintf)(r,"{custom:".concat(x,"}"))}return!1})),a=(0,c.map)(e,"id");return(0,c.zipObject)(a,r)},tt=function(){return(0,u.useSelect)((function(e){return e(p).getCustomFields()}))},nt=function(){return(0,u.useSelect)((function(e){return e(p).getCustomPlaceholders()}))},ot=function(){var e=(0,de.usePostTypes)(),t=(0,c.filter)((0,u.useSelect)((function(e){return e("core").getTaxonomies({per_page:-1})}),[]),(function(e){return e.visibility.public}));return(0,c.reduce)(Ue(["nc_any"],(0,c.map)(e,"name"),!0),(function(e,n){return e[n]=(0,c.filter)(t,(function(e){return"nc_any"===n||e.types.includes(n)})),e}),{nc_any:[]})},it=function(){var e=(0,de.usePostTypes)();return(0,c.reduce)(Ue(["nc_any"],(0,c.map)(e,"name"),!0),(function(t,n){return t[n]=e.filter((function(e){return"nc_any"===n||e.name===n})).some((function(e){return e.supports.author})),t}),{nc_any:!1})},rt=function(e){switch(e.type){case"publication-day-offset":return!(0<=e.hoursAfterPublication&&e.hoursAfterPublication<=24)&&(0,s._x)("Please select a number of hours after publication between 0 and 24 for the availability time.","user","nelio-content");case"publication-day-period":return at(e.time);case"after-publication":return e.daysAfterPublication<0?(0,s._x)("Please select a valid positive number of days after publication for the availability date.","user","nelio-content"):at(e.time);case"reshare":return(0,c.values)(e.weekday).some(Boolean)?at(e.time):(0,s._x)("Please select at least one day for the availability date or the template will not be used.","user","nelio-content")}},at=function(e){return!ct(e)&&(0,s._x)("Please select a valid availability time.","user","nelio-content")},st=function(e){switch(e){case"morning":return(0,s._x)("in the morning","text","nelio-content");case"noon":return(0,s._x)("at noon","text","nelio-content");case"afternoon":return(0,s._x)("in the afternoon","text","nelio-content");case"night":return(0,s._x)("at night","text","nelio-content");default:return(0,s.sprintf)(/* translators: a fixed time in the format HH:mm */(0,s._x)("at %s","text","nelio-content"),e)}},lt=function(e){var t=e.doesAuthorExist,n=e.isAuthorSupported,o=e.isGroupAuthor;return!!n&&(t?!o&&(0,s._x)("The author is not among those selected in the automation group","text","nelio-content"):(0,s._x)("Selected author doesn’t exist","text","nelio-content"))},ut=function(e){var t=e.doesTermExist,n=e.isGroupTerm;return t?!n&&(0,s._x)("The term is not among those selected in the automation group","text","nelio-content"):(0,s._x)("Selected term doesn’t exist","text","nelio-content")},ct=function(e){return dt(e)||/^(?:[01][0-9]|2[0-3]):[0-5][0-9](?::[0-5][0-9])?$/.test(e)},dt=function(e){return["morning","noon","afternoon","night"].includes(e)};function pt(e){return e.map((function(e){switch(e){case"mon":return(0,s._x)("Monday","text","nelio-content");case"tue":return(0,s._x)("Tuesday","text","nelio-content");case"wed":return(0,s._x)("Wednesday","text","nelio-content");case"thu":return(0,s._x)("Thursday","text","nelio-content");case"fri":return(0,s._x)("Friday","text","nelio-content");case"sat":return(0,s._x)("Saturday","text","nelio-content");case"sun":return(0,s._x)("Sunday","text","nelio-content");default:return""}}))}var mt,ft=function(e,t){var n=(0,a.useState)(t.length?"loading-entities":"loading-groups"),o=n[0],i=n[1],r="authors"===e?ht(t):vt(t),s="authors"===e?"root":"taxonomy",l="authors"===e?"view":"edit";(0,a.useEffect)((function(){t.length&&"loading-groups"===o&&i("loading-entities")}),[!!t.length,o]);var d=(0,u.useSelect)((function(e){return e(Ve),"loading-entities"===o&&(0,c.keys)(r).length?{loadedEntities:(0,c.mapValues)(r,(function(t,n){return(0,c.chunk)(t,100).flatMap((function(t){return(0,c.map)(e(Ve).getEntityRecords(s,n,{include:t.join(","),per_page:t.length,context:l}),(function(e){return e.id}))}))})),hasFinishedResolution:(0,c.every)((0,c.values)((0,c.mapValues)(r,(function(t,n){return(0,c.every)((0,c.chunk)(t,100).flatMap((function(t){return e(Ve).hasFinishedResolution("getEntityRecords",[s,n,{include:t.join(","),per_page:t.length,context:l}])})))}))))}:{loadedEntities:{},hasFinishedResolution:!0}})),p=d.loadedEntities,m=d.hasFinishedResolution,f=function(){var e=(0,u.useDispatch)(Ve),t=e.startResolution,n=e.finishResolution;return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];null==t||t.apply(void 0,e),null==n||n.apply(void 0,e)}}();return(0,a.useEffect)((function(){"loading-entities"===o&&m&&((0,c.mapValues)(p,(function(e,t){return e.forEach((function(e){return f("getEntityRecord",[s,t,e,{context:l}])}))})),i("done"))}),[o,m]),"done"!==o},ht=function(e){var t=e.flatMap((function(e){return Ue(Ue([],(0,c.values)(e.profileSettings),!0),(0,c.values)(e.networkSettings),!0)})).flatMap((function(e){return Ue(Ue([],e.publication.templates,!0),e.reshare.templates,!0)})).map((function(e){return e.author})).filter(d.isDefined),n=e.flatMap((function(e){return(0,d.isUniversalGroup)(e)?[]:e.authors}));return{user:(0,c.uniq)(Ue(Ue([],t,!0),n,!0))}},vt=function(e){var t=e.flatMap((function(e){return Ue(Ue([],(0,c.values)(e.profileSettings),!0),(0,c.values)(e.networkSettings),!0)})).flatMap((function(e){return Ue(Ue([],e.publication.templates,!0),e.reshare.templates,!0)})).map((function(e){return(0,c.mapValues)(e.taxonomies,(function(e){return[e]}))})),n=e.flatMap((function(e){return(0,d.isUniversalGroup)(e)?[]:e.taxonomies})),o=Ue(Ue([],t,!0),n,!0),i=(0,c.reduce)(o,(function(e,t){return(0,c.mergeWith)(e,t,(function(e,t){return(0,c.isArray)(e)&&(0,c.isArray)(t)?Ue(Ue([],e,!0),t,!0):void 0}))}),{});return(0,c.mapValues)(i,c.uniq)},gt=function(e){var t=e.groupId,n=e.isActive,o=e.isExpanded,i=e.onToggle,r=e.onToggleActivation,u=function(e){var t=Be(e),n=function(e){var t=e.authors,n=e.postType,o=e.publication,i=e.taxonomies,r=He(n),a=Ye(null!=t?t:[]),l=Xe(n,null!=i?i:{}),u=Qe(null!=o?o:{type:"always"}),d=(0,s.sprintf)(/* translators: 1 -> plural post type name (like “Posts” or “Pages”) or “All Content”, 2 -> byline, 3 -> in taxonomy, 4 -> published time */
(0,s._x)("%1$s %2$s %3$s %4$s","text","nelio-content"),r,a,l,u);return(0,c.trim)(d.replace(/\s+/g," "))}(null!=t?t:{});return(0,d.isUniversalGroup)(t)?(0,s._x)("Universal Group","text","nelio-content"):(null==t?void 0:t.name)||n}(t),p=_t(t),m=Je();return a.createElement("div",{className:"nelio-content-automation-group__header",onClick:i,"aria-hidden":"true"},a.createElement("div",{className:"nelio-content-automation-group__header-content",onClick:i,"aria-hidden":"true"},a.createElement("div",{className:"nelio-content-automation-group__header-content-activation-toggle",onClick:function(e){return e.stopPropagation()},"aria-hidden":"true"},a.createElement(Me.ToggleControl,{checked:n,onChange:r,disabled:m})),a.createElement(yt,{groupId:t,isActive:n,isExpanded:o}),a.createElement("div",{className:"nelio-content-automation-group__header-content-title"},u),a.createElement("div",{className:"nelio-content-automation-group__header-content-icons"},p.length<=4?p.map((function(e){var t=e.id;return a.createElement(l.SocialProfileIcon,{key:t,profileId:t})})):p.slice(0,3).map((function(e){var t=e.id;return a.createElement(l.SocialProfileIcon,{key:t,profileId:t})})),p.length>4&&a.createElement("div",{className:"nelio-content-automation-group__header-content-remaining-profiles"},"+".concat(p.length-4+1)))),a.createElement("div",{className:"nelio-content-automation-group__header-toggle"},a.createElement(Me.Button,{disabled:m,icon:o?"arrow-up":"arrow-down",onClick:i})))},yt=function(e){var t=e.groupId,n=e.isActive,o=e.isExpanded,i=xt(t),r=bt(t),l=(0,de.useIsSubscribed)("standard");return!n&&!o||i&&(o||r)?l||"universal"===t?null:a.createElement(Me.Tooltip,{text:(0,s._x)("Upgrade to Nelio Content Standard to be able to use this automation group","user","nelio-content"),position:"bottom right",delay:0},a.createElement("div",{className:Ge()({"nelio-content-automation-group--is-warning":!0,"nelio-content-automation-group--is-expanded":o})})):a.createElement(Me.Tooltip,{text:r?(0,s._x)("Please review this group’s settings and its active social profiles","user","nelio-content"):(0,s._x)("This group does not have any profiles selected","text","nelio-content"),position:"bottom right",delay:0},a.createElement("div",{className:Ge()({"nelio-content-automation-group--is-invalid":!i||!o&&!r,"nelio-content-automation-group--is-expanded":o})}))},_t=function(e){return(0,u.useSelect)((function(t){var n=t(p).getAutomationGroup(e);if(!n)return[];var o=(0,c.values)(n.profileSettings).filter((function(e){return e.enabled})).map((function(e){return e.profileId}));return t(de.STORE_NAME).getSocialProfiles().filter((function(e){return o.includes(e.id)}))}))},xt=function(e){return(0,u.useSelect)((function(t){return t(p).isGroupValid(e)}))},bt=function(e){var t=Be(e);return!!(0,c.values)(null==t?void 0:t.profileSettings).filter((function(e){return e.enabled})).length},Et=new Uint8Array(16);function Tt(){if(!mt&&!(mt="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return mt(Et)}const wt=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var kt=[],St=0;St<256;++St)kt.push((St+256).toString(16).substr(1));const Nt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(kt[e[t+0]]+kt[e[t+1]]+kt[e[t+2]]+kt[e[t+3]]+"-"+kt[e[t+4]]+kt[e[t+5]]+"-"+kt[e[t+6]]+kt[e[t+7]]+"-"+kt[e[t+8]]+kt[e[t+9]]+"-"+kt[e[t+10]]+kt[e[t+11]]+kt[e[t+12]]+kt[e[t+13]]+kt[e[t+14]]+kt[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&wt.test(e)}(n))throw TypeError("Stringified UUID is invalid");return n},At=function(e,t,n){var o=(e=e||{}).random||(e.rng||Tt)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=o[i];return t}return Nt(o)};var It,Ct=function(){return Ct=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ct.apply(this,arguments)},Ot=function(e,t,n){if(n||2===arguments.length)for(var o,i=0,r=t.length;i<r;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))},Pt=function(e){var t=e.activeTab,n=e.groupId,o=e.setActiveTab,i=(0,a.useState)(!1),r=i[0],c=i[1],m=Je(),f=Mt(n),h=(0,u.useSelect)((function(e){return e(p).getAutomationGroup(n)})),v=(0,u.useDispatch)(p),g=v.addAutomationGroup,y=v.deleteAutomationGroup,_=Zt();return h?a.createElement("div",{className:"nelio-content-automation-group__sidebar"},f.map((function(e,n){return a.createElement("div",{className:Ge()({"nelio-content-automation-group__sidebar-item":!0,"nelio-content-automation-group__sidebar-item--active":Rt(e,t)}),key:n,onClick:function(){return!m&&o(e)},"aria-hidden":"true"},"settings"===e.type?a.createElement(Me.Dashicon,{icon:"admin-settings"}):a.createElement(Me.Tooltip,{text:e.displayName,position:"bottom right",delay:0},a.createElement("div",{className:"nelio-content-profile__icon-and-indicator"},a.createElement(l.SocialProfileIcon,{className:Ge()({"nelio-content-profile__profile-icon":!0,"nelio-content-profile__profile-icon--is-selected":Rt(e,t),"nelio-content-profile__profile-icon--is-invalid":!e.isValid}),profileId:e.id,isNetworkHidden:!1}),a.createElement("div",{className:Ge()({"nelio-content-profile__profile-indicator":!0,"nelio-content-profile__profile-indicator--is-invalid":!e.isValid})}))))})),a.createElement("div",{className:"nelio-content-automation-group__sidebar-item nelio-content-automation-group__sidebar-item--is-spacer"}),a.createElement("div",{className:"nelio-content-automation-group__sidebar-item nelio-content-automation-group__sidebar-actions"},a.createElement(Me.DropdownMenu,{icon:"admin-generic",label:(0,s._x)("Actions","text","nelio-content"),toggleProps:{disabled:m},controls:Ot([{title:(0,s._x)("Duplicate group","command","nelio-content"),icon:"admin-page",onClick:function(){return g(_(h))}}],(0,d.isUniversalGroup)(h)?[]:[{title:(0,s._x)("Remove group","command","nelio-content"),icon:"trash",onClick:function(){return c(!0)}}],!0)}),"universal"!==n&&a.createElement(l.ConfirmationDialog,{isOpen:r,confirmLabel:(0,s._x)("Delete","command","nelio-content"),onConfirm:function(){c(!1),y(n)},onCancel:function(){return c(!1)},text:(0,s._x)("Are you sure you want to delete this group? This operation can’t be undone.","user","nelio-content"),title:(0,s._x)("Delete group","text","nelio-content")}))):null},Rt=function(e,t){if(e.type!==t.type)return!1;switch(e.type){case"settings":return!0;case"profile":return"profile"===t.type&&e.id===t.id}},Mt=function(e){var t=Be(e);return(0,u.useSelect)((function(n){if(!t)return[];var o=(0,c.values)(t.profileSettings).filter((function(e){return e.enabled})).map((function(e){return e.profileId})),i=n(de.STORE_NAME).getSocialProfiles().filter((function(e){return o.includes(e.id)})),r=n(p).getProfileError;return Ot([{type:"settings"}],i.map((function(t){return{displayName:r(e,t.id)||t.displayName,type:"profile",id:t.id,isValid:!r(e,t.id)}})),!0)}))},Zt=function(){var e,t,n=null!==(t=null===(e=(0,de.usePostTypes)()[0])||void 0===e?void 0:e.name)&&void 0!==t?t:d.POST;return function(e){var t,o=Ct(Ct({postType:(0,d.isUniversalGroup)(e)?n:e.postType,authors:[],taxonomies:{}},e),{id:(0,d.createAutomationGroupId)(),name:(0,d.isUniversalGroup)(e)?(0,s._x)("Copy of Universal Group","text","nelio-content"):(0,s.sprintf)(/* translators: automation group name */
(0,s._x)("Copy of %s","text","nelio-content"),null!==(t=e.name)&&void 0!==t?t:(0,s._x)("Unnamed Group","text","nelio-content"))}),i=(0,c.cloneDeep)(o);return Ct(Ct({},i),{name:(i.name||"")+(0,s._x)(" (duplicate)","text","nelio-content"),profileSettings:(0,c.mapValues)(i.profileSettings,(function(e){return Ct(Ct({},e),{publication:Ct(Ct({},e),{templates:e.publication.templates.map((function(e){return Ct(Ct({},e),{groupId:i.id,id:At()})}))}),reshare:Ct(Ct({},e.reshare),{templates:e.reshare.templates.map((function(e){return Ct(Ct({},e),{groupId:i.id,id:At()})}))})})})),networkSettings:(0,c.mapValues)(i.networkSettings,(function(e){return e?Ct(Ct({},e),{publication:Ct(Ct({},e.publication),{templates:e.publication.templates.map((function(e){return Ct(Ct({},e),{groupId:i.id,id:At()})}))}),reshare:Ct(Ct({},e.reshare),{templates:e.reshare.templates.map((function(e){return Ct(Ct({},e),{groupId:i.id,id:At()})}))})}):void 0}))})}},Gt=function(){return Gt=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Gt.apply(this,arguments)},jt=function(e,t,n){if(n||2===arguments.length)for(var o,i=0,r=t.length;i<r;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))},Dt=null!==(It=null===ue.store||void 0===ue.store?void 0:ue.store.name)&&void 0!==It?It:"core";const Lt=window.React;function Ut(e){return e.startsWith("{{/")?{type:"componentClose",value:e.replace(/\W/g,"")}:e.endsWith("/}}")?{type:"componentSelfClosing",value:e.replace(/\W/g,"")}:e.startsWith("{{")?{type:"componentOpen",value:e.replace(/\W/g,"")}:{type:"string",value:e}}function Vt(e,t){let n,o,i=[];for(let r=0;r<e.length;r++){const a=e[r];if("string"!==a.type){if(void 0===t[a.value])throw new Error(`Invalid interpolation, missing component node: \`${a.value}\``);if("object"!=typeof t[a.value])throw new Error(`Invalid interpolation, component node must be a ReactElement or null: \`${a.value}\``);if("componentClose"===a.type)throw new Error(`Missing opening component token: \`${a.value}\``);if("componentOpen"===a.type){n=t[a.value],o=r;break}i.push(t[a.value])}else i.push(a.value)}if(n){const r=function(e,t){const n=t[e];let o=0;for(let i=e+1;i<t.length;i++){const e=t[i];if(e.value===n.value){if("componentOpen"===e.type){o++;continue}if("componentClose"===e.type){if(0===o)return i;o--}}}throw new Error("Missing closing component token `"+n.value+"`")}(o,e),a=Vt(e.slice(o+1,r),t),s=(0,Lt.cloneElement)(n,{},a);if(i.push(s),r<e.length-1){const n=Vt(e.slice(r+1),t);i=i.concat(n)}}return i=i.filter(Boolean),0===i.length?null:1===i.length?i[0]:(0,Lt.createElement)(Lt.Fragment,null,...i)}function qt(e){const{mixedString:t,components:n,throwErrors:o}=e;if(!n)return t;if("object"!=typeof n){if(o)throw new Error(`Interpolation Error: unable to process \`${t}\` because components is not an object`);return t}const i=function(e){return e.split(/(\{\{\/?\s*\w+\s*\/?\}\})/g).map(Ut)}(t);try{return Vt(i,n)}catch(e){if(o)throw new Error(`Interpolation Error: unable to process \`${t}\` because of error \`${e.message}\``);return t}}var Bt=[{value:"always",label:(0,s._x)("Any date","text","nelio-content")},{value:"30",label:(0,s._x)("Last month","text","nelio-content")},{value:"60",label:(0,s._x)("Last two months","text","nelio-content")},{value:"90",label:(0,s._x)("Last three months","text","nelio-content")},{value:"180",label:(0,s._x)("Last six months","text","nelio-content")},{value:"365",label:(0,s._x)("Last year","text","nelio-content")}],Ft=function(e){var t=e.value,n=e.onChange,o="always"===t.type?"always":"".concat(t.days);return a.createElement(Me.SelectControl,{label:(0,s._x)("Publication date","text","nelio-content"),options:Bt,value:o,onChange:function(e){return n("always"===e?{type:"always"}:{type:"max-age",days:parseInt(e)||30})}})},$t=function(){return $t=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},$t.apply(this,arguments)},zt=function(e){var t=e.groupId,n=e.disabled,o=e.profileId,i=(0,de.useSocialProfile)(o),r=Wt(t,o),s=r[0],u=r[1],c=i||{},d=c.displayName,p=void 0===d?"":d,m=c.network,f=void 0===m?"twitter":m;return a.createElement(Me.Tooltip,{text:"".concat(p," (").concat((0,De.getNetworkLabel)("name",f),")"),delay:0},a.createElement("li",{className:Ge()({"nelio-content-profile-selector__profile":!0,"nelio-content-profile-selector__profile--is-selected":s,"nelio-content-profile-selector__profile--is-disabled":n})},a.createElement("span",{className:"screen-reader-text"},"".concat(p,": ")),a.createElement("input",{className:"nelio-content-profile-selector__profile-input-field",disabled:n,type:"checkbox",checked:!!s,onChange:function(){return u(!s)}}),a.createElement("div",{className:"nelio-content-profile-selector__icon-and-indicator"},a.createElement(l.SocialProfileIcon,{className:Ge()({"nelio-content-profile-selector__profile-icon":!0,"nelio-content-profile-selector__profile-icon--is-selected":s}),profileId:o,isNetworkHidden:!1}),a.createElement("div",{className:Ge()({"nelio-content-profile-selector__profile-indicator":!0,"nelio-content-profile-selector__profile-indicator--is-selected":s})}))))},Wt=function(e,t){var n=Be(e),o=(0,u.useSelect)((function(e){return e(de.STORE_NAME).getSocialProfile(t)})),i=(0,c.find)(null==n?void 0:n.profileSettings,{profileId:t}),r=(0,u.useDispatch)(p).addProfileSettings;return[!!(null==i?void 0:i.enabled),function(a){n&&o&&r(e,$t($t({profileId:t,network:o.network,publication:{enabled:!0,templates:[(0,d.createSocialTemplate)({groupId:n.id,text:"{title} {permalink}",network:o.network,profileId:o.id,postType:void 0}),(0,d.createSocialTemplate)({groupId:n.id,text:"{highlight} {permalink}",network:o.network,profileId:o.id,postType:void 0}),(0,d.createSocialTemplate)({groupId:n.id,text:"{phrase} {permalink}",network:o.network,profileId:o.id,postType:void 0})]},reshare:{enabled:!1,templates:[]}},i),{enabled:a}))}]},Kt=function(e){var t=e.groupId,n=Jt(),o=(0,de.useAdminUrl)("admin.php",{page:"nelio-content-settings"});return a.createElement("div",{className:"nelio-content-automation-group-settings__section"},a.createElement("p",{className:"nelio-content-automation-group-settings__section-title"},(0,s._x)("Where should your content be shared?","user","nelio-content")),a.createElement("div",{className:"nelio-content-automation-group-settings__section-content"},n.length?a.createElement(a.Fragment,null,a.createElement("p",{className:"screen-reader-text"},(0,s._x)("Select one or more profiles:","text","nelio-content")),a.createElement("ul",{className:"nelio-content-automation-group-settings__profile-list"},n.map((function(e){var n=e.id;return a.createElement("div",{className:"nelio-content-automation-group-settings__profile-list-item",key:n},a.createElement(zt,{groupId:t,profileId:n}))})))):a.createElement("p",null,qt({mixedString:(0,s._x)("There aren’t any social profiles connected to Nelio Content. <a>Connect one first</a> and then configure its auto share settings here.","user","nelio-content").replace("<a>","{{a}}").replace("</a>","{{/a}}"),components:{a:a.createElement("a",{href:o},".")}}))))},Jt=function(){return(0,de.useSocialProfiles)().filter((function(e){return(0,De.doesNetworkSupport)("automations",e.network)}))},Ht=function(){var e=(0,c.map)((0,de.usePostTypes)(),(function(e){return e.labels.plural})),t=(0,d.listify)("and",(0,c.map)(e,(function(e){return"<strong>".concat(e,"</strong>")}))),n=(0,de.useAdminUrl)("admin.php",{page:"nelio-content-settings",tab:"advanced"});return a.createElement("div",{className:"nelio-content-automation-group-settings"},a.createElement("div",{className:"nelio-content-automation-group-settings__section"},a.createElement("p",{className:"nelio-content-automation-group-settings__section-title"},(0,s._x)("Which content should be shared?","user","nelio-content")),a.createElement("div",{className:"nelio-content-automation-group-settings__section-content"},a.createElement(Me.BaseControl,{id:"nelio-content-universal-post-types",label:(0,s._x)("Post Types","text","nelio-content")},a.createElement("p",{className:"nelio-content-automation-group-settings__universal-post-types"},qt({mixedString:(0,s.sprintf)(/* translators: list of post type names */
(0,s._x)("When enabled, the universal group applies to all your <a>managed post types</a>: %s.","text","nelio-content"),t).replace(/<(\/)?strong>/g,"{{$1strong}}").replace(/<(\/)?a>/g,"{{$1a}}"),components:{strong:a.createElement("strong",null),a:a.createElement("a",{href:n},".")}}))),a.createElement(Yt,null))),a.createElement(Kt,{groupId:"universal"}))},Yt=function(){var e=Be("universal"),t=(0,u.useDispatch)(p).updateAutomationGroup;if(!(0,d.isUniversalGroup)(e))return null;var n=e.publication;return a.createElement("div",{className:"nelio-content-automation-group-settings__extra"},a.createElement(Ft,{value:n,onChange:function(e){return t("universal",{publication:e})}}))},Xt=function(){return Xt=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Xt.apply(this,arguments)},Qt=function(e){var t=e.groupId,n=(0,de.usePostTypes)().map((function(e){return{value:e.name,label:e.labels.plural}})),o=Fe(t,"name"),i=o[0],r=o[1],l=Fe(t,"postType"),c=l[0],d=l[1],m=(0,u.useSelect)((function(e){return e(p).isPostTypeValid(t)}));return a.createElement("div",{className:"nelio-content-automation-group-settings"},a.createElement(Me.TextControl,{className:"nelio-content-automation-group-settings__group-name",label:(0,s._x)("Group name","text","nelio-content"),value:null!=i?i:"",onChange:r}),a.createElement("p",{className:"nelio-content-automation-group-settings__section-title"},(0,s._x)("Which content should be shared?","user","nelio-content")),a.createElement("div",{className:"nelio-content-automation-group-settings__section-content"},a.createElement(Me.SelectControl,{label:(0,s._x)("Post Type","text","nelio-content"),help:!m&&a.createElement("span",{className:"nelio-content-error-help"},(0,s._x)("The selected post type is not valid.","text","nelio-content")),options:n,value:c,onChange:d}),a.createElement(en,{groupId:t})),a.createElement(Kt,{groupId:t}))},en=function(e){var t=e.groupId,n=Fe(t,"postType")[0],o=We(n),i=Fe(t,"taxonomies"),r=i[0],d=void 0===r?{}:r,m=i[1],f=Fe(t,"authors"),h=f[0],v=void 0===h?[]:h,g=f[1],y=Fe(t,"publication"),_=y[0],x=void 0===_?{type:"always"}:_,b=y[1],E=(0,a.useState)((0,c.values)(d).some((function(e){return e.length}))||v.length||x&&"always"!==x.type),T=E[0],w=E[1],k=ze(n),S=$e(n),N=(0,u.useSelect)((function(e){var n=e(p);return{areAuthorsValid:n.areAuthorsValid(t),areTermsValid:n.getGroupTermsValidation(t)}})),A=N.areAuthorsValid,I=N.areTermsValid;return T?S?a.createElement("div",{className:"nelio-content-automation-group-settings__extra"},k.map((function(e){var t;return a.createElement(l.ItemSelectControl,{id:"nelio-content-automation-group-settings-taxonomies",error:!I[e.slug]&&(0,s._x)("Some terms are not valid.","text","nelio-content"),key:e.slug,kind:"taxonomy",label:e.labels.name,name:e.slug,placeholder:e.labels.filter_by_item,value:null!==(t=d[e.slug])&&void 0!==t?t:[],onChange:function(t){var n;return m(Xt(Xt({},d),((n={})[e.slug]=t,n)))}})})),o&&a.createElement(l.ItemSelectControl,{id:"nelio-content-automation-group-settings-authors",error:!A&&(0,s._nx)("The selected author is not valid.","Some of the selected authors are not valid.",v.length,"text","nelio-content"),kind:"author",label:(0,s._x)("Authors","text","nelio-content"),placeholder:(0,s._x)("Filter by author","text","nelio-content"),value:v,onChange:g}),a.createElement(Ft,{value:x,onChange:b})):a.createElement("div",{className:"nelio-content-automation-group-settings__extra"},a.createElement(Me.Spinner,null)):a.createElement("div",{className:"nelio-content-automation-group-settings__extra"},a.createElement(Me.Button,{className:"nelio-content-automation-group-settings__extra-action",variant:"link",onClick:function(){return w(!0)}},(0,s._x)("Show additional filters","command","nelio-content")))},tn=function(e){var t=e.groupId;return"universal"===t?a.createElement(Ht,null):a.createElement(Qt,{groupId:t})},nn=/({title}|{permalink}|{phrase}|{highlight}|{tags}|{author}|{categories}|{excerpt}|{field:[^}]*}|{custom:[^}]*}|{taxonomy:[^}]*})/g,on=function(e){var t=rn(e),n=an(t),o=sn(e),i=(0,u.useDispatch)(p),r=i.deleteAutomationGroupTemplate,c=i.openTemplateEditor,m=i.openTemplateExporter;return t?a.createElement("div",{"data-template-type":"network"===e.type?(0,s._x)("Network","text (network template)","nelio-content"):"",className:Ge()({"nelio-content-social-template":!0,"nelio-content-social-template--is-network":"network"===e.type})},a.createElement("div",{className:"nelio-content-social-template__text"},un(t.text)),a.createElement("div",{className:Ge()({"nelio-content-social-template__extra":!0,"nelio-content-social-template__extra--is-invalid":!o})},a.createElement("span",{className:Ge()({"nelio-content-social-template__filters":!0,"nelio-content-social-template__filters--is-invalid":!o})},n),a.createElement("div",{className:"nelio-content-social-template__actions"},a.createElement("span",null,"•"),a.createElement(Me.Button,{variant:"link",onClick:function(){return c(e.templateType,t)}},(0,s._x)("Edit","command","nelio-content")),"|",a.createElement(Me.Button,{variant:"link",onClick:function(){return m((0,d.makeExportedTemplate)(t))}},(0,s._x)("Export","command","nelio-content")),e.canBeDeleted&&a.createElement(a.Fragment,null,a.createElement("span",null,"|"),a.createElement(l.DeleteButton,{confirmationLabels:{title:(0,s._x)("Delete Template","text","nelio-content"),text:(0,s._x)("Are you sure you want to delete this social template? If you then save your social automations, you won’t be able to recover it.","user","nelio-content")},onClick:function(){return r(t)}}))))):null},rn=function(e){var t,n,o,i,r,a,s=Be(e.groupId);if(s){var l=s.profileSettings,u=s.networkSettings;switch(e.type){case"network":return null!==(n=(0,c.find)(null===(t=u[e.networkName])||void 0===t?void 0:t.publication.templates,{id:e.templateId}))&&void 0!==n?n:(0,c.find)(null===(o=u[e.networkName])||void 0===o?void 0:o.reshare.templates,{id:e.templateId});case"profile":return null!==(r=(0,c.find)(null===(i=l[e.profileId])||void 0===i?void 0:i.publication.templates,{id:e.templateId}))&&void 0!==r?r:(0,c.find)(null===(a=l[e.profileId])||void 0===a?void 0:a.reshare.templates,{id:e.templateId})}}},an=function(e){var t=function(e){var t,n=e.attachment,o=e.author,i=e.postType,r=e.taxonomies,a=e.availability,l=He(i),u=Ye((0,d.isDefined)(o)?[o]:[]),p=Xe(i,null!==(t=(0,c.mapValues)(r,c.castArray))&&void 0!==t?t:{}),m=function(e){if(!e)return"";var t="";switch(e.type){case"publication-day-offset":t=0===e.hoursAfterPublication?(0,s._x)("on publication","text","nelio-content"):(0,s.sprintf)(/* translators: number of hours */
(0,s._nx)("%d hour after publication","%d hours after publication",e.hoursAfterPublication,"text","nelio-content"),e.hoursAfterPublication);break;case"publication-day-period":t=st(e.time);break;case"after-publication":switch(e.daysAfterPublication){case 0:t=(0,s._x)("on publication","text","nelio-content");break;case 1:t=(0,s._x)("the day after publication","text","nelio-content");break;case 7:t=(0,s._x)("one week after publication","text","nelio-content");break;case 28:case 29:case 30:case 31:t=(0,s._x)("one month after publication","text","nelio-content");break;default:t=(0,s.sprintf)(/* translators: number of days */
(0,s._x)("%d days after publication","text","nelio-content"),e.daysAfterPublication)}t+=" "+st(e.time);break;case"reshare":var n=(0,c.keys)(e.weekday).filter((function(t){return!1!==e.weekday[t]}));t=(7===n.length?(0,s._x)("every day","text","nelio-content"):2===n.length&&n.includes("sat")&&n.includes("sun")?(0,s._x)("on weekends","text","nelio-content"):5!==n.length||n.includes("sat")||n.includes("sun")?1===n.length?(0,s.sprintf)(/* translators: a day of the week */
(0,s._x)("all week but %s, ","text","nelio-content"),pt(n)[0]):(0,s.sprintf)(/* translators: a list of days */
(0,s._x)("on %s","text","nelio-content"),(0,d.listify)("and",pt(n))):(0,s._x)("on weekdays","text","nelio-content"))+" "+st(e.time)}return(0,s.sprintf)(/* translators: time period */
(0,s._x)(", used %s","text","nelio-content"),t)}(a),f=function(e){if(!e)return"";switch(e){case"none":return(0,s._x)("(text only)","text","nelio-content");case"image":return(0,s._x)("(image)","text","nelio-content");case"video":return(0,s._x)("(video)","text","nelio-content")}}(n),h=(0,s.sprintf)(/* translators: 1 -> plural post type name, 2 -> byline, 3 -> in taxonomy, 4 -> availability time, 5 -> text / image template */
(0,s._x)("%1$s %2$s %3$s %4$s %5$s","text","nelio-content"),l,u,p,m,f);return(0,c.trim)(h.replace(/\s+/g," ").replace(/ , /g,", "))}({attachment:null==e?void 0:e.attachment,postType:null==e?void 0:e.postType,author:null==e?void 0:e.author,taxonomies:null==e?void 0:e.taxonomies,availability:null==e?void 0:e.availability});return ln(e)||t},sn=function(e){return(0,u.useSelect)((function(t){var n=e.groupId,o=e.templateId;return t(p).isTemplateValid(n,o)}))},ln=function(e){var t=(0,u.useSelect)((function(t){var n=t(p).getTemplateErrors;return e&&n(e.groupId,e.id)}));return t?t.target||t.content||(t.author?t.author:(0,c.values)(t.taxonomies).some(Boolean)?(0,s._x)("Please review selected terms","user","nelio-content"):t.availability?(0,s._x)("Please review availability settings","user","nelio-content"):""):""},un=function(e){return qt({mixedString:cn(e),components:{code:a.createElement("span",{className:"nelio-content-social-template__code-tag"}),newline:a.createElement("span",{className:"nelio-content-social-template__newline-tag"})}})},cn=function(e){return(0,c.flow)(dn,pn,mn,fn,c.trim)(" ".concat(e," "))},dn=function(e){return e.replace(/\r?\n/g,"¶")},pn=function(e){return e.replace(new RegExp("{{","g"),"{⁠{").replace(new RegExp("}}","g"),"}⁠}")},mn=function(e){return e.replace(nn,"{{code}}$1{{/code}}")},fn=function(e){return e.replace(/ *\\u00b6 */g,"{{newline}}¶{{/newline}}")},hn=function(e,t,n){if(n||2===arguments.length)for(var o,i=0,r=t.length;i<r;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))},vn=function(e){var t=(0,a.useState)(0),n=t[0],o=t[1];(0,a.useEffect)((function(){return o(0)}),[e.profileId]);var i=(0,u.useDispatch)(p),r=i.openTemplateEditor,l=i.openTemplateExporter,m=i.openTemplateImporter,f=Be(e.groupId),h=xn(e),v=yn(e.profileId),g=1===(null==h?void 0:h.length);if(!h||!v)return null;var y=h.length<=20?[h]:(0,c.chunk)(h,10),_=y.length,x=_>1;return a.createElement("div",{className:"nelio-content-automation-templates"},a.createElement("div",{className:"nelio-content-automation-templates__header"},a.createElement("h3",{className:"nelio-content-automation-templates__title"},(0,s._x)("Social Templates","text","nelio-content"),x?" (".concat(h.length,")"):""),a.createElement(Me.Button,{isSmall:!0,variant:"secondary",onClick:function(){if(f){var t=(0,d.createSocialTemplate)({groupId:f.id,text:"",network:v,profileId:e.profileId,postType:(0,d.isUniversalGroup)(f)?void 0:f.postType});r(e.mode,t,"new")}}},(0,s._x)("Add Template","command","nelio-content")),a.createElement(Me.Button,{isSmall:!0,variant:"secondary",onClick:function(){return m(e.groupId,e.profileId,e.mode)}},(0,s._x)("Import","command","nelio-content")),!!h.length&&a.createElement(Me.Button,{isSmall:!0,variant:"secondary",onClick:function(){return l(h.map(d.makeExportedTemplate))}},(0,s._x)("Export","command","nelio-content")),x&&a.createElement(gn,{mode:"title",current:n,total:_,onChange:o})),a.createElement("div",{className:"nelio-content-automation-templates__content"},(0,c.map)(y[n],(function(t){return t.profileId?a.createElement(on,{key:t.id,type:"profile",groupId:e.groupId,profileId:t.profileId,templateId:t.id,templateType:e.mode,canBeDeleted:!g}):a.createElement(on,{key:t.id,type:"network",groupId:e.groupId,networkName:t.network,templateId:t.id,templateType:e.mode,canBeDeleted:!g})}))),x&&a.createElement(gn,{mode:"footer",current:n,total:_,onChange:o}))},gn=function(e){var t=e.mode,n=e.current,o=e.total,i=e.onChange;return a.createElement("div",{className:"nelio-content-automation-templates__pagination nelio-content-automation-templates__pagination--".concat(t)},a.createElement(Me.ButtonGroup,null,a.createElement(Me.Button,{disabled:0===n,onClick:function(){return i(n-1)},variant:"title"===t?"secondary":void 0,isSmall:"title"===t},"< ",a.createElement(Me.VisuallyHidden,null,(0,s._x)("Previous page","command","nelio-content"))),"footer"===t&&a.createElement("div",{className:"nelio-content-automation-templates__current-page"},"".concat(n+1," / ").concat(o)),a.createElement(Me.Button,{disabled:n>=o-1,onClick:function(){return i(n+1)},variant:"title"===t?"secondary":void 0,isSmall:"title"===t},"> ",a.createElement(Me.VisuallyHidden,null,(0,s._x)("Next page","command","nelio-content")))))},yn=function(e){return(0,u.useSelect)((function(t){var n;return null===(n=t(de.STORE_NAME).getSocialProfile(e))||void 0===n?void 0:n.network}))},xn=function(e){var t=e.groupId,n=e.profileId,o=e.mode,i=yn(n);return(0,u.useSelect)((function(e){var r,a,s=e(p).getAutomationGroup(t);if(s){var l=s.profileSettings[n],u=i?s.networkSettings[i]:void 0;return hn(hn([],null!==(r=null==l?void 0:l[o].templates)&&void 0!==r?r:[],!0),null!==(a=null==u?void 0:u[o].templates)&&void 0!==a?a:[],!0)}}))},bn=function(e){var t=e.className,n=e.tab,o=e.setTab;return a.createElement(Me.Toolbar,{className:t,label:(0,s._x)("Settings","text","nelio-content")},a.createElement(Me.ToolbarButton,{icon:"megaphone",title:(0,s._x)("Publication","text","nelio-content"),isActive:"publication"===n,onClick:function(){return o("publication")}}),a.createElement(Me.ToolbarButton,{icon:"share-alt",title:(0,s._x)("Reshare","text","nelio-content"),isActive:"reshare"===n,onClick:function(){return o("reshare")}}))},En=function(){return En=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},En.apply(this,arguments)},Tn=function(e){var t=e.groupId,n=e.profileId,o=(0,a.useState)("publication"),i=o[0],r=o[1],s=(0,de.useSocialProfile)(n),u=Sn(n),c=Nn(t,n)[0];if(!s||!c)return null;var d=u&&!!c[i].enabled;return a.createElement("div",{className:"nelio-content-automation-profile-settings"},a.createElement("div",{className:"nelio-content-automation-profile-settings__header"},a.createElement("div",{className:"nelio-content-automation-profile-settings__profile-details"},a.createElement("h3",{className:"nelio-content-automation-profile-settings__profile-name"},s.displayName),a.createElement(l.ProfileCreator,{className:"nelio-content-automation-profile-settings__profile-creator",profileId:n})),a.createElement(bn,{className:"nelio-content-automation-profile-settings__tab-selector",tab:i,setTab:r})),a.createElement("div",{className:"nelio-content-automation-profile-settings__content"},a.createElement(wn,En({type:i},e)),d&&a.createElement(vn,{groupId:t,profileId:n,mode:i})))},wn=function(e){var t=e.type,n=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n}(e,["type"]),o=n.groupId,i=n.profileId,r=Nn(o,i),s=r[0],l=r[1],u=Be(o),c=An(o,i,t);return u&&s?a.createElement("div",{className:"nelio-content-automation-profile-settings__sharing-settings"},a.createElement(Me.CheckboxControl,{checked:s[t].enabled,onChange:function(){var e,o=c||!!s[t].templates.length,i=!s[t].enabled,r=s[t].templates,a=[(0,d.createSocialTemplate)({groupId:u.id,text:"{title} {permalink}",network:s.network,profileId:n.profileId,postType:void 0}),(0,d.createSocialTemplate)({groupId:u.id,text:"{highlight} {permalink}",network:s.network,profileId:n.profileId,postType:void 0}),(0,d.createSocialTemplate)({groupId:u.id,text:"{phrase} {permalink}",network:s.network,profileId:n.profileId,postType:void 0})];l(En(En({},s),((e={})[t]=En(En({},s[t]),{enabled:i,templates:i&&!o?a:r}),e)))},label:a.createElement(kn,{profileId:n.profileId,enabled:s[t].enabled,type:t})})):null},kn=function(e){var t=e.enabled,n=e.profileId,o=e.type,i=In(n,o),r=i[0],l=i[1];if(!t)return a.createElement(a.Fragment,null,"publication"===o?(0,s._x)("Share content on publication","command","nelio-content"):(0,s._x)("Reshare content","command","nelio-content"));var u=function(e){return Math.min(20,Math.max(1,e))},c="publication"===o?/* translators: number of social messages */
(0,s._x)("Share content on publication using up to %s messages","command","nelio-content"):/* translators: number of social messages */
(0,s._x)("Reshare content using up to %s daily messages","command","nelio-content");return qt({mixedString:(0,s.sprintf)(c,"{{value}}{{/value}}"),components:{value:a.createElement("input",{type:"number",style:{width:"4.5em"},min:"1",max:20,value:u(r),onChange:function(e){var t=e.target.value,n=Number.parseInt(t);isNaN(n)||l(u(n))}})}})},Sn=function(e){var t=(0,de.useSocialProfile)(e);return!!t&&(0,De.doesNetworkSupport)("profile-template",t.network)},Nn=function(e,t){var n=(0,u.useSelect)((function(n){return n(p).getProfileAutomationSettings(e,t)})),o=(0,u.useDispatch)(p).addProfileSettings;return[n,function(t){if(n)return o(e,En(En({},n),t))}]},An=function(e,t,n){var o,i,r=Be(e),a=null===(o=null==r?void 0:r.profileSettings[t])||void 0===o?void 0:o.network;return!!a&&!!(null===(i=null==r?void 0:r.networkSettings[a])||void 0===i?void 0:i[n].templates.length)},In=function(e,t){var n=(0,u.useSelect)((function(n){var o,i;return null!==(i=null===(o=n(p).getProfileFrequencies(e))||void 0===o?void 0:o[t])&&void 0!==i?i:1})),o=(0,u.useDispatch)(p).setProfileFrequencies;return[n,function(n){var i;return o(e,((i={})[t]=n,i))}]},Cn=function(e){var t=e.groupId,n=On(t),o=n[0],i=n[1],r=(0,a.useState)(o),l=r[0],m=r[1],f=(0,a.useState)({type:"settings"}),h=f[0],v=f[1],g=Je();return function(e){var t=Be(e),n=(0,c.map)((0,de.usePostTypes)(),"name"),o=!!(0,d.isUniversalGroup)(t)||!!(null==t?void 0:t.postType)&&n.includes(t.postType),i=function(e){var t,n=(0,d.isUniversalGroup)(e)||null==e?void 0:e.postType,o=!!(null===(t=(0,de.usePostType)(n))||void 0===t?void 0:t.supports.author);return(0,u.useSelect)((function(t){var n;if(t(Dt),!o||(0,d.isUniversalGroup)(e))return!0;var i=t(Dt),r=i.getEntityRecord,a=i.hasFinishedResolution,s=i.hasResolutionFailed,l=null!==(n=null==e?void 0:e.authors)&&void 0!==n?n:[],u=(0,c.map)(l,(function(e){return r("root","user",e,{context:"view"})})),p=(0,c.map)(l,(function(e){return a("getEntityRecord",["root","user",e,{context:"view"}])||s("getEntityRecord",["root","user",e,{context:"view"}])}));return!(0,c.every)(p)||(0,c.every)(u)}))}(t),r=function(e){var t,n=(0,d.isUniversalGroup)(e)||null==e?void 0:e.postType,o=(0,c.map)(ze(n),"slug"),i=(0,c.pick)(Gt(Gt({},(0,c.zipObject)(o,(0,c.map)(o,(function(){return[]})))),(0,d.isUniversalGroup)(e)?{}:null!==(t=null==e?void 0:e.taxonomies)&&void 0!==t?t:{}),o);return(0,u.useSelect)((function(e){var t=e(Dt),n=t.getEntityRecord,o=t.hasFinishedResolution,r=t.hasResolutionFailed,a=(0,c.mapValues)(i,(function(e,t){return e.map(function(e){return function(t){return n("taxonomy",e,t)||void 0}}(t))})),s=(0,c.mapValues)(i,(function(e,t){return e.map(function(e){return function(t){return!!o("getEntityRecord",["taxonomy",e,t])||!!r("getEntityRecord",["taxonomy",e,t])}}(t))}));return(0,c.mapValues)(i,(function(e,t){return!(0,c.every)(s[t])||(0,c.every)(a[t])}))}))}(t),l=function(e){return(0,c.mapValues)(null==e?void 0:e.profileSettings,(function(e){return!(!e.enabled||e.publication.enabled||e.reshare.enabled)&&(0,s._x)("Missing permissions to automatically share content on your behalf","user","nelio-content")}))}(t),m=Ke(t,function(e){var t=(0,c.filter)((0,c.values)(null==e?void 0:e.profileSettings),{enabled:!0}),n=(0,c.map)(t,"network"),o=(0,c.values)((0,c.pick)(null==e?void 0:e.networkSettings,n));return jt(jt(jt(jt([],(0,c.flatten)((0,c.map)((0,c.filter)((0,c.map)(t,"publication"),{enabled:!0}),"templates")),!0),(0,c.flatten)((0,c.map)((0,c.filter)((0,c.map)(t,"reshare"),{enabled:!0}),"templates")),!0),(0,c.flatten)((0,c.map)((0,c.map)(o,"publication"),"templates")),!0),(0,c.flatten)((0,c.map)((0,c.map)(o,"reshare"),"templates")),!0)}(t)),f=(0,u.useDispatch)(p).setAutomationGroupValidation;(0,a.useEffect)((function(){t&&f(e,{isPostTypeValid:o,areAuthorsValid:i,areTermsValid:r,socialProfileErrors:l,templateErrors:m})}),[JSON.stringify(o),JSON.stringify(i),JSON.stringify(r),JSON.stringify(l),JSON.stringify(m)])}(t),a.createElement("div",{className:Ge()({"nelio-content-automation-group":!0,"nelio-content-automation-group--inactive":!o&&!l,"nelio-content-automation-group--disabled":g})},a.createElement(gt,{groupId:t,isActive:o,isExpanded:l,onToggleActivation:function(){return i(!o)},onToggle:function(){return m(!l)}}),l&&a.createElement("div",{className:"nelio-content-automation-group__body"},a.createElement(Pt,{groupId:t,activeTab:h,setActiveTab:v}),a.createElement("div",{className:"nelio-content-automation-group__body-content"},"settings"===h.type?a.createElement(tn,{groupId:t}):a.createElement(Tn,{groupId:t,profileId:h.id}))))},On=function(e){var t=Be(e),n=!!(null==t?void 0:t.priority),o=(0,u.useDispatch)(p).updateAutomationGroup;return[n,function(t){return o(e,{priority:t?100:0})}]},Pn=function(){var e=(0,u.useSelect)((function(e){return e(p).getAutomationGroups()})),t=(0,u.useSelect)((function(e){return e(de.STORE_NAME).getPluginLimits().maxAutomationGroups})),n=(0,u.useSelect)((function(e){return e(de.STORE_NAME).canCurrentUserManagePlugin()})),o=(0,u.useSelect)((function(e){return e(de.STORE_NAME).getAdminUrl("/admin.php",{page:"nelio-content-account"})})),i=e.length<t,r=(0,de.usePostTypes)(),l=(0,u.useDispatch)(p),c=l.addAutomationGroup,m=l.saveAutomationGroups,f=(0,u.useSelect)((function(e){return e(p).isSaving()})),h=qe();return(0,d.isEmpty)(e)?null:a.createElement(a.Fragment,null,a.createElement("div",{className:"nelio-content-automation-group-list"},e.map((function(e){return a.createElement(Cn,{key:e,groupId:e})}))),a.createElement(Rn,{limit:t,active:!i}),a.createElement("div",{className:"nelio-content-automation-group-list__actions"},!(0,d.isEmpty)(e)&&a.createElement(Me.Button,{className:"nelio-content-save-automation-groups",variant:"primary",onClick:m,disabled:!h||f},f?(0,s._x)("Saving…","text","nelio-content"):(0,s._x)("Save Changes","command","nelio-content")),1===t&&n&&a.createElement(Me.ExternalLink,{href:o,disabled:f||!i},(0,s._x)("Upgrade to Add Groups","command","nelio-content")),1<t&&a.createElement(Me.Button,{className:"nelio-content-add-automation-group",variant:(0,d.isEmpty)(e)?"primary":"secondary",onClick:function(){r[0]&&c({id:(0,d.createAutomationGroupId)(),name:"",priority:100,postType:r[0].name,taxonomies:{},publication:{type:"always"},authors:[],profileSettings:{},networkSettings:{}})},disabled:f||!i},(0,s._x)("Add Group","command","nelio-content"))))},Rn=function(e){var t=e.active,n=e.limit,o=(0,u.useSelect)((function(e){return e(de.STORE_NAME).getAdminUrl("/admin.php",{page:"nelio-content-account"})})),i=(0,u.useSelect)((function(e){return e(de.STORE_NAME).canCurrentUserManagePlugin()})),r=(0,u.useSelect)((function(e){return e(de.STORE_NAME).isSubscribed("plus")}));return t&&1!==n?a.createElement("div",{className:"nelio-content-automation-group-list__error"},(0,s.sprintf)(/* translators: number of groups allowed */
(0,s._x)("You’ve reached the maximum number of automation groups allowed (i.e. %d).","user","nelio-content"),n)+" ",!r&&i&&a.createElement(Me.ExternalLink,{href:o},(0,s._x)("Please consider upgrading your subscription.","user","nelio-content"))):null},Mn=function(){var e=(0,u.useSelect)((function(e){return e(de.STORE_NAME).isSocialPublicationPaused()})),t=(0,u.useSelect)((function(e){return e(de.STORE_NAME).isSocialPublicationStatusBeingSynched()})),n=(0,u.useDispatch)(de.STORE_NAME).toggleSocialPublicationStatus,o=e?(0,s._x)("Resume Social Publication","command","nelio-content"):(0,s._x)("Pause Social Publication","command","nelio-content"),i=e?(0,s._x)("Resuming Social Publication…","command","nelio-content"):(0,s._x)("Pausing Social Publication…","command","nelio-content");return a.createElement(Me.Button,{variant:"link",disabled:t,onClick:n},t?i:o)},Zn=function(){switch((0,u.useSelect)((function(e){return e(de.STORE_NAME).getResetStatus()}))){case"ready":return a.createElement(Gn,null);case"resetting":return a.createElement(jn,null);case"done":return a.createElement(Dn,null);case"error":return a.createElement(Ln,null)}},Gn=function(){var e=(0,u.useDispatch)(de.STORE_NAME).resetSocialMessages;return a.createElement(Me.Button,{variant:"link",onClick:e},(0,s._x)("Reset Social Messages","command","nelio-content"))},jn=function(){return a.createElement(a.Fragment,null,(0,s._x)("Resetting Social Messages…","text","nelio-content"))},Dn=function(){return a.createElement(a.Fragment,null,a.createElement(Me.Dashicon,{icon:"info"})," ",(0,s._x)("Social messages will be automatically regenerated shortly","text","nelio-content"))},Ln=function(){return a.createElement(a.Fragment,null,a.createElement(Me.Dashicon,{icon:"warning"})," ",(0,s._x)("Unable to reset social messages","text","nelio-content"))},Un=function(){var e=qe();return!(0,u.useSelect)((function(e){return!!e(de.STORE_NAME).canCurrentUserManagePlugin()}))||e?null:a.createElement("div",{className:"nelio-content-message-actions"},a.createElement(Zn,null),a.createElement("span",null,"|"),a.createElement(Mn,null))},Vn=function(){var e=qn(),t=e.publication,n=e.reshare,o=(0,u.useSelect)((function(e){return e(de.STORE_NAME).isSocialPublicationPaused()}));return t||n?a.createElement("div",{className:"nelio-content-message-count-estimation"},a.createElement("div",null,!!o&&Bn(),!!t&&$n(t),!!n&&Fn(n)),a.createElement(Un,null)):a.createElement("div",{className:"nelio-content-message-count-estimation"},a.createElement("div",null,(0,s._x)("Enable social automations on one or more profiles to allow Nelio Content to generate messages automatically.","user","nelio-content")))},qn=function(){return(0,u.useSelect)((function(e){var t=e(p),n=t.getAutomationGroup,o=t.getAutomationGroups,i=t.getProfileFrequencies,r=o().map(n).filter(d.isDefined),a=function(e){return(0,c.sum)((0,c.uniq)(r.flatMap((function(t){return Object.keys(t.profileSettings).map((function(e){return e})).filter((function(n){var o,i;return!!t.priority&&!!(null===(o=t.profileSettings[n])||void 0===o?void 0:o.enabled)&&!!(null===(i=t.profileSettings[n])||void 0===i?void 0:i[e].enabled)}))}))).map(i).filter(d.isDefined).map((function(t){return t[e]})))};return{publication:a("publication"),reshare:a("reshare")}}))},Bn=function(){return zn((0,s._x)("{{strong}}Notice!{{/strong}} Social publication is currently paused. This means Nelio Content will not share any scheduled social messages when their time comes.","usr","nelio-content")+"{{br/}}")},Fn=function(e){return zn(30<e?(0,s._x)("Your calendar will contain {{strong}}as many messages per day as possible{{/strong}}.","text","nelio-content"):(0,s.sprintf)(/* translators: number of social messages */
(0,s._nx)("Your calendar will contain {{strong}}%d social message per day{{/strong}}.","Your calendar will contain {{strong}}%d social messages per day{{/strong}}.",e,"text","nelio-content"),e))},$n=function(e){return zn(30<e?(0,s._x)("When publishing new content, Nelio will automatically generate {{strong}}as many messages as possible{{/strong}}.","text","nelio-content"):(0,s.sprintf)(/* translators: number of social messages */
(0,s._nx)("When publishing new content, Nelio will automatically generate up to {{strong}}%d social message{{/strong}}.","When publishing new content, Nelio will automatically generate up to {{strong}}%d social messages{{/strong}}.",e,"text","nelio-content"),e))},zn=function(e){return qt({mixedString:e+" ",components:{strong:a.createElement("strong",null),br:a.createElement("br",null)}})},Wn=function(e){var t=e.resetDateTime;return a.createElement("div",{className:"nelio-content-social-template-editor__reset-date-button"},a.createElement(Me.Button,{variant:"link",onClick:function(){return t()}},(0,s._x)("Change","command","nelio-content")))},Kn=function(e){var t=e.value,n=e.onChange,o=e.resetSelector;return a.createElement(Me.BaseControl,{id:"nelio-content-social-template-editor__date-selector",label:(0,s._x)("Date","text","nelio-content")},a.createElement("div",{className:"nelio-content-social-template-editor__date-selector"},qt({mixedString:(0,s.sprintf)(/* translators: number of days */
(0,s._x)("%s days after publication.","text","nelio-content"),"{{input/}}"),components:{input:a.createElement(l.NumberControl,{className:"nelio-content-social-template-editor__positive-days-selector",value:t,min:2,onChange:function(e){return n(null!=e?e:2)}})}}),a.createElement(Wn,{resetDateTime:o})))},Jn=function(e){var t=e.daysAfterPublication,n=e.onChange;return a.createElement(Me.BaseControl,{id:"nelio-content-social-template-editor__date-selector",label:(0,s._x)("Date","text","nelio-content")},a.createElement("div",{className:"nelio-content-social-template-editor__date-selector"},a.createElement(Me.SelectControl,{options:Hn,value:"".concat(t),onChange:function(e){return n("positive-days"===e?"positive-days":parseInt(e))}})))},Hn=[{value:"0",label:(0,s._x)("Same day as publication","text","nelio-content")},{value:"1",label:(0,s._x)("The day after publication","text","nelio-content")},{value:"7",label:(0,s._x)("A week after publication","text","nelio-content")},{value:"28",label:(0,s._x)("A month after publication","text","nelio-content")},{value:"positive-days",label:(0,s._x)("__ days after publication","text","nelio-content")}],Yn=function(){return Yn=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Yn.apply(this,arguments)},Xn=function(e,t,n){if(n||2===arguments.length)for(var o,i=0,r=t.length;i<r;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))},Qn=function(e){var t=e.days,n=e.onChange,o=(0,u.useSelect)((function(e){return e(de.STORE_NAME).getFirstDayOfWeek()})),i=[{id:"sun",label:(0,s._x)("SUN","text","nelio-content")},{id:"mon",label:(0,s._x)("MON","text","nelio-content")},{id:"tue",label:(0,s._x)("TUE","text","nelio-content")},{id:"wed",label:(0,s._x)("WED","text","nelio-content")},{id:"thu",label:(0,s._x)("THU","text","nelio-content")},{id:"fri",label:(0,s._x)("FRI","text","nelio-content")},{id:"sat",label:(0,s._x)("SAT","text","nelio-content")}],r=Xn(Xn([],i.slice(o),!0),i.slice(0,o),!0);return a.createElement(Me.BaseControl,{id:"nelio-content-social-template-editor__week-days-selector",label:(0,s._x)("Week Days","text","nelio-content")},a.createElement("div",{className:"nelio-content-social-template-editor__week-days-selector"},r.map((function(e,o){var i=e.id,r=e.label;return a.createElement(Me.CheckboxControl,{key:o,label:r,checked:t[i],onChange:function(e){var o;return n(Yn(Yn({},t),((o={})[i]=e,o)))}})}))))},eo=function(){return eo=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},eo.apply(this,arguments)},to=function(e){var t=e.templateType,n=e.availability,o=e.setAvailability,i=(0,a.useState)("after-publication"===n.type&&!io(n.daysAfterPublication)),r=i[0],s=i[1],l=no(n),u=oo(n);return"reshare"===t||"reshare"===n.type?a.createElement(Qn,{days:u,onChange:function(e){return o(eo(eo({},n),function(e){switch(e.type){case"publication-day-offset":case"after-publication":case"publication-day-period":return!1;case"reshare":return!0}}(n)&&{weekday:eo({},e)}))}}):"after-publication"!==n.type||io(n.daysAfterPublication)&&!r?a.createElement(Jn,{daysAfterPublication:l,onChange:function(e){0===e?o(eo(eo({},n),{type:"publication-day-offset",hoursAfterPublication:"publication-day-offset"===n.type?n.hoursAfterPublication:0})):"positive-days"===e?(o(eo(eo({},n),{type:"after-publication",daysAfterPublication:2,time:"after-publication"===n.type?n.time:"morning"})),s(!0)):o(eo(eo({},n),{type:"after-publication",daysAfterPublication:e,time:"after-publication"===n.type?n.time:"morning"}))}}):a.createElement(Kn,{value:n.daysAfterPublication,onChange:function(e){return o(eo(eo({},n),{type:"after-publication",daysAfterPublication:e}))},resetSelector:function(){o({type:"publication-day-offset",hoursAfterPublication:0}),s(!1)}})},no=function(e){return"after-publication"!==e.type?0:e.daysAfterPublication},oo=function(e){return"reshare"===e.type?e.weekday:{mon:!1,tue:!1,wed:!1,thu:!1,fri:!1,sat:!1,sun:!1}};function io(e){return[0,1,7,28].includes(e)}var ro=function(e){var t=e.onClick;return a.createElement("div",{className:"nelio-content-social-template-editor__reset-time-button"},a.createElement(Me.Button,{variant:"link",onClick:t},(0,s._x)("Change","command","nelio-content")))},ao=function(e){var t=e.exactTime,n=e.setExactTime,o=e.reset;return a.createElement(Me.BaseControl,{id:"nelio-content-social-template-editor__time-selector",label:(0,s._x)("Time","text","nelio-content")},a.createElement("div",{className:"nelio-content-social-template-editor__time-selector"},a.createElement(l.TimeInput,{value:t,onChange:function(e){return e?n(e):null}}),a.createElement(ro,{onClick:function(){return o()}})))},so=function(e){var t=e.hours,n=e.setHours,o=e.reset;return a.createElement(Me.BaseControl,{id:"nelio-content-social-template-editor__time-selector",label:(0,s._x)("Time","text","nelio-content")},a.createElement("div",{className:"nelio-content-social-template-editor__time-selector"},qt({mixedString:(0,s.sprintf)(/* translators: number of hours */
(0,s._x)("%s hours after publication.","text","nelio-content"),"{{input/}}"),components:{input:a.createElement(l.NumberControl,{className:"nelio-content-social-template-editor__positive-hours-selector",value:t,min:2,max:24,onChange:function(e){return n(null!=e?e:2)}})}}),a.createElement(ro,{onClick:function(){return o()}})))},lo=function(e){var t=e.interval,n=e.setIntervalValue,o=e.selectExactTime,i=e.reset;return a.createElement(Me.BaseControl,{id:"nelio-content-social-template-editor__time-selector",label:(0,s._x)("Time","text","nelio-content")},a.createElement("div",{className:"nelio-content-social-template-editor__time-selector"},a.createElement(Me.SelectControl,{options:uo,value:t,onChange:function(e){return"exact"===e?o():n(e)}})),!!i&&a.createElement(ro,{onClick:function(){return i()}}))},uo=[{value:"morning",label:(0,s._x)("Morning (8am – 11am)","text","nelio-content")},{value:"noon",label:(0,s._x)("Noon (11am – 3pm)","text","nelio-content")},{value:"afternoon",label:(0,s._x)("Afternoon (3pm – 7pm)","text","nelio-content")},{value:"night",label:(0,s._x)("Night (7pm – 11pm)","text","nelio-content")},{value:"exact",label:(0,s._x)("Choose a custom time…","user","nelio-content")}],co=function(e){var t=e.value,n=e.setValue,o=e.selectExactTime,i=e.selectPositiveHours,r=e.selectTimeInterval;return a.createElement(Me.BaseControl,{id:"nelio-content-social-template-editor__time-selector",label:(0,s._x)("Time","text","nelio-content")},a.createElement("div",{className:"nelio-content-social-template-editor__time-selector"},a.createElement(Me.SelectControl,{options:po,value:"".concat(t),onChange:function(e){"positive-hours"===e?i():"exact"===e?o():"time-interval"===e?r():n(parseInt(e))}})))},po=[{value:"0",label:(0,s._x)("Same time as publication","text","nelio-content")},{value:"1",label:(0,s._x)("One hour after publication","text","nelio-content")},{value:"3",label:(0,s._x)("Three hours after publication","text","nelio-content")},{value:"5",label:(0,s._x)("Five hours after publication","text","nelio-content")},{value:"positive-hours",label:(0,s._x)("__ hours after publication","text","nelio-content")},{value:"time-interval",label:(0,s._x)("Choose a time interval…","user","nelio-content")},{value:"exact",label:(0,s._x)("Choose a custom time…","user","nelio-content")}],mo=function(){return mo=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},mo.apply(this,arguments)},fo=function(e){var t=e.templateType,n=e.availability,o=e.setAvailability,i=(0,a.useState)("publication-day-offset"===n.type&&!_o(n.hoursAfterPublication)),r=i[0],s=i[1],l=ho(t,r,n),u=vo(n);return"exact"===l||"time-interval"===l&&bo(u)?a.createElement(ao,{exactTime:bo(u)?u:"10:00",setExactTime:function(e){return o(mo(mo({},n),go(n)&&{time:e}))},reset:function(){return o("publication-day-period"===n.type?{type:"publication-day-offset",hoursAfterPublication:0}:mo(mo({},n),go(n)&&{time:"morning"}))}}):"positive-hours"===l?a.createElement(so,{hours:"number"==typeof u?u:2,setHours:function(e){return o({type:"publication-day-offset",hoursAfterPublication:e})},reset:function(){o(mo(mo({},n),yo(n)&&{hoursAfterPublication:0})),s(!1)}}):"time-interval"===l?a.createElement(lo,{interval:"number"!=typeof u&&xo(u)?u:"morning",setIntervalValue:function(e){return o(mo(mo({},n),go(n)&&{time:e}))},selectExactTime:function(){return o(mo(mo({},n),go(n)&&{time:"10:00"}))},reset:"publication-day-period"===n.type?function(){return o({type:"publication-day-offset",hoursAfterPublication:0})}:void 0}):"predefined-offset"===l?a.createElement(co,{value:"publication-day-offset"===n.type&&_o(n.hoursAfterPublication)?n.hoursAfterPublication:0,setValue:function(e){s(!1),o(mo(mo({},n),yo(n)&&{hoursAfterPublication:e}))},selectExactTime:function(){s(!1),o({type:"publication-day-period",time:"10:00"})},selectTimeInterval:function(){s(!1),o({type:"publication-day-period",time:"morning"})},selectPositiveHours:function(){s(!0),o(mo(mo({},n),yo(n)&&{hoursAfterPublication:2}))}}):null},ho=function(e,t,n){var o=n.type;if("reshare"===e)return"time-interval";switch(o){case"publication-day-offset":return!n.hoursAfterPublication||!t&&_o(n.hoursAfterPublication)?"predefined-offset":"positive-hours";case"after-publication":case"publication-day-period":case"reshare":return xo(n.time)?"time-interval":"exact"}},vo=function(e){switch(e.type){case"publication-day-offset":return e.hoursAfterPublication;case"after-publication":case"publication-day-period":case"reshare":return e.time}};function go(e){switch(e.type){case"publication-day-offset":return!1;case"after-publication":case"publication-day-period":case"reshare":return!0}}function yo(e){return"publication-day-offset"===e.type}function _o(e){return[0,1,3,5].includes(e)}function xo(e){return!e.includes(":")}function bo(e){return"string"==typeof e&&!xo(e)}var Eo,To,wo,ko,So=function(){var e,t=Ao(),n=No(),o=n[0],i=n[1],r=(0,u.useSelect)((function(e){return e(p).getEditingTemplateErrors()}));if(!o)return null;var l=o.availability;return a.createElement("div",{className:"nelio-content-availability-control"},!l&&a.createElement(Me.Button,{variant:"link",onClick:function(){return i({availability:Io(t)})}},(0,s._x)("Customize template availability","command","nelio-content")),!!l&&a.createElement(a.Fragment,null,a.createElement("div",{className:Ge()("nelio-content-availability-control__options",{"nelio-content-availability-control__options--reshare":"reshare"===t})},a.createElement(to,{templateType:t,availability:l,setAvailability:function(e){return i({availability:e})}}),a.createElement(fo,{templateType:t,availability:l,setAvailability:function(e){return i({availability:e})}})),a.createElement("div",{className:"nelio-content-availability-control__error"},null!==(e=r.availability)&&void 0!==e?e:""),a.createElement("div",null,a.createElement(Me.Button,{variant:"link",onClick:function(){return i({availability:void 0})}},(0,s._x)("Make template always available","command","nelio-content")))))},No=function(){return[(0,u.useSelect)((function(e){return e(p).getEditingTemplate()})),(0,u.useDispatch)(p).setEditingTemplateAttributes]},Ao=function(){return(0,u.useSelect)((function(e){return e(p).getEditingTemplateType()}))},Io=function(e){return"publication"===e?{type:"publication-day-offset",hoursAfterPublication:0}:{type:"reshare",weekday:{mon:!0,tue:!0,wed:!0,thu:!0,fri:!0,sat:!0,sun:!0},time:"morning"}},Co=[{title:(0,s._x)("Social Template Editor","text","nelio-content"),intro:(0,s._x)("Welcome to the social template editor, the easiest way to create custom templates for sharing your content on social media.","user","nelio-content"),elementToClick:function(){return null},element:function(){return document.querySelector(".nelio-content-social-template-editor-dialog")}},{title:(0,s._x)("Message","text","nelio-content"),intro:(0,s._x)("Here you can write the template itself. Add placeholders like, for example, {title} or {tags}, which will be then replaced by Nelio Content when the template is used for sharing a specific post from your site.","user","nelio-content"),elementToClick:function(){return null},element:function(){return document.querySelector(".nelio-content-social-template-editor-dialog__text")}},{title:(0,s._x)("Placeholders","text","nelio-content"),intro:(0,s._x)("If you don’t know which placeholders are available, use this action and select the placeholder(s) you want to include in your template.","user","nelio-content"),elementToClick:function(){return null},element:function(){return document.querySelector(".nelio-content-social-template-editor-dialog__add-placeholder")}},{title:(0,s._x)("Additional Filters","text","nelio-content"),intro:(0,s._x)("By default, templates apply to all content in the Automation Group. But you can narrow the selection using these actions here.","user","nelio-content"),elementToClick:function(){return null},element:function(){return document.querySelector(".nelio-content-social-template-editor-dialog__quick-actions .is-link")||document.querySelector(".nelio-content-social-template-editor-dialog__tab-selector")}},{title:(0,s._x)("Content Type","text","nelio-content"),intro:(0,s._x)("Depending on the content selected in the Automation Group, you’ll be able to filter the tempate by taxonomy and/or author.","user","nelio-content"),elementToClick:function(){return document.querySelector(".nelio-content-social-template-editor-dialog__quick-actions .is-link")},element:function(){return document.querySelector(".nelio-content-social-template-editor-dialog__tab-selector")}},{title:(0,s._x)("Template Availability","text","nelio-content"),intro:(0,s._x)("You can also customize the template’s availability (i.e. when a template is eligible). For instance, let Nelio Content use a template on post’s publication or on a Monday morning","user","nelio-content"),elementToClick:function(){return document.querySelector(".nelio-content-social-template-editor__availability-action")},element:function(){return document.querySelector(".nelio-content-availability-control")}},{title:(0,s._x)("Save Changes","text","nelio-content"),intro:(0,s._x)("Save the template using the “Save” button. If there are any errors, the button will be disabled – hover it to reveal the error.","user","nelio-content"),elementToClick:function(){return null},element:function(){return document.querySelector(".nelio-content-social-template-editor-dialog__save-button")}}],Oo=null!==(Eo=null===ue.store||void 0===ue.store?void 0:ue.store.name)&&void 0!==Eo?Eo:"core",Po=function(){"function"==typeof To&&To()},Ro=function(e){var t=e.onClick,n=Zo(),o=Mo(),i=function(e){return(0,u.useSelect)((function(t){var n=t(p).getCustomFields();return e&&"nc_any"!==e?n[e]||[]:(0,c.values)((0,c.keyBy)((0,c.values)(n).flatMap((function(e){return e})),"key"))}))}(n),r=function(e){return(0,u.useSelect)((function(t){var n=t(p).getCustomPlaceholders();return e&&"nc_any"!==e?n[e]||[]:(0,c.values)((0,c.keyBy)((0,c.values)(n).flatMap((function(e){return e})),"key"))}))}(n),l=Go();return a.createElement(Me.DropdownMenu,{className:"nelio-content-social-template-editor-dialog__quick-action nelio-content-social-template-editor-dialog__add-placeholder",icon:"tag",label:(0,s._x)("Placeholders","text","nelio-content"),toggleProps:{tooltipPosition:"bottom center"},popoverProps:{onFocusOutside:Po}},(function(e){var n=e.onClose;return To=n,a.createElement(Me.MenuGroup,null,a.createElement(Me.MenuGroup,null,o.title&&a.createElement(Me.MenuItem,{role:"menuitem",icon:"editor-textcolor",onClick:function(){return t("{title}")}},(0,s._x)("Add Title","command","nelio-content")),a.createElement(Me.MenuItem,{role:"menuitem",icon:"format-status",onClick:function(){return t("{phrase}")}},(0,s._x)("Add Content Phrase","command","nelio-content")),a.createElement(Me.MenuItem,{role:"menuitem",icon:"editor-quote",onClick:function(){return t("{highlight}")}},(0,s._x)("Add Highlight","command","nelio-content")),o.author&&a.createElement(Me.MenuItem,{role:"menuitem",icon:"admin-users",onClick:function(){return t("{author}")}},(0,s._x)("Add Author","command","nelio-content")),o.excerpt&&a.createElement(Me.MenuItem,{role:"menuitem",icon:"text",onClick:function(){return t("{excerpt}")}},(0,s._x)("Add Excerpt","command","nelio-content")),a.createElement(Me.MenuItem,{role:"menuitem",icon:"admin-links",onClick:function(){return t("{permalink}")}},(0,s._x)("Add Permalink","command","nelio-content"))),!!l.length&&a.createElement(Me.MenuGroup,{label:(0,s._x)("Taxonomies","text","nelio-content")},l.map((function(e){var n=e.slug,o=e.labels;return a.createElement(Me.MenuItem,{key:n,role:"menuitem",icon:Do(n),onClick:function(){return t(Lo(n))}},(0,s.sprintf)(/* translators: taxonomy name */
(0,s._x)("Add %s","command","nelio-content"),o.name))}))),!!i.length&&a.createElement(Me.MenuGroup,{label:(0,s._x)("Custom fields","text","nelio-content")},i.map((function(e){var n=e.key,o=e.name;return a.createElement(Me.MenuItem,{key:n,role:"menuitem",icon:"welcome-widgets-menus",onClick:function(){return t("{field:".concat(n,"}"))}},(0,s.sprintf)(/* translators: custom field name */
(0,s._x)("Add %s","command","nelio-content"),o))}))),!!r.length&&a.createElement(Me.MenuGroup,{label:(0,s._x)("Custom placeholders","text","nelio-content")},r.map((function(e){var n=e.key,o=e.name;return a.createElement(Me.MenuItem,{key:n,role:"menuitem",icon:"plus-alt",onClick:function(){return t("{custom:".concat(n,"}"))}},(0,s.sprintf)(/* translators: custom placeholder name */
(0,s._x)("Add %s","command","nelio-content"),o))}))))}))},Mo=function(){var e=Zo();return(0,u.useSelect)((function(t){var n="nc_any"===e?(0,c.map)(t(de.STORE_NAME).getPostTypes(),"name"):[e],o=t(Oo).getPostType,i=n.map((function(e){return o(e)})).filter(jo).filter(d.isDefined);return{author:i.some((function(e){var t;return!!(null===(t=e.supports)||void 0===t?void 0:t.author)})),excerpt:i.some((function(e){var t;return!!(null===(t=e.supports)||void 0===t?void 0:t.excerpt)})),title:i.some((function(e){var t;return!!(null===(t=e.supports)||void 0===t?void 0:t.title)}))}}))},Zo=function(){return(0,u.useSelect)((function(e){var t;return null===(t=e(p).getEditingTemplate())||void 0===t?void 0:t.postType}))},Go=function(){return(0,u.useSelect)((function(e){var t;e(Oo);var n=e(p),o=n.getEditingTemplate,i=n.getAutomationGroup,r=o();if(!r)return[];var a=i(r.groupId);if((0,d.isUniversalGroup)(a))return[];var s=r.postType;return(null!==(t=(0,e(Oo).getTaxonomies)({per_page:-1}))&&void 0!==t?t:[]).filter((function(e){return!!e})).filter((function(e){return e.visibility.public&&e.types.includes(null!=s?s:"")}))}))},jo=function(e){return!!e},Do=function(e){switch(e){case"category":case"product_cat":return"category";case"post_tag":case"product_tag":return"tag";default:return"archive"}},Lo=function(e){switch(e){case"category":case"product_cat":return"{categories}";case"post_tag":case"product_tag":return"{tags}";default:return"{taxonomy:".concat(e,"}")}},Uo=function(){return Uo=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Uo.apply(this,arguments)},Vo=function(e){var t=e.data,n=t.label,o=t.image,i=e.isFocused,r=e.isSelected,s=e.innerRef,l=e.innerProps;return a.createElement("div",Uo({ref:s,className:Ge()({"nelio-content-target-option-in-profile-selector":!0,"nelio-content-target-option-in-profile-selector--is-focused":i,"nelio-content-target-option-in-profile-selector--is-selected":r})},l),a.createElement("div",{className:"nelio-content-target-option-in-profile-selector__icon-wrapper"},a.createElement("div",{className:"nelio-content-target-option-in-profile-selector__icon",style:{backgroundImage:"url(".concat(o||"",")")}})),a.createElement("div",{className:"nelio-content-target-option-in-profile-selector__label"},n))},qo=function(e){var t=e.network,n=e.profileId,o=e.targetName,i=e.onTargetChange,r=Bo(n,t),u=r.targets,d=r.isLoadingTargets;if(!n||!u)return null;var p=(0,c.map)(u,(function(e){return{value:e.name,label:e.displayName,image:e.image}})),m=o?(0,c.find)(p,{value:o}):void 0;return a.createElement("div",{className:"nelio-content-social-profile-selector__targets"},a.createElement(l.StylizedSelectControl,{disabled:d,placeholder:d?(0,s._x)("Loading…","text","nelio-content"):(0,De.getTargetLabel)("selectTarget",t),options:p,value:m,onChange:function(e){return i(null==e?void 0:e.value)},components:{Option:Vo}}))},Bo=function(e,t){return(0,u.useSelect)((function(n){if(n(de.STORE_NAME),!e||!(0,De.doesNetworkSupport)("multi-target",t))return{};var o=(0,n(de.STORE_NAME).getTargetsInProfile)(e);return{isLoadingTargets:void 0===o,targets:o||[]}}))},Fo=function(){return Fo=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Fo.apply(this,arguments)},$o=function(e,t,n){if(n||2===arguments.length)for(var o,i=0,r=t.length;i<r;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))},zo=function(e){var t=e.className,n=void 0===t?"":t,o=Ho(),i=Xo(),r=i[0],d=i[1],m=(0,a.useState)("availability"),f=m[0],h=m[1],v=Qo(),g=v[0],y=v[1],_=ti(),x=_.isNewTemplate,b=_.templateType,E=Yo(null==g?void 0:g.groupId),T=We(null==g?void 0:g.postType),w=ei(),k=w[0],S=w[1],N=(0,u.useDispatch)(p),A=N.closeTemplateEditor,I=N.receiveAutomationGroupTemplates,C=ni();oi();var O=ze(null==g?void 0:g.postType);if((0,a.useEffect)((function(){E.length>1?h("postType"):O.length?h("taxonomy"):h(T?"author":"availability")}),[E.length,null==g?void 0:g.postType]),!o||!g||!O)return null;var P=function(){A(),d(!1)},R=g.text,M=g.network,Z=function(e){return y({text:e})};return a.createElement(Me.Modal,{className:"nelio-content-social-template-editor-dialog ".concat(n),title:k?ai(x):si(x),isDismissible:!1,shouldCloseOnEsc:!1,shouldCloseOnClickOutside:!1,onRequestClose:P},a.createElement(qo,{network:g.network,profileId:g.profileId,targetName:g.targetName,onTargetChange:function(e){return y({targetName:e})}}),a.createElement(Me.TextareaControl,{className:"nelio-content-social-template-editor-dialog__text",value:R,onChange:Z,placeholder:(0,s._x)("Write a template…","user","nelio-content")}),a.createElement("div",{className:"nelio-content-social-template-editor-dialog__quick-actions"},r?a.createElement(Jo,{className:"nelio-content-social-template-editor-dialog__tab-selector",tab:f,availableTabs:[E.length>1&&"postType",!!O.length&&"taxonomy",T&&"author","availability","attachment"],setTab:h}):a.createElement(Me.Button,{variant:"link",onClick:function(){return d(!0)}},(0,s._x)("Additional options","command","nelio-content")),a.createElement("div",{className:"nelio-content-social-template-editor-dialog__quick-action-spacer"}),x&&(0,De.doesNetworkSupport)("network-template",M)&&!(0,De.doesNetworkSupport)("multi-target",M)&&a.createElement(Me.Button,{className:Ge()({"nelio-content-social-template-editor-dialog__quick-action":!0,"nelio-content-social-template-editor-dialog__quick-action--is-preview":!0,"nelio-content-social-template-editor-dialog__quick-action--is-toggled":k}),icon:(0,De.getNetworkIcon)(M),label:(0,s.sprintf)(/* translators: network name */
(0,s._x)("Network template (available to all %s profiles)","text","nelio-content"),(0,De.getNetworkLabel)("name",M)),onClick:function(){return S(!k)}}),a.createElement(Ro,{onClick:function(e){return function(e){return Z(/[^\s]$/.test(R)?"".concat(R," ").concat(e):"".concat(R).concat(e))}(e)}})),r&&a.createElement(Wo,{type:f}),a.createElement("div",{className:"nelio-content-social-template-editor-dialog__buttons"},a.createElement(l.ContextualHelp,{context:"social-template-editor",walkthrough:Co,autostart:!0}),a.createElement("div",{className:"nelio-content-social-template-editor-dialog__default-buttons-wrapper"},a.createElement(Me.Button,{className:"nelio-content-social-template-editor-dialog__cancel-button",variant:"secondary",onClick:P},(0,s._x)("Cancel","command","nelio-content")),a.createElement(l.SaveButton,{className:"nelio-content-social-template-editor-dialog__save-button",variant:"primary",isUpdate:!x,error:C,onClick:function(){P(),I(b,Fo(Fo({},g),{taxonomies:(0,c.pick)(g.taxonomies,(0,c.map)(O,"slug")),profileId:k?void 0:g.profileId,targetName:k?void 0:g.targetName}))}}))))},Wo=function(e){var t=e.type,n=Qo(),o=n[0],i=n[1],r=(0,de.usePostTypes)(),c=ze(null==o?void 0:o.postType),m=$e(null==o?void 0:o.postType),f=(0,u.useSelect)((function(e){return e(p).getEditingTemplateErrors()})),h=ii(null==o?void 0:o.attachment);if(!o||!f)return null;var v=o.author;if(!m)return a.createElement("div",{className:"nelio-content-social-template-editor-dialog__extra"},a.createElement(Me.Spinner,null));switch(t){case"postType":return a.createElement("div",{className:"nelio-content-social-template-editor-dialog__extra"},a.createElement(Me.SelectControl,{value:(null==o?void 0:o.postType)||"__nc-all",options:$o([{value:"__nc-all",label:(0,s._x)("All Content","text","nelio-content")}],r.map((function(e){return{value:e.name,label:e.labels.plural||e.labels.singular||e.name}})),!0),onChange:function(e){return i("__nc-all"===e?{postType:void 0}:{postType:e})}}));case"taxonomy":return a.createElement("div",{className:"nelio-content-social-template-editor-dialog__extra"},c.map((function(e){return a.createElement(l.ItemSelectControl,{key:e.slug,error:f.taxonomies[e.slug],isSingle:!0,kind:"taxonomy",label:e.labels.singular_name,name:e.slug,value:o.taxonomies[e.slug],onChange:function(t){var n;return i({taxonomies:ri(Fo(Fo({},o.taxonomies),(n={},n[e.slug]=t||void 0,n)))})}})})));case"author":return a.createElement("div",{className:"nelio-content-social-template-editor-dialog__extra"},a.createElement(l.ItemSelectControl,{isSingle:!0,error:f.author,kind:"author",label:(0,s._x)("Author","text","nelio-content"),value:v,onChange:function(e){return i({author:e})}}));case"availability":return a.createElement("div",{className:"nelio-content-social-template-editor-dialog__extra"},a.createElement(So,null));case"attachment":return a.createElement("div",{className:"nelio-content-social-template-editor-dialog__extra"},a.createElement(Me.SelectControl,{options:[{label:(0,s._x)("Auto Image","text","nelio-content"),value:"auto-image"},{label:(0,s._x)("Text","text","nelio-content"),value:"none"},{label:(0,s._x)("Image","text","nelio-content"),value:"image"},"video"===(null==o?void 0:o.attachment)?{label:(0,s._x)("Video","text","nelio-content"),value:"video"}:void 0].filter(d.isDefined),value:(null==o?void 0:o.attachment)||"auto-image",onChange:function(e){return i({attachment:"auto-image"===e?void 0:e})},help:h}))}},Ko={postType:{icon:"admin-post",title:(0,s._x)("Post Type","text","nelio-content")},taxonomy:{icon:"archive",title:(0,s._x)("Taxonomies","text","nelio-content")},author:{icon:"admin-users",title:(0,s._x)("Author","text","nelio-content")},availability:{icon:"calendar-alt",title:(0,s._x)("Availability","text","nelio-content")},attachment:{icon:"format-gallery",title:(0,s._x)("Media Requirements","text","nelio-content")}},Jo=function(e){var t=e.className,n=e.availableTabs,o=e.tab,i=e.setTab;return a.createElement(Me.Toolbar,{className:t,label:(0,s._x)("Settings","text","nelio-content")},n.filter((function(e){return!!e})).map((function(e){return a.createElement(Me.ToolbarButton,{key:e,className:"nelio-content-social-template-editor__".concat(e,"-action"),icon:Ko[e].icon,title:Ko[e].title,isActive:o===e,onClick:function(){return i(e)}})})))},Ho=function(){return(0,u.useSelect)((function(e){return e(p).isEditingTemplate()}))},Yo=function(e){var t=Be(e);return(0,de.usePostTypes)().filter((function(e){return(0,d.isUniversalGroup)(t)||e.name===(null==t?void 0:t.postType)}))},Xo=function(){var e=Ho(),t=Qo()[0],n=(0,a.useState)(!1),o=n[0],i=n[1];return(0,a.useEffect)((function(){i(!(!e||!(null==t?void 0:t.author)&&!(0,c.keys)(null==t?void 0:t.taxonomies).length&&!(null==t?void 0:t.availability)))}),[e]),[o,i]},Qo=function(){return[(0,u.useSelect)((function(e){return e(p).getEditingTemplate()})),(0,u.useDispatch)(p).setEditingTemplateAttributes]},ei=function(){return[(0,u.useSelect)((function(e){return e(p).isEditingNetworkTemplate()})),(0,u.useDispatch)(p).markAsNetworkTemplate]},ti=function(){return{isNewTemplate:(0,u.useSelect)((function(e){return e(p).isEditingNewTemplate()})),templateType:(0,u.useSelect)((function(e){return e(p).getEditingTemplateType()}))}},ni=function(){var e=(0,u.useSelect)((function(e){return e(p).getEditingTemplateErrors()}));return e.target||e.content||(e.author?e.author:(0,c.values)(e.taxonomies).some(Boolean)?(0,s._x)("Please review selected terms","user","nelio-content"):e.availability?(0,s._x)("Please review availability settings","user","nelio-content"):"")},oi=function(){var e=Ho(),t=Qo()[0],n=(0,u.useDispatch)(p).setEditingTemplateErrors,o=Be(null==t?void 0:t.groupId),i=Ke(o,t?[t]:[]);(0,a.useEffect)((function(){if(e&&(null==t?void 0:t.id)){var o=i[t.id];o&&n(o)}}),[e,JSON.stringify(i)])},ii=function(e){switch(e){case void 0:return(0,s._x)("Nelio Content may sometimes generate messages that share an image from related content","text","nelio-content");case"none":return(0,s._x)("Nelio Content won’t attach any images to messages generated using this template","text","nelio-content");case"image":return(0,s._x)("Nelio Content will only use this template if it can extract an image from shared content","text","nelio-content");case"video":return""}},ri=function(e){return(0,c.keys)(e).reduce((function(t,n){var o;return e[n]?Fo(Fo({},t),((o={})[n]=e[n],o)):t}),{})},ai=function(e){return e?(0,s._x)("New Network Template","text","nelio-content"):(0,s._x)("Edit Network Template","text","nelio-content")},si=function(e){return e?(0,s._x)("New Template","text","nelio-content"):(0,s._x)("Edit Template","text","nelio-content")};!function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(_x){throw new Error},e.arrayToEnum=e=>{const t={};for(const n of e)t[n]=n;return t},e.getValidEnumValues=t=>{const n=e.objectKeys(t).filter((e=>"number"!=typeof t[t[e]])),o={};for(const e of n)o[e]=t[e];return e.objectValues(o)},e.objectValues=t=>e.objectKeys(t).map((function(e){return t[e]})),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},e.find=(e,t)=>{for(const n of e)if(t(n))return n},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map((e=>"string"==typeof e?`'${e}'`:e)).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(wo||(wo={})),function(e){e.mergeShapes=(e,t)=>({...e,...t})}(ko||(ko={}));const li=wo.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ui=e=>{switch(typeof e){case"undefined":return li.undefined;case"string":return li.string;case"number":return isNaN(e)?li.nan:li.number;case"boolean":return li.boolean;case"function":return li.function;case"bigint":return li.bigint;case"symbol":return li.symbol;case"object":return Array.isArray(e)?li.array:null===e?li.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?li.promise:"undefined"!=typeof Map&&e instanceof Map?li.map:"undefined"!=typeof Set&&e instanceof Set?li.set:"undefined"!=typeof Date&&e instanceof Date?li.date:li.object;default:return li.unknown}},ci=wo.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class di extends Error{constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(e){return e.message},n={_errors:[]},o=e=>{for(const i of e.issues)if("invalid_union"===i.code)i.unionErrors.map(o);else if("invalid_return_type"===i.code)o(i.returnTypeError);else if("invalid_arguments"===i.code)o(i.argumentsError);else if(0===i.path.length)n._errors.push(t(i));else{let e=n,o=0;for(;o<i.path.length;){const n=i.path[o];o===i.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(t(i))):e[n]=e[n]||{_errors:[]},e=e[n],o++}}};return o(this),n}toString(){return this.message}get message(){return JSON.stringify(this.issues,wo.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=(e=>e.message)){const t={},n=[];for(const o of this.issues)o.path.length>0?(t[o.path[0]]=t[o.path[0]]||[],t[o.path[0]].push(e(o))):n.push(e(o));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}di.create=e=>new di(e);const pi=(e,t)=>{let n;switch(e.code){case ci.invalid_type:n=e.received===li.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case ci.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,wo.jsonStringifyReplacer)}`;break;case ci.unrecognized_keys:n=`Unrecognized key(s) in object: ${wo.joinValues(e.keys,", ")}`;break;case ci.invalid_union:n="Invalid input";break;case ci.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${wo.joinValues(e.options)}`;break;case ci.invalid_enum_value:n=`Invalid enum value. Expected ${wo.joinValues(e.options)}, received '${e.received}'`;break;case ci.invalid_arguments:n="Invalid function arguments";break;case ci.invalid_return_type:n="Invalid function return type";break;case ci.invalid_date:n="Invalid date";break;case ci.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:wo.assertNever(e.validation):n="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case ci.too_small:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case ci.too_big:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case ci.custom:n="Invalid input";break;case ci.invalid_intersection_types:n="Intersection results could not be merged";break;case ci.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case ci.not_finite:n="Number must be finite";break;default:n=t.defaultError,wo.assertNever(e)}return{message:n}};let mi=pi;function fi(){return mi}const hi=e=>{const{data:t,path:n,errorMaps:o,issueData:i}=e,r=[...n,...i.path||[]],a={...i,path:r};let s="";const l=o.filter((e=>!!e)).slice().reverse();for(const e of l)s=e(a,{data:t,defaultError:s}).message;return{...i,path:r,message:i.message||s}};function vi(e,t){const n=hi({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,fi(),pi].filter((e=>!!e))});e.common.issues.push(n)}class gi{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const o of t){if("aborted"===o.status)return yi;"dirty"===o.status&&e.dirty(),n.push(o.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const e of t)n.push({key:await e.key,value:await e.value});return gi.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const o of t){const{key:t,value:i}=o;if("aborted"===t.status)return yi;if("aborted"===i.status)return yi;"dirty"===t.status&&e.dirty(),"dirty"===i.status&&e.dirty(),(void 0!==i.value||o.alwaysSet)&&(n[t.value]=i.value)}return{status:e.value,value:n}}}const yi=Object.freeze({status:"aborted"}),_i=e=>({status:"dirty",value:e}),xi=e=>({status:"valid",value:e}),bi=e=>"aborted"===e.status,Ei=e=>"dirty"===e.status,Ti=e=>"valid"===e.status,wi=e=>"undefined"!=typeof Promise&&e instanceof Promise;var ki;!function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:null==e?void 0:e.message}(ki||(ki={}));class Si{constructor(e,t,n,o){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=o}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Ni=(e,t)=>{if(Ti(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new di(e.common.issues);return this._error=t,this._error}}};function Ai(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:o,description:i}=e;if(t&&(n||o))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:i}:{errorMap:(e,t)=>"invalid_type"!==e.code?{message:t.defaultError}:void 0===t.data?{message:null!=o?o:t.defaultError}:{message:null!=n?n:t.defaultError},description:i}}class Ii{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return ui(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:ui(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new gi,ctx:{common:e.parent.common,data:e.data,parsedType:ui(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(wi(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const o={common:{issues:[],async:null!==(n=null==t?void 0:t.async)&&void 0!==n&&n,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ui(e)},i=this._parseSync({data:e,path:o.path,parent:o});return Ni(o,i)}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ui(e)},o=this._parse({data:e,path:n.path,parent:n}),i=await(wi(o)?o:Promise.resolve(o));return Ni(n,i)}refine(e,t){const n=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement(((t,o)=>{const i=e(t),r=()=>o.addIssue({code:ci.custom,...n(t)});return"undefined"!=typeof Promise&&i instanceof Promise?i.then((e=>!!e||(r(),!1))):!!i||(r(),!1)}))}refinement(e,t){return this._refinement(((n,o)=>!!e(n)||(o.addIssue("function"==typeof t?t(n,o):t),!1)))}_refinement(e){return new vr({schema:this,typeName:Nr.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return gr.create(this,this._def)}nullable(){return yr.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Yi.create(this,this._def)}promise(){return hr.create(this,this._def)}or(e){return er.create([this,e],this._def)}and(e){return ir.create(this,e,this._def)}transform(e){return new vr({...Ai(this._def),schema:this,typeName:Nr.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new _r({...Ai(this._def),innerType:this,defaultValue:t,typeName:Nr.ZodDefault})}brand(){return new Tr({typeName:Nr.ZodBranded,type:this,...Ai(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new xr({...Ai(this._def),innerType:this,catchValue:t,typeName:Nr.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return wr.create(this,e)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Ci=/^c[^\s-]{8,}$/i,Oi=/^[a-z][a-z0-9]*$/,Pi=/[0-9A-HJKMNP-TV-Z]{26}/,Ri=/^([a-f0-9]{8}-[a-f0-9]{4}-[1-5][a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12}|00000000-0000-0000-0000-000000000000)$/i,Mi=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\])|(\[IPv6:(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))\])|([A-Za-z0-9]([A-Za-z0-9-]*[A-Za-z0-9])*(\.[A-Za-z]{2,})+))$/,Zi=/^(\p{Extended_Pictographic}|\p{Emoji_Component})+$/u,Gi=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,ji=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/;class Di extends Ii{constructor(){super(...arguments),this._regex=(e,t,n)=>this.refinement((t=>e.test(t)),{validation:t,code:ci.invalid_string,...ki.errToObj(n)}),this.nonempty=e=>this.min(1,ki.errToObj(e)),this.trim=()=>new Di({...this._def,checks:[...this._def.checks,{kind:"trim"}]}),this.toLowerCase=()=>new Di({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]}),this.toUpperCase=()=>new Di({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==li.string){const t=this._getOrReturnCtx(e);return vi(t,{code:ci.invalid_type,expected:li.string,received:t.parsedType}),yi}const t=new gi;let n;for(const a of this._def.checks)if("min"===a.kind)e.data.length<a.value&&(n=this._getOrReturnCtx(e,n),vi(n,{code:ci.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),t.dirty());else if("max"===a.kind)e.data.length>a.value&&(n=this._getOrReturnCtx(e,n),vi(n,{code:ci.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),t.dirty());else if("length"===a.kind){const o=e.data.length>a.value,i=e.data.length<a.value;(o||i)&&(n=this._getOrReturnCtx(e,n),o?vi(n,{code:ci.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):i&&vi(n,{code:ci.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),t.dirty())}else if("email"===a.kind)Mi.test(e.data)||(n=this._getOrReturnCtx(e,n),vi(n,{validation:"email",code:ci.invalid_string,message:a.message}),t.dirty());else if("emoji"===a.kind)Zi.test(e.data)||(n=this._getOrReturnCtx(e,n),vi(n,{validation:"emoji",code:ci.invalid_string,message:a.message}),t.dirty());else if("uuid"===a.kind)Ri.test(e.data)||(n=this._getOrReturnCtx(e,n),vi(n,{validation:"uuid",code:ci.invalid_string,message:a.message}),t.dirty());else if("cuid"===a.kind)Ci.test(e.data)||(n=this._getOrReturnCtx(e,n),vi(n,{validation:"cuid",code:ci.invalid_string,message:a.message}),t.dirty());else if("cuid2"===a.kind)Oi.test(e.data)||(n=this._getOrReturnCtx(e,n),vi(n,{validation:"cuid2",code:ci.invalid_string,message:a.message}),t.dirty());else if("ulid"===a.kind)Pi.test(e.data)||(n=this._getOrReturnCtx(e,n),vi(n,{validation:"ulid",code:ci.invalid_string,message:a.message}),t.dirty());else if("url"===a.kind)try{new URL(e.data)}catch(o){n=this._getOrReturnCtx(e,n),vi(n,{validation:"url",code:ci.invalid_string,message:a.message}),t.dirty()}else"regex"===a.kind?(a.regex.lastIndex=0,a.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),vi(n,{validation:"regex",code:ci.invalid_string,message:a.message}),t.dirty())):"trim"===a.kind?e.data=e.data.trim():"includes"===a.kind?e.data.includes(a.value,a.position)||(n=this._getOrReturnCtx(e,n),vi(n,{code:ci.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),t.dirty()):"toLowerCase"===a.kind?e.data=e.data.toLowerCase():"toUpperCase"===a.kind?e.data=e.data.toUpperCase():"startsWith"===a.kind?e.data.startsWith(a.value)||(n=this._getOrReturnCtx(e,n),vi(n,{code:ci.invalid_string,validation:{startsWith:a.value},message:a.message}),t.dirty()):"endsWith"===a.kind?e.data.endsWith(a.value)||(n=this._getOrReturnCtx(e,n),vi(n,{code:ci.invalid_string,validation:{endsWith:a.value},message:a.message}),t.dirty()):"datetime"===a.kind?((r=a).precision?r.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${r.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${r.precision}}Z$`):0===r.precision?r.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):r.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$")).test(e.data)||(n=this._getOrReturnCtx(e,n),vi(n,{code:ci.invalid_string,validation:"datetime",message:a.message}),t.dirty()):"ip"===a.kind?(o=e.data,("v4"!==(i=a.version)&&i||!Gi.test(o))&&("v6"!==i&&i||!ji.test(o))&&(n=this._getOrReturnCtx(e,n),vi(n,{validation:"ip",code:ci.invalid_string,message:a.message}),t.dirty())):wo.assertNever(a);var o,i,r;return{status:t.value,value:e.data}}_addCheck(e){return new Di({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ki.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ki.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ki.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ki.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ki.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ki.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ki.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ki.errToObj(e)})}datetime(e){var t;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,...ki.errToObj(null==e?void 0:e.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...ki.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...ki.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...ki.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...ki.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...ki.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...ki.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...ki.errToObj(t)})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function Li(e,t){const n=(e.toString().split(".")[1]||"").length,o=(t.toString().split(".")[1]||"").length,i=n>o?n:o;return parseInt(e.toFixed(i).replace(".",""))%parseInt(t.toFixed(i).replace(".",""))/Math.pow(10,i)}Di.create=e=>{var t;return new Di({checks:[],typeName:Nr.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...Ai(e)})};class Ui extends Ii{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==li.number){const t=this._getOrReturnCtx(e);return vi(t,{code:ci.invalid_type,expected:li.number,received:t.parsedType}),yi}let t;const n=new gi;for(const o of this._def.checks)"int"===o.kind?wo.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),vi(t,{code:ci.invalid_type,expected:"integer",received:"float",message:o.message}),n.dirty()):"min"===o.kind?(o.inclusive?e.data<o.value:e.data<=o.value)&&(t=this._getOrReturnCtx(e,t),vi(t,{code:ci.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),n.dirty()):"max"===o.kind?(o.inclusive?e.data>o.value:e.data>=o.value)&&(t=this._getOrReturnCtx(e,t),vi(t,{code:ci.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),n.dirty()):"multipleOf"===o.kind?0!==Li(e.data,o.value)&&(t=this._getOrReturnCtx(e,t),vi(t,{code:ci.not_multiple_of,multipleOf:o.value,message:o.message}),n.dirty()):"finite"===o.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),vi(t,{code:ci.not_finite,message:o.message}),n.dirty()):wo.assertNever(o);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,ki.toString(t))}gt(e,t){return this.setLimit("min",e,!1,ki.toString(t))}lte(e,t){return this.setLimit("max",e,!0,ki.toString(t))}lt(e,t){return this.setLimit("max",e,!1,ki.toString(t))}setLimit(e,t,n,o){return new Ui({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:ki.toString(o)}]})}_addCheck(e){return new Ui({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ki.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ki.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ki.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ki.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ki.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ki.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:ki.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ki.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ki.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&wo.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if("finite"===n.kind||"int"===n.kind||"multipleOf"===n.kind)return!0;"min"===n.kind?(null===t||n.value>t)&&(t=n.value):"max"===n.kind&&(null===e||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Ui.create=e=>new Ui({checks:[],typeName:Nr.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...Ai(e)});class Vi extends Ii{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==li.bigint){const t=this._getOrReturnCtx(e);return vi(t,{code:ci.invalid_type,expected:li.bigint,received:t.parsedType}),yi}let t;const n=new gi;for(const o of this._def.checks)"min"===o.kind?(o.inclusive?e.data<o.value:e.data<=o.value)&&(t=this._getOrReturnCtx(e,t),vi(t,{code:ci.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),n.dirty()):"max"===o.kind?(o.inclusive?e.data>o.value:e.data>=o.value)&&(t=this._getOrReturnCtx(e,t),vi(t,{code:ci.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),n.dirty()):"multipleOf"===o.kind?e.data%o.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),vi(t,{code:ci.not_multiple_of,multipleOf:o.value,message:o.message}),n.dirty()):wo.assertNever(o);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,ki.toString(t))}gt(e,t){return this.setLimit("min",e,!1,ki.toString(t))}lte(e,t){return this.setLimit("max",e,!0,ki.toString(t))}lt(e,t){return this.setLimit("max",e,!1,ki.toString(t))}setLimit(e,t,n,o){return new Vi({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:ki.toString(o)}]})}_addCheck(e){return new Vi({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ki.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ki.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ki.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ki.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ki.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}Vi.create=e=>{var t;return new Vi({checks:[],typeName:Nr.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...Ai(e)})};class qi extends Ii{_parse(e){if(this._def.coerce&&(e.data=Boolean(e.data)),this._getType(e)!==li.boolean){const t=this._getOrReturnCtx(e);return vi(t,{code:ci.invalid_type,expected:li.boolean,received:t.parsedType}),yi}return xi(e.data)}}qi.create=e=>new qi({typeName:Nr.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...Ai(e)});class Bi extends Ii{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==li.date){const t=this._getOrReturnCtx(e);return vi(t,{code:ci.invalid_type,expected:li.date,received:t.parsedType}),yi}if(isNaN(e.data.getTime()))return vi(this._getOrReturnCtx(e),{code:ci.invalid_date}),yi;const t=new gi;let n;for(const o of this._def.checks)"min"===o.kind?e.data.getTime()<o.value&&(n=this._getOrReturnCtx(e,n),vi(n,{code:ci.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),t.dirty()):"max"===o.kind?e.data.getTime()>o.value&&(n=this._getOrReturnCtx(e,n),vi(n,{code:ci.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),t.dirty()):wo.assertNever(o);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Bi({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:ki.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:ki.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}Bi.create=e=>new Bi({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:Nr.ZodDate,...Ai(e)});class Fi extends Ii{_parse(e){if(this._getType(e)!==li.symbol){const t=this._getOrReturnCtx(e);return vi(t,{code:ci.invalid_type,expected:li.symbol,received:t.parsedType}),yi}return xi(e.data)}}Fi.create=e=>new Fi({typeName:Nr.ZodSymbol,...Ai(e)});class $i extends Ii{_parse(e){if(this._getType(e)!==li.undefined){const t=this._getOrReturnCtx(e);return vi(t,{code:ci.invalid_type,expected:li.undefined,received:t.parsedType}),yi}return xi(e.data)}}$i.create=e=>new $i({typeName:Nr.ZodUndefined,...Ai(e)});class zi extends Ii{_parse(e){if(this._getType(e)!==li.null){const t=this._getOrReturnCtx(e);return vi(t,{code:ci.invalid_type,expected:li.null,received:t.parsedType}),yi}return xi(e.data)}}zi.create=e=>new zi({typeName:Nr.ZodNull,...Ai(e)});class Wi extends Ii{constructor(){super(...arguments),this._any=!0}_parse(e){return xi(e.data)}}Wi.create=e=>new Wi({typeName:Nr.ZodAny,...Ai(e)});class Ki extends Ii{constructor(){super(...arguments),this._unknown=!0}_parse(e){return xi(e.data)}}Ki.create=e=>new Ki({typeName:Nr.ZodUnknown,...Ai(e)});class Ji extends Ii{_parse(e){const t=this._getOrReturnCtx(e);return vi(t,{code:ci.invalid_type,expected:li.never,received:t.parsedType}),yi}}Ji.create=e=>new Ji({typeName:Nr.ZodNever,...Ai(e)});class Hi extends Ii{_parse(e){if(this._getType(e)!==li.undefined){const t=this._getOrReturnCtx(e);return vi(t,{code:ci.invalid_type,expected:li.void,received:t.parsedType}),yi}return xi(e.data)}}Hi.create=e=>new Hi({typeName:Nr.ZodVoid,...Ai(e)});class Yi extends Ii{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),o=this._def;if(t.parsedType!==li.array)return vi(t,{code:ci.invalid_type,expected:li.array,received:t.parsedType}),yi;if(null!==o.exactLength){const e=t.data.length>o.exactLength.value,i=t.data.length<o.exactLength.value;(e||i)&&(vi(t,{code:e?ci.too_big:ci.too_small,minimum:i?o.exactLength.value:void 0,maximum:e?o.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:o.exactLength.message}),n.dirty())}if(null!==o.minLength&&t.data.length<o.minLength.value&&(vi(t,{code:ci.too_small,minimum:o.minLength.value,type:"array",inclusive:!0,exact:!1,message:o.minLength.message}),n.dirty()),null!==o.maxLength&&t.data.length>o.maxLength.value&&(vi(t,{code:ci.too_big,maximum:o.maxLength.value,type:"array",inclusive:!0,exact:!1,message:o.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map(((e,n)=>o.type._parseAsync(new Si(t,e,t.path,n))))).then((e=>gi.mergeArray(n,e)));const i=[...t.data].map(((e,n)=>o.type._parseSync(new Si(t,e,t.path,n))));return gi.mergeArray(n,i)}get element(){return this._def.type}min(e,t){return new Yi({...this._def,minLength:{value:e,message:ki.toString(t)}})}max(e,t){return new Yi({...this._def,maxLength:{value:e,message:ki.toString(t)}})}length(e,t){return new Yi({...this._def,exactLength:{value:e,message:ki.toString(t)}})}nonempty(e){return this.min(1,e)}}function Xi(e){if(e instanceof Qi){const t={};for(const n in e.shape){const o=e.shape[n];t[n]=gr.create(Xi(o))}return new Qi({...e._def,shape:()=>t})}return e instanceof Yi?new Yi({...e._def,type:Xi(e.element)}):e instanceof gr?gr.create(Xi(e.unwrap())):e instanceof yr?yr.create(Xi(e.unwrap())):e instanceof rr?rr.create(e.items.map((e=>Xi(e)))):e}Yi.create=(e,t)=>new Yi({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Nr.ZodArray,...Ai(t)});class Qi extends Ii{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=wo.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==li.object){const t=this._getOrReturnCtx(e);return vi(t,{code:ci.invalid_type,expected:li.object,received:t.parsedType}),yi}const{status:t,ctx:n}=this._processInputParams(e),{shape:o,keys:i}=this._getCached(),r=[];if(!(this._def.catchall instanceof Ji&&"strip"===this._def.unknownKeys))for(const e in n.data)i.includes(e)||r.push(e);const a=[];for(const e of i){const t=o[e],i=n.data[e];a.push({key:{status:"valid",value:e},value:t._parse(new Si(n,i,n.path,e)),alwaysSet:e in n.data})}if(this._def.catchall instanceof Ji){const e=this._def.unknownKeys;if("passthrough"===e)for(const e of r)a.push({key:{status:"valid",value:e},value:{status:"valid",value:n.data[e]}});else if("strict"===e)r.length>0&&(vi(n,{code:ci.unrecognized_keys,keys:r}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of r){const o=n.data[t];a.push({key:{status:"valid",value:t},value:e._parse(new Si(n,o,n.path,t)),alwaysSet:t in n.data})}}return n.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of a){const n=await t.key;e.push({key:n,value:await t.value,alwaysSet:t.alwaysSet})}return e})).then((e=>gi.mergeObjectSync(t,e))):gi.mergeObjectSync(t,a)}get shape(){return this._def.shape()}strict(e){return ki.errToObj,new Qi({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,n)=>{var o,i,r,a;const s=null!==(r=null===(i=(o=this._def).errorMap)||void 0===i?void 0:i.call(o,t,n).message)&&void 0!==r?r:n.defaultError;return"unrecognized_keys"===t.code?{message:null!==(a=ki.errToObj(e).message)&&void 0!==a?a:s}:{message:s}}}:{}})}strip(){return new Qi({...this._def,unknownKeys:"strip"})}passthrough(){return new Qi({...this._def,unknownKeys:"passthrough"})}extend(e){return new Qi({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Qi({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Nr.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new Qi({...this._def,catchall:e})}pick(e){const t={};return wo.objectKeys(e).forEach((n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])})),new Qi({...this._def,shape:()=>t})}omit(e){const t={};return wo.objectKeys(this.shape).forEach((n=>{e[n]||(t[n]=this.shape[n])})),new Qi({...this._def,shape:()=>t})}deepPartial(){return Xi(this)}partial(e){const t={};return wo.objectKeys(this.shape).forEach((n=>{const o=this.shape[n];e&&!e[n]?t[n]=o:t[n]=o.optional()})),new Qi({...this._def,shape:()=>t})}required(e){const t={};return wo.objectKeys(this.shape).forEach((n=>{if(e&&!e[n])t[n]=this.shape[n];else{let e=this.shape[n];for(;e instanceof gr;)e=e._def.innerType;t[n]=e}})),new Qi({...this._def,shape:()=>t})}keyof(){return pr(wo.objectKeys(this.shape))}}Qi.create=(e,t)=>new Qi({shape:()=>e,unknownKeys:"strip",catchall:Ji.create(),typeName:Nr.ZodObject,...Ai(t)}),Qi.strictCreate=(e,t)=>new Qi({shape:()=>e,unknownKeys:"strict",catchall:Ji.create(),typeName:Nr.ZodObject,...Ai(t)}),Qi.lazycreate=(e,t)=>new Qi({shape:e,unknownKeys:"strip",catchall:Ji.create(),typeName:Nr.ZodObject,...Ai(t)});class er extends Ii{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;if(t.common.async)return Promise.all(n.map((async e=>{const n={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const n of e)if("dirty"===n.result.status)return t.common.issues.push(...n.ctx.common.issues),n.result;const n=e.map((e=>new di(e.ctx.common.issues)));return vi(t,{code:ci.invalid_union,unionErrors:n}),yi}));{let e;const o=[];for(const i of n){const n={...t,common:{...t.common,issues:[]},parent:null},r=i._parseSync({data:t.data,path:t.path,parent:n});if("valid"===r.status)return r;"dirty"!==r.status||e||(e={result:r,ctx:n}),n.common.issues.length&&o.push(n.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const i=o.map((e=>new di(e)));return vi(t,{code:ci.invalid_union,unionErrors:i}),yi}}get options(){return this._def.options}}er.create=(e,t)=>new er({options:e,typeName:Nr.ZodUnion,...Ai(t)});const tr=e=>e instanceof cr?tr(e.schema):e instanceof vr?tr(e.innerType()):e instanceof dr?[e.value]:e instanceof mr?e.options:e instanceof fr?Object.keys(e.enum):e instanceof _r?tr(e._def.innerType):e instanceof $i?[void 0]:e instanceof zi?[null]:null;class nr extends Ii{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==li.object)return vi(t,{code:ci.invalid_type,expected:li.object,received:t.parsedType}),yi;const n=this.discriminator,o=t.data[n],i=this.optionsMap.get(o);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(vi(t,{code:ci.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),yi)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const o=new Map;for(const n of t){const t=tr(n.shape[e]);if(!t)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const i of t){if(o.has(i))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(i)}`);o.set(i,n)}}return new nr({typeName:Nr.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:o,...Ai(n)})}}function or(e,t){const n=ui(e),o=ui(t);if(e===t)return{valid:!0,data:e};if(n===li.object&&o===li.object){const n=wo.objectKeys(t),o=wo.objectKeys(e).filter((e=>-1!==n.indexOf(e))),i={...e,...t};for(const n of o){const o=or(e[n],t[n]);if(!o.valid)return{valid:!1};i[n]=o.data}return{valid:!0,data:i}}if(n===li.array&&o===li.array){if(e.length!==t.length)return{valid:!1};const n=[];for(let o=0;o<e.length;o++){const i=or(e[o],t[o]);if(!i.valid)return{valid:!1};n.push(i.data)}return{valid:!0,data:n}}return n===li.date&&o===li.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class ir extends Ii{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),o=(e,o)=>{if(bi(e)||bi(o))return yi;const i=or(e.value,o.value);return i.valid?((Ei(e)||Ei(o))&&t.dirty(),{status:t.value,value:i.data}):(vi(n,{code:ci.invalid_intersection_types}),yi)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then((([e,t])=>o(e,t))):o(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}ir.create=(e,t,n)=>new ir({left:e,right:t,typeName:Nr.ZodIntersection,...Ai(n)});class rr extends Ii{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==li.array)return vi(n,{code:ci.invalid_type,expected:li.array,received:n.parsedType}),yi;if(n.data.length<this._def.items.length)return vi(n,{code:ci.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),yi;!this._def.rest&&n.data.length>this._def.items.length&&(vi(n,{code:ci.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const o=[...n.data].map(((e,t)=>{const o=this._def.items[t]||this._def.rest;return o?o._parse(new Si(n,e,n.path,t)):null})).filter((e=>!!e));return n.common.async?Promise.all(o).then((e=>gi.mergeArray(t,e))):gi.mergeArray(t,o)}get items(){return this._def.items}rest(e){return new rr({...this._def,rest:e})}}rr.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new rr({items:e,typeName:Nr.ZodTuple,rest:null,...Ai(t)})};class ar extends Ii{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==li.object)return vi(n,{code:ci.invalid_type,expected:li.object,received:n.parsedType}),yi;const o=[],i=this._def.keyType,r=this._def.valueType;for(const e in n.data)o.push({key:i._parse(new Si(n,e,n.path,e)),value:r._parse(new Si(n,n.data[e],n.path,e))});return n.common.async?gi.mergeObjectAsync(t,o):gi.mergeObjectSync(t,o)}get element(){return this._def.valueType}static create(e,t,n){return new ar(t instanceof Ii?{keyType:e,valueType:t,typeName:Nr.ZodRecord,...Ai(n)}:{keyType:Di.create(),valueType:e,typeName:Nr.ZodRecord,...Ai(t)})}}class sr extends Ii{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==li.map)return vi(n,{code:ci.invalid_type,expected:li.map,received:n.parsedType}),yi;const o=this._def.keyType,i=this._def.valueType,r=[...n.data.entries()].map((([e,t],r)=>({key:o._parse(new Si(n,e,n.path,[r,"key"])),value:i._parse(new Si(n,t,n.path,[r,"value"]))})));if(n.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const n of r){const o=await n.key,i=await n.value;if("aborted"===o.status||"aborted"===i.status)return yi;"dirty"!==o.status&&"dirty"!==i.status||t.dirty(),e.set(o.value,i.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const n of r){const o=n.key,i=n.value;if("aborted"===o.status||"aborted"===i.status)return yi;"dirty"!==o.status&&"dirty"!==i.status||t.dirty(),e.set(o.value,i.value)}return{status:t.value,value:e}}}}sr.create=(e,t,n)=>new sr({valueType:t,keyType:e,typeName:Nr.ZodMap,...Ai(n)});class lr extends Ii{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==li.set)return vi(n,{code:ci.invalid_type,expected:li.set,received:n.parsedType}),yi;const o=this._def;null!==o.minSize&&n.data.size<o.minSize.value&&(vi(n,{code:ci.too_small,minimum:o.minSize.value,type:"set",inclusive:!0,exact:!1,message:o.minSize.message}),t.dirty()),null!==o.maxSize&&n.data.size>o.maxSize.value&&(vi(n,{code:ci.too_big,maximum:o.maxSize.value,type:"set",inclusive:!0,exact:!1,message:o.maxSize.message}),t.dirty());const i=this._def.valueType;function r(e){const n=new Set;for(const o of e){if("aborted"===o.status)return yi;"dirty"===o.status&&t.dirty(),n.add(o.value)}return{status:t.value,value:n}}const a=[...n.data.values()].map(((e,t)=>i._parse(new Si(n,e,n.path,t))));return n.common.async?Promise.all(a).then((e=>r(e))):r(a)}min(e,t){return new lr({...this._def,minSize:{value:e,message:ki.toString(t)}})}max(e,t){return new lr({...this._def,maxSize:{value:e,message:ki.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}lr.create=(e,t)=>new lr({valueType:e,minSize:null,maxSize:null,typeName:Nr.ZodSet,...Ai(t)});class ur extends Ii{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==li.function)return vi(t,{code:ci.invalid_type,expected:li.function,received:t.parsedType}),yi;function n(e,n){return hi({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,fi(),pi].filter((e=>!!e)),issueData:{code:ci.invalid_arguments,argumentsError:n}})}function o(e,n){return hi({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,fi(),pi].filter((e=>!!e)),issueData:{code:ci.invalid_return_type,returnTypeError:n}})}const i={errorMap:t.common.contextualErrorMap},r=t.data;return this._def.returns instanceof hr?xi((async(...e)=>{const t=new di([]),a=await this._def.args.parseAsync(e,i).catch((o=>{throw t.addIssue(n(e,o)),t})),s=await r(...a);return await this._def.returns._def.type.parseAsync(s,i).catch((e=>{throw t.addIssue(o(s,e)),t}))})):xi(((...e)=>{const t=this._def.args.safeParse(e,i);if(!t.success)throw new di([n(e,t.error)]);const a=r(...t.data),s=this._def.returns.safeParse(a,i);if(!s.success)throw new di([o(a,s.error)]);return s.data}))}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ur({...this._def,args:rr.create(e).rest(Ki.create())})}returns(e){return new ur({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new ur({args:e||rr.create([]).rest(Ki.create()),returns:t||Ki.create(),typeName:Nr.ZodFunction,...Ai(n)})}}class cr extends Ii{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}cr.create=(e,t)=>new cr({getter:e,typeName:Nr.ZodLazy,...Ai(t)});class dr extends Ii{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return vi(t,{received:t.data,code:ci.invalid_literal,expected:this._def.value}),yi}return{status:"valid",value:e.data}}get value(){return this._def.value}}function pr(e,t){return new mr({values:e,typeName:Nr.ZodEnum,...Ai(t)})}dr.create=(e,t)=>new dr({value:e,typeName:Nr.ZodLiteral,...Ai(t)});class mr extends Ii{_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),n=this._def.values;return vi(t,{expected:wo.joinValues(n),received:t.parsedType,code:ci.invalid_type}),yi}if(-1===this._def.values.indexOf(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return vi(t,{received:t.data,code:ci.invalid_enum_value,options:n}),yi}return xi(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){return mr.create(e)}exclude(e){return mr.create(this.options.filter((t=>!e.includes(t))))}}mr.create=pr;class fr extends Ii{_parse(e){const t=wo.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==li.string&&n.parsedType!==li.number){const e=wo.objectValues(t);return vi(n,{expected:wo.joinValues(e),received:n.parsedType,code:ci.invalid_type}),yi}if(-1===t.indexOf(e.data)){const e=wo.objectValues(t);return vi(n,{received:n.data,code:ci.invalid_enum_value,options:e}),yi}return xi(e.data)}get enum(){return this._def.values}}fr.create=(e,t)=>new fr({values:e,typeName:Nr.ZodNativeEnum,...Ai(t)});class hr extends Ii{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==li.promise&&!1===t.common.async)return vi(t,{code:ci.invalid_type,expected:li.promise,received:t.parsedType}),yi;const n=t.parsedType===li.promise?t.data:Promise.resolve(t.data);return xi(n.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}hr.create=(e,t)=>new hr({type:e,typeName:Nr.ZodPromise,...Ai(t)});class vr extends Ii{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Nr.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),o=this._def.effect||null;if("preprocess"===o.type){const e=o.transform(n.data);return n.common.async?Promise.resolve(e).then((e=>this._def.schema._parseAsync({data:e,path:n.path,parent:n}))):this._def.schema._parseSync({data:e,path:n.path,parent:n})}const i={addIssue:e=>{vi(n,e),e.fatal?t.abort():t.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),"refinement"===o.type){const e=e=>{const t=o.refinement(e,i);if(n.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===n.common.async){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===o.status?yi:("dirty"===o.status&&t.dirty(),e(o.value),{status:t.value,value:o.value})}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((n=>"aborted"===n.status?yi:("dirty"===n.status&&t.dirty(),e(n.value).then((()=>({status:t.value,value:n.value}))))))}if("transform"===o.type){if(!1===n.common.async){const e=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Ti(e))return e;const r=o.transform(e.value,i);if(r instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:r}}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((e=>Ti(e)?Promise.resolve(o.transform(e.value,i)).then((e=>({status:t.value,value:e}))):e))}wo.assertNever(o)}}vr.create=(e,t,n)=>new vr({schema:e,typeName:Nr.ZodEffects,effect:t,...Ai(n)}),vr.createWithPreprocess=(e,t,n)=>new vr({schema:t,effect:{type:"preprocess",transform:e},typeName:Nr.ZodEffects,...Ai(n)});class gr extends Ii{_parse(e){return this._getType(e)===li.undefined?xi(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}gr.create=(e,t)=>new gr({innerType:e,typeName:Nr.ZodOptional,...Ai(t)});class yr extends Ii{_parse(e){return this._getType(e)===li.null?xi(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}yr.create=(e,t)=>new yr({innerType:e,typeName:Nr.ZodNullable,...Ai(t)});class _r extends Ii{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===li.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}_r.create=(e,t)=>new _r({innerType:e,typeName:Nr.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...Ai(t)});class xr extends Ii{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},o=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return wi(o)?o.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new di(n.common.issues)},input:n.data})}))):{status:"valid",value:"valid"===o.status?o.value:this._def.catchValue({get error(){return new di(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}xr.create=(e,t)=>new xr({innerType:e,typeName:Nr.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...Ai(t)});class br extends Ii{_parse(e){if(this._getType(e)!==li.nan){const t=this._getOrReturnCtx(e);return vi(t,{code:ci.invalid_type,expected:li.nan,received:t.parsedType}),yi}return{status:"valid",value:e.data}}}br.create=e=>new br({typeName:Nr.ZodNaN,...Ai(e)});const Er=Symbol("zod_brand");class Tr extends Ii{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class wr extends Ii{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const e=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?yi:"dirty"===e.status?(t.dirty(),_i(e.value)):this._def.out._parseAsync({data:e.value,path:n.path,parent:n})})();{const e=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?yi:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:n.path,parent:n})}}static create(e,t){return new wr({in:e,out:t,typeName:Nr.ZodPipeline})}}const kr=(e,t={},n)=>e?Wi.create().superRefine(((o,i)=>{var r,a;if(!e(o)){const e="function"==typeof t?t(o):"string"==typeof t?{message:t}:t,s=null===(a=null!==(r=e.fatal)&&void 0!==r?r:n)||void 0===a||a,l="string"==typeof e?{message:e}:e;i.addIssue({code:"custom",...l,fatal:s})}})):Wi.create(),Sr={object:Qi.lazycreate};var Nr;!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline"}(Nr||(Nr={}));const Ar=Di.create,Ir=Ui.create,Cr=br.create,Or=Vi.create,Pr=qi.create,Rr=Bi.create,Mr=Fi.create,Zr=$i.create,Gr=zi.create,jr=Wi.create,Dr=Ki.create,Lr=Ji.create,Ur=Hi.create,Vr=Yi.create,qr=Qi.create,Br=Qi.strictCreate,Fr=er.create,$r=nr.create,zr=ir.create,Wr=rr.create,Kr=ar.create,Jr=sr.create,Hr=lr.create,Yr=ur.create,Xr=cr.create,Qr=dr.create,ea=mr.create,ta=fr.create,na=hr.create,oa=vr.create,ia=gr.create,ra=yr.create,aa=vr.createWithPreprocess,sa=wr.create,la={string:e=>Di.create({...e,coerce:!0}),number:e=>Ui.create({...e,coerce:!0}),boolean:e=>qi.create({...e,coerce:!0}),bigint:e=>Vi.create({...e,coerce:!0}),date:e=>Bi.create({...e,coerce:!0})},ua=yi;var ca,da=Object.freeze({__proto__:null,defaultErrorMap:pi,setErrorMap:function(e){mi=e},getErrorMap:fi,makeIssue:hi,EMPTY_PATH:[],addIssueToContext:vi,ParseStatus:gi,INVALID:yi,DIRTY:_i,OK:xi,isAborted:bi,isDirty:Ei,isValid:Ti,isAsync:wi,get util(){return wo},get objectUtil(){return ko},ZodParsedType:li,getParsedType:ui,ZodType:Ii,ZodString:Di,ZodNumber:Ui,ZodBigInt:Vi,ZodBoolean:qi,ZodDate:Bi,ZodSymbol:Fi,ZodUndefined:$i,ZodNull:zi,ZodAny:Wi,ZodUnknown:Ki,ZodNever:Ji,ZodVoid:Hi,ZodArray:Yi,ZodObject:Qi,ZodUnion:er,ZodDiscriminatedUnion:nr,ZodIntersection:ir,ZodTuple:rr,ZodRecord:ar,ZodMap:sr,ZodSet:lr,ZodFunction:ur,ZodLazy:cr,ZodLiteral:dr,ZodEnum:mr,ZodNativeEnum:fr,ZodPromise:hr,ZodEffects:vr,ZodTransformer:vr,ZodOptional:gr,ZodNullable:yr,ZodDefault:_r,ZodCatch:xr,ZodNaN:br,BRAND:Er,ZodBranded:Tr,ZodPipeline:wr,custom:kr,Schema:Ii,ZodSchema:Ii,late:Sr,get ZodFirstPartyTypeKind(){return Nr},coerce:la,any:jr,array:Vr,bigint:Or,boolean:Pr,date:Rr,discriminatedUnion:$r,effect:oa,enum:ea,function:Yr,instanceof:(e,t={message:`Input not instance of ${e.name}`})=>kr((t=>t instanceof e),t),intersection:zr,lazy:Xr,literal:Qr,map:Jr,nan:Cr,nativeEnum:ta,never:Lr,null:Gr,nullable:ra,number:Ir,object:qr,oboolean:()=>Pr().optional(),onumber:()=>Ir().optional(),optional:ia,ostring:()=>Ar().optional(),pipeline:sa,preprocess:aa,promise:na,record:Kr,set:Hr,strictObject:Br,string:Ar,symbol:Mr,transformer:oa,tuple:Wr,undefined:Zr,union:Fr,unknown:Dr,void:Ur,NEVER:ua,ZodIssueCode:ci,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:di}),pa=function(){return pa=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},pa.apply(this,arguments)},ma=function(){var e=fa(),t=(0,u.useDispatch)(p),n=t.receiveAutomationGroupTemplates,o=t.closeTemplateImportExport,i=(0,a.useState)(""),r=i[0],l=i[1],c=ha(r);if((0,a.useEffect)((function(){"export"===(null==e?void 0:e.mode)?l(JSON.stringify(e.templates,null,2)):l("")}),[e]),!e)return null;var d=e.mode,m="export"===d?(0,s._x)("Export Templates","text","nelio-content"):(0,s._x)("Import Templates","text","nelio-content"),f="export"===d?(0,s._x)("Copy","command","nelio-content"):(0,s._x)("Import","command","nelio-content"),h="import"===d?function(){"import"===d&&c.length&&(n(e.templateType,c),o())}:function(){navigator.clipboard.writeText(r).then((function(){return o()}))},v="import"===d&&!c.length,g="export"!==d||"https:"===document.location.protocol;return a.createElement(Me.Modal,{className:"nelio-content-import-export-templates",title:m,onRequestClose:o,style:{minWidth:"30%"}},a.createElement(Me.TextareaControl,{placeholder:"import"===d?(0,s._x)("Paste social templates here…","user","nelio-content"):void 0,value:r,onChange:l,readOnly:"export"===d}),a.createElement("div",{className:"nelio-content-import-export-templates__actions"},a.createElement(Me.Button,{variant:"secondary",onClick:o},(0,s._x)("Close","command","nelio-content")),g&&a.createElement(Me.Button,{variant:"primary",onClick:h,disabled:v},f)))},fa=function(){return(0,u.useSelect)((function(e){return e(p).getImportExportData()}))},ha=function(e){var t=fa(),n=(0,u.useSelect)((function(e){return e(de.STORE_NAME).getCurrentUserId()})),o=(0,u.useSelect)((function(e){var n,o=e(de.STORE_NAME).getSocialProfile;return"import"===(null==t?void 0:t.mode)?null===(n=o(t.profileId))||void 0===n?void 0:n.network:void 0}));if("import"!==(null==t?void 0:t.mode)||!o)return[];try{var i=t.groupId,r=t.profileId;return(0,c.castArray)(JSON.parse(e)).map((function(e){return ba.safeParse(e)})).map((function(e){return e.success?e.data:void 0})).filter(d.isDefined).map((function(e){var a;return pa(pa({groupId:i,id:At(),creatorId:n,network:o},!e.isNetwork&&{profileId:r,targetName:e.targetName}),{taxonomies:null!==(a=e.taxonomies)&&void 0!==a?a:{},text:e.text,postType:"universal"===i?e.postType:void 0,author:e.author,availability:va(t.templateType,e.availability)?e.availability:void 0})})).filter((function(e){return!!e.text.length}))}catch(e){return[]}},va=function(e,t){return!!(null==t?void 0:t.type.includes(e))},ga=da.object({mon:da.boolean(),tue:da.boolean(),wed:da.boolean(),thu:da.boolean(),fri:da.boolean(),sat:da.boolean(),sun:da.boolean()}),ya=da.union([da.literal("morning"),da.literal("noon"),da.literal("afternoon"),da.literal("night"),da.custom((function(e){return"string"==typeof e&&/^[0-2][0-9]:[0-5][0-9]$/.test(e)}))]),_a=da.object({instanceCount:da.number().nonnegative(),intervalInDays:da.number().positive()}),xa=da.discriminatedUnion("type",[da.object({type:da.literal("publication-day-offset"),hoursAfterPublication:da.number().nonnegative(),randomize:da.optional(da.number().nonnegative()),recurrency:da.optional(_a)}),da.object({type:da.literal("publication-day-period"),time:ya,randomize:da.optional(da.number().nonnegative()),recurrency:da.optional(_a)}),da.object({type:da.literal("after-publication"),daysAfterPublication:da.number().nonnegative(),time:ya,randomize:da.optional(da.number().nonnegative()),recurrency:da.optional(_a)}),da.object({type:da.literal("reshare"),weekday:ga,time:ya,randomize:da.optional(da.number().nonnegative())})]),ba=da.object({text:da.string().min(1),isNetwork:da.boolean(),targetName:da.optional(da.string()).transform((function(e){return e})),author:da.optional(da.number().positive()).transform((function(e){return e})),postType:da.optional(da.string()).transform((function(e){return e})),taxonomies:da.optional(da.record(da.number().positive())).transform((function(e){return e})),availability:da.optional(xa)}),Ea=null!==(ca=null===ce.store||void 0===ce.store?void 0:ce.store.name)&&void 0!==ca?ca:"core/notices",Ta=function(){var e=function(){var e=(0,u.useSelect)((function(e){return{groups:e(de.STORE_NAME).getAutomationGroups().map((function(t){return e(de.STORE_NAME).getAutomationGroup(t)})).filter(d.isDefined),isLoadingGroups:!e(de.STORE_NAME).hasFinishedResolution("getAutomationGroups")}})),t=e.groups,n=e.isLoadingGroups,o=ft("authors",n?[]:t),i=ft("terms",n?[]:t);return{data:t,isLoading:n||o||i}}(),t=e.isLoading,n=e.data,o=wa(),i=o.isLoading,r=o.data,s=(0,u.useDispatch)(p).initAutomationGroups,c=ka(),m=c[0],f=c[1],h=qe(),v=t||i;return(0,a.useEffect)((function(){v||s(n,r)}),[v]),(0,a.useEffect)((function(){if(!v)return h?window.addEventListener("beforeunload",Sa,{capture:!0}):window.removeEventListener("beforeunload",Sa,{capture:!0}),function(){window.removeEventListener("beforeunload",Sa,{capture:!0})}}),[h,v]),v?a.createElement("div",{className:"nelio-content-automations-settings-layout"},a.createElement(l.LoadingAnimation,null)):a.createElement("div",{className:"nelio-content-automations-settings-layout"},a.createElement(a.StrictMode,null,a.createElement(Me.SlotFillProvider,null,a.createElement(Me.NoticeList,{notices:m,className:"components-editor-notices__pinned",onRemove:f}),a.createElement(Pn,null),a.createElement(zo,null),a.createElement(ma,null),a.createElement(Vn,null),a.createElement(Me.Popover.Slot,null))))},wa=function(){return(0,u.useSelect)((function(e){var t=e(de.STORE_NAME).getSocialProfiles();return{isLoading:e(de.STORE_NAME).isLoadingSocialProfiles(),data:t}}))},ka=function(){return[(0,u.useSelect)((function(e){return e(Ea).getNotices()})),(0,u.useDispatch)(Ea).removeNotice]},Sa=function(e){return e.preventDefault(),e.returnValue=""};function Na(e){var t=document.getElementById(e);(0,a.render)(a.createElement(Ta,null),t);var n=document.getElementById("nelio-content-settings-title");n&&(0,a.render)(a.createElement(l.ContextualHelp,{context:"social-automations",walkthrough:Re,autostart:!0,component:Aa}),n)}var Aa=function(e){var t=e.className,n=e.runWalkthrough;return a.createElement("button",{className:"".concat(t,"  page-title-action"),onClick:function(){Ia().then(n)}},(0,s._x)("Help","text","nelio-content"))},Ia=function(){return e=void 0,t=void 0,o=function(){var e,t,n,o;return function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}(this,(function(i){switch(i.label){case 0:return e=".nelio-content-automation-group",(t=document.querySelector("".concat(e,":first-child")))?t.querySelector("".concat(e,"__body"))?[3,2]:(null==(n=t.querySelector("".concat(e,"__header-content")))||n.click(),[4,Ca()]):[2];case 1:i.sent(),i.label=2;case 2:return null==(o=t.querySelector("".concat(e,"__sidebar-item")))||o.click(),[4,Ca()];case 3:return i.sent(),[2]}}))},new((n=void 0)||(n=Promise))((function(i,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}));var e,t,n,o},Ca=function(){return new Promise((function(e){return setTimeout(e,50)}))}})();var i=NelioContent="undefined"==typeof NelioContent?{}:NelioContent;for(var r in o)i[r]=o[r];o.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();
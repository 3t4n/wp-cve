"use strict";!function(t){var o=[];window.setAvailableCouriers=function(a){t(a).each(function(e){a[e].courierName=decodeURI(a[e].courierName).replace("+"," ")}),o=a},window.changeTab=function(e){for(var a=document.getElementsByClassName("tab"),o=0;o<a.length;o++)a[o].style.display="none";document.getElementById(e).style.display="block"},window.getEpakaOrderLabel=function(e){t.post(epaka_admin_object.api_endpoint+"/get-epaka-order-label?token="+epaka_admin_object.admin_token,{orderId:e},function(e){for(var a=atob(e),o=new Array(a.length),n=0;n<a.length;n++)o[n]=a.charCodeAt(n);var t=new Uint8Array(o),i=new Blob([t],{type:"application/pdf;base64"}),r=URL.createObjectURL(i);window.open(r)}).fail(function(){alert("Nie udało się pobrac etykiety.")})},window.setParcelNumberToTrack=function(e){t(".epaka-order-tracking").find(".epaka-tracking-loading").show(),t.post(epaka_admin_object.api_endpoint+"/get-epaka-courier-tracking?token="+epaka_admin_object.admin_token,{label:e},function(e){var a,o;t(".epaka-order-tracking").find(".epaka-tracking-loading").hide(),Array.isArray(e.step)?t(e.step).each(function(){var e=new Date(this.time),a=document.createElement("tr");t(a).append("<td>"+e.toLocaleDateString()+"</td>"),t(a).append("<td>"+e.toLocaleTimeString()+"</td>"),t(a).append("<td>"+this.status_code_desc+"</td>"),t(a).append("<td>"+this.location+"</td>"),t(".epaka-order-tracking").find("tbody").append(a)}):(a=new Date(e.step.time),o=document.createElement("tr"),t(o).append("<td>"+a.toLocaleDateString()+"</td>"),t(o).append("<td>"+a.toLocaleTimeString()+"</td>"),t(o).append("<td>"+e.step.status_code_desc+"</td>"),t(o).append("<td>"+e.step.location+"</td>"),t(".epaka-order-tracking").find("tbody").append(o))}).fail(function(){t(".epaka-order-tracking").find(".epaka-tracking-loading").hide(),t(".epaka-order-tracking").find("tbody").append("<tr><td colspan='4'><center>Brak danych...</center></td></tr>")})},window.unlinkEpakaOrderFromWooOrder=function(e){1==confirm("Czy na pewno chcesz złożyć nowe zamówienie?(Stare zostanie odpięte)")&&t.post(epaka_admin_object.api_endpoint+"/unlink-epaka-order-from-woo-order?token="+epaka_admin_object.admin_token,{woo_order_id:e},function(e){window.location.reload()}).fail(function(){alert("Nie udało się odlinkować zamówienia Epaka.")})},window.cancelEpakaOrder=function(e){1==confirm("Czy na pewno chcesz anulować zamówienie?")&&t.post(epaka_admin_object.api_endpoint+"/cancel-epaka-order?token="+epaka_admin_object.admin_token,{epaka_order_id:e},function(e){window.location.reload()}).fail(function(){alert("Nie udało się odlinkować zamówienia Epaka.")})},window.getEpakaOrderLabelZebra=function(e){t.post(epaka_admin_object.api_endpoint+"/get-epaka-order-label-zebra?token="+epaka_admin_object.admin_token,{orderId:e},function(e){for(var a=atob(e),o=new Array(a.length),n=0;n<a.length;n++)o[n]=a.charCodeAt(n);var t=new Uint8Array(o),i=new Blob([t],{type:"application/pdf;base64"}),r=URL.createObjectURL(i);window.open(r)}).fail(function(){alert("Nie udało się pobrać etykiety zebra.")})},window.getEpakaOrderProforma=function(e){t.post(epaka_admin_object.api_endpoint+"/get-epaka-order-proforma?token="+epaka_admin_object.admin_token,{orderId:e},function(e){for(var a=atob(e),o=new Array(a.length),n=0;n<a.length;n++)o[n]=a.charCodeAt(n);var t=new Uint8Array(o),i=new Blob([t],{type:"application/pdf;base64"}),r=URL.createObjectURL(i);window.open(r)}).fail(function(){alert("Nie udało się pobrać proformy.")})},window.getEpakaOrderProtocol=function(e){t.post(epaka_admin_object.api_endpoint+"/get-epaka-order-protocol?token="+epaka_admin_object.admin_token,{orderId:e},function(e){for(var a=atob(e),o=new Array(a.length),n=0;n<a.length;n++)o[n]=a.charCodeAt(n);var t=new Uint8Array(o),i=new Blob([t],{type:"application/pdf;base64"}),r=URL.createObjectURL(i);window.open(r)}).fail(function(){alert("Nie udało się pobrać protokołu.")})},window.openPaymentForOrder=function(e){window.open(e,"_blank").focus()},window.addExistingOrder=function(e,a){var o=t(e).parent().find("input").val();t.post(epaka_admin_object.api_endpoint+"/link-epaka-order-to-woo-order?token="+epaka_admin_object.admin_token,{woo_order_id:a,epaka_order_id:o},function(e){window.location.reload()}).fail(function(){alert("Nie udało się podpiąć zamówienia.")})},window.showInputForAddExisting=function(e){t(e).parent().find(".epaka-add-existing-order").is(":visible")?(t(e).parent().find(".epaka-add-existing-order").hide(),t(e).text("Dodaj istniejące zamówienie")):(t(e).parent().find(".epaka-add-existing-order").show(),t(e).text("Ukryj"))},window.getEpakaOrderAuthorizationDocument=function(e){t.post(epaka_admin_object.api_endpoint+"/get-epaka-order-authorization-document?token="+epaka_admin_object.admin_token,{orderId:e},function(e){for(var a=atob(e),o=new Array(a.length),n=0;n<a.length;n++)o[n]=a.charCodeAt(n);var t=new Uint8Array(o),i=new Blob([t],{type:"application/pdf;base64"}),r=URL.createObjectURL(i);window.open(r)}).fail(function(){alert("Nie udało się pobrać upoważnienia.")})},t(window).load(function(){t(".epaka-add-existing-order").find("input").click(function(e){return e.preventDefault(),!1}),t("#logout").click(function(){window.location.href=window.location.origin+window.location.pathname+"?page=epaka_admin_panel_logout"}),t("#saveMethods").click(function(){var a=t(this);t(a).prop("disabled",!0);var e=t("#panel-form-methods").serializeArray();t.post(epaka_admin_object.api_endpoint+"/set-shipping-courier-mapping?token="+epaka_admin_object.admin_token,e,function(e){t(a).prop("disabled",!1),"OK"!=e.status?window.addAlert(e.message,"danger"):window.addAlert("Zapisano mapowanie","success")}).fail(function(){t(a).prop("disabled",!1),window.addAlert("Wystąpił błąd przy połączeniu z API.","danger")})}),t(".method-courier-map-value").each(function(){var a=t(this).find("option:selected"),e=o.filter(function(e){return e.courierId==t(a).val()});Array.isArray(e)&&0<e.length&&"1"==e[0].courierPointDelivery&&(t(this).parent().find("[type=checkbox]").attr("checked",!0),t(this).parent().find(".map_source_id").val(e[0].courierMapSourceId),t(this).parent().find(".map_source_url").val(e[0].courierMapSourceUrl),t(this).parent().find(".map_source_name").val(e[0].courierMapSourceName))}),t(".method-courier-map-value").change(function(a){var e=o.filter(function(e){return e.courierId==t(a.target).val()});Array.isArray(e)&&0!=e.length&&"1"==e[0].courierPointDelivery?(t(a.target).parent().find("input[type=checkbox]").attr("checked",!0),t(a.target).parent().find(".map_source_id").val(e[0].courierMapSourceId),t(a.target).parent().find(".map_source_url").val(e[0].courierMapSourceUrl),t(a.target).parent().find(".map_source_name").val(e[0].courierMapSourceName)):(t(a.target).parent().find("input[type=checkbox]").attr("checked",!1),t(a.target).parent().find(".map_source_id").val(""),t(a.target).parent().find(".map_source_url").val(""),t(a.target).parent().find(".map_source_name").val(""))}),t("#saveProfile").click(function(){var a=t(this);t(a).prop("disabled",!0);var o=[];t(".profile-forms form").each(function(e,a){o.push(t(a).serializeArray())});var n=[];o.forEach(function(e,a){n=n.concat(e)}),t.post(epaka_admin_object.api_endpoint+"/save-profile?token="+epaka_admin_object.admin_token,n,function(e){t(a).prop("disabled",!1),"OK"!=e.status?window.addAlert(e.message,"danger"):window.addAlert("Zapisano profil","success")}).fail(function(){t(a).prop("disabled",!1),window.addAlert("Wystąpił błąd przy połączeniu z API.","danger")})}),t(".epakainvoicecheckbox").change(function(){switch(t(this).attr("id")){case"UzytkownikBezFakturyCheckbox":t("#UzytkownikFakturaPoPlatnosciCheckbox").prop("checked",!1),t("#UzytkownikFakturaZbiorczaCheckbox").prop("checked",!1);break;case"UzytkownikFakturaPoPlatnosciCheckbox":t("#UzytkownikBezFakturyCheckbox").prop("checked",!1),t("#UzytkownikFakturaZbiorczaCheckbox").prop("checked",!1);break;case"UzytkownikFakturaZbiorczaCheckbox":t("#UzytkownikFakturaPoPlatnosciCheckbox").prop("checked",!1),t("#UzytkownikBezFakturyCheckbox").prop("checked",!1)}0==t(this).prop("checked")&&0==t("#UzytkownikFakturaPoPlatnosciCheckbox").prop("checked")&&0==t("#UzytkownikBezFakturyCheckbox").prop("checked")&&0==t("#UzytkownikFakturaZbiorczaCheckbox").prop("checked")&&t(this).prop("checked",!0)})})}(jQuery);
!function(e){"use strict";var a=e(".aop-upload-image__button"),i=e(".aop-media-wrapper"),t=e(".aop-media-attachment"),d=e(".aop-image-preview-wrapper"),n=e(".aop-delete-image");a.on("click",(function(a){a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation();var i=e(this).closest(".aop-media-wrapper"),t=i.find(".aop-media-attachment"),d=i.find(".aop-image-preview-wrapper"),n=i.find(".aop-delete-image"),o=this.getAttribute("extention"),s=wp.media.frames.file_frame=wp.media({title:"Select or upload image",button:{text:"Use this image"},library:{type:o},multiple:!1}),r=wp.media.frame.toolbar.selector;d.hasClass("hidden")&&setTimeout((function(){e(r+" .media-button-select").prop("disabled",!0)})),s.on("select",(function(){var a=s.state().get("selection").first().toJSON();if(!(0>e.trim(a.url.length))){if(!o.includes(a.mime))return d.addClass("hidden"),n.addClass("hidden"),void t.val("0");var i;i=a.sizes.thumbnail?a.sizes.thumbnail.url:a.url,d.removeClass("hidden").children().css({"background-image":"url("+i+")"}),n.removeClass("hidden"),t.val(a.id),e(".warning-message").addClass("hidden"),e(".notice.is-dismissible").addClass("hidden")}})),s.on("open",(function(){var e=s.state().get("selection"),a=t.val();a&&e.add(wp.media.attachment(a))})),s.open()})),i.each((function(){t=e(this).find(".aop-media-attachment"),d=e(this).find(".aop-image-preview-wrapper"),n=e(this).find(".aop-delete-image"),"0"!==t.val()&&(d.removeClass("hidden"),n.removeClass("hidden")),"0"===t.val()&&e(".notice-error").removeClass("hidden"),n.on("click",(function(a){a.stopPropagation(),a.stopImmediatePropagation(),a.preventDefault();var i=e(this).closest(".aop-media-wrapper"),t=i.find(".aop-media-attachment"),d=i.find(".aop-image-preview-wrapper"),n=i.find(".aop-delete-image");t.val("0"),d.addClass("hidden"),n.addClass("hidden")}))}))}(jQuery);
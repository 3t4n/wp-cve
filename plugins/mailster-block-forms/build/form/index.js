!function(){var e,t={592:function(e,t,n){"use strict";var r=window.wp.blocks;function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i.apply(this,arguments)}var s=window.wp.element,l=(n(184),window.wp.i18n),o=window.wp.blockEditor,a=window.wp.serverSideRender,c=n.n(a),m=window.wp.components,u=window.wp.data,p=(window.wp.compose,window.wp.primitives),d=(0,s.createElement)(p.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,s.createElement)(p.Path,{d:"m19 7-3-3-8.5 8.5-1 4 4-1L19 7Zm-7 11.5H5V20h7v-1.5Z"})),h=(0,s.createElement)(p.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,s.createElement)(p.Path,{d:"m11.3 17.2-5-5c-.1-.1-.1-.3 0-.4l2.3-2.3-1.1-1-2.3 2.3c-.7.7-.7 1.8 0 2.5l5 5H7.5v1.5h5.3v-5.2h-1.5v2.6zm7.5-6.4-5-5h2.7V4.2h-5.2v5.2h1.5V6.8l5 5c.1.1.1.3 0 .4l-2.3 2.3 1.1 1.1 2.3-2.3c.6-.7.6-1.9-.1-2.5z"})),f=(0,s.createElement)(p.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,s.createElement)(p.Path,{d:"M18 11.2h-5.2V6h-1.6v5.2H6v1.6h5.2V18h1.6v-5.2H18z"}));const b=[{id:"submission",name:(0,l.__)("Signup Form","mailster"),title_DEL:"/",label:(0,l.__)("This is the homepage","mailster"),help:(0,l.__)("This section is displayed if users visit the newsletter homepage.","mailster")},{id:"profile",name:(0,l.__)("Profile","mailster"),title_DEL:"/profile",label:(0,l.__)("This is the profile page","mailster"),help:(0,l.__)("This section is displayed if users visits the profile page. People can update their subscription on this page.","mailster")},{id:"unsubscribe",name:(0,l.__)("Unsubscribe","mailster"),title_DEL:"/unsubscribe",label:(0,l.__)("This is the unsubscribe page","mailster"),help:(0,l.__)("This section is displayed on the unsubscribe page. If the user clicks an unsubscribe link in a newsletter, he will be redirected to this page.","mailster")},{id:"subscribe",name:(0,l.__)("Subscribe","mailster"),title_DEL:"/subscribe",label:(0,l.__)("This is the Landing page","mailster"),help:(0,l.__)("Use this section to define the content when people click on the link in the confirmation email.","mailster")}];function g(e){let{id:t,align:n}=e;const r=new URL("https://kb.mailster.co/"+t);r.searchParams.set("utm_campaign","plugin"),r.searchParams.set("utm_medium","link"),r.searchParams.set("utm_source","Mailster Plugin"),r.searchParams.set("utm_term","workflow");var i={};return n&&(i.float=n),(0,s.createElement)("a",{className:"mailster-help",href:r.toString(),"data-article":t,style:i})}function w(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=(0,u.select)("core/block-editor").getBlocks(t);var i=r.find((t=>new RegExp(e,"g").test(t.name)));if(i)return i.rootClientId=t,i;if(n)for(var s=0;s<r.length;s++)if(i=w(e,r[s].clientId))return i;return!1}function y(e){const{current:t,onSelect:n}=e,r=w("mailster/homepage"),i=(0,u.useSelect)((e=>e("core/block-editor").getBlockAttributes(r.clientId))),a=(0,u.useSelect)((e=>e("core/editor").getPermalink()));return(0,s.createElement)(o.InspectorControls,null,(0,s.createElement)(m.Panel,null,(0,s.createElement)(m.PanelBody,{initialOpen:!0},(0,s.createElement)(m.PanelRow,null,(0,s.createElement)(m.BaseControl,{label:(0,l.__)("Newsletter Homepage Sections","mailster")},(0,s.createElement)(g,{id:"6453abdab9f4b70821b98a1b",align:"right"}),(0,s.createElement)("div",{className:"components-dropdown-menu__menu context-buttons"},(0,s.createElement)((e=>{let{onClose:r=(()=>{})}=e;return b.map(((e,o)=>{const c="submission"==e.id?a:(0,l.sprintf)("%s%s",a,mailster_homepage_slugs[e.id]||e.id),u=i[e.id]||"subscribe"==e.id;return(0,s.createElement)(m.MenuGroup,{key:o,isSelected:e.id===t},(0,s.createElement)(m.MenuItem,{info:u?c:(0,l.__)("Not defined yet!","mailster"),isDestructive:!u,isPressed:e.id===t,onClick:()=>{n(e.id,o),r()}},e.name,(0,s.createElement)(m.ExternalLink,{href:c})))}))}),null))))),(0,s.createElement)(m.PanelBody,{initialOpen:!0},(0,s.createElement)(m.PanelRow,null,(0,s.createElement)(m.Tip,null,b[t]?b[t].help:(0,l.__)("You have to define a form for each section. You can use the same form as well.","mailster")))),("profile"==t||"unsubscribe"==t)&&(0,s.createElement)(m.PanelBody,{initialOpen:!0},(0,s.createElement)(m.PanelRow,null,(0,s.createElement)(m.ExternalLink,{href:"edit.php?post_type=newsletter&page=mailster_settings#texts"},(0,l.__)("Change the text of the button on the Texts tab in the settings.","mailster"))))))}window.wp.apiFetch,window.lodash,window.wp.date;var E=window.wp.coreData;const _=(0,s.createElement)("form",{className:"mailster-block-form"},(0,s.createElement)("label",{className:"mailster-label"},"This is my Label"),(0,s.createElement)("select",{className:"input"},(0,s.createElement)("option",null,"This is a select")),(0,s.createElement)("input",{type:"checkbox"}),(0,s.createElement)("input",{type:"radio"}),(0,s.createElement)("input",{type:"text",className:"input"}),(0,s.createElement)("input",{type:"email",className:"input"}),(0,s.createElement)("input",{type:"date",className:"input"}),(0,s.createElement)("input",{type:"submit",className:"wp-block-button__link"}),(0,s.createElement)("textarea",{defaultValue:"Sample Content"})),v=e=>{let[...t]=e;return t.slice(1)};function k(){const e=(0,u.useSelect)((e=>e("core").canUser("update","settings"))),[t,n]=(0,E.useEntityProp)("root","site","mailster_inline_styles"),[r,i]=(0,s.useState)(!0),o=(0,s.useRef)(),a=(0,u.useSelect)((e=>e("core").getEntityRecords("postType","post",{per_page:1}))),[c]=(0,E.useEntityProp)("root","site","url");if(!e||!a||!c)return null;const m=a.length>0?a[0].link:c;return r?(0,s.createElement)("div",{className:"mailster-editor-inlinestyles",style:{position:"absolute",left:0},hidden:!0},(0,s.createElement)("iframe",{ref:o,src:m,style:{pointerEvents:"none",width:screen.width,zIndex:-1,position:"absolute",visibility:"hidden"},onLoad:()=>{if(!o.current)return;const e=(e=>{const t=e.getElementsByClassName("entry-content")[0]||e.getElementById("page")||e.getElementById("site-content")||e.getElementById("content")||e.getElementsByClassName("wp-site-blocks")[0]||e.getElementsByTagName("body")[0];return!t.classList.contains("mailster-inline-styles")&&((0,s.createRoot)(t).render(_),t.classList.add("mailster-inline-styles"),t)})(o.current.contentWindow.document);e&&setTimeout((()=>{const r=(e=>{const t=["padding","border","font","border-radius","background","box-shadow","line-height","appearance","outline","text-transform","letter-spacing"],n={'input[type="text"]':["height"],'input[type="email"]':["height"],'input[type="date"]':["height"],'input[type="checkbox"]':["width","height"],'input[type="radio"]':["width","height"],'input[type="submit"]':["border","outline","color"],select:["height"],label:[],textarea:[]};return Object.keys(n).map(((r,i)=>{const s=function(){const e=[...arguments],[t]=e;let n="";if(!t)return n;const r=[...e][1]instanceof Array?e[1]:v(e),i=window.getComputedStyle(t);return r.reduce(((e,t)=>{const r=i.getPropertyValue(t);r&&(n+=t+":"+r+";")}),{}),n}(e.querySelector(r),[...t,...n[r]]);return".mailster-block-form "+r+"{"+s+"}"})).join("")})(e);r!=t&&(n(r),(0,u.dispatch)("core").saveEditedEntityRecord("root","site"),!t&&(0,u.dispatch)("core/notices").createNotice("success",(0,l.__)("Mailster Inline styles have been updated.","mailster"),{id:"mailster-inline-styles-updated",type:"snackbar",isDismissible:!0})),i(!1)}),1)},loading:"eager"})):null}function x(e){const{attributes:t,setAttributes:n,isSelected:r,selectForm:i,formId:o}=e,a=(0,u.useSelect)((e=>e("core").getEntityRecords("postType","mailster-form")));return(0,u.useSelect)((e=>e("core/data").isResolving("core","getEntityRecords",["postType","mailster-form"])))?(0,s.createElement)("p",null,(0,s.createElement)(m.Spinner,null)):a&&0===a.length?(0,s.createElement)("p",null,(0,l.__)("You currently have no forms. Please create a new form.","mailster")):a&&(0,s.createElement)(m.SelectControl,{value:o,onChange:e=>i(parseInt(e,10))},(0,s.createElement)("option",{value:""},(0,l.__)("Choose an existing form","mailster")),a.map((e=>(0,s.createElement)("option",{key:e.id,value:e.id},e.title.rendered))))}var S=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"mailster/form","version":"0.4.0","title":"Mailster Form","category":"widgets","keywords":["form","newsletter","mailster","subscribe","signup","optin","opt-in","opt in","email","mail"],"icon":"email","description":"Use a Mailster Block Form on your page","supports":{"html":false,"anchor":true,"align":true,"spacing":{"margin":true,"padding":true}},"attributes":{"id":{"type":"integer"},"type":{"type":"string","enum":["submission","profile","unsubscribe"]}},"usesContext":["mailster-homepage-context/type","mailster-homepage-context/align","mailster-homepage-context/submission","mailster-homepage-context/profile","mailster-homepage-context/unsubscribe"],"textdomain":"mailster","editorScript":"file:./index.js","editorStyle":"file:./index.css","style":"file:./style-index.css","viewScript":"file:./view.js"}');const{name:P,...B}=S;(0,r.registerBlockType)(P,{...B,edit:function(e){const{attributes:t,isSelected:n,setAttributes:r,context:a,clientId:p}=e,{id:g=!1}=t,[E,_]=(0,s.useState)(a["mailster-homepage-context/type"]),v=a["mailster-homepage-context/align"],S=a["mailster-homepage-context/"+E]||g,[P,B]=(0,s.useState)(!1),[C,N]=(0,s.useState)(void 0),O=(0,s.useRef)();(0,s.useEffect)((()=>{r({align:v})}),[v]);const T=e=>{if(E){const t=w("mailster/homepage");(0,u.dispatch)("core/block-editor").updateBlockAttributes(t.clientId,{[E]:e})}else r({id:e})};(0,s.useEffect)((()=>{if(!O.current)return;const e=new MutationObserver((e=>{e.forEach((e=>{const t=e.addedNodes.length>0?e.addedNodes[0]:null;t&&C!=t.offsetHeight&&t.classList.contains("mailster-block-form-editor-wrap-inner")&&t.offsetHeight&&N(t.offsetHeight)}))}));return e.observe(O.current,{childList:!0}),()=>e.disconnect()}),[O.current]),(0,s.useEffect)((()=>{B(!!g)}),[g]);const R=e=>{let{children:t}=e;return(0,s.createElement)("div",{style:{minHeight:C?C+"px":void 0,zIndex:10}},(!t||!P)&&(0,s.createElement)(m.Flex,{justify:"center"},(0,s.createElement)(m.Spinner,null)),P&&t)},I=()=>{B(!1),(0,u.dispatch)("core").receiveEntityRecords("postType","mailster-form",[],{},!0),setTimeout((()=>{B(!0)}),1)},j=()=>{window.open("post.php?post="+S+"&action=edit","edit_form_"+S)},F=b.find((e=>e.id===E)),L=(0,o.useBlockProps)({style:{minHeight:C?C+"px":void 0}}),H={...t,type:E,id:S};return(0,s.createElement)(s.Fragment,null,(0,s.createElement)("div",L,S?(0,s.createElement)("div",{className:"mailster-block-form-editor-wrap",ref:O},(0,s.createElement)(m.Flex,{className:"update-form-button",justify:"center"},(0,s.createElement)(m.Button,{variant:"primary",icon:d,onClick:j,text:(0,l.__)("Edit form","mailster")}),(0,s.createElement)(m.Button,{variant:"secondary",icon:h,onClick:I,text:(0,l.__)("Reload Form","mailster")})),(0,s.createElement)(c(),{className:"mailster-block-form-editor-wrap-inner",block:"mailster/form",attributes:H,EmptyResponsePlaceholder:R,XLoadingResponsePlaceholder:R})):(0,s.createElement)(m.Placeholder,{icon:m.email,label:E?(0,l.sprintf)((0,l.__)("Newsletter Homepage: %s","mailster"),F.name):(0,l.__)("Mailster Subscription Form","mailster"),instructions:E?F.help:(0,l.__)("Select a form you like to display on this page.","mailster")},(0,s.createElement)(x,i({},e,{selectForm:T,formId:S})),(0,s.createElement)("div",{className:"placeholder-buttons-wrap"},(0,s.createElement)(m.Button,{variant:"secondary",icon:f,href:"post-new.php?post_type=mailster-form",target:"edit_form_new",text:(0,l.__)("Create new form","mailster")}),(0,s.createElement)(m.Button,{variant:"tertiary",icon:h,onClick:I,text:(0,l.__)("Reload Forms","mailster")})))),(0,s.createElement)(o.BlockControls,null,(0,s.createElement)(m.ToolbarGroup,null,(0,s.createElement)(m.ToolbarButton,{label:(0,l.__)("Edit Form","mailster"),icon:d,disabled:!S,onClick:j}),(0,s.createElement)(m.ToolbarButton,{label:(0,l.__)("Reload Form","mailster"),icon:h,onClick:I}))),E&&(0,s.createElement)(y,{current:E,onSelect:(e,t)=>{location.hash="#mailster-"+e,_(e)}}),"subscribe"!==E&&(0,s.createElement)(o.InspectorControls,null,(0,s.createElement)(m.Panel,null,(0,s.createElement)(m.PanelBody,{title:(0,l.__)("Form Selector","mailster"),initialOpen:!0},(0,s.createElement)(x,i({},e,{selectForm:T,formId:S}))))),(0,s.createElement)(k,null))},save:()=>null})},184:function(e,t){var n;!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var s=typeof n;if("string"===s||"number"===s)e.push(n);else if(Array.isArray(n)){if(n.length){var l=i.apply(null,n);l&&e.push(l)}}else if("object"===s){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var o in n)r.call(n,o)&&n[o]&&e.push(o)}}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var s=n[e]={exports:{}};return t[e](s,s.exports,r),s.exports}r.m=t,e=[],r.O=function(t,n,i,s){if(!n){var l=1/0;for(m=0;m<e.length;m++){n=e[m][0],i=e[m][1],s=e[m][2];for(var o=!0,a=0;a<n.length;a++)(!1&s||l>=s)&&Object.keys(r.O).every((function(e){return r.O[e](n[a])}))?n.splice(a--,1):(o=!1,s<l&&(l=s));if(o){e.splice(m--,1);var c=i();void 0!==c&&(t=c)}}return t}s=s||0;for(var m=e.length;m>0&&e[m-1][2]>s;m--)e[m]=e[m-1];e[m]=[n,i,s]},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={283:0,828:0};r.O.j=function(t){return 0===e[t]};var t=function(t,n){var i,s,l=n[0],o=n[1],a=n[2],c=0;if(l.some((function(t){return 0!==e[t]}))){for(i in o)r.o(o,i)&&(r.m[i]=o[i]);if(a)var m=a(r)}for(t&&t(n);c<l.length;c++)s=l[c],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return r.O(m)},n=self.webpackChunkmailster_block_forms=self.webpackChunkmailster_block_forms||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var i=r.O(void 0,[828],(function(){return r(592)}));i=r.O(i)}();
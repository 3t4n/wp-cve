jQuery(document).ready(function(t){function e(t,e,i){if(0===i)document.cookie=t+"="+e+";path=/;";else{var o=new Date;o.setTime(o.getTime()+24*i*60*60*1e3),document.cookie=t+"="+e+";path=/;expires="+o.toUTCString()}}t(document).on("submit",".fca_eoi_form",function(i){i.preventDefault();var o,a=t(this),n=t("[name=email]",a),r=t("[name=name]",a),c=r.val(),_=n.val(),l=a.data("fca_eoi_list_id"),s=t("[type=submit]",a),d=a.data("fca_eoi_thank_you_mode"),p=a.data("fca_eoi_thank_you_text_color"),f=a.data("fca_eoi_thank_you_bg_color"),u=a.data("fca_eoi_thank_you_page"),h=a.data("fca_eoi_success_cookie_duration"),m=a.data("fca_eoi_sub_msg"),v=!1,y=t("[name=fca_eoi_form_id]",a).val();if(a.find(".tooltipstered").tooltipster("hide"),t("[name=email], [name=name]",a).not(".tooltipstered").each(function(){var e=t(this),i=.8*e.width();e.tooltipster({contentAsHTML:!0,fixedWidth:i,minWidth:i,maxWidth:i,trigger:"none",theme:["tooltipster-borderless","tooltipster-optin-cat"]})}),t("[name=email], [name=name]",t(this)).focus(function(){var e=t(this),i=t("[type=submit]",e.closest(".fca_eoi_form")),o=i.data("fca_eoi_initial_val");void 0!==o&&i.val(o),t(this).tooltipster("hide")}),s.data("fca_eoi_initial_val")?o=s.data("fca_eoi_initial_val"):(o=s.val(),s.data("fca_eoi_initial_val",o)),s.val(o),fcaEoiScriptData.invalid_email=a.find(".fca_eoi_error_texts_email").val(),fcaEoiScriptData.field_required=a.find(".fca_eoi_error_texts_required").val(),_&&function(t){return/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(t)}(_)||(n.tooltipster("content",_?fcaEoiScriptData.invalid_email:fcaEoiScriptData.field_required),n.tooltipster("show"),s.val("✗ "+o),v=!0),r.is(":visible")&&!c&&(r.tooltipster("content",fcaEoiScriptData.field_required),r.tooltipster("show"),s.val("✗ "+o),v=!0),t("[name=i_agree]",a).prop("checked"))return!1;if(v)return!1;var b="unknown";if(fcaEoiScriptData.gdpr_checkbox){if(0===a.find(".fca_eoi_gdpr_consent").length)return a.find(".fca_eoi_layout_field_wrapper").hide(),a.find(".fca_eoi_layout_email_field_inner").hide(),a.find(".fca_eoi_layout_name_field_inner").hide(),a.closest(".fca_eoi_form_wrapper ").hasClass("fca_eoi_layout_banner_wrapper")?(a.find(".fca_eoi_layout_headline_copy_wrapper")[0].style.setProperty("display","block","important"),a.find(".fca_eoi_layout_headline_copy_wrapper").html('<div style="font-size: 14px;">'+fcaEoiScriptData.consent_headline+'<br><label><input class="fca_eoi_gdpr_consent" value="" type="checkbox"></input>'+fcaEoiScriptData.consent_msg+"</label></div>")):(a.find(".fca_eoi_layout_description_copy_wrapper")[0].style.setProperty("display","block","important"),a.find(".fca_eoi_layout_description_copy_wrapper").html('<div style="text-align:left;">'+fcaEoiScriptData.consent_headline+'<br><br><label><input class="fca_eoi_gdpr_consent" value="" type="checkbox"></input>'+fcaEoiScriptData.consent_msg+"</label></div>")),!1;if(0==(b=a.find(".fca_eoi_gdpr_consent").prop("checked")))return a.find(".fca_eoi_gdpr_consent").not(".tooltipstered").tooltipster({contentAsHTML:!0,trigger:"none",theme:["tooltipster-borderless","tooltipster-optin-cat"]}).tooltipster("content",fcaEoiScriptData.field_required).tooltipster("show"),!1}s.val(m),s.prop("disabled",!0);var g=jstz.determine();t.ajax({type:"POST",url:fcaEoiScriptData.ajax_url,data:{email:_,name:c,action:"fca_eoi_subscribe",list_id:l,form_id:y,nonce:fcaEoiScriptData.nonce,timezone:g.name(),consent_granted:b}}).done(function(i){if("✓"===i){s.val(i+" "+o),e("fca_eoi_success_"+y,Math.floor(Date.now()/1e3),h);var c=JSON.parse(function(t){var e=("; "+document.cookie).split("; "+t+"=");return 2===e.length&&e.pop().split(";").shift()}("fca_eoi_active_optins"));Array.isArray(c)||(c=[]);var _=c.indexOf(y);-1!==_&&c.splice(_,1),e("fca_eoi_active_optins",JSON.stringify(c))}else"✗ Failed to add user - denied"===i?(s.prop("disabled",!1),s.val(o),a.find(".fca_eoi_gdpr_consent").tooltipster("show")):(s.prop("disabled",!1),s.val(i));"ajax"===d&&"✓"===i?(clearInterval(!1),u&&"✓"===i&&(tooltipWidth=s.width(),s.tooltipster({contentAsHTML:!0,trigger:"none",fixedWidth:tooltipWidth,minWidth:tooltipWidth,maxWidth:tooltipWidth,arrow:!1,theme:["tooltipster-borderless","tooltipster-optin-cat"]}),s.tooltipster("content",u),s.tooltipster("show"),n.prop("disabled",!0),r.prop("disabled",!0),t(".tooltipster-content").css("color",p),t(".tooltipster-content").css("background-color",f))):"✓"===i&&(window.location.href=u)})})});
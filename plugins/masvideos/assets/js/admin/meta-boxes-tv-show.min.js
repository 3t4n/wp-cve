jQuery(function(i){function e(e){var t=i(e).next().is(".hasDatepicker")?"minDate":"maxDate",s="minDate"==t?i(e).next():i(e).prev(),o=i(e).datepicker("getDate");i(s).datepicker("option",t,o),i(e).change()}var t;function _(){i(".tv_show_cast_persons .masvideos_cast_person").each(function(e,t){i(".person_position",t).val(parseInt(i(t).index(".tv_show_cast_persons .masvideos_cast_person"),10))})}function r(){i(".tv_show_crew_persons .masvideos_crew_person").each(function(e,t){i(".person_position",t).val(parseInt(i(t).index(".tv_show_crew_persons .masvideos_crew_person"),10))})}i(function(){i('[id$="-all"] > ul.categorychecklist').each(function(){var e=i(this),t=e.find(":checked").first();if(t.length){var s=e.find("input").position().top,o=t.position().top;e.closest(".tabs-panel").scrollTop(o-s+5)}})}),i("#upsell_tv_show_data").bind("keypress",function(e){if(13===e.keyCode)return!1}),i(".type_box").appendTo("#masvideos-tv-show-data .handle span"),i(".tv_show_date_picker").each(function(){i(this).find("input").datepicker({defaultDate:"",dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:!0,onSelect:function(){e(i(this))}}),i(this).find("input").each(function(){e(i(this))})}),(t=i(".tv_show_cast_persons").find(".masvideos_cast_person").get()).sort(function(e,t){var s=parseInt(i(e).attr("rel"),10),o=parseInt(i(t).attr("rel"),10);return s<o?-1:o<s?1:0}),i(t).each(function(e,t){i(".tv_show_cast_persons").append(t)}),i(".tv_show_cast_persons .masvideos_cast_person").each(function(e,t){if("none"!==i(t).css("display")){var s=i("#tv_show_cast_persons select.person_id").data("exclude")||[];s.push(i(t).data("person_id")),i("#tv_show_cast_persons select.person_id").data("exclude",s)}}),i("button.add_person_tv_show_cast").on("click",function(){var e=i(".tv_show_cast_persons .masvideos_cast_person").length,t=i("#tv_show_cast_persons select.person_id").val(),s=i(this).closest("#tv_show_cast_persons"),o=s.find(".tv_show_cast_persons"),a={action:"masvideos_add_person_tv_show_cast",person_id:t,i:e,security:masvideos_admin_meta_boxes.add_person_tv_show_nonce};if(s.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),i.post(masvideos_admin_meta_boxes.ajax_url,a,function(e){o.append(e),i(document.body).trigger("masvideos-enhanced-select-init"),_(),s.unblock(),i(document.body).trigger("masvideos_added_person_tv_show_cast")}),t){var n=i("#tv_show_cast_persons select.person_id").data("exclude")||[];n.push(t),i("#tv_show_cast_persons select.person_id").data("exclude",n),i("#tv_show_cast_persons select.person_id").val("").trigger("change")}return!1}),i(".tv_show_cast_persons").on("blur","input.person_id",function(){i(this).closest(".masvideos_cast_person").find("strong.person_id").text(i(this).val())}),i(".tv_show_cast_persons").on("click",".remove_row",function(){if(window.confirm(masvideos_admin_meta_boxes.remove_person)){var e=i(this).parent().parent();e.find("select, input[type=text], input[type=hidden]").val(""),e.hide();var t=i("#tv_show_cast_persons select.person_id").data("exclude")||[];t.splice(i.inArray(e.data("person_id"),t),1),i("#tv_show_cast_persons select.person_id").data("exclude",t),_()}return!1}),i(".tv_show_cast_persons").sortable({items:".masvideos_cast_person",cursor:"move",axis:"y",handle:"h3",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"masvideos-metabox-sortable-placeholder",start:function(e,t){t.item.css("background-color","#f6f6f6")},stop:function(e,t){t.item.removeAttr("style"),_()}}),i(".save_persons_tv_show_cast").on("click",function(){i("#masvideos-tv-show-data").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var e={post_id:masvideos_admin_meta_boxes.post_id,data:i(".tv_show_cast_persons").find("input, select, textarea").serialize(),action:"masvideos_save_persons_tv_show_cast",security:masvideos_admin_meta_boxes.save_persons_tv_show_nonce};i.post(masvideos_admin_meta_boxes.ajax_url,e,function(){var e=window.location.toString();e=e.replace("post-new.php?","post.php?post="+masvideos_admin_meta_boxes.post_id+"&action=edit&"),i("#masvideos-tv-show-data").unblock()})}),(t=i(".tv_show_crew_persons").find(".masvideos_crew_person").get()).sort(function(e,t){var s=parseInt(i(e).attr("rel"),10),o=parseInt(i(t).attr("rel"),10);return s<o?-1:o<s?1:0}),i(t).each(function(e,t){i(".tv_show_crew_persons").append(t)}),i(".tv_show_crew_persons .masvideos_crew_person").each(function(e,t){if("none"!==i(t).css("display")){var s=i("#tv_show_crew_persons select.person_id").data("exclude")||[];i("#tv_show_crew_persons select.person_id").data("exclude",s)}}),i("button.add_person_tv_show_crew").on("click",function(){var e=i(".tv_show_crew_persons .masvideos_crew_person").length,t=i("#tv_show_crew_persons select.person_id").val(),s=i(this).closest("#tv_show_crew_persons"),o=s.find(".tv_show_crew_persons"),a={action:"masvideos_add_person_tv_show_crew",person_id:t,i:e,security:masvideos_admin_meta_boxes.add_person_tv_show_nonce};if(s.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),i.post(masvideos_admin_meta_boxes.ajax_url,a,function(e){o.append(e),i(document.body).trigger("masvideos-enhanced-select-init"),r(),s.unblock(),i(document.body).trigger("masvideos_added_person_tv_show_crew")}),t){var n=i("#tv_show_crew_persons select.person_id").data("exclude")||[];i("#tv_show_crew_persons select.person_id").data("exclude",n),i("#tv_show_crew_persons select.person_id").val("").trigger("change")}return!1}),i(".tv_show_crew_persons").on("blur","input.person_id",function(){i(this).closest(".masvideos_crew_person").find("strong.person_id").text(i(this).val())}),i(".tv_show_crew_persons").on("click",".remove_row",function(){if(window.confirm(masvideos_admin_meta_boxes.remove_person)){var e=i(this).parent().parent();e.find("select, input[type=text], input[type=hidden]").val(""),e.hide();var t=i("#tv_show_crew_persons select.person_id").data("exclude")||[];i("#tv_show_crew_persons select.person_id").data("exclude",t),r()}return!1}),i(".tv_show_crew_persons").sortable({items:".masvideos_crew_person",cursor:"move",axis:"y",handle:"h3",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"masvideos-metabox-sortable-placeholder",start:function(e,t){t.item.css("background-color","#f6f6f6")},stop:function(e,t){t.item.removeAttr("style"),r()}}),i(".save_persons_tv_show_crew").on("click",function(){i("#masvideos-tv-show-data").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var e={post_id:masvideos_admin_meta_boxes.post_id,data:i(".tv_show_crew_persons").find("input, select, textarea").serialize(),action:"masvideos_save_persons_tv_show_crew",security:masvideos_admin_meta_boxes.save_persons_tv_show_nonce};i.post(masvideos_admin_meta_boxes.ajax_url,e,function(){var e=window.location.toString();e=e.replace("post-new.php?","post.php?post="+masvideos_admin_meta_boxes.post_id+"&action=edit&"),i("#masvideos-tv-show-data").unblock()})});var s=i(".tv_show_seasons").find(".masvideos_season").get();function a(){i(".tv_show_seasons .masvideos_season").each(function(e,t){i(".season_position",t).val(parseInt(i(t).index(".tv_show_seasons .masvideos_season"),10))})}s.sort(function(e,t){var s=parseInt(i(e).attr("rel"),10),o=parseInt(i(t).attr("rel"),10);return s<o?-1:o<s?1:0}),i(s).each(function(e,t){i(".tv_show_seasons").append(t)}),i("button.add_tv_show_season").on("click",function(){var e=i(".tv_show_seasons .masvideos_season").length,t=i(this).closest("#tv_show_seasons"),s=t.find(".tv_show_seasons"),o={action:"masvideos_add_season_tv_show",i:e,security:masvideos_admin_meta_boxes.add_season_tv_show_nonce};return t.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),i.post(masvideos_admin_meta_boxes.ajax_url,o,function(e){s.append(e),i(document.body).trigger("masvideos-enhanced-select-init"),a(),t.unblock(),i(document.body).trigger("masvideos_added_season_tv_show")}),!1}),i(".tv_show_seasons").on("blur","input.season_name",function(){i(this).closest(".masvideos_season").find("strong.season_name").text(i(this).val())}),i(".tv_show_seasons").on("click",".remove_row",function(){if(window.confirm(masvideos_admin_meta_boxes.remove_season)){var e=i(this).parent().parent();e.find("select, input[type=text]").val(""),e.hide(),a()}return!1}),i(".tv_show_seasons").sortable({items:".masvideos_season",cursor:"move",axis:"y",handle:"h3",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"masvideos-metabox-sortable-placeholder",start:function(e,t){t.item.css("background-color","#f6f6f6")},stop:function(e,t){t.item.removeAttr("style"),a()}}),i(".save_seasons_tv_show").on("click",function(){i("#masvideos-tv-show-data").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var e={post_id:masvideos_admin_meta_boxes.post_id,data:i(".tv_show_seasons").find("input, select, textarea").serialize(),action:"masvideos_save_seasons_tv_show",security:masvideos_admin_meta_boxes.save_seasons_tv_show_nonce};i.post(masvideos_admin_meta_boxes.ajax_url,e,function(){var e=window.location.toString();e=e.replace("post-new.php?","post.php?post="+masvideos_admin_meta_boxes.post_id+"&action=edit&"),i("#masvideos-tv-show-data").unblock()})});var n,o=i(".tv_show_attributes").find(".masvideos_attribute").get();function c(){i(".tv_show_attributes .masvideos_attribute").each(function(e,t){i(".attribute_position",t).val(parseInt(i(t).index(".tv_show_attributes .masvideos_attribute"),10))})}o.sort(function(e,t){var s=parseInt(i(e).attr("rel"),10),o=parseInt(i(t).attr("rel"),10);return s<o?-1:o<s?1:0}),i(o).each(function(e,t){i(".tv_show_attributes").append(t)}),i(".tv_show_attributes .masvideos_attribute").each(function(e,t){"none"!==i(t).css("display")&&i(t).is(".taxonomy")&&i("select.attribute_taxonomy").find('option[value="'+i(t).data("taxonomy")+'"]').attr("disabled","disabled")}),i("button.add_attribute_tv_show").on("click",function(){var e=i(".tv_show_attributes .masvideos_attribute").length,t=i("select.attribute_taxonomy").val(),s=i(this).closest("#tv_show_attributes"),o=s.find(".tv_show_attributes"),a={action:"masvideos_add_attribute_tv_show",taxonomy:t,i:e,security:masvideos_admin_meta_boxes.add_attribute_tv_show_nonce};return s.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),i.post(masvideos_admin_meta_boxes.ajax_url,a,function(e){o.append(e),i(document.body).trigger("masvideos-enhanced-select-init"),c(),s.unblock(),i(document.body).trigger("masvideos_added_attribute_tv_show")}),t&&(i("select.attribute_taxonomy").find('option[value="'+t+'"]').attr("disabled","disabled"),i("select.attribute_taxonomy").val("")),!1}),i(".tv_show_attributes").on("blur","input.attribute_name",function(){i(this).closest(".masvideos_attribute").find("strong.attribute_name").text(i(this).val())}),i(".tv_show_attributes").on("click","button.select_all_attributes",function(){return i(this).closest("td").find("select option").attr("selected","selected"),i(this).closest("td").find("select").change(),!1}),i(".tv_show_attributes").on("click","button.select_no_attributes",function(){return i(this).closest("td").find("select option").removeAttr("selected"),i(this).closest("td").find("select").change(),!1}),i(".tv_show_attributes").on("click",".remove_row",function(){if(window.confirm(masvideos_admin_meta_boxes.remove_attribute)){var e=i(this).parent().parent();e.is(".taxonomy")?(e.find("select, input[type=text]").val(""),e.hide(),i("select.attribute_taxonomy").find('option[value="'+e.data("taxonomy")+'"]').removeAttr("disabled")):(e.find("select, input[type=text]").val(""),e.hide(),c())}return!1}),i(".tv_show_attributes").sortable({items:".masvideos_attribute",cursor:"move",axis:"y",handle:"h3",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"masvideos-metabox-sortable-placeholder",start:function(e,t){t.item.css("background-color","#f6f6f6")},stop:function(e,t){t.item.removeAttr("style"),c()}}),i(".tv_show_attributes").on("click","button.add_new_attribute",function(){i(".tv_show_attributes").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var t=i(this).closest(".masvideos_attribute"),e=t.data("taxonomy"),s=window.prompt(masvideos_admin_meta_boxes.new_attribute_prompt);if(s){var o={action:"masvideos_add_new_attribute_tv_show",taxonomy:e,term:s,security:masvideos_admin_meta_boxes.add_attribute_tv_show_nonce};i.post(masvideos_admin_meta_boxes.ajax_url,o,function(e){e.error?window.alert(e.error):e.slug&&(t.find("select.attribute_values").append('<option value="'+e.term_id+'" selected="selected">'+e.name+"</option>"),t.find("select.attribute_values").change()),i(".tv_show_attributes").unblock()})}else i(".tv_show_attributes").unblock();return!1}),i(".save_attributes_tv_show").on("click",function(){i("#masvideos-tv-show-data").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var e={post_id:masvideos_admin_meta_boxes.post_id,data:i(".tv_show_attributes").find("input, select, textarea").serialize(),action:"masvideos_save_attributes_tv_show",security:masvideos_admin_meta_boxes.save_attributes_tv_show_nonce};i.post(masvideos_admin_meta_boxes.ajax_url,e,function(){var e=window.location.toString();e=e.replace("post-new.php?","post.php?post="+masvideos_admin_meta_boxes.post_id+"&action=edit&"),i("#masvideos-tv-show-data").unblock()})});var d=i("#tv_show_image_gallery"),l=i("#tv_show_images_container").find("ul.tv_show_images");i(".add_tv_show_images").on("click","a",function(e){var o=i(this);e.preventDefault(),n||(n=wp.media.frames.tv_show_gallery=wp.media({title:o.data("choose"),button:{text:o.data("update")},states:[new wp.media.controller.Library({title:o.data("choose"),filterable:"all",multiple:!0})]})).on("select",function(){var e=n.state().get("selection"),s=d.val();e.map(function(e){if((e=e.toJSON()).id){s=s?s+","+e.id:e.id;var t=e.sizes&&e.sizes.thumbnail?e.sizes.thumbnail.url:e.url;l.append('<li class="image" data-attachment_id="'+e.id+'"><img src="'+t+'" /><ul class="actions"><li><a href="#" class="delete" title="'+o.data("delete")+'">'+o.data("text")+"</a></li></ul></li>")}}),d.val(s)}),n.open()}),l.sortable({items:"li.image",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,placeholder:"masvideos-metabox-sortable-placeholder",start:function(e,t){t.item.css("background-color","#f6f6f6")},stop:function(e,t){t.item.removeAttr("style")},update:function(){var t="";i("#tv_show_images_container").find("ul li.image").css("cursor","default").each(function(){var e=i(this).attr("data-attachment_id");t=t+e+","}),d.val(t)}}),i("#tv_show_images_container").on("click","a.delete",function(){i(this).closest("li.image").remove();var t="";return i("#tv_show_images_container").find("ul li.image").css("cursor","default").each(function(){var e=i(this).attr("data-attachment_id");t=t+e+","}),d.val(t),i("#tiptip_holder").removeAttr("style"),i("#tiptip_arrow").removeAttr("style"),!1})});
!function(o){"use strict";var i;o(document).ready(function(){o(".masvideos-select2").selectWoo(),o(".masvideos-select2-tags").selectWoo({tags:!0})}),o(".upload_image_id").val()||o(".masvideos_remove_image_button").hide(),o(document).on("click",".masvideos_upload_image_button",function(e){var i=o(this),t=o(this).parents(".form-field").attr("id");if(void 0===a)var a;e.preventDefault(),a||(a=wp.media.frames.downloadable_file=wp.media({title:"Choose an image",button:{text:"Use image"},library:{type:["image"]},multiple:!1})).on("select",function(){var e=a.state().get("selection").first().toJSON();o("#"+t+" .upload_image_id").val(e.id),o("#"+t+" img.upload_image_preview").attr("src",e.url),o("#"+t+" .masvideos_remove_image_button").show(),i.closest(".widget-inside").find(".widget-control-save").prop("disabled",!1)}),a.open()}),o(document).on("click",".masvideos_remove_image_button",function(e){var i=o(this),t=o(this).parents(".form-field").attr("id");return o("#"+t+" img.upload_image_preview").attr("src",o("#"+t+" img.upload_image_preview").data("placeholder-src")),o("#"+t+" .upload_image_id").val(""),o("#"+t+" .masvideos_remove_image_button").hide(),i.closest(".widget-inside").find(".widget-control-save").prop("disabled",!1),!1});var d=o("#video_image_gallery"),s=o(".video_images_container").find("ul.video_images");o(".add_video_images").on("click","a",function(e){var a=o(this);e.preventDefault(),i||(i=wp.media.frames.video_gallery=wp.media({title:a.data("choose"),button:{text:a.data("update")},library:{type:["image"]},multiple:!0})).on("select",function(){var e=i.state().get("selection"),t=d.val();e.map(function(e){if((e=e.toJSON()).id){t=t?t+","+e.id:e.id;var i=e.sizes&&e.sizes.thumbnail?e.sizes.thumbnail.url:e.url;s.append('<li class="image" data-attachment_id="'+e.id+'"><img src="'+i+'" /><ul class="actions"><li><a href="#" class="delete" title="'+a.data("delete")+'">'+a.data("text")+"</a></li></ul></li>")}}),d.val(t)}),i.open()}),s.sortable({items:"li.image",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,placeholder:"masvideos-metabox-sortable-placeholder",start:function(e,i){i.item.css("background-color","#f6f6f6")},stop:function(e,i){i.item.removeAttr("style")},update:function(){var i="";o(".video_images_container").find("ul li.image").css("cursor","default").each(function(){var e=o(this).attr("data-attachment_id");i=i+e+","}),d.val(i)}}),o(".video_images_container").on("click","a.delete",function(){o(this).closest("li.image").remove();var i="";return o(".video_images_container").find("ul li.image").css("cursor","default").each(function(){var e=o(this).attr("data-attachment_id");i=i+e+","}),d.val(i),o("#tiptip_holder").removeAttr("style"),o("#tiptip_arrow").removeAttr("style"),!1}),o(".upload_video_id").val()||o(".masvideos_remove_video_button").hide(),o(document).on("click",".masvideos_upload_video_button",function(e){var i=o(this),t=o(this).parents(".form-field").attr("id");if(void 0===a)var a;e.preventDefault(),a||(a=wp.media.frames.downloadable_file=wp.media({title:"Choose an video",button:{text:"Use video"},library:{type:["video"]},multiple:!1})).on("select",function(){var e=a.state().get("selection").first().toJSON();o("#"+t+" .upload_video_id").val(e.id),o("#"+t+" .masvideos_remove_video_button").show(),i.closest(".widget-inside").find(".widget-control-save").prop("disabled",!1)}),a.open()}),o(document).on("click",".masvideos_remove_video_button",function(e){var i=o(this),t=o(this).parents(".form-field").attr("id");return o("#"+t+" div.wp-video").remove(),o("#"+t+" .upload_video_id").val(""),o("#"+t+" .masvideos_remove_video_button").hide(),i.closest(".widget-inside").find(".widget-control-save").prop("disabled",!1),!1}),o(".edit-video-form #video_choice").on("change",function(){var e=o(this).val(),i=o(this).parents(".edit-video-form");i.find(".form-field").hide(),i.find(".show_if_"+e).show()}).change()}(jQuery,window);
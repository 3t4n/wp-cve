!function(t,e){function a(){var t=c(document.body);t.on("keyup",c.proxy(this._on_document_keyup,this)),t.on("click",c.proxy(this._on_document_click,this)),+peepsodata.currentuserid&&!r.isTouch()&&t.on("mouseenter",".ps-js-reaction-toggle",t=>{var e,a=c(t.currentTarget),s=a.data("stream-id"),o=c(".ps-js-act-reactions-options--"+s),t=o.find(".ps-reaction-option").not(".ps-reaction-option-delete");if(!(t.length<=1))return a.hasClass("liked")?(a.attr("onclick",a.attr("ps-onclick")),a.off("mouseenter.reactions mouseleave.reactions"),o.off("mouseenter.reactions mouseleave.reactions"),void a.removeData("reactions.init")):void(a.data("reactions.init")||(a.data("reactions.init",1).attr("ps-onclick",a.attr("onclick")).attr("onclick","event.preventDefault(); event.stopPropagation();").on("mouseenter.reactions",()=>{if(a.hasClass("liked"))return a.attr("onclick",a.attr("ps-onclick")),a.off("mouseenter.reactions mouseleave.reactions"),o.off("mouseenter.reactions mouseleave.reactions"),void a.removeData("reactions.init");o.is(":hidden")&&(clearTimeout(e),this.action_reactions(a[0],s))}).on("mouseleave.reactions",()=>{clearTimeout(e),e=setTimeout(()=>{o.is(":visible")&&this.action_reactions(a[0],s)},500)}),o.on("mouseenter.reactions",()=>{clearTimeout(e)}).on("mouseleave.reactions",()=>{clearTimeout(e),e=setTimeout(()=>{o.is(":visible")&&this.action_reactions(a[0],s)},500)}),a.trigger("mouseenter.reactions")))})}var c,r,l;reactions=(c=t,r=e,l='<img src="'+peepsoreactionsdata.ajaxloader+'"/>',a.prototype.action_reactions=function(t,e){var a=c(".ps-reaction-toggle--"+e),s=c(".ps-js-act-reactions-options--"+e),e=c(".ps-reaction-option-delete--"+e),o=s.find(".ps-reactions__list"),i=s.eq(0).find(".ps-reaction-option").not(".ps-reaction-option-delete");1===i.length?(a.hasClass("liked")?e:i).click():(a.hasClass("liked")?(e.show(),o.addClass("ps-reactions__list--selected")):(e.hide(),o.removeClass("ps-reactions__list--selected")),s.fadeToggle(200))},a.prototype.action_react=function(t,a,e,s){var o,i;this.action_react_progress||(this.action_react_progress=!0,e={act_id:a,post_id:e,react_id:s},o=this,i=c(".ps-js-act-reactions--"+a),c(".ps-js-act-reactions-options--"+a).fadeOut(200),$like_a=c(".ps-reaction-toggle--"+a),$like_span=$like_a.children("span"),$like_a.removeClass(),$like_a.addClass("ps-reaction-toggle--"+a+" ps-js-reaction-toggle"),$like_a.addClass("ps-reaction"),$like_a.addClass("liked"),$like_a.addClass("ps-post__action"),$like_a.addClass("ps-reaction-emoticon-"+s),i.animate({opacity:.5}),$like_span.html(l),r.postJson("reactionsajax.react",e,function(t){var e="ps-reactions__likes--hide";o.action_react_progress=!1,t.success?(c.isNumeric(t.data.reaction_mine_id)&&$like_span.html("<span>"+t.data.reaction_mine_label+"<span>"),t.data.html_reactions?(i.removeClass(e),i.html(t.data.html_reactions).animate({opacity:1})):(i.addClass(e),i.html("")),r.hooks.doAction("reaction_added",a)):alert("Something went wrong")}))},a.prototype.action_react_delete=function(t,a,e){var s,o,i;this.action_react_progress||(this.action_react_progress=!0,e={act_id:a,post_id:e},s=this,o=c(".ps-js-act-reactions--"+a),c(".ps-reaction-option--"+a).removeClass("ps-reaction-option-selected"),i=(i=c(".ps-js-act-reactions-options--"+a).fadeOut(200).find(".ps-reaction-option").first().attr("class").match(/ps-reaction-emoticon-\d+/))?i[0]:"ps-reaction-emoticon-0",$like_a=c(".ps-reaction-toggle--"+a),$like_span=$like_a.children("span"),$like_a.removeClass(),$like_a.addClass("ps-reaction-toggle--"+a+" ps-js-reaction-toggle"),$like_a.addClass("ps-reaction"),$like_a.removeClass("liked"),$like_a.addClass("ps-post__action"),$like_a.addClass(i),o.animate({opacity:.5}),$like_span.html(l),r.postJson("reactionsajax.react_delete",e,function(t){var e="ps-reactions__likes--hide";s.action_react_progress=!1,t.success?(c.isNumeric(t.data.reaction_mine_id)||$like_span.html("<span>"+t.data.reaction_mine_label+"<span>"),t.data.html_reactions?(o.removeClass(e),o.html(t.data.html_reactions).animate({opacity:1})):(o.addClass(e),o.html("")),r.hooks.doAction("reaction_deleted",a)):alert("Something went wrong")}))},a.prototype.action_html_reactions=function(t,e){var a,s,o;this.action_react_progress||(this.action_react_progress=!0,a={act_id:e},s=this,(o=c(".ps-js-act-reactions--"+e)).html(o.html()+" "+l),o.animate({opacity:.5}),r.postJson("reactionsajax.html_reactions",a,function(t){s.action_react_progress=!1,t.success?(o.removeClass("ps-reactions__likes--open"),o.html(t.data.html_reactions).animate({opacity:1})):alert("Something went wrong")}))},a.prototype.action_html_reactions_details=function(t,e,a){var s,o,i,n;this.action_react_progress||(this.action_react_progress=!0,s={act_id:e},o=this,i=c(".ps-js-act-reactions--"+e),n=i.html(),i.animate({opacity:.5}),i.html(n+" "+l),r.postJson("reactionsajax.html_reactions_details",s,function(t){o.action_react_progress=!1,i.addClass("ps-reactions__likes--open"),i.html(t.success?t.data.html_reactions:n).animate({opacity:1})}))},a.prototype._on_document_keyup=function(t){27===t.keyCode&&c(".ps-js-reaction-options:visible").fadeOut(200)},a.prototype._on_document_click=function(t){var t=c(t.target).closest(".ps-js-reaction-options, .ps-js-reaction-toggle");t.length?(t=t.closest(".js-stream-actions").nextAll(".ps-js-reaction-options"),c(".ps-js-reaction-options:visible").not(t).fadeOut(200)):c(".ps-js-reaction-options:visible").fadeOut(200)},new a)}(jQuery,peepso);
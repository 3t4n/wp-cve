!function i(o,a,s){function r(n,e){if(!a[n]){if(!o[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(d)return d(n,!0);throw(e=new Error("Cannot find module '"+n+"'")).code="MODULE_NOT_FOUND",e}t=a[n]={exports:{}},o[n][0].call(t.exports,function(e){return r(o[n][1][e]||e)},t,t.exports,i,o,a,s)}return a[n].exports}for(var d="function"==typeof require&&require,e=0;e<s.length;e++)r(s[e]);return r}({1:[function(e,n,t){!function(g){!function(){"use strict";var e,o=(e="undefined"!=typeof window?window.jQuery:void 0!==g?g.jQuery:null)&&e.__esModule?e:{default:e},a="undefined"!=typeof window?window.peepso:void 0!==g?g.peepso:null;const n=+("undefined"!=typeof window?window.peepsodata:void 0!==g?g.peepsodata:null).currentuserid;let i={page:1,per_page:10,unread_only:0},t,s,r,d,l,c;function f(o){return new Promise((t,i)=>{a.ajax.post("notificationsajax.get_latest",o).done(e=>{var n;e.success?(n=e.data||{},t(n.notifications||[])):e.errors&&1===o.page?i(e.errors):t([])}).fail(i)})}function u(e){e=0<arguments.length&&void 0!==e?e:0;i.page=1,i.unread_only=e?1:0,d.hide(),c.hide(),l.show(),f(i).then(function(e){e instanceof Array&&e.length&&(d.html(e.join("")).show(),e.length>=i.per_page&&p())}).catch(function(e){c.html(e).show()}).finally(()=>l.hide())}function p(){let n="scroll.ps-page-notifications",t=(0,o.default)(a.observer.applyFilters("autoload_scrollable_container",window));t.off(n),t.on(n,()=>{let e=d.find(".ps-js-notification").last();e.get(0).getBoundingClientRect().top<(window.innerHeight||document.documentElement.clientHeight)&&(t.off(n),i.page++,l.show(),f(i).then(function(e){e instanceof Array&&e.length&&(d.append(e.join("")),e.length>=i.per_page&&p())}).finally(()=>l.hide()))}).trigger(n)}function h(e){return new Promise((n,t)=>{a.ajax.post("notificationsajax.mark_as_read",{note_id:e}).done(e=>{e.success?n():e.errors?t(e.errors[0]):t()}).fail(t)})}(0,o.default)(function(){let e=(0,o.default)(".ps-js-page-notifications");e.length&&n&&(t=e.find(".ps-js-notification-show-all"),s=e.find(".ps-js-notification-show-unread"),r=e.find(".ps-js-notification-mark-all-as-read"),d=e.find(".ps-js-page-notifications-list"),l=e.find(".ps-js-page-notifications-loading"),c=e.find(".ps-js-page-notifications-alert").hide(),t.on("click",e=>{e.preventDefault(),t.addClass("active"),s.removeClass("active"),u(0)}),s.on("click",e=>{e.preventDefault(),t.removeClass("active"),s.addClass("active"),u(1)}),r.on("click",e=>{e.preventDefault();let n=(0,o.default)(e.currentTarget);n.data("loading")||(n.data("loading",1),new Promise((n,t)=>{a.ajax.post("notificationsajax.mark_as_read").done(e=>{e.success?n():e.errors?t(e.errors[0]):t()}).fail(t)}).then(()=>{n.removeData("loading"),d.find(".ps-js-notification[data-unread]").each(function(){(0,o.default)(this).removeClass("ps-notification--unread").removeAttr("data-unread").find(".ps-js-mark-as-read").remove()}),(0,o.default)(".ps-js-notifications").find(".ps-js-counter").html(0).css("display","none")}))}),d.on("mousedown click",".ps-js-mark-as-read",e=>{e.preventDefault(),e.stopPropagation();let t=(0,o.default)(e.currentTarget),i=t.closest(".ps-js-notification");e=i.data("id");i.data("loading")||(i.css("opacity",.5),i.data("loading",1),h(e).then(()=>{t.remove(),i.removeClass("ps-notification--unread"),i.removeAttr("data-unread"),i.css("opacity",""),i.removeData("loading");let n=(0,o.default)(".ps-js-notifications");if(n.length){let e=+n.eq(0).find(".ps-js-counter").text();n.each(function(){(0,o.default)(this).find(".ps-js-counter").html(e-1).css("display",1<e?"":"none")})}}))}),d.on("mousedown.ps-notification",".ps-js-notification a",e=>{var t=(0,o.default)(e.currentTarget),i=t.closest(".ps-js-notification");!+i.data("unread")||3===e.which||e.ctrlKey||e.altKey||(2===e.which||e.metaKey||e.shiftKey||t.on("click",function(e){e.preventDefault(),e.stopPropagation()}),i.css("opacity",.5),i.removeClass("ps-notification--unread"),h(i.data("id")).then(()=>{i.css("opacity",""),i.data("unread",0),1!==e.which||e.metaKey||e.shiftKey||(t.off("click"),t[0].click());let n=(0,o.default)(".ps-js-notifications");if(n.length){let e=+n.eq(0).find(".ps-js-counter").text();n.each(function(){(0,o.default)(this).find(".ps-js-counter").html(e-1).css("display",1<e?"":"none")})}}).fail(function(e){i.addClass("ps-notification--unread"),e&&peepso.dialog(e,{error:!0}).show()}))}),t.triggerHandler("click"))})}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]);
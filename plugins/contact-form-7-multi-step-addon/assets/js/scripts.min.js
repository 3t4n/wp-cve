!function(a){"use strict";a.fn.trx_mscf_ajax=function(s){return a.fn.trx_mscf_ajax.options=a.extend({},a.fn.trx_mscf_ajax.defaults,s),this.each(function(s,t){a(a.fn.trx_mscf_ajax.options.classes.step,a(t)).length>0&&a.fn.trx_mscf_ajax.init(a(t))})},a.fn.trx_mscf_ajax.defaults={ajax_url:TRX_MSCF_GLOBALS.ajax_url,ajax_nonce:TRX_MSCF_GLOBALS.ajax_nonce,classes:{active:"trx_mscf_active",hidden:"trx_hidden",step:".trx_mscf_step",next:".trx_mscf_next",prev:".trx_mscf_prev",progressbar:".trx_mscf_progressbar",progressbar_template:"trx_mscf_template"}},a.fn.trx_mscf_ajax.init=function(s){var t=a.fn.trx_mscf_ajax.options;a(t.classes.step,s).each(function(s,e){0===s&&a(e).addClass(t.classes.active),a(e).attr("data-step",++s)}),a(t.classes.next,s).stop().click(function(e){e.preventDefault();var r=a(e.target).closest(t.classes.step);if(r.length>0){var n=parseInt(r.attr("data-step")),c=a(t.classes.step+"[data-step="+ ++n+"]",s);a.fn.trx_mscf_ajax.step_validate(s,r,c)}else console.log("Cant find current step.")}),a(t.classes.prev,s).stop().click(function(e){e.preventDefault();var r=a(e.target).closest(t.classes.step);if(r.length>0){var n=parseInt(r.attr("data-step")),c=a(t.classes.step+"[data-step="+--n+"]",s);a.fn.trx_mscf_ajax.change_progressbar(r,c,s),a.fn.trx_mscf_ajax.do_step(r,c)}else console.log("Cant find current step.")})},a.fn.trx_mscf_ajax.step_validate=function(s,t,e){var r=a.fn.trx_mscf_ajax.options,n=a("form",s),c=a(t).find(".wpcf7-form-control").map(function(){return this.name}).get(),f=a(t).find(".wpcf7-form-control").serialize();a(t).find(".wpcf7-form-control[type='file']").length>0&&a(t).find(".wpcf7-form-control[type='file']").each(function(s,t){f+="&"+a(this).attr("name")+"="+a(this).val()});var o=f+"&action=trx_mscf_validate_fields&trx_form_id="+wpcf7.getId(a("form",s))+"&trx_fields_to_check="+c+"&trx_ajax_nonce="+r.ajax_nonce;c.length>0?a.ajax({type:"post",dataType:"json",url:r.ajax_url,data:o,success:function(r){var c="";a.fn.trx_mscf_ajax.clear_error_messages(n,t);try{if((c="object"==typeof r?r:JSON.parse(JSON.stringify(r))).is_valid)a.fn.trx_mscf_ajax.change_progressbar(t,e,s),a.fn.trx_mscf_ajax.do_step(t,e);else{var f=a(".wpcf7-response-output",n);a.each(c.invalid_fields,function(s,t){a(t.into,n).each(function(){wpcf7.notValidTip(this,t.message),a(".wpcf7-form-control",this).addClass("wpcf7-not-valid"),a("[aria-invalid]",this).attr("aria-invalid","true")})}),f.addClass("wpcf7-validation-errors"),n.addClass("invalid")}}catch(a){console.log("error: "+a)}}}):(a.fn.trx_mscf_ajax.change_progressbar(t,e,s),a.fn.trx_mscf_ajax.do_step(t,e))},a.fn.trx_mscf_ajax.do_step=function(s,t){var e=a.fn.trx_mscf_ajax.options;a(s).removeClass(e.classes.active).addClass(e.classes.hidden),a(t).removeClass(e.classes.hidden).addClass(e.classes.active)},a.fn.trx_mscf_ajax.clear_error_messages=function(s,t){s.removeClass("invalid"),a(".wpcf7-response-output",s).removeClass("wpcf7-validation-errors"),a(".wpcf7-form-control",t).removeClass("wpcf7-not-valid"),a("[aria-invalid]",t).attr("aria-invalid","false"),a(".wpcf7-not-valid-tip",t).remove()},a.fn.trx_mscf_ajax.change_progressbar=function(s,t,e){var r=a.fn.trx_mscf_ajax.options;if(a(r.classes.progressbar,e).length>0){var n=a(r.classes.progressbar,e),c=parseInt(s.attr("data-step")),f=parseInt(t.attr("data-step"));c--,f--,n.each(function(s,t){c<f?a("li",t).eq(f).addClass("active"):(a("li",t).eq(c).removeClass("active"),a("li",t).eq(f).addClass("active"))})}}}(jQuery),jQuery(document).ready(function(){"use strict";jQuery(".wpcf7").trx_mscf_ajax()});
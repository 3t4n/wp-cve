function upiwcIntent(t,e){switch(e){case"gpay":prefix="gpay://upi/";break;case"phonepe":prefix="phonepe://";break;case"paytm":prefix="paytmmp://";break;default:prefix="upi://"}return prefix+t}function upiwcIsNumber(t){t=t||window.event;let e=t.which?t.which:t.keyCode;return!(8!=e&&0!=e&&e>31&&(e<48||e>57))}function upiwcStartTimer(t,e){function n(){i=t-((Date.now()-p)/1e3|0),o=i/60|0,c=i%60|0,o=o<10?"0"+o:o,c=c<10?"0"+c:c,e.textContent="Waiting... ("+o+":"+c+")",i<=0&&(p=Date.now()+1e3)}let i,o,c,a,p=Date.now();clearTimeout(a),n(),a=setInterval(n,1e3),setTimeout(function(){clearTimeout(a)},1e3*t)}(function(t){"use strict";if("undefined"==typeof upiwcData)return!1;let e="pay?pa="+upiwcData.payee_vpa+"&pn="+upiwcData.payee_name+"&am="+upiwcData.order_amount+"&tr="+upiwcData.order_key.replace("wc_order_","")+"&mc="+upiwcData.mc_code+"&orgid=000000&mode=01&cu=INR&tn="+upiwcData.payee_name+"+OrderId:"+upiwcData.order_number;e=encodeURI(e.replace(/\s/g,"")),t("body").on("contextmenu",".upiwc-payment-qr-code img",function(t){return!1}),t("body").on("click","#upiwc-cancel-payment",function(t){t.preventDefault(),window.location=upiwcData.cancel_url}),t("body").on("click",".upiwc-return-link",function(t){t.preventDefault(),window.location=upiwcData.payment_url}),t("body").on("click","#upiwc-confirm-payment",function(n){n.preventDefault();let i='<span class="payment-amount">â‚¹ '+upiwcData.order_amount+"</span>";""!=upiwcData.payer_vpa&&(i+='<span class="upi-id">'+upiwcData.payer_vpa+"</span>");let o=t.confirm({title:t("body").find(".upiwc-modal-header").html(),content:t("body").find(".upiwc-modal-content").html(),useBootstrap:!1,animation:"scale",boxWidth:"375px",draggable:!1,offsetBottom:0,offsetTop:0,closeIcon:!0,bgOpacity:.8,lazyOpen:!0,theme:upiwcData.theme,onOpenBefore:function(){this.$el.addClass("upiwc-payment-modal"),t(document).trigger("upiwcOnOpenBefore",[this])},onContentReady:function(){t(document).trigger("upiwcBeforeContentReady",[this]);let n,i,o=this;o.$content.find(".upiwc-payment-upi-id").on("click",function(e){e.preventDefault(),clearTimeout(i),navigator.clipboard.writeText(upiwcData.payee_vpa).then(function(){console.log("Copying to clipboard was successful!")},function(t){console.error("Could not copy text: ",t)});let n=t(this);n.text("Copied!"),i=setTimeout(function(){n.text(upiwcData.payee_vpa)},1e3)}),o.$content.find("#upiwc-payment-transaction-number").on("input",function(t){o.$content.find(".upiwc-payment-error").hide()}),o.$content.find("#upiwc-payment-file").on("change",function(t){o.$content.find(".upiwc-payment-error").hide()});let c=o.$content.find("#upiwc-payment-qr-code img").attr("src");o.$content.find("#upi-download").on("click",function(t){t.preventDefault();let e=document.createElement("a");e.href=c,e.download="QR Code.png",e.click()}),o.$content.find(".upiwc-payment-btn").on("click",function(i){i.preventDefault(),clearTimeout(n),o.$content.find(".upiwc-payment-intent-error").hide();let c=t(this).data("type"),a=window.open(upiwcIntent(e,c));n=setTimeout(function(){a.closed||(a.close(),o.$content.find(".upiwc-payment-intent-error").text("No specified UPI App on this device. Select other UPI option to proceed.").show())},2500)});let a=parseInt(upiwcData.btn_show_interval);a&&a>=1e3?(1==upiwcData.btn_timer&&upiwcStartTimer(a/1e3,document.querySelector(".btn.upiwc-next")),setTimeout(function(){o.buttons.nextStep.setText("Proceed to Next"),o.buttons.nextStep.enable()},a)):(o.buttons.nextStep.setText("Proceed to Next"),o.buttons.nextStep.enable()),t(document).trigger("upiwcAfterContentReady",[this])},onClose:function(){t("#upiwc-processing").hide(),t("#upiwc-confirm-payment, #upiwc-cancel-payment, .upiwc-return-link").show(),t(".upiwc-waiting-text").text("Please click the Pay Now button below to complete the payment against this order."),t(document).trigger("upiwcOnClose",[this])},onAction:function(e){t(document).trigger("upiwcOnAction",[this,e])},buttons:{amount:{text:i,btnClass:"upiwc-amount",action:function(){return!1}},nextStep:{text:"Waiting...",btnClass:"upiwc-next",isDisabled:!0,action:function(){t(document).trigger("upiwcBeforeNextStepAction",[this]);let e=this;return e.$content.find(".upiwc-payment-confirm").show(),e.$content.find(".upiwc-payment-info, .upiwc-payment-qr-code.upiwc-show, .upiwc-payment-actions, .upiwc-payment-container").hide(),e.$closeIcon.hide(),e.buttons.amount.hide(),e.buttons.nextStep.hide(),e.buttons.back.show(),e.buttons.confirm.show(),t(document).trigger("upiwcAfterNextStepAction",[this]),!1}},back:{text:"Back",isHidden:!0,btnClass:"upiwc-back",action:function(){t(document).trigger("upiwcBeforeBackAction",[this]);let e=this;return e.$content.find(".upiwc-payment-confirm").hide(),e.$content.find(".upiwc-payment-info, .upiwc-payment-qr-code.upiwc-show, .upiwc-payment-actions, .upiwc-payment-container").show(),e.buttons.amount.show(),e.buttons.nextStep.show(),e.buttons.back.hide(),e.buttons.confirm.hide(),e.$closeIcon.show(),t(document).trigger("upiwcAfterBackAction",[this]),!1}},confirm:{text:"Confirm",btnClass:"upiwc-confirm",isHidden:!0,action:function(){t(document).trigger("upiwcBeforeConfirmAction",[this]);let e=this,n=e.$content.find("#upiwc-payment-transaction-number"),i=e.$content.find("#upiwc-payment-file");if(n.length>0){let t=n.val();if(""!=t&&12!=t.length)return e.$content.find(".upiwc-payment-error").text("Transaction ID should be of 12 digits!").show(),!1;if("show_require"===upiwcData.transaction_id&&""==t)return e.$content.find(".upiwc-payment-error").text("Transaction ID is required!").show(),!1}if(i.length>0&&"show_require"===upiwcData.transaction_image){var o=i[0];if(!o.files.length)return e.$content.find(".upiwc-payment-error").text("File is required!").show(),!1}n.attr("readonly","readonly"),e.buttons.confirm.disable(),e.buttons.back.disable(),e.buttons.confirm.setText("Processing...");let c=e.$content.find("#upiwc-payment-confirm-form");return c.attr("method","POST"),c.attr("enctype","multipart/form-data"),c.attr("action",upiwcData.callback_url),c.append('<input type="hidden" name="upiwc_order_id" value="'+upiwcData.order_id+'"><input type="hidden" name="upiwc_order_key" value="'+upiwcData.order_key+'"><input type="hidden" name="upiwc_nonce" value="'+upiwcData.nonce+'">'),c.submit(),t(document).trigger("upiwcAfterConfirmAction",[this]),!1}}}});o.open(),t("#upiwc-processing").show(),t("#upiwc-confirm-payment, #upiwc-cancel-payment, .upiwc-return-link").hide(),t(".upiwc-waiting-text").text("Please wait and don't press back or refresh this page while we are processing your payment...")}),t("#upiwc-payment-qr-code").length?new QRCode("upiwc-payment-qr-code",{text:"upi://"+e,width:200,height:200,correctLevel:QRCode.CorrectLevel.H,quietZone:8,onRenderingEnd:function(){t("#upiwc-confirm-payment").trigger("click")}}):t("#upiwc-confirm-payment").trigger("click")})(jQuery);
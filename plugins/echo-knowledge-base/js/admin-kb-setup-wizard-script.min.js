jQuery(document).ready(function(e){function t(t){!function(e){o.find(".epkb-setup-wizard-step-tab").removeClass("epkb-setup-wizard-step-tab--active epkb-setup-wizard-step-tab--completed");let t=o.find(".epkb-setup-wizard-step-tab--"+e);t.addClass("epkb-setup-wizard-step-tab--active"),t.prevAll(".epkb-setup-wizard-step-tab").addClass("epkb-setup-wizard-step-tab--completed")}(t),e(".epkb-wc-step-header").removeClass("epkb-wc-step-header--active"),e(".epkb-wc-step-header--"+t).addClass("epkb-wc-step-header--active"),e("#epkb-config-wizard-content").hasClass("epkb-config-setup-wizard-modular")?function(t){e(".epkb-wc-step-panel").removeClass("epkb-wc-step-panel--active"),e(".eckb-wizard-step-"+t).addClass("epkb-wc-step-panel--active"),e(".epkb-wc-step-panel-button").removeClass("epkb-wc-step-panel-button--active");let a=e(".epkb-wizard-content .epkb-wc-step-panel").length;1===t&&e(".epkb-wsb-step-1-panel-button").addClass("epkb-wc-step-panel-button--active");if(1!==t&&t<a){let a=e(".epkb-wsb-step-2-panel-button");a.addClass("epkb-wc-step-panel-button--active"),a.find(".epkb-setup-wizard-button-prev").val(t-1),a.find(".epkb-setup-wizard-button-next").val(t+1)}t===a&&e(".epkb-wsb-step-3-panel-button").addClass("epkb-wc-step-panel-button--active")}(t):function(t){e(".epkb-wsb-step").removeClass("epkb-wsb-step--active"),e("#epkb-wsb-step-"+t).addClass("epkb-wsb-step--active"),e(".epkb-wc-step-panel").removeClass("epkb-wc-step-panel--active"),e(".epkb-wc-step-panel-button").removeClass("epkb-wc-step-panel-button--active"),e("#epkb-wsb-step-"+t+"-panel").addClass("epkb-wc-step-panel--active"),e(".epkb-wsb-step-"+t+"-panel-button").addClass("epkb-wc-step-panel-button--active"),e(".epkb-wizard-top-bar").show(),e(".epkb-setup-wizard-theme-header__info__title[data-title-id]").length&&(e(".epkb-setup-wizard-theme-header__info__title[data-title-id]").addClass("hidden"),e(".epkb-setup-wizard-theme-header__info__title[data-title-id="+t+"]").removeClass("hidden"));!function(t){o.find(".epkb-wizard-status-bar .epkb-wsb-step").removeClass("epkb-wsb-step--completed"),o.find(".epkb-wizard-status-bar .epkb-wsb-step").each(function(){let a=e(this).attr("id");a[a.length-1]<t&&e(this).addClass("epkb-wsb-step--completed")})}(t)}(t);const a=e(".epkb-config-setup-wizard-modular .epkb-setup-wizard-theme-content-show-option");if(a.length>0&&4===t){let t=e('.epkb-config-setup-wizard-modular input[name="epkb-layout"]:checked').val();void 0===t&&(t="");const i=e(".epkb-config-setup-wizard-modular .epkb-wizard-content .eckb-wizard-step-4");a.data("ignore_layouts").replace(/\s/g,"").split(",").includes(t.replace(/\s/g,""))?(a.hide(),i.addClass("epkb-wc-step-panel--active")):(a.show(),e(".epkb-config-setup-wizard-modular input[name=epkb-setup-wizard-theme-content-show-option__toggle]").prop("checked")?i.addClass("epkb-wc-step-panel--active"):i.removeClass("epkb-wc-step-panel--active"))}e("html, body").animate({scrollTop:0},0)}function a(){const t=e(".epkb-setup-wizard-sidebar input[name=article_navigation]:checked").val(),a=e(".epkb-setup-wizard-sidebar input[name=article_location]:checked").val();let i=5;"categories_articles"===t?i="left"===a?1:2:"top_categories"===t&&(i="left"===a?3:4),e(".epkb-setup-wizard-sidebar .epkb-setup-wizard__featured-img-container").removeClass("epkb-setup-wizard__featured-img-container--active"),e(`.epkb-setup-wizard-sidebar .epkb-setup-wizard__featured-img-container[data-value=${i}]`).addClass("epkb-setup-wizard__featured-img-container--active")}function i(t){if(!t)return;let a=o.find(".epkb-setup-wizard-option__navigation-selector"),i=a.data("hide-none-on-layout"),s=a.data("current-value");void 0!==i&&t===i?(a.find('[name="article_navigation"][value="none"]').parent(".epkb-input-container").hide(),"none"===s?e(a.find('[name="article_navigation"]')[0]).prop("checked",!0).trigger("change"):a.find('[name="article_navigation"][value="'+s+'"]').prop("checked",!0).trigger("change")):(a.find('[name="article_navigation"][value="none"]').parent(".epkb-input-container").show().trigger("change"),a.find('[name="article_navigation"][value="'+s+'"]').prop("checked",!0).trigger("change"))}function s(t,a){if("show"===t){let t='<div class="epkb-admin-dialog-box-loading"><div class="epkb-admin-dbl__header"><div class="epkb-admin-dbl-icon epkbfa epkbfa-hourglass-half"></div>'+(a?'<div class="epkb-admin-text">'+a+"</div>":"")+'</div></div><div class="epkb-admin-dialog-box-overlay"></div>';e("body").append(t)}else"remove"===t&&(e(".epkb-admin-dialog-box-loading").remove(),e(".epkb-admin-dialog-box-overlay").remove())}let o=e("#epkb-config-wizard-content");if(o.length<=0)return;let p=e(".epkb-admin__error-form__container");o.find(".epkb-setup-wizard-button-apply").on("click",function(t){let a=[],i={action:"epkb_apply_setup_wizard_changes",_wpnonce_epkb_ajax_action:e("#_wpnonce_epkb_ajax_action").val(),epkb_wizard_kb_id:e("#epkb_wizard_kb_id").val(),sidebar_selection:"0"},n=e('input[name="epkb-layout"]:checked').val();void 0===n&&(n="");let d=e('input[name="epkp-theme"]:checked').val();void 0===d&&(d="current"),e(".epkb-menu-checkbox input[type=checkbox]:checked").length&&e(".epkb-menu-checkbox input[type=checkbox]:checked").each(function(){a.push(e(this).prop("name").split("epkb_menu_")[1])}),e(".epkb-setup-wizard-sidebar input[type=radio]:checked").length&&(i.sidebar_selection=e(".epkb-setup-wizard-sidebar .epkb-setup-wizard__featured-img-container--active").data("value"));let r=e("input[name=categories_articles_sidebar_location]:checked").val();void 0===r&&(r="");let l=e(".epkb-setup-wizard-step-container--modules .epkb-setup-wizard-module-row .epkb-setup-wizard-module-row-toggle"),c=void 0===l[0]?"":e(l[0]).find("input:checked").val(),u=void 0===l[1]?"":e(l[1]).find("input:checked").val(),b=void 0===l[2]?"":e(l[2]).find("input:checked").val(),k=void 0===l[3]?"":e(l[3]).find("input:checked").val(),m=void 0===l[4]?"":e(l[4]).find("input:checked").val(),w=e(".epkb-setup-wizard-step-container--presets .epkb-setup-wizard-module-settings-row--active input:checked").val();if(void 0===w&&(w=""),w.length&&!o.hasClass("epkb-config-setup-wizard-modular--first-setup")){let t=e('[name="epkb-setup-wizard-theme-content-show-option__toggle"]'),a=t.closest(".epkb-setup-wizard-theme-content-show-option").data("ignore_layouts");t.prop("checked")&&-1===a.indexOf(n)||(w="current")}i.layout_name=n,i.theme_name=d,i.kb_name=e(".epkb-wizard-name input").val(),i.kb_slug=e(".epkb-wizard-slug input").val(),i.menu_ids=a,i.categories_articles_sidebar_location=r,i.row_1_module=c,i.row_2_module=u,i.row_3_module=b,i.row_4_module=k,i.row_5_module=m,i.categories_articles_preset_name=w,function(t){let a,i;e.ajax({type:"POST",dataType:"json",data:t,url:ajaxurl,beforeSend:function(e){s("show",epkb_vars.saving_changes)}}).done(function(t){if(i=t||"",s("remove",""),i.error||void 0===i.message)return a=i.message?i.message:function(e,t,a){return'<div class="eckb-bottom-notice-message"><div class="contents"><span class="'+"error"+'">'+(e?"<h4>"+e+"</h4>":"")+(t||"")+"</span></div></div>"}("",epkb_vars.reload_try_again),e(p).find(".epkb-admin__error-form__title").text(epkb_vars.setup_wizard_error_title),e(p).find(".epkb-admin__error-form__desc").text(epkb_vars.setup_wizard_error_desc),e(p).find("#epkb-admin__error-form__message").val("Setup Wizard: "+e(a).text().trim()),void e(p).css("display","block","important");i.redirect_to_url&&i.redirect_to_url.length>0&&(e("#epkb-wizard-success-message").addClass("epkb-dialog-box-form--active"),e("#epkb-wizard-success-message .epkb-accept-button").on("click",function(){window.location=i.redirect_to_url}))}).fail(function(){s("remove","");let t=window.location.href.replace("&page=epkb-kb-configuration&setup-wizard-on","&page=epkb-kb-need-help&epkb_after_kb_setup");e("#epkb-wizard-success-message").addClass("epkb-dialog-box-form--active"),e("#epkb-wizard-success-message .epkb-accept-button").on("click",function(){window.location=t})})}(i)}),o.find(".epkb-setup-wizard-button-next, .epkb-setup-wizard-button-prev").on("click",function(a){a.preventDefault();t(Number(e(this).val()))}),e(document).on("click",".epkb-setup-wizard-step-tab",function(){t(Number(e(this).data("step")))}),e(document).on("change",".epkb-config-setup-wizard-modular input[name=epkb-setup-wizard-theme-content-show-option__toggle]",function(){const t=e(".epkb-config-setup-wizard-modular .epkb-wizard-content .eckb-wizard-step-4");e(this).prop("checked")?t.addClass("epkb-wc-step-panel--active"):t.removeClass("epkb-wc-step-panel--active")}),e(document).on("change",".epkb-setup-wizard-sidebar input[name=article_navigation]",a),e(document).on("change",".epkb-setup-wizard-sidebar input[name=article_location]",a),e(".epkb-setup-wizard-step__item-description__option__label").on("click",function(){e(this).closest(".epkb-wc-step-panel").find(".epkb-setup-option-container").removeClass("epkb-setup-option-container--active"),e(this).closest(".epkb-setup-wizard-step__item-content").find(".epkb-setup-option-container").addClass("epkb-setup-option-container--active")}),e("#epkb-wsb-step-3-panel .epkb-setup-option__featured-img").on("click",function(){let t=`\n\t\t\t<div class="epkb-config-wizard-image-popup-overlay">\n\t\t\t\t<div class="epkb-config-wizard-image-popup-container">\n\t\t\t\t\t<img src="${e(this).attr("src")}" alt="">\n\t\t\t\t\t<span class="epkb-config-wizard-image-close-popup">&times;</span>\n\t\t\t\t</div>\n\t\t\t</div>`;e("body").append(t),e(".epkb-config-wizard-image-popup-container").click(function(){e(this).toggleClass("epkb-zoomed")}),e(".epkb-config-wizard-image-close-popup").click(function(){e(".epkb-config-wizard-image-popup-overlay").remove(),i()});const a=t=>{$target=e(t.target),!$target.closest(".epkb-config-wizard-image-popup-container").length&&e(".epkb-config-wizard-image-popup-container").is(":visible")&&(e(".epkb-config-wizard-image-popup-overlay").remove(),i())},i=()=>{document.removeEventListener("click",a)};setTimeout(function(){document.addEventListener("click",a)},10)}),e('.epkb-wizard-slug input[type="text"]').on("input",function(){e("#epkb-wizard-slug-target").text(e(this).val())}),function(){let t=e(".epkb-setup-wizard-module-row--resource-link--disabled");if(t.length){e(".epkb-setup-wizard-hidden-rows-title").addClass("epkb-setup-wizard-hidden-rows-title--active");t.closest(".epkb-setup-wizard-module-rows-list").append(t)}}(),e(document).on("change",".epkb-setup-wizard-module-row-toggle input",function(){let t=e(this).val(),a=e(this).closest(".epkb-setup-wizard-module-row"),i=a.data("row-module"),s=o.find(".epkb-setup-wizard-step-container--presets"),p=o.find(".epkb-setup-wizard-step-container--layout"),n=e(this).closest(".epkb-setup-wizard-module-rows-list");if("none"===t)a.removeClass("epkb-setup-wizard-module-row--active"),n.append(a),a.removeClass("epkb-setup-wizard-module-row--activated"),a.addClass("epkb-setup-wizard-module-row--inactivated"),setTimeout(()=>{a.removeClass("epkb-setup-wizard-module-row--inactivated")},3e4);else{a.addClass("epkb-setup-wizard-module-row--active");let e=n.find('.epkb-setup-wizard-module-row--active:not([data-row-module="'+i+'"])').last();e.length?a.insertAfter(e):n.prepend(a),a.removeClass("epkb-setup-wizard-module-row--inactivated"),a.addClass("epkb-setup-wizard-module-row--activated"),setTimeout(()=>{a.removeClass("epkb-setup-wizard-module-row--activated")},3e4)}e(".epkb-setup-wizard-step-container--modules .epkb-setup-wizard-module-row").length-e(".epkb-setup-wizard-step-container--modules .epkb-setup-wizard-module-row--active").length?e(".epkb-setup-wizard-hidden-rows-title").addClass("epkb-setup-wizard-hidden-rows-title--active"):e(".epkb-setup-wizard-hidden-rows-title").removeClass("epkb-setup-wizard-hidden-rows-title--active"),"categories_articles"===i&&("none"===t?(p.addClass("epkb-setup-wizard-step-container--hide"),s.addClass("epkb-setup-wizard-step-container--hide"),o.find(".epkb-setup-wizard-no-categories-articles-message").addClass("epkb-setup-wizard-no-categories-articles-message--active")):(p.removeClass("epkb-setup-wizard-step-container--hide"),s.removeClass("epkb-setup-wizard-step-container--hide"),o.find(".epkb-setup-wizard-no-categories-articles-message").removeClass("epkb-setup-wizard-no-categories-articles-message--active")))}),e(document).on("click",".epkb-setup-wizard-module-row-sequence",function(){let t=e(this).closest(".epkb-setup-wizard-module-row");if(t.hasClass("epkb-setup-wizard-module-row--active"))if(t.addClass("epkb-setup-wizard-module-row--selected"),setTimeout(()=>{t.removeClass("epkb-setup-wizard-module-row--selected")},3e4),e(this).hasClass("epkb-setup-wizard-module-row-sequence--up")){let e=t.prev();e.length&&t.slideUp(500,function(){t.insertBefore(e),t.slideDown(500)})}else{let e=t.next();e.length&&e.hasClass("epkb-setup-wizard-module-row--active")&&t.slideUp(500,function(){t.insertAfter(e),t.slideDown(500)})}}),e(document).on("change",".epkb-setup-wizard-module-sidebar-selector input",function(){let t=e(this).closest(".epkb-setup-wizard-step-container--modules");t.find(".epkb-setup-wizard-module-sidebar").removeClass("epkb-setup-wizard-module-sidebar--active"),t.find(".epkb-setup-wizard-module--categories_articles").removeClass("epkb-setup-wizard-module-sidebar--active"),"left"===e(this).val()&&(t.find(".epkb-setup-wizard-module-sidebar--left").addClass("epkb-setup-wizard-module-sidebar--active"),t.find(".epkb-setup-wizard-module--categories_articles").addClass("epkb-setup-wizard-module-sidebar--active")),"right"===e(this).val()&&(t.find(".epkb-setup-wizard-module-sidebar--right").addClass("epkb-setup-wizard-module-sidebar--active"),t.find(".epkb-setup-wizard-module--categories_articles").addClass("epkb-setup-wizard-module-sidebar--active"))}),e(document).on("change",'.epkb-setup-wizard-step-container--layout input[name="epkb-layout"]',function(){let t=e(this).val(),a=o.find(".epkb-setup-wizard-step-container--modules");a.find(".epkb-setup-wizard-module--categories_articles").find(".epkb-setup-wizard-module-layout").removeClass("epkb-setup-wizard-module-layout--active"),a.find(".epkb-setup-wizard-module--categories_articles").find(".epkb-setup-wizard-module-layout--"+t).addClass("epkb-setup-wizard-module-layout--active");let s=o.find(".epkb-setup-wizard-step-container--presets");s.find(".epkb-setup-wizard-module-layout").removeClass("epkb-setup-wizard-module-layout--active"),s.find(".epkb-setup-wizard-module-settings-row").removeClass("epkb-setup-wizard-module-settings-row--active"),s.find(".epkb-setup-wizard-module-layout--"+t).addClass("epkb-setup-wizard-module-layout--active"),s.find(".epkb-setup-wizard-module-settings-row--"+t).addClass("epkb-setup-wizard-module-settings-row--active"),i(t)}),i(o.find('.epkb-setup-wizard-step-container--layout input[name="epkb-layout"]:checked').val()),e(document).on("change",".epkb-setup-wizard-module-preset-selector input",function(){let t=e(this).val(),a=o.find(".epkb-setup-wizard-step-container--presets").find(".epkb-setup-wizard-module-layout--active");a.find(".epkb-setup-wizard-module-preset").removeClass("epkb-setup-wizard-module-preset--active"),a.find(".epkb-setup-wizard-module-preset--"+t).addClass("epkb-setup-wizard-module-preset--active")}),function(){o.on("click",".epkb__option-tooltip__button",function(){const a=e(this).parent().find(".epkb__option-tooltip__contents");let i="block"==a.css("display");a.fadeOut(),i||(clearTimeout(t),a.fadeIn())});let t;o.on("mouseenter",".epkb__option-tooltip__button, .epkb__option-tooltip__contents",function(){const a=e(this).parent().find(".epkb__option-tooltip__contents");clearTimeout(t),a.fadeIn()}),o.on("mouseleave",".epkb__option-tooltip__button, .epkb__option-tooltip__contents",function(){const a=e(this).parent().find(".epkb__option-tooltip__contents");t=setTimeout(function(){a.fadeOut()},1e3)}),o.find("#epkb-wsb-step-2-panel .epkb-setup-wizard-module-row .epkb-setup-wizard-module-row-toggle .epkb-radio-buttons-container .epkb-input-container").each(function(t,a){"none"===e(a).find("input.epkb-input").val()?e(a).find("label.epkb-label").attr("data-tooltip","Hide Row"):e(a).find("label.epkb-label").attr("data-tooltip","Show Row")}),o.find("#epkb-wsb-step-2-panel .epkb-setup-wizard-module-row .epkb-setup-wizard-module-row-right-settings .epkb-setup-wizard-module-row--resource-links-activate").on("click",function(t){e("#epkb-dialog-pro-feature-ad-resource-links").addClass("epkb-dialog-pro-feature-ad--active")}),o.find("#epkb-wsb-step-3-panel .epkb-setup-wizard-step__item .epkb-setup-wizard-step__item-description .epkb-setup-wizard-step__item-description__button-pro").on("click",function(t){const a=e(this).data("target");e("#"+a).addClass("epkb-dialog-pro-feature-ad--active")}),o.find(".epkb-dialog-pro-feature-ad .epkb-dbf__close").on("click",function(){e(this).closest(".epkb-dialog-pro-feature-ad").removeClass("epkb-dialog-pro-feature-ad--active")}),e(document).on("click",function(t){let a=e(t.target);a.closest(".epkb-setup-wizard-module-row--resource-links-activate").length||a.closest(".epkb-dialog-pro-feature-ad").length||a.closest(".epkb-setup-wizard-step__item-description__button-pro").length||e(".epkb-dialog-pro-feature-ad").removeClass("epkb-dialog-pro-feature-ad--active")}),o.find(".eckb-wizard-step-2 .epkb-setup-option__featured-img-container").on("click",function(t){t.preventDefault(),t.stopPropagation(),o.find(".image_zoom").remove();var a,i=e(this).find("img");a=i.length>1?e(i[0]).is(":visible")?e(i[0]).attr("src"):e(i[1]).is(":visible")?e(i[1]).attr("src"):e(i[2]).attr("src"):e(this).find("img").attr("src"),e(this).after('<div id="epkb_image_zoom" class="epkb-setup-wizard-image_zoom"><div class="epkb-setup-wizard-image_zoom__content"><img src="'+a+'" class="epkb-setup-wizard-image_zoom__image"><span class="epkb-setup-wizard-image_zoom__close epkbfa epkbfa-close"></span></div></div>');let s=e(document).scrollTop();e("html, body").css({overflow:"hidden"}),e("html, body").on("click",function(){e("#epkb_image_zoom").remove(),e(this).css({overflow:"initial"}).off("click").animate({scrollTop:s},0)})})}(),e(document).on("click",".epkb-close-notice",function(){e(this).parent().addClass("fadeOutDown")}),e(p).on("click",".epkb-close-notice, .epkb-admin__error-form__btn-cancel",function(){window.location=epkb_vars.need_help_url}),e(p).find("#epkb-admin__error-form").on("submit",function(t){t.preventDefault();let a=e(this);e.ajax({type:"POST",dataType:"json",url:ajaxurl,data:a.serialize(),beforeSend:function(t){a.find(".epkb-admin__error-form__btn-wrap, input, label, textarea").slideUp("fast"),e(p).find(".epkb-admin__error-form__response").addClass("epkb-admin__error-form__response--active"),e(p).find(".epkb-admin__error-form__response").html(epkb_vars.sending_error_report)}}).done(function(t){void 0!==t.success&&0==t.success?e(p).find(".epkb-admin__error-form__response").html(t.data):void 0!==t.success&&1==t.success?e(p).find(".epkb-admin__error-form__response").html(t.data):e(p).find(".epkb-admin__error-form__response").html(epkb_vars.send_report_error)}).fail(function(t,a,i){e(p).find(".epkb-admin__error-form__response").html(epkb_vars.send_report_error)}).always(function(){e(p).find("input, textarea").prop("disabled",!1),setTimeout(function(){window.location=epkb_vars.need_help_url},1e3)})}),e(document).on("click",".epkb-notice-dismiss",function(t){t.preventDefault(),e("#"+e(this).data("notice-id")).slideUp();var a={action:"epkb_dismiss_ongoing_notice",epkb_dismiss_id:e(this).data("notice-id")};e.ajax({type:"POST",dataType:"json",url:ajaxurl,data:a})})});
jQuery(function(a){function t(t){var o=a(".docopy-"+t),r=a(".wpa_loop-"+t).attr("class");if(r){var e=r.match(/wpa_loop_limit-([0-9]*)/i);if(e){var c=e[1];a(".wpa_group-"+t).not(".wpa_group.tocopy").length>=c?o.hide():o.show()}}}a(document).on("click",function(o){var r=a(o.target);if(r.attr("class")&&r.filter("[class*=dodelete]").length){o.preventDefault();var e=r.parents(".postbox"),c=r.attr("class").match(/dodelete-([a-zA-Z0-9_-]*)/i);if(c=c&&c[1]?c[1]:null,confirm("This action can not be undone, are you sure?")){c?a(".wpa_group-"+c,e).not(".tocopy").remove():r.parents(".wpa_group").remove();var p=r.parents(".wpa_group");p&&p.attr("class")&&t(c=(c=p.attr("class").match(/wpa_group-([a-zA-Z0-9_-]*)/i))&&c[1]?c[1]:null),a.wpalchemy.trigger("wpa_delete")}}}),a("[class*=docopy-]").on("click",function(o){o.preventDefault();var r=a(this).parents(".postbox"),e=a(this).attr("class").match(/docopy-([a-zA-Z0-9_-]*)/i)[1],c=a(".wpa_group-"+e+".tocopy",r).first(),p=c.clone().removeClass("tocopy last"),s=["name","id","for","class"];c.find("*").each(function(t,o){for(var r=0;r<s.length;r++){var e=a(o).attr(s[r]);if(e){var c=e.match(/\[(\d+)\]/i);c&&(e=e.replace(c[0],"["+(+c[1]+1)+"]"),a(o).attr(s[r],e)),c=null,(c=e.match(/n(\d+)/i))&&(e=e.replace(c[0],"n"+(+c[1]+1)),a(o).attr(s[r],e))}}}),a(this).hasClass("ontop")?a(".wpa_group-"+e,r).first().before(p):c.before(p),t(e),a.wpalchemy.trigger("wpa_copy",[p])}),a("[class*=docopy-]").each(function(){t(a(this).attr("class").match(/docopy-([a-zA-Z0-9_-]*)/i)[1])})});
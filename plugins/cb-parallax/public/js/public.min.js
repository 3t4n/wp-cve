"use strict";(function(c){var d=true===/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?"1":"0";var b=null;function a(){this.document=c(document);this.window=c(window);this.html=c("html");this.body=c("body");this.adminbar=c("#wpadminbar");this.editorContainer=c("#wp-content-editor-container");this.cbParallax=Cb_Parallax_Public;this.defaultOptions={background_image_url:"",background_color:"",position_x:"center",position_y:"center",background_attachment:"fixed",can_parallax:"0",parallax_enabled:"0",direction:"vertical",vertical_scroll_direction:"top",horizontal_scroll_direction:"left",horizontal_alignment:"center",vertical_alignment:"center",overlay_image:"",image_width:c(window).innerWidth(),image_height:c(window).innerHeight(),overlay_path:"",overlay_opacity:"0.3",overlay_color:""};this.direction=undefined!==this.cbParallax.image_options.direction?this.cbParallax.image_options.direction:this.defaultOptions.direction;this.verticalScrollDirection=undefined!==this.cbParallax.image_options.vertical_scroll_direction?this.cbParallax.image_options.vertical_scroll_direction:this.defaultOptions.vertical_scroll_direction;this.horizontalScrollDirection=undefined!==this.cbParallax.image_options.horizontal_scroll_direction?this.cbParallax.image_options.horizontal_scroll_direction:this.defaultOptions.horizontal_scroll_direction;this.horizontalAlignment=undefined!==this.cbParallax.image_options.horizontal_alignment?this.cbParallax.image_options.horizontal_alignment:this.defaultOptions.horizontal_alignment;this.verticalAlignment=undefined!==this.cbParallax.image_options.vertical_alignment?this.cbParallax.image_options.vertical_alignment:this.defaultOptions.vertical_alignment;this.parallaxEnabled=undefined!==this.cbParallax.plugin_options.parallax_enabled?this.cbParallax.plugin_options.parallax_enabled:"0";this.allowOverride=undefined!==this.cbParallax.plugin_options.allow_override?this.cbParallax.plugin_options.allow_override:"0";this.disableOnMobile=undefined!==this.cbParallax.plugin_options.disable_on_mobile?this.cbParallax.plugin_options.disable_on_mobile:"0";this.canParallax=undefined!==this.cbParallax.image_options.can_parallax?this.cbParallax.image_options.can_parallax:"0";this.scrolling={preserved:undefined!==this.cbParallax.plugin_options.preserve_scrolling?this.cbParallax.plugin_options.preserve_scrolling:"0"};this.image={src:undefined!==this.cbParallax.image_options.background_image_url?this.cbParallax.image_options.background_image_url:this.defaultOptions.background_image_url,backgroundColor:undefined!==this.cbParallax.image_options.background_color?this.cbParallax.image_options.background_color:this.defaultOptions.background_color,positionX:undefined!==this.cbParallax.image_options.position_x?this.cbParallax.image_options.position_x:this.defaultOptions.position_x,positionY:undefined!==this.cbParallax.image_options.position_y?this.cbParallax.image_options.position_y:this.defaultOptions.position_y,backgroundAttachment:undefined!==this.cbParallax.image_options.background_attachment?this.cbParallax.image_options.background_attachment:this.defaultOptions.background_attachment,backgroundRepeat:undefined!==this.cbParallax.image_options.background_repeat?this.cbParallax.image_options.background_repeat:this.defaultOptions.background_repeat,width:undefined!==this.cbParallax.image_data.image_width?this.cbParallax.image_data.image_width:this.defaultOptions.image_width,height:undefined!==this.cbParallax.image_data.image_height?this.cbParallax.image_data.image_height:this.defaultOptions.image_height};this.overlay={path:undefined!==this.cbParallax.overlay_options.overlay_path?this.cbParallax.overlay_options.overlay_path:this.defaultOptions.overlay_path,image:undefined!==this.cbParallax.overlay_options.overlay_image?this.cbParallax.overlay_options.overlay_image:this.defaultOptions.overlay_image,opacity:undefined!==this.cbParallax.overlay_options.overlay_opacity?this.cbParallax.overlay_options.overlay_opacity:this.defaultOptions.overlay_opacity,color:undefined!==this.cbParallax.overlay_options.overlay_color?this.cbParallax.overlay_options.overlay_color:this.defaultOptions.overlay_color};this.imageAspectRatio=this.getBackgroundImageAspectRatio();this.context=null;this.canvas=null;this.canvasElement=null;this.img=null;this.canvas=null;this.parallaxfactor=1.2;b=this}a.prototype={init:function(){this.imports={polyfill:polyfill};this.imports={requestAnimationFrame:requestAnimationFrame};window.__forceSmoothScrollPolyfill__=true;polyfill();this.initBackground();this.addEvents()},initBackground:function(){if("parallax"===this.getBackgroundMode()){this.setupCanvas();var e=this;window.onload=function(){var f=e.getCanvasDimensions();e.canvas=document.getElementById("cb_parallax_canvas");e.context=e.canvas.getContext("2d");e.img=new Image();e.img.onload=function(){e.context.drawImage(this,0,0,f.x,f.y);e.initParallaxBackgroundImage()};e.img.src=e.image.src}}else{this.initStaticBackgroundImage()}},getBackgroundMode:function(){var e="static";if("1"===this.parallaxEnabled&&"1"===this.canParallax){e="parallax"}if("1"===d&&"1"===this.disableOnMobile){e="static"}return e},addEvents:function(){if("1"===this.canParallax&&"1"===this.parallaxEnabled){this.window.on("scroll",{context:this},this.parallaxOnScroll);this.window.on("resize",{context:this},this.parallaxOnResize)}else{this.window.on("resize",{context:this},this.staticBackgroundImageOnResize)}},initParallaxBackgroundImage:function(){this.setupOverlay();this.addCss();this.updateCanvasAlignment();this.updateParallaxAxis();this.doParallaxTranslate3DTransform(this.getParallaxTransform())},setupCanvas:function(){var e=this.getCanvasDimensions();this.body.prepend('<canvas id="cb_parallax_canvas" class="custom-background" width="'+e.x+'" height="'+e.y+'" style="background-color: '+this.image.backgroundColor+'"></canvas>');this.canvasElement=c("#cb_parallax_canvas")},setupCanvasJS:function(){var e=this.getCanvasDimensions();document.body.insertAdjacentHTML("afterbegin",'<canvas id="cb_parallax_canvas" class="custom-background" width="'+e.x+'" height="'+e.y+'" style="background-color: '+this.image.backgroundColor+'"></canvas>');this.canvasElement=c("#cb_parallax_canvas")},setupOverlay:function(){document.body.insertAdjacentHTML("afterbegin",'<div id="cb_parallax_overlay"></div>');this.overlayContainer=c("#cb_parallax_overlay");if("0.0"!==this.overlay.opacity&&"none"!==this.overlay.opacity){this.overlayContainer.css({opacity:this.overlay.opacity})}if(""!==this.overlay.color){this.overlayContainer.css({"background-color":this.overlay.color})}if("none"!==this.overlay.image){this.overlayContainer.css({background:"url("+this.overlay.path+this.overlay.image+")"})}},parallaxOnScroll:function(e){var f=this;if(undefined!==e){f=e.data.context}f.isScrolling="1";requestAnimationFrame(f.scrollParallaxBackgroundImage)},scrollParallaxBackgroundImage:function(){if("1"===b.isScrolling){b.doParallaxTranslate3DTransform(b.getParallaxTransform())}b.isScrolling="0";requestAnimationFrame(b.scrollParallaxBackgroundImage)},parallaxOnResize:function(e){var f=this;if(undefined!==e){f=e.data.context}f.isResizing="1";requestAnimationFrame(b.resizeParallaxBackgroundImage)},resizeParallaxBackgroundImage:function(){if("1"===b.isResizing){b.updateCanvasDimensions();b.updateCanvasAlignment();b.doParallaxTranslate3DTransform(b.getParallaxTransform());b.updateParallaxAxis()}b.isResizing="0";requestAnimationFrame(b.resizeParallaxBackgroundImage)},getBackgroundImageHorizontalAlignment:function(){var i=null;var e=this.getCanvasDimensions();var f=this.getViewportAspectRatio();var g=f>=this.imageAspectRatio?"1":"0";var h=f<this.imageAspectRatio?"1":"0";if("vertical"===this.direction){if("to top"===this.verticalScrollDirection){if("1"===g){switch(this.horizontalAlignment){case"left":i="0";break;case"center":i=(c(window).innerWidth()/2)-(e.x/2);break;case"right":i=c(window).innerWidth()-e.x;break}return parseInt(i)+"px"}else{if("1"===h){switch(this.horizontalAlignment){case"left":i="0";break;case"center":i=(c(window).innerWidth()/2)-(e.x/2);break;case"right":i=c(window).innerWidth()-e.x;break}return parseInt(i)+"px"}}}else{if("to bottom"===this.verticalScrollDirection){if("1"===g){switch(this.horizontalAlignment){case"left":i="0";break;case"center":i=(c(window).innerWidth()/2)-(e.x/2);break;case"right":i=c(window).innerWidth()-e.x;break}return parseInt(i)+"px"}else{if("1"===h){switch(this.horizontalAlignment){case"left":i="0";break;case"center":i=(c(window).innerWidth()/2)-(e.x/2);break;case"right":i=c(window).innerWidth()-e.x;break}return parseInt(i)+"px"}}}}}},updateCanvasAlignment:function(){if("vertical"===this.direction){this.canvasElement.css({left:this.getBackgroundImageHorizontalAlignment()})}else{if("horizontal"===this.direction){this.canvasElement.css({top:this.getBackgroundImageVerticalAlignment()})}}},getBackgroundImageVerticalAlignment:function(){var h=null;var e=this.getCanvasDimensions();var f=this.getViewportAspectRatio();var g=f>=this.imageAspectRatio?"1":"0";var i=f<this.imageAspectRatio?"1":"0";if("horizontal"===this.direction){if("to the left"===this.horizontalScrollDirection){if("1"===g){switch(this.verticalAlignment){case"top":h="0";break;case"center":h=(c(window).innerHeight()/2)-(e.y/2);break;case"bottom":h=c(window).innerHeight()-e.y;break}return parseInt(h)+"px"}else{if("1"===i){switch(this.verticalAlignment){case"top":h="0";break;case"center":h=(c(window).innerHeight()/2)-(e.y/2);break;case"bottom":h=-c(window).innerHeight()+e.y;break}return parseInt(h)+"px"}}}else{if("to the right"===this.horizontalScrollDirection){if("1"===g){switch(this.verticalAlignment){case"top":h="0";break;case"center":h=(c(window).innerHeight()/2)-(e.y/2);break;case"bottom":h=c(window).innerHeight()-e.y;break}return parseInt(h)+"px"}else{if("1"===i){switch(this.verticalAlignment){case"top":h="0";break;case"center":h=(c(window).innerHeight()/2)-(e.y/2);break;case"bottom":h=c(window).innerHeight()-e.y;break}return parseInt(h)+"px"}}}}}},updateParallaxAxis:function(){if("vertical"===this.direction){if("to bottom"===this.verticalScrollDirection){this.canvasElement.css({position:"fixed",top:this.getBackgroundImageVerticalPositionInPx()})}}else{if("horizontal"===this.direction){this.canvasElement.css({position:"fixed",left:this.getBackgroundImageHorizontalPositionInPx()})}}},getParallaxTransform:function(){var e={x:null,y:null};var f=this.getParallaxScrollRatio();var g=c(window).scrollTop();if("vertical"===this.direction){if("to top"===this.verticalScrollDirection){e.x=0;e.y=-g*f}else{if("to bottom"===this.verticalScrollDirection){e.x=0;e.y=g*f}}}else{if("horizontal"===this.direction){if("to the left"===this.horizontalScrollDirection){e.x=-g*f;e.y=0}else{if("to the right"===this.horizontalScrollDirection){e.x=g*f;e.y=0}}}}return e},getParallaxScrollRatio:function(){var e=this.getCanvasDimensions();var g=null;var f=null;var h=null;var i=null;if("vertical"===this.direction){g=c(document).innerHeight()-c(window).innerHeight();f=e.y-c(window).height();i=(f/g)}else{if("horizontal"===this.direction){g=c(document).innerHeight()-c(window).innerHeight();h=e.x-c(window).innerWidth();i=(h/g)}}return i},doParallaxTranslate3DTransform:function(e){this.canvasElement.css({"-webkit-transform":"translate3d("+e.x+"px, "+e.y+"px, 0px)","-moz-transform":"translate3d("+e.x+"px, "+e.y+"px, 0px)","-ms-transform":"translate3d("+e.x+"px, "+e.y+"px, 0px)","-o-transform":"translate3d("+e.x+"px, "+e.y+"px, 0px)",transform:"translate3d("+e.x+"px, "+e.y+"px, 0px)"})},getViewportDimensions:function(){return{height:c(window).innerHeight(),width:c(window).innerWidth()}},getCanvasDimensions:function(){var h=this.window.innerWidth()/this.window.innerHeight();var g=this.image.width/this.image.height;var e=0;var f=0;if("vertical"===this.direction){if(g<h){f=this.window.innerWidth();e=f/this.image.width*this.image.height;return{x:(f).toFixed(0),y:(e).toFixed(0)}}else{e=this.window.innerHeight()*this.parallaxfactor;f=e/this.image.height*this.image.width;return{x:(f).toFixed(0),y:(e).toFixed(0)}}}if("horizontal"===this.direction){if(g<h){f=this.window.innerWidth()*this.parallaxfactor;e=f/this.image.width*this.image.height;return{x:(f).toFixed(0),y:(e).toFixed(0)}}else{e=this.window.innerHeight();f=e/this.image.height*this.image.width;return{x:(f).toFixed(0),y:(e).toFixed(0)}}}},updateCanvasDimensions:function(){var e=this.getCanvasDimensions();this.canvasElement.width(parseInt(e.x));this.canvasElement.height(parseInt(e.y))},initStaticBackgroundImage:function(){this.setupOverlay();this.addCss();this.setupStaticBackgroundImageContainer()},setupStaticBackgroundImageContainer:function(){var e=this.getStaticBackgroundImageDimensions();this.body.css({background:"url("+this.image.src+")","background-size":e.width+"px "+e.height+"px","background-position":this.image.positionX+" "+this.image.positionY,"background-attachment":this.image.backgroundAttachment,"background-repeat":this.image.backgroundRepeat})},staticBackgroundImageOnResize:function(e){var f=this;if(undefined!==e){f=e.data.context}f.isResizing="1";requestAnimationFrame(b.updateStaticBackgroundImageAlignment)},updateStaticBackgroundImageAlignment:function(){if("1"===b.isResizing){b.updateStaticBackgroundImageDimensions()}b.isResizing="0";requestAnimationFrame(b.updateStaticBackgroundImageAlignment)},updateStaticBackgroundImageDimensions:function(){var e=this.getStaticBackgroundImageDimensions();this.body.css({"background-size":e.width+"px "+e.height+"px"})},getStaticBackgroundImageDimensions:function(){var e=this.getViewportDimensions();var f={};if(this.getViewportAspectRatio()>=this.imageAspectRatio){f.width=e.width;f.height=f.width/this.imageAspectRatio;return(f)}else{f.height=e.height;f.width=f.height*this.imageAspectRatio;return f}},addCss:function(){this.body.removeClass("custom-background");this.body.removeProp("background-image")},getBackgroundImageHorizontalPositionInPx:function(){var f=null;var e=this.getCanvasDimensions();if("to the left"===this.horizontalScrollDirection){f="0";return parseInt(f)+"px"}else{if("to the right"===this.horizontalScrollDirection){f=c(window).innerWidth()-e.x;return parseInt(f)+"px"}}},getBackgroundImageVerticalPositionInPx:function(){var f=null;var e=this.getCanvasDimensions();if("to top"===this.verticalScrollDirection){f="0";return parseInt(f)+"px"}else{if("to bottom"===this.verticalScrollDirection){f=c(window).innerHeight()-e.y;return parseInt(f)+"px"}}},getBackgroundImageAspectRatio:function(){return this.image.width/this.image.height},getViewportAspectRatio:function(){return c(window).innerWidth()/c(window).innerHeight()}};c(document).one("ready",function(){if("none"!==Cb_Parallax_Public.image_source.source){var e=new a();e.init()}})})(jQuery);
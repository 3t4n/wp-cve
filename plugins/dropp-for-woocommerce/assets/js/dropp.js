jQuery((function(o){function n(n){o(n).block({message:null,overlayCSS:{background:"#fff",opacity:.6}})}_dropp.location_selected;var t=!1;function e(n,e,r){if("undefined"==typeof chooseDroppLocation)return o(".dropp-error").show().text(_dropp.i18n.error_loading),void o(".dropp-location__button").hide();t||(t=!0,chooseDroppLocation().then((function(t){if(!t||!t.id)return o(".dropp-error").show().text(_dropp.i18n.error_loading),void o(".dropp-location__button").hide();e.text(t.name).show(),o.post(_dropp.ajaxurl,{action:"dropp_set_location",instance_id:n,location_id:t.id,location_name:t.name,location_address:t.address,location_pricetype:t.pricetype},r)})).finally((function(){return t=!1})))}var r=void 0;function c(){return r||(externalJsAdded=!0,(r=document.createElement("script")).src=_dropp.dropplocationsurl,r.dataset.storeId=_dropp.storeid,setTimeout((function(){return document.body.appendChild(r)}),10),r)}function i(n,t){if(!n.length)return o();var r=n.next();return r.length&&r.hasClass("dropp-location")||(r=o(_dropp.location_picker),n.after(r),r.find(".button").on("click",(function(n){n.preventDefault(),function(n){e(n,o(".dropp-location__name"),(function(){window.location.reload()}))}(t)}))),r}function p(){for(var o=function(){if(!window.wc||!window.wp)return[];var o=wc.wcBlocksData.CART_STORE_KEY;return wp.data.select(o).getShippingRates()}(),n=[],t=0;t<o.length;t++){var e=o[t].shipping_rates;n=n.concat(e)}return n}function a(){var n=p(),t=n.filter((function(o){return o.selected})),e=t.filter((function(o){return"dropp_is"===o.method_id||"dropp_is_oca"===o.method_id}));if(e.length)for(var r=0;r<e.length;r++){var c=e[r],a=1===n.length?o(".wc-block-components-shipping-rates-control .wc-block-components-radio-control__label-group"):o('[value="'+c.rate_id+'"]').closest(".wc-block-components-radio-control__option");if(!a.length)return;i(a,c.instance_id).show()}}function d(n){if(o(".dropp-location").hide(),n.shippingRateId){var t=n.shippingRateId.split(":");"dropp_is"!==t[0]&&"dropp_is_oca"!==t[0]||a()}}function l(n){n.preventDefault();var t=o("form.checkout"),r=o(this).closest(".dropp-location");e(r.data("instance_id"),r.find(".dropp-location__name"),(function(){return t.trigger("update_checkout")}))}function s(){o(".dropp-location").show(),o(".dropp-error").hide(),o(".dropp-location__button").on("click",l),o("#shipping_method").unblock()}if(document.querySelector(".wp-block-woocommerce-checkout")){if(!window.wp||!wp.hooks)return;c(),wp.hooks.addAction("woocommerce_blocks-checkout-set-selected-shipping-rate","dropp-for-woocommerce",d),wp.hooks.addAction("experimental__woocommerce_blocks-checkout-set-selected-shipping-rate","dropp-for-woocommerce",d);var u=setInterval((function(){var n=o(".wc-block-components-shipping-rates-control");n.length&&n.find(".wc-block-components-radio-control__option, .wc-block-components-radio-control__label-group").length&&(clearInterval(u),a())}),50)}else{var _=!1;n("#shipping_method"),c().onload=function(){s(),_=!0},o(document).on("updated_checkout",(function(){return _?s():n("#shipping_method")}))}}));
!function(t){tinymce.PluginManager.add("fmc",function(t,e){t.addButton("fmc_button",{text:!1,title:"FlexMLSÂ® Shortcode Generator",image:fmcAjax.pluginurl+"/assets/images/fbs_small.png",onclick:function(){var t=jQuery(window).height()-119;tb_show("FlexMLS&reg; Shortcode Generator","#TB_inline?width=753&height="+t+"&inlineId=fmc_shortcode_window"),jQuery("#TB_window").width(783)}})}),t(document).ready(function(){var e=t('<div id="fmc_shortcode_window" style="display: none;"></div>');e.appendTo("body"),t.post(ajaxurl,{action:"fmcShortcodeContainer"},function(o){t("#fmc_shortcode_window").html(o.body),e.find(".fmc_which_shortcode").click(function(){t(".flexmls_connect__widget_menu li").removeClass("fmc_selected_shortcode"),t(this).parent().addClass("fmc_selected_shortcode"),t("#fmc_shortcode_window_content").html('<p class="first">Loading...</p>');var e=t(this).attr("data-connect-shortcode");t.post(ajaxurl,{action:e+"_shortcode"},function(o){var c='<div class="flexmls-shorcode-generator">';if(c+='<form id="fmc-shortcode-generator" fmc-shortcode-form="true">',c+='<h3 id="fmc_box_title">'+o.title+"</h3>",c+=o.body,c+='<div class="flexmls-widget-settings-submit-row">',c+='<input type="button" class="fmc_shortcode_submit button-primary" value="Insert Widget">',c+="</div>",c+="</form>",c+="</div>",t("#fmc_shortcode_window_content").html(c),"fmcSearchResults"===e&&t("#fmc_shortcode_field_property_type").dependentDropdown("#fmc_shortcode_field_property_sub_type"),["fmcMarketStats","fmcPhotos","fmcLocationLinks","fmcSearchResults"].indexOf(e)>=0){new AdminLocationSearch(t("#fmc_shortcode_window_content form"))}t(".fmc_shortcode_submit").click(function(){var e;if(t('input[name="shortcode_to_use"]').length){e={action:"tinymce_shortcodes_generate",shortcode_to_use:t('input[name="shortcode_to_use"]').val(),shortcode_fields_to_catch:{}};var o=t('input[name="shortcode_fields_to_catch"]').val().split(",");t.each(o,function(c,n){e.shortcode_fields_to_catch[o[c]]=t("#widget-fmcleadgen--"+n).val()})}else{var c=t("input[name='widget']").val();e={action:c+"_shortcode_gen"};var n=t('input[name="shortcode_fields_to_catch"]').val(),o=n.split(",");t.each(o,function(){var o=this.trim(),c=t('[fmc-field="'+o+'"]'),n=c.val();value="","select"==c.attr("fmc-type")?n=t(":selected",c).map(function(){return t(this).val()}).get().join():"checkbox"==c.attr("fmc-type")&&(n=jQuery(':checked[fmc-field="'+o+'"]').map(function(){return jQuery(this).val()}).get().join()),e[o]=n})}t.post(ajaxurl,e,function(t){return tinyMCE.activeEditor.execCommand("mceInsertContent",0,t.body),tb_remove(),!1},"json")})},"json")})},"json")})}(jQuery);
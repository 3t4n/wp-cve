!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";let t=new Object;t={$:jQuery,action:{toast:null,cart:null},api:{event:null}},window.addonifyFloatingCart=t;const o=addonifyFloatingCartJSObject.ajax_url,e=addonifyFloatingCartJSObject.nonce,n=addonifyFloatingCartJSObject.ajax_refresh_cart_fragments,a=addonifyFloatingCartJSObject.ajax_update_cart_item_action,i=addonifyFloatingCartJSObject.ajax_remove_from_cart_action,d=addonifyFloatingCartJSObject.ajax_restore_in_cart_action,r="1"===addonifyFloatingCartJSObject.open_cart_modal_immediately_after_add_to_cart,c="1"===addonifyFloatingCartJSObject.open_cart_modal_after_click_on_view_cart,s="1"===addonifyFloatingCartJSObject.openCartModalOnTriggerButtonHover,l="1"===addonifyFloatingCartJSObject.hideTriggerButtonIfCartIsEmpty,p="1"===addonifyFloatingCartJSObject.addonifyFloatingCartNotifyShow,f=addonifyFloatingCartJSObject.addonifyFloatingCartNotifyDuration,u="1"===addonifyFloatingCartJSObject.addonifyFloatingCartNotifyDismissible,_=addonifyFloatingCartJSObject.toast_notification_display_position.split("-"),g="1"===addonifyFloatingCartJSObject.displayToastNotificationButton,h=addonifyFloatingCartJSObject.addonifyFloatingCartNotifyMessage,y=addonifyFloatingCartJSObject.toastNotificationButton,m=addonifyFloatingCartJSObject.ajax_apply_coupon,w=addonifyFloatingCartJSObject.ajax_remove_coupon,v=addonifyFloatingCartJSObject.updateShippingInfo,C=addonifyFloatingCartJSObject.updateShippingMethod,b=addonifyFloatingCartJSObject.shippingAddressUpdatable,E=addonifyFloatingCartJSObject.states;function F(t){if(!t)throw new Error("Spinner action is required!");const o=document.getElementById("adfy__woofc-spinner-container");o&&("show"===t?(o.classList.add("visible"),o.classList.remove("hidden")):(o.classList.add("hidden"),o.classList.remove("visible")))}addonifyFloatingCartJSObject.hideCartOnOverlayClicked;const{action:O}=t;const{$:j,action:S,api:A}=t;const T=async()=>{F("show");try{const{fragments:a}=await j.ajax({type:"POST",dataType:"json",url:o,data:{action:n,nonce:e}});if(!a)throw new Error("Fragments not fetched! aborting...");return j.each(a,(function(t,o){j(t).replaceWith(o)})),j(document).trigger("wc_update_cart"),t.api.event.cartUpdated(a),a}catch(t){return console.error(t),t}finally{F("hide")}},{$:M,api:k}=t;const{$:x}=t;function W(t){if(!t)throw new Error("Function [setShoppingMeterVisibility] requires action!");const o=x("#adfy__floating-cart .adfy__woofc-shipping-bar");o.length>0&&("hide"===t?o.addClass("adfy__woofc-hidden"):o.removeClass("adfy__woofc-hidden"))}function J(t){if(!t)throw new Error("Function [setTriggerButtonVisibility] requires action!");const o=document.getElementById("adfy__woofc-trigger");o&&o.hasAttribute("data_display")&&("hide"===t?o.setAttribute("data_display","hidden"):o.setAttribute("data_display","visible"))}const{$:q}=t;function D(){q(document).on("click",".adfy__woofc-prevent-default",(function(t){t.preventDefault()})),q(document).on("click",".adfy__show-woofc",(function(o){t.action.cart.open(o)})),q(document).on("mouseover",".adfy__show-woofc",(function(o){s&&t.action.cart.open(o)})),q(document).on("click",".added_to_cart.wc-forward",(function(o){c&&(o.preventDefault(),t.action.cart.open(o))})),q(document).on("click",".adfy__hide-woofc",(function(o){o.preventDefault(),t.action.cart.close(o)})),document.addEventListener("addonifyFloatingCartUpdated",(()=>{(()=>{const o=x("#adfy__floating-cart .adfy__woofc-shipping-bar .progress-bars .live-progress-bar");o&&(parseInt(o.attr("data_percentage"))>=100?(o.addClass("hide-animation"),t.api.event.shoppingMeterThresholdReached()):o.removeClass("hide-animation"))})()})),document.addEventListener("addonifyFloatingCartItemRestored",(()=>{l&&J("show")}))}const{$:U}=t;let L;function I(t="hide",o="info",e=""){const n=U("#adfy__floating-cart #adfy__woofc-cart-errors"),a=()=>{L&&clearTimeout(L),n.hasClass("error")&&n.removeClass("error"),n.html(" ").addClass("hidden")};"hide"===t?a():e.length>0&&(L&&clearTimeout(L),"error"===o&&n.addClass("error"),n.html(" ").html(e).removeClass("hidden"),L=setTimeout((()=>a()),1e4))}function R(t,o=null){if(!t)throw new Error("Coupon alert action is required!");let e=U("#adfy__floating-cart .adfy__woofc-alert");const n=()=>{let t;clearTimeout(t),t=setTimeout((()=>{U(e).fadeOut(),clearTimeout(t)}),1e4)};if("hide"!==t){if(e.length>0){const t={success:'<svg fill="currentColor" viewBox="0 0 16 16"><path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8 4a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0l.35-3.507A.905.905 0 0 0 8 4zm.002 6a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/></svg>',error:'<svg fill="currentColor" viewBox="0 0 16 16"><path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8 4a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0l.35-3.507A.905.905 0 0 0 8 4zm.002 6a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/></svg>'};if(!o)throw new Error("Coupon alert data is required!");const{style:e,message:a}=o;if(!e||!a)throw new Error("Coupon alert style & message is required!");let i;switch(e){case"success":i=`<p class="adfy__woofc-alert-text">\n                        ${t.success}\n                        ${a}\n                    </p>`,U(".adfy__woofc-alert.success").html(" ").html(i).fadeIn(),n();break;case"error":i=`<p class="adfy__woofc-alert-text">\n                        ${t.error}\n                        ${a}\n                    </p>`,U(".adfy__woofc-alert.error").html(" ").html(i).fadeIn(),n()}}}else n()}function P(){clearTimeout(L);let t=document.getElementById("adfy__woofc-coupon-alerts");t&&t.hasChildNodes()&&(L=setTimeout((function(){U("#adfy__woofc-coupon-alerts").html("")}),1e4))}function $(t="hide",o=null){if("string"!=typeof t)throw new Error("Colophon visibility must be a string value.");const e=document.querySelector(".adfy__woofc-colophon"),n=document.querySelector(".adfy__woofc-cart-summary ul li.discount"),a=document.querySelector(".adfy__woofc-cart-summary ul li.sub-total"),i="adfy__woofc-hidden";if(e&&("show"===t?e.classList.remove(i):e.classList.add(i)),e&&"show"===t){const{discountVisibility:t,subTotalVisibility:e}=o;n&&t&&("show"===t?n.classList.remove(i):n.classList.add(i)),a&&("show"===e?a.classList.remove(i):a.classList.add(i))}}const{$:N}=t;function B(){N(document).on("added_to_cart",(function(o,e){o.preventDefault(),r&&t.action.cart.open(o),l&&J("show"),p&&function(o){if(!o||"object"!=typeof o)throw new Error("Toast message data invalid!");if(o&&"object"==typeof o){let e,n;n=Object.hasOwn(o,"product")?o.product.charAt(0).toUpperCase()+o.product.slice(1):__("Product","addonify-floating-cart"),e=g?h.replace("{product_name}",n)+" "+y:h.replace("{product_name}",n),t.action.toast.dispatch("success",e)}}(e),I("hide"),W("show"),$("show",{discountVisibility:"show",subTotalVisibility:"show"}),t.api.event.cartUpdated(e)})),N(document).on("wc_cart_emptied",(function(o){l&&J("hide"),W("hide"),$("hide"),t.api.event.cartUpdated(o)}))}const V=()=>{const t=document.getElementById("adfy__woofc-scrollbar"),o=t.classList.contains("ps");t&&!o&&new PerfectScrollbar(t,{wheelSpeed:1,wheelPropagation:!0,minScrollbarLength:20})},{$:z}=t,{__:Q}=wp.i18n;function H(n,i,d=1){if(!n)throw new Error("Function [updateCartViaAjax] requires current element!");if(!i)throw new Error("Function [updateCartViaAjax] requires action!");let r;switch(i){case"add":r=z(n).next();break;case"sub":r=z(n).prev();break;default:r=z(n)}let c=z(n).attr("data-product_id"),s=z(n).attr("data-cart_item_key"),l=z(n).parents(".adfy__woofc-item");F("show"),z.ajax({type:"POST",dataType:"json",url:o,data:{action:a,product_id:c,cart_item_key:s,nonce:e,type:i,quantity:d},success:function(o){if(!o||o.error)throw new Error("Error updating cart via AJAX!");let e=o.fragments;e&&z.each(e,(function(t,o){z(t).replaceWith(o)}));let n=o.nQuantity;"OoS"===n?(alert("Out of stock range"),r.val(n)):"nil"!==n&&r.val(n),l.find(z(".adfy__woofc-item-price-multiplier-quantity")).html(n),l.unblock(),z(document.body).trigger("wc_update_cart"),t.api.event.cartUpdated(o)},error:function(o){const{__:e}=wp.i18n,n=e("Error processing cart update request!","addonify-floating-cart");throw t.action.toast.dispatch("error",n),new Error(o)},complete:function(){F("hide")}})}const{$:X}=t;const{$:G}=t;function K(){G(document).on("click","#adfy__woofc-shipping-trigger",(function(o){o.preventDefault(),G("#adfy__woofc-shipping-container").attr("data_display","visible"),t.api.event.shippingModalOpened(),"1"===b&&(G("#addonify_floating_cart_shipping_country").length&&G("#addonify_floating_cart_shipping_country").selectWoo({dropdownAutoWidth:!1,dropdownCssClass:"afc-selectWoo-dropdown"}),G("select#addonify_floating_cart_shipping_state")&&G("select#addonify_floating_cart_shipping_state").selectWoo({dropdownAutoWidth:!1,dropdownCssClass:"afc-selectWoo-dropdown"}))})),G(document).on("click","#adfy__woofc-hide-shipping-container",(function(o){o.preventDefault(),G("#adfy__woofc-shipping-container").attr("data_display","hidden"),t.api.event.shippingModalClosed()})),G(document).on("change","#addonify_floating_cart_shipping_country",(function(t){let o=G(this).val(),e=G("#addonify_floating_cart_shipping_state"),n=E[o];if(e.siblings("span.select2").remove(),"object"==typeof n&&Object.keys(n).length>0){let t="";for(let o in n)t+='<option value="'+o+'">'+n[o]+"</option>";if("input"===e.prop("tagName").toLowerCase()){let t=e.parent();e.remove();let o=G(document.createElement("select"));o.addClass("state_select").prop("id","addonify_floating_cart_shipping_state").prop("name","addonify_floating_cart_shipping_state"),o.prop("data-placeholder","State / County"),t.append(o),G(document).on("change","#addonify_floating_cart_shipping_country",(function(t){t.preventDefault(),"1"===b&&G("select#addonify_floating_cart_shipping_state")&&G("select#addonify_floating_cart_shipping_state").selectWoo({dropdownAutoWidth:!1,dropdownCssClass:"afc-selectWoo-dropdown"})}))}G("#addonify_floating_cart_shipping_state").html(t)}else if(n instanceof Array&&0===n.length){let t=e.parent();e.remove();let o=G(document.createElement("input"));o.addClass("input_text").prop("id","addonify_floating_cart_shipping_state").prop("name","addonify_floating_cart_shipping_state"),o.prop("type","hidden"),t.append(o)}else{let t=e.parent();e.remove();let o=G(document.createElement("input"));o.addClass("input_text").prop("id","addonify_floating_cart_shipping_state").prop("name","addonify_floating_cart_shipping_state"),o.prop("placeholder","State / County"),t.append(o)}}))}function Y(){G(document).on("submit","#adfy__woofc-shipping-form",(function(e){e.preventDefault(),F("show");let n=G("#addonify_floating_cart_shipping_country").val(),a=G("#addonify_floating_cart_shipping_state").val(),i=G("#addonify_floating_cart_shipping_city").val(),d=G("#addonify_floating_cart_shipping_postcode").val(),r=G("#addonify-floating-cart-shipping-nonce").val();const{__:c}=wp.i18n;let s=c("Error updating shipping address!.","addonify-floating-cart");G.ajax({url:o,method:"POST",data:{action:v,calc_shipping_country:n,calc_shipping_state:a,calc_shipping_city:i,calc_shipping_postcode:d,nonce:r},success:function(o){o?(o.fragments&&(G.each(o.fragments,(function(t,o){""!==o?G(t).replaceWith(o):G(t).html(o)})),t.api.event.shippingAddressUpdated(o.fragments)),G("#adfy__woofc-shipping-container").attr("data_display","visible"),"1"===b&&(G("#addonify_floating_cart_shipping_country").length&&G("#addonify_floating_cart_shipping_country").selectWoo({dropdownAutoWidth:!1,dropdownCssClass:"afc-selectWoo-dropdown"}),G("select#addonify_floating_cart_shipping_state")&&G("select#addonify_floating_cart_shipping_state").selectWoo({dropdownAutoWidth:!1,dropdownCssClass:"afc-selectWoo-dropdown"}))):t.action.toast.dispatchToast("error",s)},error:function(o){console.log(o),t.action.toast.dispatchToast("error",s)},complete:function(){F("hide")}})}))}function Z(){G(document).on("change",".shipping_method",(function(n){const{__:a}=wp.i18n;let i=new Object,d=a("Error processing shipping method update request.","addonify-floating-cart");G("select.shipping_method, :input[name^=shipping_method][type=radio]:checked, :input[name^=shipping_method][type=hidden]").each((function(){i[G(this).data("index")]=G(this).val()})),F("show"),G.ajax({url:o,method:"POST",data:{action:C,nonce:e,shipping_method:i},success:function(o){if(!o||o.error)return void t.action.toast.dispatch("error",d);let e=o.fragments;e&&G.each(e,(function(t,o){""!==o?G(t).replaceWith(o):G(t).html(o)})),G("#adfy__woofc-shipping-container").attr("data_display","visible"),"1"===b&&(G("#addonify_floating_cart_shipping_country").length&&G("#addonify_floating_cart_shipping_country").selectWoo({dropdownAutoWidth:!1,dropdownCssClass:"afc-selectWoo-dropdown"}),G("select#addonify_floating_cart_shipping_state")&&G("select#addonify_floating_cart_shipping_state").selectWoo({dropdownAutoWidth:!1,dropdownCssClass:"afc-selectWoo-dropdown"}))},error:function(o){console.log(o),t.action.toast.dispatch("error",d)},complete:function(){F("hide")}})}))}document.addEventListener("DOMContentLoaded",(function(){(()=>{if("function"!=typeof PerfectScrollbar)return void console.warn("Info: Addonify Floating Cart, PerfectScrollbar is not defined. Perfect scroll bar won't be initialized.");const t=document.getElementById("adfy__floating-cart");new MutationObserver((t=>{t.length>0&&V()})).observe(t,{attributes:!1,childList:!0,subtree:!0})})()})),function(n){S.cart={open:t=>{t.preventDefault(),j("body").addClass("adfy__woofc-visible"),A.event.cartOpened(t)},close:t=>{t.preventDefault(),j("body").removeClass("adfy__woofc-visible"),A.event.cartClosed(t)},refresh:()=>{T()}},k.event={cartOpened:t=>{M(document).trigger("addonifyFloatingCartOpened"),document.dispatchEvent(new CustomEvent("addonifyFloatingCartOpened"))},cartClosed:t=>{M(document).trigger("addonifyFloatingCartClosed"),document.dispatchEvent(new CustomEvent("addonifyFloatingCartClosed"))},cartUpdated:t=>{M(document).trigger("addonifyFloatingCartUpdated",t),document.dispatchEvent(new CustomEvent("addonifyFloatingCartUpdated",{detail:t}))},cartEmptied:()=>{M(document).trigger("addonifyFloatingCartEmptied"),document.dispatchEvent(new CustomEvent("addonifyFloatingCartEmptied")),M(document).trigger("wc_cart_emptied")},productRemoved:o=>{M(document).trigger("addonifyFloatingCartProductRemoved",o),document.dispatchEvent(new CustomEvent("addonifyFloatingCartProductRemoved",{detail:o})),t.api.event.cartUpdated(data)},productRestored:o=>{M(document).trigger("addonifyFloatingCartProductRestored",o),document.dispatchEvent(new CustomEvent("addonifyFloatingCartProductRestored",{detail:o})),t.api.event.cartUpdated(o)},couponModalOpened:()=>{M(document).trigger("addonifyFloatingCartCouponModalOpened"),document.dispatchEvent(new CustomEvent("addonifyFloatingCartCouponModalOpened"))},couponModalClosed:()=>{M(document).trigger("addonifyFloatingCartCouponModalClosed"),document.dispatchEvent(new CustomEvent("addonifyFloatingCartCouponModalClosed"))},couponApplied:o=>{M(document).trigger("addonifyFloatingCartCouponApplied",o),document.dispatchEvent(new CustomEvent("addonifyFloatingCartCouponApplied",{detail:o})),t.api.event.cartUpdated(o)},couponRemoved:o=>{M(document).trigger("addonifyFloatingCartCouponRemoved",o),document.dispatchEvent(new CustomEvent("addonifyFloatingCartCouponRemoved",{detail:o})),t.api.event.cartUpdated(o)},shippingModalOpened:()=>{M(document).trigger("addonifyFloatingCartShippingModalOpened"),document.dispatchEvent(new CustomEvent("addonifyFloatingCartShippingModalOpened"))},shippingModalClosed:()=>{M(document).trigger("addonifyFloatingCartShippingModalClosed"),document.dispatchEvent(new CustomEvent("addonifyFloatingCartShippingModalClosed"))},shippingAddressUpdated:o=>{M(document).trigger("addonifyFloatingCartShippingAddressUpdated",o),document.dispatchEvent(new CustomEvent("addonifyFloatingCartShippingAddressUpdated",{detail:o})),t.api.event.cartUpdated(o)},shoppingMeterThresholdReached:()=>{M(document).trigger("addonifyFloatingCartShoppingMeterThresholdReached"),document.dispatchEvent(new CustomEvent("addonifyFloatingCartShoppingMeterThresholdReached"))}},O.toast={dispatch:(t="success",o)=>{if("undefined"!=typeof Notyf){let e=new Notyf({duration:f,dismissible:u,ripple:!0,position:{x:_[1],y:_[0]}});if(!o)throw new Error("Notification toast data/message is empty, bailing out...");"error"===t&&e.error({className:"adfy__woofc-notfy-error",message:o}),p&&"success"===t&&e.success({className:"adfy__woofc-notfy-success",message:o})}}},n(document).ready((function(){T(),D(),B(),z(document).on("click",".adfy__woofc-item .adfy__woofc-inc-quantity",(function(t){t.preventDefault();const o=z(this).prev();(parseInt(o.val())<parseInt(o.attr("max"))||""===o.attr("max"))&&H(this,"add")})),z(document).on("click",".adfy__woofc-item .adfy__woofc-dec-quantity",(function(t){t.preventDefault();const o=z(this).next();parseInt(o.val())<=parseInt(o.attr("min"))||H(this,"sub")})),z(document).on("change",".adfy__woofc-item .adfy__woofc-quantity-input-field",(function(t){t.preventDefault(),H(this,"update",z(this).val())})),z(document).on("click",".adfy__woofc-item .thumb .product-remove",(function(n){n.preventDefault();const a=z(this).attr("data-product_id"),d=z(this).attr("data-cart_item_key"),r=z(this);F("show"),z.ajax({type:"POST",dataType:"json",url:o,data:{action:i,product_id:a,cart_item_key:d,nonce:e},success:function(o){if(!o||o.error)throw new Error("Error removing product from cart!");z(".post-"+a).find("a.wc-forward").remove(),z(".post-"+a).find("a.add_to_cart_button").removeClass("added");let e=o.fragments;e&&z.each(e,(function(t,o){z(t).replaceWith(o)})),I("show","info",o.undo_product_link),0===o.cart_items_count&&(t.api.event.cartEmptied(),z(".adfy__woofc-content-entry").html(o.empty_cart_message)),z(document).trigger("removed_from_cart",[o.fragments,o.cart_hash,r]),z(document).trigger("wc_update_cart"),t.api.event.cartUpdated(o)},error:function(o){console.log(o);const e=Q("Error processing product removal request!","addonify-floating-cart");t.action.toast.dispatch("error",e)},complete:function(){F("hide")}})})),z(document).on("click","#adfy__woofc_restore_item",(function(n){n.preventDefault();const a=z(this).attr("data-item_key");F("show"),z.ajax({type:"POST",dataType:"json",url:o,data:{action:d,cart_item_key:a,nonce:e},success:function(o){if(!o.fragments||o.error)throw new Error("Error restoring product to cart!");const e=o.fragments,n=z(".adfy__woofc-colophon"),a=z(".adfy__woofc-shipping-bar");e&&z.each(e,(function(t,o){z(t).replaceWith(o)})),n.hasClass("adfy__woofc-hidden")&&n.removeClass("adfy__woofc-hidden"),a.hasClass("adfy__woofc-hidden")&&a.removeClass("adfy__woofc-hidden"),t.api.event.productRestored(e),I("hide")},error:function(o){console.log(o);const e=Q("Error processing product restore request!","addonify-floating-cart");t.action.toast.dispatch("error",e)},complete:function(){F("hide")}})})),function(){const o=X("#adfy__woofc-coupon-container");X(document).on("click","#adfy__woofc-coupon-trigger",(function(e){e.preventDefault(),o.attr("data_display","visible"),t.api.event.couponModalOpened()})),X(document).on("click","#adfy__woofc-hide-coupon-container",(function(e){e.preventDefault(),o.attr("data_display","hidden"),t.api.event.couponModalClosed()}))}(),function(){const{__:n}=wp.i18n;let a;X(document).on("submit","#adfy__woofc-coupon-form",(function(i){i.preventDefault(),F("show");let d=X(this).find("input[name=adfy__woofc-coupon-input-field]"),r=d.val();X.ajax({url:o,method:"post",data:{action:m,nonce:e,form_data:r},success:function(o){if(!o)return a=n("Error processing coupon request.","addonify-floating-cart"),void R("show",{style:"error",message:a});const{couponApplied:e,html:i}=o;e&&(d.val(""),t.api.event.couponApplied(o)),X.each(i,(function(t,o){X(t).replaceWith(o)})),P()},error:function(o){console.log(o),a=n("Error processing coupon request.","addonify-floating-cart"),t.action.toast.dispatch("error",a),R("show",{style:"error",message:a})},complete:function(){F("hide")}})}))}(),function(){const{__:n}=wp.i18n;let a;X(document).on("click",".adfy__woofc-remove-applied-coupon-button",(function(i){i.preventDefault(),F("show");let d=X(this).closest("li"),r=X(this).attr("data-coupon");X.ajax({url:o,method:"post",data:{action:w,nonce:e,form_data:r},success:function(o){if(!o)return a=n("Error processing coupon request.","addonify-floating-cart"),void R("show",{style:"error",message:a});const{couponRemoved:e,html:i}=o;e&&(d.remove(),t.api.event.couponRemoved(o)),X.each(i,(function(t,o){X(t).replaceWith(o)})),P()},error:function(t){console.log(t),a=n("Error processing coupon request.","addonify-floating-cart"),R("show",{style:"error",message:a})},complete:function(){F("hide")}})}))}(),K(),Y(),Z()}))}(jQuery)}));

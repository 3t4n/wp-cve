jQuery.noConflict(),function(a){"use strict";function e(b){"end"==b?a(".hybgl-tmpl-title-loader").removeClass("hybgl-tmpl-title-loader-active"):a(".hybgl-tmpl-title-loader").addClass("hybgl-tmpl-title-loader-active")}function f(b,c){a(".hybgl-popup-mask").addClass("hybgl-popup-mask-active"),"loading"==c&&a(".hybgl-popup-loader").addClass("hybgl-popup-loader-active"),b&&"loaded"==c&&(a(".hybgl-popup-loader").removeClass("hybgl-popup-loader-active"),a(".hybgl-popup").addClass("hybgl-popup-active"),a(".hybgl-popup").find(".hybgl-popup-content").html(b),a(".hybgl-popup").find(".hybgl-popup-close").click(function(){a(".hybgl-popup").removeClass("hybgl-popup-active"),a(".hybgl-popup-mask").removeClass("hybgl-popup-mask-active")})),"close"==c&&(a(".hybgl-popup-loader").removeClass("hybgl-popup-loader-active"),a(".hybgl-popup").removeClass("hybgl-popup-active"),a(".hybgl-popup-mask").removeClass("hybgl-popup-mask-active"))}function g(){a(document).on("click",".hybgl-media-button",function(){var d=a(this).closest(".wp-editor-wrap").find(".wp-editor-area").attr("id");d||(d="content"),a(".hybgl-popup-editor").text(d),f("","loading"),a.ajax({type:"POST",dataType:"html",url:b,cache:!1,data:{action:"hybrid_gallery_sc_layouts",nonce:c,editor:d},success:function(a){f(a,"loaded")},error:function(){f("","close")}})})}function h(){a(".hybgl-sc-tmpl-list").find(".hybgl-sc-tmpl-name").click(function(){e();var d=a(this).parent().find(".hybgl-sc-tmpl-code").html(),g=a(this).parent().find(".hybgl-sc-tmpl-code").data("panel");d=d.replace(/\\/g,""),d=d.replace(/^\[|\]$/g,""),d=d.split(" ");var h={};for(var i in d)/\w+=".+"/.test(d[i])&&(h[d[i].replace(/=".+/g,"")]=d[i].replace(/^\w+="|"$/g,""));a.ajax({type:"POST",dataType:"html",url:b,cache:!1,data:{action:"hybrid_gallery_sc_tmpl_set",panel:g,nonce:c,atts:h},success:function(b){a(".hybgl-sc-tmpl-box").removeClass("hybgl-sc-tmpl-box-active"),e("end"),f(b,"loaded")},error:function(){f("","close")}})}),a(".hybgl-sc-tmpl-list").find(".hybgl-sc-tmpl-del").click(function(){var d=a(this);e(),a.ajax({type:"POST",dataType:"html",url:b,cache:!1,data:{action:"hybrid_gallery_sc_tmpl_del",nonce:c,id:d.data("id")},success:function(a){d.parent().remove(),e("end")}})})}function i(){var d=a(".hybgl-sc-tmpl-box");a(document).bind("click",function(a){d.is(a.target)||0!==d.has(a.target).length||d.removeClass("hybgl-sc-tmpl-box-active")}),a(".hybgl-popup").find(".hybgl-tmpl-title-button").click(function(){d.hasClass("hybgl-sc-tmpl-box-active")?d.removeClass("hybgl-sc-tmpl-box-active"):(e(),a.ajax({type:"POST",dataType:"html",url:b,cache:!1,data:{action:"hybrid_gallery_sc_tmpl_list",nonce:c},success:function(a){d.addClass("hybgl-sc-tmpl-box-active").html(a),h(),e("end")}}))})}function j(g,h,i){var j="hybrid_gallery_"+i;h[j]={shortcode_data:{},template:g.template("editor-hybrid-gallery-template-"+i),getContent:function(){var a=this.shortcode.attrs.named;return this.template(a)},bindNode:function(e,f){var h=this.text,i=this.shortcode.attrs.named,j=a(f).closest("body").data("id"),k=a("#"+j+"_ifr");j||(j="content"),a.ajax({type:"POST",dataType:"html",url:b,cache:!1,data:{action:"hybrid_gallery_sc_attachments",nonce:c,ids:i.ids},success:function(b){var c=a(k).contents().find(".hybgl-wpview > .hybgl-wpview");c.html&&void 0!==c.html&&(c.parent().replaceWith(c),c.next().remove(),c.next().next().remove()),a(f).find(".hybgl-media-visual-images").html(b)}}),a(f).on("click",".hybgl-media-visual-button-edit",function(){a(".hybgl-popup-editor").text(j),alert("This is a PRO feature! Please upgrade.")}),a(f).on("click",".hybgl-media-visual-button-copy",function(){var b=a(".hybgl-shortcode-prop");b.prepend('<textarea class="hybgl-sc-copy-code">'+h+"</textarea>"),document.execCommand("copy",!1,a(".hybgl-sc-copy-code").select()),alert(d),b.html("")}),a(f).on("click",".hybgl-media-visual-button-remove",function(){a(this).closest(".hybgl-media-visual").remove(),g.editor.insert("")})},replaceMarkers:function(){this.getMarkers(function(b,c){var e,d=c===b.selection.getNode();if(!this.loader&&a(c).text()!==this.text)return void b.dom.setAttrib(c,"data-wpview-marker",null);e=b.$('<div class="hybgl-wpview" contenteditable="false" data-wpview-text="'+this.encodedText+'" data-wpview-type="'+this.type+'"><p class="wpview-selection-before"> </p><div class="wpview-body" contenteditable="false"><div class="wpview-content wpview-type-'+this.type+'"></div></div><p class="wpview-selection-after"> </p></div>'),b.$(c).replaceWith(e),d&&b.wp.setViewCursor(!1,e[0])})},popup_window:function(d,g,h){h=h||[],"sc-add"==d&&(e(),f(),a.ajax({type:"POST",dataType:"html",url:b,cache:!1,data:{action:"hybrid_gallery_sc_add",panel:i,layout:g,nonce:c},success:function(a){e("end"),f(a,"loaded")},error:function(){f("","close")}}))}},h.views.register(j,h[j])}var b=hybrid_gallery_ajax_request.ajaxUrl,c=hybrid_gallery_ajax_request.nonce,d=hybrid_gallery_ajax_request.copyText;a(document).ready(function(){["grid","carousel","slider"].forEach(function(a,b){j(wp.media,wp.mce,a)}),i(),g()})}(jQuery);
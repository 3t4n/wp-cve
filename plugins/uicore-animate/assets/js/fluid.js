"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(n){var r=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(n);return _possibleConstructorReturn(this,r?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return a};var l,a={},e=Object.prototype,c=e.hasOwnProperty,u=Object.defineProperty||function(e,t,n){e[t]=n.value},t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",n=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(l){o=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var i,o,a,s,t=t&&t.prototype instanceof y?t:y,t=Object.create(t.prototype),r=new A(r||[]);return u(t,"_invoke",{value:(i=e,o=n,a=r,s=h,function(e,t){if(s===v)throw new Error("Generator is already running");if(s===b){if("throw"===e)throw t;return{value:l,done:!0}}for(a.method=e,a.arg=t;;){var n=a.delegate;if(n){n=function e(t,n){var r=n.method,i=t.iterator[r];if(i===l)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=l,e(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;r=d(i,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,m;i=r.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=l),n.delegate=null,m):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}(n,a);if(n){if(n===m)continue;return n}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(s===h)throw s=b,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s=v;n=d(i,o,a);if("normal"===n.type){if(s=a.done?b:f,n.arg===m)continue;return{value:n.arg,done:a.done}}"throw"===n.type&&(s=b,a.method="throw",a.arg=n.arg)}})}),t}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var h="suspendedStart",f="suspendedYield",v="executing",b="completed",m={};function y(){}function p(){}function g(){}var t={},w=(o(t,r,function(){return this}),Object.getPrototypeOf),w=w&&w(w(O([]))),x=(w&&w!==e&&c.call(w,r)&&(t=w),g.prototype=y.prototype=Object.create(t));function _(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function C(a,s){var t;u(this,"_invoke",{value:function(n,r){function e(){return new s(function(e,t){!function t(e,n,r,i){var o,e=d(a[e],a,n);if("throw"!==e.type)return(n=(o=e.arg).value)&&"object"==_typeof(n)&&c.call(n,"__await")?s.resolve(n.__await).then(function(e){t("next",e,r,i)},function(e){t("throw",e,r,i)}):s.resolve(n).then(function(e){o.value=e,r(o)},function(e){return t("throw",e,r,i)});i(e.arg)}(n,r,e,t)})}return t=t?t.then(e,e):e()}})}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function O(t){if(t||""===t){var n,e=t[r];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return n=-1,(e=function e(){for(;++n<t.length;)if(c.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=l,e.done=!0,e}).next=e}throw new TypeError(_typeof(t)+" is not iterable")}return u(x,"constructor",{value:p.prototype=g,configurable:!0}),u(g,"constructor",{value:p,configurable:!0}),p.displayName=o(g,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,o(e,i,"GeneratorFunction")),e.prototype=Object.create(x),e},a.awrap=function(e){return{__await:e}},_(C.prototype),o(C.prototype,n,function(){return this}),a.AsyncIterator=C,a.async=function(e,t,n,r,i){void 0===i&&(i=Promise);var o=new C(s(e,t,n,r),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},_(x),o(x,i,"Generator"),o(x,r,function(){return this}),o(x,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,n=Object(e),r=[];for(t in n)r.push(t);return r.reverse(),function e(){for(;r.length;){var t=r.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=O,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=l,this.done=!1,this.delegate=null,this.method="next",this.arg=l,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&c.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=l)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function e(e,t){return o.type="throw",o.arg=n,r.next=e,t&&(r.method="next",r.arg=l),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=c.call(i,"catchLoc"),s=c.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&c.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n,r,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(n=i.completion).type&&(r=n.arg,L(i)),r}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:O(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=l),m}},a}function asyncGeneratorStep(e,t,n,r,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function _asyncToGenerator(s){return function(){var e=this,a=arguments;return new Promise(function(t,n){var r=s.apply(e,a);function i(e){asyncGeneratorStep(r,t,n,i,o,"next",e)}function o(e){asyncGeneratorStep(r,t,n,i,o,"throw",e)}i(void 0)})}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var n;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}function normalizeColor(e){return[(e>>16&255)/255,(e>>8&255)/255,(255&e)/255]}["SCREEN","LINEAR_LIGHT"].reduce(function(e,t,n){return Object.assign(e,_defineProperty({},t,n))},{});var MiniGl=function(){function o(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]&&arguments[3],f=(_classCallCheck(this,o),this),i=-1!==document.location.search.toLowerCase().indexOf("debug=webgl"),l=(f.canvas=e,f.gl=f.canvas.getContext("webgl",{antialias:!0}),f.meshes=[],f.gl),e=(t&&n&&this.setSize(t,n),f.lastDebugMsg,f.debug=r&&i?function(e){var t,n=new Date;1e3<n-f.lastDebugMsg&&console.log("---"),(t=console).log.apply(t,[n.toLocaleTimeString()+Array(Math.max(0,32-e.length)).join(" ")+e+": "].concat(_toConsumableArray(Array.from(arguments).slice(1)))),f.lastDebugMsg=n}:function(){},Object.defineProperties(f,{Material:{enumerable:!1,value:function(){function s(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=(_classCallCheck(this,s),this);function i(e,t){e=l.createShader(e);return l.shaderSource(e,t),l.compileShader(e),l.getShaderParameter(e,l.COMPILE_STATUS)||console.error(l.getShaderInfoLog(e)),f.debug("Material.compileShaderSource",{source:t}),e}function o(e,n){return Object.entries(e).map(function(e){var e=_slicedToArray(e,2),t=e[0];return e[1].getDeclaration(t,n)}).join("\n")}r.uniforms=n,r.uniformInstances=[];var a="\n              precision highp float;\n            ";r.vertexSource="\n              ".concat(a,"\n              attribute vec4 position;\n              attribute vec2 uv;\n              attribute vec2 uvNorm;\n              ").concat(o(f.commonUniforms,"vertex"),"\n              ").concat(o(n,"vertex"),"\n              ").concat(e,"\n            "),r.Source="\n              ".concat(a,"\n              ").concat(o(f.commonUniforms,"fragment"),"\n              ").concat(o(n,"fragment"),"\n              ").concat(t,"\n            "),r.vertexShader=i(l.VERTEX_SHADER,r.vertexSource),r.fragmentShader=i(l.FRAGMENT_SHADER,r.Source),r.program=l.createProgram(),l.attachShader(r.program,r.vertexShader),l.attachShader(r.program,r.fragmentShader),l.linkProgram(r.program),l.getProgramParameter(r.program,l.LINK_STATUS)||console.error(l.getProgramInfoLog(r.program)),l.useProgram(r.program),r.attachUniforms(void 0,f.commonUniforms),r.attachUniforms(void 0,r.uniforms)}return _createClass(s,[{key:"attachUniforms",value:function(n,e){var r=this;void 0===n?Object.entries(e).forEach(function(e){var e=_slicedToArray(e,2),t=e[0],e=e[1];r.attachUniforms(t,e)}):"array"==e.type?e.value.forEach(function(e,t){return r.attachUniforms("".concat(n,"[").concat(t,"]"),e)}):"struct"==e.type?Object.entries(e.value).forEach(function(e){var e=_slicedToArray(e,2),t=e[0],e=e[1];return r.attachUniforms("".concat(n,".").concat(t),e)}):(f.debug("Material.attachUniforms",{name:n,uniform:e}),r.uniformInstances.push({uniform:e,location:l.getUniformLocation(r.program,n)}))}}]),s}()},Uniform:{enumerable:!1,value:function(){function t(e){_classCallCheck(this,t),this.type="float",Object.assign(this,e),this.typeFn={float:"1f",int:"1i",vec2:"2fv",vec3:"3fv",vec4:"4fv",mat4:"Matrix4fv"}[this.type]||"1f",this.update()}return _createClass(t,[{key:"update",value:function(e){void 0!==this.value&&l["uniform".concat(this.typeFn)](e,0===this.typeFn.indexOf("Matrix")?this.transpose:this.value,0===this.typeFn.indexOf("Matrix")?this.value:null)}},{key:"getDeclaration",value:function(e,n,t){var r,i=this;if(i.excludeFrom!==n)return"array"===i.type?i.value[0].getDeclaration(e,n,i.value.length)+"\nconst int ".concat(e,"_length = ").concat(i.value.length,";"):"struct"===i.type?(r=(r=e.replace("u_","")).charAt(0).toUpperCase()+r.slice(1),"uniform struct ".concat(r," \n                                  {\n")+Object.entries(i.value).map(function(e){var e=_slicedToArray(e,2),t=e[0];return e[1].getDeclaration(t,n).replace(/^uniform/,"")}).join("")+"\n} ".concat(e).concat(0<t?"[".concat(t,"]"):"",";")):"uniform ".concat(i.type," ").concat(e).concat(0<t?"[".concat(t,"]"):"",";")}}]),t}()},PlaneGeometry:{enumerable:!1,value:function(){function o(e,t,n,r,i){_classCallCheck(this,o),l.createBuffer(),this.attributes={position:new f.Attribute({target:l.ARRAY_BUFFER,size:3}),uv:new f.Attribute({target:l.ARRAY_BUFFER,size:2}),uvNorm:new f.Attribute({target:l.ARRAY_BUFFER,size:2}),index:new f.Attribute({target:l.ELEMENT_ARRAY_BUFFER,size:3,type:l.UNSIGNED_SHORT})},this.setTopology(n,r),this.setSize(e,t,i)}return _createClass(o,[{key:"setTopology",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=this;n.xSegCount=e,n.ySegCount=t,n.vertexCount=(n.xSegCount+1)*(n.ySegCount+1),n.quadCount=n.xSegCount*n.ySegCount*2,n.attributes.uv.values=new Float32Array(2*n.vertexCount),n.attributes.uvNorm.values=new Float32Array(2*n.vertexCount),n.attributes.index.values=new Uint16Array(3*n.quadCount);for(var r=0;r<=n.ySegCount;r++)for(var i=0;i<=n.xSegCount;i++){var o,a=r*(n.xSegCount+1)+i;n.attributes.uv.values[2*a]=i/n.xSegCount,n.attributes.uv.values[2*a+1]=1-r/n.ySegCount,n.attributes.uvNorm.values[2*a]=i/n.xSegCount*2-1,n.attributes.uvNorm.values[2*a+1]=1-r/n.ySegCount*2,i<n.xSegCount&&r<n.ySegCount&&(o=r*n.xSegCount+i,n.attributes.index.values[6*o]=a,n.attributes.index.values[6*o+1]=a+1+n.xSegCount,n.attributes.index.values[6*o+2]=a+1,n.attributes.index.values[6*o+3]=a+1,n.attributes.index.values[6*o+4]=a+1+n.xSegCount,n.attributes.index.values[6*o+5]=a+2+n.xSegCount)}n.attributes.uv.update(),n.attributes.uvNorm.update(),n.attributes.index.update(),f.debug("Geometry.setTopology",{uv:n.attributes.uv,uvNorm:n.attributes.uvNorm,index:n.attributes.index})}},{key:"setSize",value:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"xz",r=this,i=(r.width=e,r.height=t,r.orientation=n,r.attributes.position.values&&r.attributes.position.values.length===3*r.vertexCount||(r.attributes.position.values=new Float32Array(3*r.vertexCount)),e/-2),o=t/-2,a=e/r.xSegCount,s=t/r.ySegCount,l=0;l<=r.ySegCount;l++)for(var c=o+l*s,u=0;u<=r.xSegCount;u++){var d=i+u*a,h=l*(r.xSegCount+1)+u;r.attributes.position.values[3*h+"xyz".indexOf(n[0])]=d,r.attributes.position.values[3*h+"xyz".indexOf(n[1])]=-c}r.attributes.position.update(),f.debug("Geometry.setSize",{position:r.attributes.position})}}]),o}()},Mesh:{enumerable:!1,value:function(){function r(e,t){_classCallCheck(this,r);var n=this;n.geometry=e,n.material=t,n.wireframe=!1,n.attributeInstances=[],Object.entries(n.geometry.attributes).forEach(function(e){var e=_slicedToArray(e,2),t=e[0],e=e[1];n.attributeInstances.push({attribute:e,location:e.attach(t,n.material.program)})}),f.meshes.push(n),f.debug("Mesh.constructor",{mesh:n})}return _createClass(r,[{key:"draw",value:function(){l.useProgram(this.material.program),this.material.uniformInstances.forEach(function(e){var t=e.uniform,e=e.location;return t.update(e)}),this.attributeInstances.forEach(function(e){var t=e.attribute,e=e.location;return t.use(e)}),l.drawElements(this.wireframe?l.LINES:l.TRIANGLES,this.geometry.attributes.index.values.length,l.UNSIGNED_SHORT,0)}},{key:"remove",value:function(){var t=this;f.meshes=f.meshes.filter(function(e){return e!=t})}}]),r}()},Attribute:{enumerable:!1,value:function(){function t(e){_classCallCheck(this,t),this.type=l.FLOAT,this.normalized=!1,this.buffer=l.createBuffer(),Object.assign(this,e),this.update()}return _createClass(t,[{key:"update",value:function(){void 0!==this.values&&(l.bindBuffer(this.target,this.buffer),l.bufferData(this.target,this.values,l.STATIC_DRAW))}},{key:"attach",value:function(e,t){t=l.getAttribLocation(t,e);return this.target===l.ARRAY_BUFFER&&(l.enableVertexAttribArray(t),l.vertexAttribPointer(t,this.size,this.type,this.normalized,0,0)),t}},{key:"use",value:function(e){l.bindBuffer(this.target,this.buffer),this.target===l.ARRAY_BUFFER&&(l.enableVertexAttribArray(e),l.vertexAttribPointer(e,this.size,this.type,this.normalized,0,0))}}]),t}()}}),[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);f.commonUniforms={projectionMatrix:new f.Uniform({type:"mat4",value:e}),modelViewMatrix:new f.Uniform({type:"mat4",value:e}),resolution:new f.Uniform({type:"vec2",value:[1,1]}),aspectRatio:new f.Uniform({type:"float",value:1})}}return _createClass(o,[{key:"setSize",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:640,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:480;this.width=e,this.height=t,this.canvas.width=e,this.canvas.height=t,this.gl.viewport(0,0,e,t),this.commonUniforms.resolution.value=[e,t],this.commonUniforms.aspectRatio.value=e/t,this.debug("MiniGL.setSize",{width:e,height:t})}},{key:"setOrthographicCamera",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;this.commonUniforms.projectionMatrix.value=[2/this.width,0,0,0,0,2/this.height,0,0,0,0,2/((3<arguments.length&&void 0!==arguments[3]?arguments[3]:-2e3)-(4<arguments.length&&void 0!==arguments[4]?arguments[4]:2e3)),0,e,t,n,1],this.debug("setOrthographicCamera",this.commonUniforms.projectionMatrix.value)}},{key:"render",value:function(){this.gl.clearColor(0,0,0,0),this.gl.clearDepth(1),this.meshes.forEach(function(e){return e.draw()})}}]),o}();function e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Gradient=function(){function n(){var t=this;_classCallCheck(this,n),e(this,"el",void 0),e(this,"cssVarRetries",0),e(this,"maxCssVarRetries",200),e(this,"angle",0),e(this,"isLoadedClass",!1),e(this,"isScrolling",!1),e(this,"scrollingTimeout",void 0),e(this,"scrollingRefreshDelay",200),e(this,"isIntersecting",!1),e(this,"shaderFiles",void 0),e(this,"vertexShader",void 0),e(this,"sectionColors",void 0),e(this,"computedCanvasStyle",void 0),e(this,"conf",void 0),e(this,"uniforms",void 0),e(this,"t",1253106),e(this,"last",0),e(this,"width",void 0),e(this,"minWidth",1111),e(this,"height",600),e(this,"xSegCount",void 0),e(this,"ySegCount",void 0),e(this,"mesh",void 0),e(this,"material",void 0),e(this,"geometry",void 0),e(this,"minigl",void 0),e(this,"scrollObserver",void 0),e(this,"amp",320),e(this,"seed",5),e(this,"freqX",14e-5),e(this,"freqY",29e-5),e(this,"freqDelta",1e-5),e(this,"activeColors",[1,1,1,1]),e(this,"isMetaKey",!1),e(this,"isGradientLegendVisible",!1),e(this,"isMouseDown",!1),e(this,"handleScroll",function(){clearTimeout(t.scrollingTimeout),t.scrollingTimeout=setTimeout(t.handleScrollEnd,t.scrollingRefreshDelay),t.isGradientLegendVisible&&t.hideGradientLegend(),t.conf.playing&&(t.isScrolling=!0,t.pause())}),e(this,"handleScrollEnd",function(){t.isScrolling=!1,t.isIntersecting&&t.play()}),e(this,"resize",function(){t.width=window.innerWidth,t.minigl.setSize(t.width,t.height),t.minigl.setOrthographicCamera(),t.xSegCount=Math.ceil(t.width*t.conf.density[0]),t.ySegCount=Math.ceil(t.height*t.conf.density[1]),t.mesh.geometry.setTopology(t.xSegCount,t.ySegCount),t.mesh.geometry.setSize(t.width,t.height),t.mesh.material.uniforms.u_shadow_power.value=t.width<600?5:6}),e(this,"handleMouseDown",function(e){t.isGradientLegendVisible&&(t.isMetaKey=e.metaKey,!(t.isMouseDown=!0)===t.conf.playing)&&requestAnimationFrame(t.animate)}),e(this,"handleMouseUp",function(){t.isMouseDown=!1}),e(this,"animate",function(e){t.shouldSkipFrame(e)&&!t.isMouseDown||(t.t+=Math.min(e-t.last,1e3/15),t.last=e,t.isMouseDown&&(e=160,t.isMetaKey&&(e=-160),t.t+=e),t.mesh.material.uniforms.u_time.value=t.t,t.minigl.render()),0!==t.last&&t.isStatic?(t.minigl.render(),t.disconnect()):(t.isIntersecting&&t.conf.playing||t.isMouseDown)&&requestAnimationFrame(t.animate)}),e(this,"addIsLoadedClass",function(){t.isIntersecting&&!t.isLoadedClass&&(t.isLoadedClass=!0,t.el.classList.add("isLoaded"),setTimeout(function(){t.el.parentElement.classList.add("isLoaded")},3e3))}),e(this,"pause",function(){t.conf.playing=!1}),e(this,"play",function(){requestAnimationFrame(t.animate),t.conf.playing=!0}),e(this,"initGradient",function(e){return t.el=document.querySelector(e),t.connect(),t})}var t;return _createClass(n,[{key:"connect",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t=this;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.shaderFiles={vertex:"varying vec3 v_color;\n\nvoid main() {\n  float time = u_time * u_global.noiseSpeed;\n\n  vec2 noiseCoord = resolution * uvNorm * u_global.noiseFreq;\n\n  vec2 st = 1. - uvNorm.xy;\n\n  //\n  // Tilting the plane\n  //\n\n  // Front-to-back tilt\n  float tilt = resolution.y / 2.0 * uvNorm.y;\n\n  // Left-to-right angle\n  float incline = resolution.x * uvNorm.x / 2.0 * u_vertDeform.incline;\n\n  // Up-down shift to offset incline\n  float offset = resolution.x / 2.0 * u_vertDeform.incline * mix(u_vertDeform.offsetBottom, u_vertDeform.offsetTop, uv.y);\n\n  //\n  // Vertex noise\n  //\n\n  float noise = snoise(vec3(\n    noiseCoord.x * u_vertDeform.noiseFreq.x + time * u_vertDeform.noiseFlow,\n    noiseCoord.y * u_vertDeform.noiseFreq.y,\n    time * u_vertDeform.noiseSpeed + u_vertDeform.noiseSeed\n  )) * u_vertDeform.noiseAmp;\n\n  // Fade noise to zero at edges\n  noise *= 1.0 - pow(abs(uvNorm.y), 2.0);\n\n  // Clamp to 0\n  noise = max(0.0, noise);\n\n  vec3 pos = vec3(\n    position.x,\n    position.y + tilt + incline + noise - offset,\n    position.z\n  );\n\n  //\n  // Vertex color, to be passed to fragment shader\n  //\n\n  if (u_active_colors[0] == 1.) {\n    v_color = u_baseColor;\n  }\n\n  for (int i = 0; i < u_waveLayers_length; i++) {\n    if (u_active_colors[i + 1] == 1.) {\n      WaveLayers layer = u_waveLayers[i];\n\n      float noise = smoothstep(\n        layer.noiseFloor,\n        layer.noiseCeil,\n        snoise(vec3(\n          noiseCoord.x * layer.noiseFreq.x + time * layer.noiseFlow,\n          noiseCoord.y * layer.noiseFreq.y,\n          time * layer.noiseSpeed + layer.noiseSeed\n        )) / 2.0 + 0.5\n      );\n\n      v_color = blendNormal(v_color, layer.color, pow(noise, 4.));\n    }\n  }\n\n  //\n  // Finish\n  //\n\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\n}",noise:"//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : stegu\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//               https://github.com/stegu/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v)\n{\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289(i);\n  vec4 p = permute( permute( permute(\n            i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n          + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n          + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n}",blend:"//\n// https://github.com/jamieowen/glsl-blend\n//\n\n// Normal\n\nvec3 blendNormal(vec3 base, vec3 blend) {\n\treturn blend;\n}\n\nvec3 blendNormal(vec3 base, vec3 blend, float opacity) {\n\treturn (blendNormal(base, blend) * opacity + base * (1.0 - opacity));\n}\n\n// Screen\n\nfloat blendScreen(float base, float blend) {\n\treturn 1.0-((1.0-base)*(1.0-blend));\n}\n\nvec3 blendScreen(vec3 base, vec3 blend) {\n\treturn vec3(blendScreen(base.r,blend.r),blendScreen(base.g,blend.g),blendScreen(base.b,blend.b));\n}\n\nvec3 blendScreen(vec3 base, vec3 blend, float opacity) {\n\treturn (blendScreen(base, blend) * opacity + base * (1.0 - opacity));\n}\n\n// Multiply\n\nvec3 blendMultiply(vec3 base, vec3 blend) {\n\treturn base*blend;\n}\n\nvec3 blendMultiply(vec3 base, vec3 blend, float opacity) {\n\treturn (blendMultiply(base, blend) * opacity + base * (1.0 - opacity));\n}\n\n// Overlay\n\nfloat blendOverlay(float base, float blend) {\n\treturn base<0.5?(2.0*base*blend):(1.0-2.0*(1.0-base)*(1.0-blend));\n}\n\nvec3 blendOverlay(vec3 base, vec3 blend) {\n\treturn vec3(blendOverlay(base.r,blend.r),blendOverlay(base.g,blend.g),blendOverlay(base.b,blend.b));\n}\n\nvec3 blendOverlay(vec3 base, vec3 blend, float opacity) {\n\treturn (blendOverlay(base, blend) * opacity + base * (1.0 - opacity));\n}\n\n// Hard light\n\nvec3 blendHardLight(vec3 base, vec3 blend) {\n\treturn blendOverlay(blend,base);\n}\n\nvec3 blendHardLight(vec3 base, vec3 blend, float opacity) {\n\treturn (blendHardLight(base, blend) * opacity + base * (1.0 - opacity));\n}\n\n// Soft light\n\nfloat blendSoftLight(float base, float blend) {\n\treturn (blend<0.5)?(2.0*base*blend+base*base*(1.0-2.0*blend)):(sqrt(base)*(2.0*blend-1.0)+2.0*base*(1.0-blend));\n}\n\nvec3 blendSoftLight(vec3 base, vec3 blend) {\n\treturn vec3(blendSoftLight(base.r,blend.r),blendSoftLight(base.g,blend.g),blendSoftLight(base.b,blend.b));\n}\n\nvec3 blendSoftLight(vec3 base, vec3 blend, float opacity) {\n\treturn (blendSoftLight(base, blend) * opacity + base * (1.0 - opacity));\n}\n\n// Color dodge\n\nfloat blendColorDodge(float base, float blend) {\n\treturn (blend==1.0)?blend:min(base/(1.0-blend),1.0);\n}\n\nvec3 blendColorDodge(vec3 base, vec3 blend) {\n\treturn vec3(blendColorDodge(base.r,blend.r),blendColorDodge(base.g,blend.g),blendColorDodge(base.b,blend.b));\n}\n\nvec3 blendColorDodge(vec3 base, vec3 blend, float opacity) {\n\treturn (blendColorDodge(base, blend) * opacity + base * (1.0 - opacity));\n}\n\n// Color burn\n\nfloat blendColorBurn(float base, float blend) {\n\treturn (blend==0.0)?blend:max((1.0-((1.0-base)/blend)),0.0);\n}\n\nvec3 blendColorBurn(vec3 base, vec3 blend) {\n\treturn vec3(blendColorBurn(base.r,blend.r),blendColorBurn(base.g,blend.g),blendColorBurn(base.b,blend.b));\n}\n\nvec3 blendColorBurn(vec3 base, vec3 blend, float opacity) {\n\treturn (blendColorBurn(base, blend) * opacity + base * (1.0 - opacity));\n}\n\n// Vivid Light\n\nfloat blendVividLight(float base, float blend) {\n\treturn (blend<0.5)?blendColorBurn(base,(2.0*blend)):blendColorDodge(base,(2.0*(blend-0.5)));\n}\n\nvec3 blendVividLight(vec3 base, vec3 blend) {\n\treturn vec3(blendVividLight(base.r,blend.r),blendVividLight(base.g,blend.g),blendVividLight(base.b,blend.b));\n}\n\nvec3 blendVividLight(vec3 base, vec3 blend, float opacity) {\n\treturn (blendVividLight(base, blend) * opacity + base * (1.0 - opacity));\n}\n\n// Lighten\n\nfloat blendLighten(float base, float blend) {\n\treturn max(blend,base);\n}\n\nvec3 blendLighten(vec3 base, vec3 blend) {\n\treturn vec3(blendLighten(base.r,blend.r),blendLighten(base.g,blend.g),blendLighten(base.b,blend.b));\n}\n\nvec3 blendLighten(vec3 base, vec3 blend, float opacity) {\n\treturn (blendLighten(base, blend) * opacity + base * (1.0 - opacity));\n}\n\n// Linear burn\n\nfloat blendLinearBurn(float base, float blend) {\n\t// Note : Same implementation as BlendSubtractf\n\treturn max(base+blend-1.0,0.0);\n}\n\nvec3 blendLinearBurn(vec3 base, vec3 blend) {\n\t// Note : Same implementation as BlendSubtract\n\treturn max(base+blend-vec3(1.0),vec3(0.0));\n}\n\nvec3 blendLinearBurn(vec3 base, vec3 blend, float opacity) {\n\treturn (blendLinearBurn(base, blend) * opacity + base * (1.0 - opacity));\n}\n\n// Linear dodge\n\nfloat blendLinearDodge(float base, float blend) {\n\t// Note : Same implementation as BlendAddf\n\treturn min(base+blend,1.0);\n}\n\nvec3 blendLinearDodge(vec3 base, vec3 blend) {\n\t// Note : Same implementation as BlendAdd\n\treturn min(base+blend,vec3(1.0));\n}\n\nvec3 blendLinearDodge(vec3 base, vec3 blend, float opacity) {\n\treturn (blendLinearDodge(base, blend) * opacity + base * (1.0 - opacity));\n}\n\n// Linear light\n\nfloat blendLinearLight(float base, float blend) {\n\treturn blend<0.5?blendLinearBurn(base,(2.0*blend)):blendLinearDodge(base,(2.0*(blend-0.5)));\n}\n\nvec3 blendLinearLight(vec3 base, vec3 blend) {\n\treturn vec3(blendLinearLight(base.r,blend.r),blendLinearLight(base.g,blend.g),blendLinearLight(base.b,blend.b));\n}\n\nvec3 blendLinearLight(vec3 base, vec3 blend, float opacity) {\n\treturn (blendLinearLight(base, blend) * opacity + base * (1.0 - opacity));\n}",fragment:"varying vec3 v_color;\n\nvoid main() {\n  vec3 color = v_color;\n  if (u_darken_top == 1.0) {\n    vec2 st = gl_FragCoord.xy/resolution.xy;\n    color.g -= pow(st.y + sin(-12.0) * st.x, u_shadow_power) * 0.4;\n  }\n  gl_FragColor = vec4(color, 1.0);\n}"},this.conf={presetName:"",wireframe:!1,density:[.06,.16],zoom:1,rotation:0,playing:!0},document.querySelectorAll("canvas").length<1?(console.log("DID NOT LOAD FLUID CANVAS"),e.next=14):e.next=6;break;case 6:return this.minigl=new MiniGl(this.el,null,null,!0),requestAnimationFrame(function(){t.el&&(t.computedCanvasStyle=getComputedStyle(t.el),t.waitForCssVars())}),e.next=10,s.create(.1,!1);case 10:this.scrollObserver=e.sent,this.scrollObserver.observe(this.el),this.scrollObserver.onSeparate(function(){window.removeEventListener("scroll",t.handleScroll),window.removeEventListener("mousedown",t.handleMouseDown),window.removeEventListener("mouseup",t.handleMouseUp),window.removeEventListener("keydown",t.handleKeyDown),t.isIntersecting=!1,t.conf.playing&&t.pause()}),this.scrollObserver.onIntersect(function(){window.addEventListener("scroll",t.handleScroll),window.addEventListener("mousedown",t.handleMouseDown),window.addEventListener("mouseup",t.handleMouseUp),window.addEventListener("keydown",t.handleKeyDown),t.isIntersecting=!0,t.addIsLoadedClass(),t.play()});case 14:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"disconnect",value:function(){this.scrollObserver&&(window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("mousedown",this.handleMouseDown),window.removeEventListener("mouseup",this.handleMouseUp),window.removeEventListener("keydown",this.handleKeyDown),this.scrollObserver.disconnect()),window.removeEventListener("resize",this.resize)}},{key:"initMaterial",value:function(){this.uniforms={u_time:new this.minigl.Uniform({value:0}),u_shadow_power:new this.minigl.Uniform({value:5}),u_darken_top:new this.minigl.Uniform({value:""===this.el.dataset.jsDarkenTop?1:0}),u_active_colors:new this.minigl.Uniform({value:this.activeColors,type:"vec4"}),u_global:new this.minigl.Uniform({value:{noiseFreq:new this.minigl.Uniform({value:[this.freqX,this.freqY],type:"vec2"}),noiseSpeed:new this.minigl.Uniform({value:5e-6})},type:"struct"}),u_vertDeform:new this.minigl.Uniform({value:{incline:new this.minigl.Uniform({value:Math.sin(this.angle)/Math.cos(this.angle)}),offsetTop:new this.minigl.Uniform({value:-.5}),offsetBottom:new this.minigl.Uniform({value:-.5}),noiseFreq:new this.minigl.Uniform({value:[3,4],type:"vec2"}),noiseAmp:new this.minigl.Uniform({value:this.amp}),noiseSpeed:new this.minigl.Uniform({value:10}),noiseFlow:new this.minigl.Uniform({value:3}),noiseSeed:new this.minigl.Uniform({value:this.seed})},type:"struct",excludeFrom:"fragment"}),u_baseColor:new this.minigl.Uniform({value:this.sectionColors[0],type:"vec3",excludeFrom:"fragment"}),u_waveLayers:new this.minigl.Uniform({value:[],excludeFrom:"fragment",type:"array"})};for(var e=1;e<this.sectionColors.length;e+=1)this.uniforms.u_waveLayers.value.push(new this.minigl.Uniform({value:{color:new this.minigl.Uniform({value:this.sectionColors[e],type:"vec3"}),noiseFreq:new this.minigl.Uniform({value:[2+e/this.sectionColors.length,3+e/this.sectionColors.length],type:"vec2"}),noiseSpeed:new this.minigl.Uniform({value:11+.3*e}),noiseFlow:new this.minigl.Uniform({value:6.5+.3*e}),noiseSeed:new this.minigl.Uniform({value:this.seed+10*e}),noiseFloor:new this.minigl.Uniform({value:.1}),noiseCeil:new this.minigl.Uniform({value:.63+.07*e})},type:"struct"}));return this.vertexShader=[this.shaderFiles.noise,this.shaderFiles.blend,this.shaderFiles.vertex].join("\n\n"),new this.minigl.Material(this.vertexShader,this.shaderFiles.fragment,this.uniforms)}},{key:"initMesh",value:function(){this.material=this.initMaterial(),this.geometry=new this.minigl.PlaneGeometry,this.mesh=new this.minigl.Mesh(this.geometry,this.material)}},{key:"shouldSkipFrame",value:function(e){return!!window.document.hidden||!this.conf.playing||parseInt(e,10)%2==0||void 0}},{key:"updateFrequency",value:function(e){this.freqX+=e,this.freqY+=e}},{key:"toggleColor",value:function(e){this.activeColors[e]=0===this.activeColors[e]?1:0}},{key:"showGradientLegend",value:function(){this.width>this.minWidth&&(this.isGradientLegendVisible=!0,document.body.classList.add("isGradientLegendVisible"))}},{key:"hideGradientLegend",value:function(){this.isGradientLegendVisible=!1,document.body.classList.remove("isGradientLegendVisible")}},{key:"init",value:function(){this.initGradientColors(),this.initMesh(),this.resize(),requestAnimationFrame(this.animate),window.addEventListener("resize",this.resize)}},{key:"waitForCssVars",value:function(){var e=this;this.computedCanvasStyle&&-1!==this.computedCanvasStyle.getPropertyValue("--ui-fluid-1").indexOf("#")?(this.init(),this.addIsLoadedClass()):(this.cssVarRetries+=1,this.cssVarRetries>this.maxCssVarRetries?(this.sectionColors=[16711680,16711680,16711935,65280,255],this.init()):requestAnimationFrame(function(){return e.waitForCssVars()}))}},{key:"initGradientColors",value:function(){var n=this;this.sectionColors=["--ui-fluid-1","--ui-fluid-2","--ui-fluid-3","--ui-fluid-4"].map(function(e){var t,e=n.computedCanvasStyle.getPropertyValue(e).trim();return 4===e.length&&(t=e.substr(1).split("").map(function(e){return e+e}).join(""),e="#".concat(t)),e&&"0x".concat(e.substr(1))}).filter(Boolean).map(normalizeColor)}}]),n}(),r=function(){function s(t){var n=this,r=t.threshold,i=t.requireThreshold,o=t.onlyOnce,a=t.rootMargin,t=t.root;_classCallCheck(this,s),e(this,"__intersectHandlers",[]),e(this,"__separateHandlers",[]),e(this,"__observer",void 0),this.__observer=new IntersectionObserver(function(t){!i||t[0].intersectionRatio>=r?(n.__intersectHandlers.forEach(function(e){e(t)}),o&&n.disconnect()):n.__separateHandlers.forEach(function(e){e(t)})},{threshold:r,rootMargin:a,root:t})}return _createClass(s,[{key:"observe",value:function(e){this.__observer.observe(e)}},{key:"onIntersect",value:function(e){this.__intersectHandlers.push(e)}},{key:"onSeparate",value:function(e){this.__separateHandlers.push(e)}},{key:"disconnect",value:function(){this.__observer.disconnect()}}]),s}(),s={create:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"0px 0px 0px 0px",a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null;return new Promise(function(e){e(new r({threshold:t,requireThreshold:i,onlyOnce:n,rootMargin:o,root:a}))})}};window.addEventListener("DOMContentLoaded",function(){var t=function(){_inherits(t,elementorModules.frontend.handlers.Base);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"bindEvents",value:function(){"yes"===this.getElementSettings("section_fluid_on")&&this.Init()}},{key:"onElementChange",value:function(e){var t="yes"===this.getElementSettings("section_fluid_on");0<=e.indexOf("fluid")&&t&&this.Init()}},{key:"Init",value:function(){this.$element.find(".ui-e-fluid-canvas").remove();var e=Math.floor(1e3+9e3*Math.random());0<=this.$element.attr("class").indexOf("ui-fluid-animation-6")?(this.$element.prepend("<canvas class='ui-e-fluid-canvas' id='ui-fluid-canvas-"+e+"' data-transition-in />"),(new Gradient).initGradient("#ui-fluid-canvas-"+e)):this.$element.prepend('<div class="ui-fluid-gradient-wrapper ui-e-fluid-canvas"><div class="ui-fluid-gradient"></div></div>')}}]),t}();jQuery(window).on("elementor/frontend/init",function(){function e(e){elementorFrontend.elementsHandler.addHandler(t,{$element:e})}elementorFrontend.hooks.addAction("frontend/element_ready/section",e),elementorFrontend.hooks.addAction("frontend/element_ready/container",e)})},!1);
/**
 * Javascript for the shipping method functionality.
 *
 * @package Fish and Ships
 * @version 1.5
 */
jQuery(document).ready(function(e){function n(){var n=e("#mainform"),t=e("#fns_import_field").val(),s=["global_group_by","multiple_currency","free_shipping","disallow_other"];t=(t=t.split(String.fromCharCode(10)).join("")).split(String.fromCharCode(13)).join("");try{t=JSON.parse(t)}catch(e){return alert(wcfns_data.i18n_import_err+" \r"+e),void m()}e("#fns_recreate_form_wrap").remove(),e("body").append('<div id="fns_recreate_form_wrap" style="display:none"><form method="post" id="fns_recreate_form" action="" enctype="multipart/form-data"></form></div>');for(key in t)-1!=e.inArray(key,s)&&""==t[key]||(key_form=key,"shipping_rules"!=key.substr(0,14)&&(key_form="woocommerce_fish_n_ships_"+key),e("#fns_recreate_form").append('<input type="hidden" name="'+key_form+'" value="'+t[key]+'" />'));var a=["select","undefined","fns-serial","fns-register"];e("input, checkbox, select, radio, button",n).each(function(n,t){if(name=e(t).attr("name"),"undefined"!=typeof name&&-1==e.inArray(name,a)&&"shipping_rules"!=name.substr(0,14)){if(val=e(t).val(),e(t).is(":checkbox"))return;shorted_name=name,"woocommerce_fish_n_ships_"==name.substr(0,25)&&(shorted_name=name.substr(25)),0==e('[name="'+name+'"]',"#fns_recreate_form").length&&e("#fns_recreate_form").append('<input type="hidden" name="'+name+'" value="'+val+'" />')}}),e("#fns_recreate_form").submit()}function s(n){wrapper=e("#shipping-rules-table-fns .fns-ruletype-container-"+n),e(wrapper).append(wcfns_data.empty_row_html),e("tr:last",wrapper).addClass("fns-ruletype-"+n).removeClass("fns-ruletype-unknown"),e("tr:last input.rule_type_selector",wrapper).val(n),e("tr:last",wrapper).addClass("animate-bg"),setTimeout(function(){e("#shipping-rules-table-fns tbody tr").removeClass("animate-bg")},50),e(".add-selector a.add_selector_bt",wrapper).last().trigger("click"),o(),e("#shipping-rules-table-fns .column-handle").css("display","table-cell"),e("#shipping-rules-table-fns > tbody").sortable("refresh")}function a(){0==e("#shipping-rules-table-fns .check-column input:checked").length?e("#shipping-rules-table-fns .duplicate-rules, #shipping-rules-table-fns .delete-rules").addClass("disabled"):e("#shipping-rules-table-fns .duplicate-rules, #shipping-rules-table-fns .delete-rules").removeClass("disabled")}function o(){c(),e("#shipping-rules-table-fns > tbody").each(function(n,t){e("> tr",t).each(function(n,t){e("td.order-number",t).html("#"+(n+1)),e(t).removeClass("odd"),n%2==0&&e(t).addClass("odd")})}),e("#shipping-rules-table-fns > tbody > tr").each(function(n,s){e("selection_wrapper",s)<2?e(".logical_operator_wrapper").hide():e(".logical_operator_wrapper").show();var a="or"==e(".logical_operator_radio:checked",s).val()?wcfns_data.i18n_or:wcfns_data.i18n_and;e(".helper",s).each(function(n,t){e(t).html(0==n?wcfns_data.i18n_where:a)}),e(".selection-rules-column .delete",s).css("display",1==e(".selection-rules-column .delete",s).length?"none":"block"),e(".selection-rules-column .field-logical_operator",s).css("display",1==e(".selection-rules-column .delete",s).length?"none":"inline-block"),e("input, select, textarea",s).each(function(t,s){var a=e(s).attr("name");void 0!==a&&e(s).attr("name",a.replace(/\[[0-9]+\]/,"["+n+"]"))}),e(".selection_wrapper",s).each(function(n,s){e("input, select, textarea",s).each(function(s,a){var o=e(a).attr("name");void 0!==o&&(t=0,e(a).attr("name",o.replace(/\[[0-9]*\]/g,function(e){return t++,2==t?"["+n+"]":e})))})}),e(".action_wrapper",s).each(function(n,s){e("input, select, textarea",s).each(function(s,a){var o=e(a).attr("name");void 0!==o&&(t=0,e(a).attr("name",o.replace(/\[[0-9]*\]/g,function(e){return t++,2==t?"["+n+"]":e})))})})}),e("#shipping-rules-table-fns").outerHeight()>350?e("#shipping-rules-table-fns .fns-footer-header").show():e("#shipping-rules-table-fns .fns-footer-header").hide(),e("#shipping-rules-table-fns input:radio").each(function(n,t){"1"==e(t).attr("data-save")&&e(t).prop("checked",!0)}),a(),max_width=0,e("#shipping-rules-table-fns .helper").each(function(n,t){w=e(t).width(),max_width<w&&(max_width=w)}),e("#shipping-rules-table-fns .selection_wrapper").css("padding-left",max_width+10),e(".fns_slider_wrap").each(function(n,t){e(".slider",t).not(".ui-slider",t).slider({slide:f,change:f,min:0,max:100,step:2,value:e("input",t).val()})}),e(".fns_slider_wrap").each(function(n,t){e(".slider",t).slider("value",e("input",t).val())}),d(),e.fn.dropdownSubmenu&&e(".selection_wrapper > select.wc-fns-selection-method").dropdownSubmenu({watchChangeVal:!0}),e(document.body).trigger("init_tooltips")}function l(){if(chk=e("#woocommerce_fish_n_ships_multiple_currency"),mc=e(chk).is(":checked"),mc&&e(chk).hasClass("fns-mc-unavailable")){var n=e("<div/>").html(q).text();return alert(n),e(chk).prop("checked",!1),!1}mc?(e("#wrapper-shipping-rules-table-fns").addClass("mc-tabs-fns"),e(".fns-currency-secondary").show()):(e("#wrapper-shipping-rules-table-fns .nav-tab").eq(0).trigger("click"),e("#wrapper-shipping-rules-table-fns").removeClass("mc-tabs-fns"),e(".fns-currency-secondary").hide())}function c(){var n=!1,t=!1;e("#shipping-rules-table-fns select.wc-fns-selection-method").each(function(s,a){"volumetric"!=e(a).val()&&"volumetric-set"!=e(a).val()||(n=!0,t=!0)}),e("#shipping-rules-table-fns select.wc-fns-actions").each(function(t,s){"math"==e(s).val()&&(n=!0)}),n?e("#woocommerce_fish_n_ships_volumetric_weight_factor").closest("tr").show():e("#woocommerce_fish_n_ships_volumetric_weight_factor").closest("tr").hide(),t?e("#woocommerce_fish_n_ships_volumetric_weight_factor").attr("required","required"):e("#woocommerce_fish_n_ships_volumetric_weight_factor").removeAttr("required")}function r(){if(e("#woocommerce_fish_n_ships_global_group_by").is(":checked"))e("#woocommerce_fish_n_ships_global_group_by_method").closest("tr").show(),e("#shipping-rules-table-fns .field-group_by").not("#shipping-rules-table-fns .field-cant-group_by").hide(),"none"==e("#woocommerce_fish_n_ships_global_group_by_method").val()?e("#shipping-rules-table-fns .field-cant-group_by").hide():e("#shipping-rules-table-fns .field-cant-group_by").css("display","block");else if(e("#woocommerce_fish_n_ships_global_group_by").hasClass("onlypro"))e("#woocommerce_fish_n_ships_global_group_by").prop("checked",!0),b("pro",!1,wcfns_data.admin_lang);else if(e("#woocommerce_fish_n_ships_global_group_by_method").closest("tr").hide(),e("#shipping-rules-table-fns .field-group_by").css("display","block"),R){var n=e("#woocommerce_fish_n_ships_global_group_by_method").val();e("#shipping-rules-table-fns .field-group_by select").val(n)}}function p(n,t){var s=e(n).closest(".field");e(".comp_icon",s).removeClass("on"),e(n).addClass("on"),e("input.comparison_way",s).val(t);e(s).attr("data-input-name");attr=e(".wc_fns_input_tip",s).attr("data-wc-fns-tip"),last_hypen=attr.lastIndexOf("_"),-1!=last_hypen&&(attr=attr.substr(0,last_hypen+1)+t,e(".wc_fns_input_tip",s).attr("data-wc-fns-tip",attr))}function d(){if(e.datepicker){var n="yy-mm-dd";e(".selection-date-date-min").each(function(t,s){function a(t){var s;try{s=e.datepicker.parseDate(n,t.value)}catch(e){s=null}return s}if(!e(s).hasClass("hasDatepicker")){cont=e(s).closest(".selection_wrapper");var o=jQuery(".selection-date-date-min input[type=text]",cont).datepicker({minDate:0,changeMonth:!0,changeYear:!0,dateFormat:n,regional:[""]}).on("change",function(){i.datepicker("option","minDate",a(this))}),i=jQuery(".selection-date-date-max input[type=text]",cont).datepicker({minDate:0,changeMonth:!0,changeYear:!0,dateFormat:n,regional:[""]}).on("change",function(){console.log("change"),o.datepicker("option","maxDate",a(this))})}}),e(".wc_fns_input_dayyear").each(function(t,s){e(s).hasClass("hasDatepicker")||e(s).datepicker({changeMonth:!0,changeYear:!1,dateFormat:n,regional:[""]}).on("change",function(){var n=s.value;e(s).val(n.substr(5,5))})})}}function u(){e("#shipping-rules-table-fns select.wc-fns-cost-method").each(function(n,t){e(t).closest("tr").hasClass("fns-ruletype-normal")&&(cont=e(t).closest("td"),"composite"==e(t).val()?(e(".cost_simple",cont).hide(),e(".cost_composite",cont).show()):(e(".cost_simple",cont).show(),e(".cost_composite",cont).hide()))})}function f(n,t){if(!F){F=!0;var s=t.value,a=e(t.handle).closest(".fns_slider_wrap"),o=e(a).closest(".fns_slider_pack"),i=e(".fns_slider_wrap",o).not(a),l=e(".slider",i[0]).slider("value"),c=l/(l+e(".slider",i[1]).slider("value"));isNaN(c)&&(c=.5);var r=Math.round((100-s)*c),p=100-s-r;e(".slider",i[0]).slider("value",r),e(".slider",i[1]).slider("value",p),e("input",a).val(s),e("input",i[0]).val(r),e("input",i[1]).val(p),F=!1}}function _(){"off"!=e("#woocommerce_fish_n_ships_write_logs").val()?e("#wc_fns_debug_mode, #wc_fns_logs_list").show():e("#wc_fns_debug_mode, #wc_fns_logs_list").hide()}function g(n,t,s){e("#logs_wrapper").hasClass("loading")||(e("#logs_wrapper").addClass("loading").append('<div class="fns-loglist-loading"><span class="wc-fns-spinner"></span></div>'),e.ajax({url:ajaxurl,data:{action:"wc_fns_logs_pane",fnslogspag:n,instance_id:t,fnslogsperpag:s},error:function(n,t,s){var a=n.status+": "+n.statusText;console.log("Error loading log list - "+a),e("#logs_wrapper").removeClass("loading").find(".fns-loglist-loading").remove()},success:function(n){if("0"==n)return console.log("error loading log list"),void e("#logs_wrapper").find(".fns-loglist-loading").remove();e("#logs_wrapper").html(n).removeClass("loading"),e("#wc_fns_logs_list").show()},dataType:"html"}))}function m(){e("body.fns-popup .ui-dialog, .ui-widget-overlay").fadeOut(function(){e("body").removeClass("fns-popup"),0!=e("#fns_dialog").length&&(e("#fns_dialog .fns_fields_popup").appendTo(".fns_popup_opened"),e(".fns_popup_opened").removeClass("fns_popup_opened"),e("#fns_dialog").dialog("close").remove())})}function b(n,t,s){return t||(m(),v()),e("body").append('<div class="ui-widget-overlay ui-front fns-loading" style="z-index: 100;"><span class="wc-fns-spinner"></span></div>'),t||e(".ui-widget-overlay").css("opacity",0).animate({opacity:1}),e("body").addClass("fns-popup-opening"),e.ajax({url:ajaxurl,data:{action:"wc_fns_help",lang:s,what:n},error:function(n,t,s){e("body").removeClass("fns-popup-opening");var a=n.status+": "+n.statusText;alert("Fns Help Error - "+a),e(".ui-widget-overlay.fns-loading").remove()},success:function(t){var a=e("<div/>").append(t);for(e("body").append('<div id="fns_help"><div class="popup_scroll_control">'+a.find("#content").html()+"</div></div>"),n_lang=0,x=0;x<z.length;x++)z[x]==s&&(n_lang=x);var o='<strong id="select_lang">'+E[n_lang]+' <span class="dashicons dashicons-arrow-down-alt2"></span></strong><div id="lang_dropbox">';for(x=0;x<z.length;x++)x!=n_lang&&(o+='<a href="'+("en"==s?"":"../")+(0==x?"":z[x]+"/")+n+'.html" data-fns-tip="'+n+'" data-fns-lang="'+z[x]+'">'+E[x]+"</a>");o+="</div>",e("#fns_help .popup_scroll_control .lang_switch").html(o),e("#fns_help .popup_scroll_control img").each(function(n,t){url=e(t).attr("src"),"undefined"!=typeof url&&!1!==url&&0!==url.indexOf("http")&&e(t).attr("src",wcfns_data.help_url+url)}),e("#fns_help .popup_scroll_control a").each(function(n,t){url=e(t).attr("href"),"undefined"!=typeof url&&!1!==url&&0!==url.indexOf("http")&&e(t).attr("href",wcfns_data.help_url+url)}),e("#fns_help").dialog({title:a.find("h1").html(),dialogClass:"wp-dialog",autoOpen:!1,draggable:!0,width:.95*e("#wpcontent").width(),height:.7*e(window).height(),modal:!0,resizable:!0,closeOnEscape:!0,position:{my:"center",at:"center",of:window},open:function(){e(".ui-widget-overlay").bind("click",function(){v()})},create:function(){e(".ui-dialog-titlebar-close").addClass("ui-button")},buttons:[{text:wcfns_data.i18n_close_bt,click:v}],close:function(){v()}}),e("#fns_help").dialog("open"),e("body").addClass("fns-popup").removeClass("fns-popup-opening"),e(".ui-widget-overlay.fns-loading").remove(),e(".ui-dialog .ui-dialog-buttonset button").not(".ui-dialog-fns-samples button").attr("class","button button-primary button-large")},dataType:"html"}),!1}function v(){e("body.fns-popup .ui-dialog, .ui-widget-overlay").fadeOut(function(){e("body").removeClass("fns-popup"),0!=e("#fns_help").length&&e("#fns_help").dialog("close").remove()})}function y(){e("#woocommerce_fish_n_ships_free_shipping").is(":checked")?e(".fns_disallow_other_tr").css("opacity",1):e(".fns_disallow_other_tr").css("opacity",.5)}function k(){0!=e(".snippets-ajax-loading").length&&e.ajax({url:ajaxurl,data:{action:"wc_fns_samples"},dataType:"json",error:function(e,n,t){var s=e.status+": "+e.statusText;alert("Error loading samples - "+s)},success:function(n){console.log(n),e(".snippets-ajax-loading").replaceWith(n.snippets),e(".fullsamples-ajax-loading").replaceWith(n.fullsamples)}})}function C(){j()?e("#fns_samples .warning").hide():e("#fns_samples .warning").show()}function j(){return 1==e("select.wc-fns-selection-method").length&&""==e("select.wc-fns-selection-method").val()}function T(){e("body.fns-popup .ui-dialog, .ui-widget-overlay").fadeOut(function(){e("body").removeClass("fns-popup"),0!=e("#fns_samples").length&&e("#fns_samples").dialog("close")})}function S(n){n=void 0===n||n;var t=!0,s=new Array,a=!0;if(e('.wc_fns_tab_snippets input[type="checkbox"]:checked').each(function(n,a){restriction=e(a).attr("data-restrict-group_by"),"undefined"!=typeof restriction&&!1!==restriction&&(restriction=restriction.toString().split(","),t?(t=!1,s=restriction):s=s.filter(function(e){return-1!==restriction.indexOf(e)}))}),!t&&s.length<1){A();i="Sorry. The selected snippets needs distinct group-by strategies.";i+="\n\nDistinct group-by strategies in the same shipping method is only available in Fish and Ships Pro",n&&alert(i),a=!1}else if(!t&&!j()){var o=e("#woocommerce_fish_n_ships_global_group_by_method option:selected").val();if(-1==s.indexOf(o)){if(A(),1==s.length)i="Group-by must be set to: ";else var i="Group-by must be set to one of this: ";e(s).each(function(e,n){e>0&&(i+=" or "),i+=O(n)}),i+="\n\nYour snippet selection needs a group-by strategy change in the shipping method settings.",i+="\n\nTo address this, please, close the samples popup and locate the 'Global group-by' option in the top area of the settings page. Please, check if your rules will continue working with this change before do it.",i+="\n\nDistinct group-by strategies in the same shipping method is only available in Fish and Ships Pro",n&&alert(i),a=!1}}e(".wc_fns_tab_snippets .case-sel").removeClass("case-sel"),e(".wc_fns_tab_snippets input:checked").each(function(n,t){e(t).closest("li").addClass("case-sel")}),e(".fns-case-wrapper").each(function(n,t){count=e("input:checked",t).length,0==count?e("h2 .counter",t).html(""):e("h2 .counter",t).html(" ("+count+")")});var l=e(".wc_fns_tab_snippets input:checked").length;return a&&0!=l?e(".ui-dialog-fns-samples .fns-add-sel-snippets").removeClass("disabled"):e(".ui-dialog-fns-samples .fns-add-sel-snippets").addClass("disabled"),a}function A(){e(".fns-req-group-by").length>0||e('.wc_fns_tab_snippets input[type="checkbox"]').each(function(n,t){restriction=e(t).attr("data-restrict-group_by"),e(t).closest("li").hasClass("only_pro")||"undefined"==typeof restriction||!1===restriction||(html_info="",casewrap=e(t).closest(".case"),restriction=restriction.toString().split(","),1==restriction.length?html_info="Requires group-by set as: ":html_info="Requires group-by set as one of this: ",e(restriction).each(function(e,n){html_info+="<span>"+O(n)+"</span>"}),e(casewrap).append('<p class="fns-req-group-by">'+html_info+"</p>"))})}function O(e){return"none"==e&&(e="None"),"id_sku"==e&&(e="ID/SKU"),"product_id"==e&&(e="Per product"),"class"==e&&(e="Shipping class"),"all"==e&&(e="All together"),e}var z=["en","en-si","es","pt","it","ca","fi"],E=["English (IU)","English (SI)","Español","Português","Italiano","Català","Suomi"];if(0!=e("#shipping-rules-table-fns").length&&(e("body").addClass("wc-fish-and-ships"),0!=e("#wc-fns-freemium-panel.pro-version.closed").length&&e("body").addClass("wc-fish-and-ships-pro-closed"),e(".fns-only-notice").show()),e(document.body).on("keyup change",".wc_fns_input_decimal[type=text], .wc_fns_input_positive_decimal[type=text], .wc_fns_input_integer[type=text], .wc_fns_input_positive_integer[type=text]",function(n){var t,s,a=e(this).val();if(e(this).is(".wc_fns_input_decimal")?(t=new RegExp("^-?[0-9]+(\\"+woocommerce_admin.decimal_point+"?[0-9]*)?$"),s="i18n_decimal_error","keyup"==n.type&&"-"==a&&(s=!1)):e(this).is(".wc_fns_input_positive_decimal")?(t=new RegExp("^[0-9]+(\\"+woocommerce_admin.decimal_point+"?[0-9]*)?$"),s="i18n_decimal_error"):e(this).is(".wc_fns_input_integer")?(t=new RegExp("^-?[0-9]+$","gi"),s="i18n_fns_integer_error","keyup"==n.type&&"-"==a?s=!1:woocommerce_admin[s]=wcfns_data[s]):(t=new RegExp("^[0-9]+$","gi"),s="i18n_fns_integer_error",woocommerce_admin[s]=wcfns_data[s]),s&&""!=a&&!t.test(a))e(document.body).triggerHandler("wc_add_error_tip",[e(this),s]),e(this).closest(".currency-fns-field").addClass("fns-error-inside");else{e(document.body).triggerHandler("wc_remove_error_tip",[e(this),s]);var o=this;setTimeout(function(){e(o).closest(".currency-fns-field").removeClass("fns-error-inside")},1e3)}}),e(document.body).on("blur",".wc_fns_input_decimal[type=text], .wc_fns_input_positive_decimal[type=text], .wc_fns_input_integer[type=text], .wc_fns_input_positive_integer[type=text]",function(){var n=this;setTimeout(function(){e(n).closest(".currency-fns-field").removeClass("fns-error-inside")},1e3)}),e(document.body).on("focus",".wc_fns_input_tip",function(){if(info_type=e(this).attr("data-wc-fns-tip"),"undefined"!=typeof info_type&&!1!==info_type){var n=e(this).position();if(0===e(this).parent().find(".wc_fns_info_tip").length){if(e(".wc_fns_info_tip").remove(),!wcfns_data[info_type])return;e(this).after('<div class="wc_fns_info_tip '+info_type+'">'+wcfns_data[info_type]+"</div>"),e(this).parent().find(".wc_fns_info_tip").css("left",n.left+e(this).width()-e(this).width()/2-e(".wc_fns_info_tip").width()/2).css("top",n.top+e(this).height()).fadeIn("100"),e(this).parent().addClass("wc_fns_focus_tip")}}}),e(document.body).on("blur",".wc_fns_input_tip",function(){e(this).parent().find(".wc_fns_info_tip").remove(),e(this).parent().removeClass("wc_fns_focus_tip")}),0!=e("#shipping-rules-table-fns").length){var Q=!1,D=!1;e("#shipping-rules-table-fns, table.form-table").on("change","input, select, textarea",function(){Q=!0}),e("#mainform").submit(function(){var n=e("#woocommerce_fish_n_ships_global_group_by").is(":checked"),t=e("#woocommerce_fish_n_ships_global_group_by_method").val(),s=[];if(e("select.wc-fns-selection-method").each(function(a,o){if(!n){var i=e(o).closest(".selection_wrapper");t=e(".field-group_by select",i).val()}if("quantity"==e(o).val()&&"none"==t){var l=e(o).closest("tr"),c=e("#shipping-rules-table-fns tr").index(l),r=e("#shipping-rules-table-fns tr").index(e("#shipping-rules-table-fns tr.fns-ruletype-extra").first());-1!=r&&r<=c&&(c=c-r+1+" / EXTRA"),s.push("#"+c)}}),s.length>0){if(i=(i=wcfns_data.i18n_fns_groupby_error).replace("%rules%",s.join(", ")),!confirm(i))return!1}var a=[];if(e(".selection-rules-column").each(function(n,t){e("select.wc-fns-selection-method",t).each(function(n,s){if("always"==e(s).val()&&e("select.wc-fns-selection-method",t).length>1){var o=e(t).closest("tr"),i=e("#shipping-rules-table-fns tr").index(o),l=e("#shipping-rules-table-fns tr").index(e("#shipping-rules-table-fns tr.fns-ruletype-extra").first());return-1!=l&&l<=i&&(i=i-l+1+" / EXTRA"),a.push("#"+i),!1}})}),a.length>0){if(i=(i=wcfns_data.i18n_fns_always_error).replace("%rules%",a.join(", ")),!confirm(i))return!1}var o=[];if(e(".fns-ruletype-normal").each(function(n,t){prev_cost=!1,currency_restriction=e("#woocommerce_fish_n_ships_multiple_currency").is(":checked")?"":" .currency-main","composite"==e("select.wc-fns-cost-method",t).val()?e(".cost_composite"+currency_restriction+" input",t).each(function(n,t){"0"!=e(t).val()&&""!=e(t).val()&&(prev_cost=!0)}):e(".cost_simple"+currency_restriction+" input",t).each(function(n,t){"0"!=e(t).val()&&""!=e(t).val()&&(prev_cost=!0)}),e(".special-actions-column .action_wrapper",t).each(function(n,s){if(action=e(".wc-fns-actions",s).val(),"min_max"==action||"boxes"==action||"math"==action&&!prev_cost)prev_cost=!0;else if("math"==action&&prev_cost&&(formula=e(".action-math textarea",s).val(),"string"==typeof formula&&-1==formula.indexOf("rule_cost"))){var a=e("#shipping-rules-table-fns tr").index(t);return o.push("#"+a),!1}})}),o.length>0){var i=wcfns_data.i18n_fns_math_ignore;if(i=i.replace("%rules%",o.join(", ")),!confirm(i))return!1}D=!0})}1==e("p.submit button.woocommerce-save-button").length&&(e(".wc-fns-export-buttons a").insertAfter("p.submit button.woocommerce-save-button"),e(".wc-fns-export-buttons").remove()),e("a.wc-fns-export").click(function(){var n={version:wcfns_data.version,pro:wcfns_data.im_pro},t=["select","undefined","_wp_http_referer","_wpnonce","fns-serial","fns-register","log[]","fnslogsperpag"],s=e(this).closest("form");return e("input, checkbox, select, radio, textarea",s).each(function(s,a){if(name=e(a).attr("name"),"undefined"!=typeof name&&-1==e.inArray(name,t)){if("woocommerce_fish_n_ships_"==name.substr(0,25)&&(name=name.substr(25)),val=e(a).val(),e(a).is(":checkbox")&&!e(a).is(":checked"))return;if(e(a).is(":radio")&&!e(a).is(":checked"))return;if("object"==typeof val){i=0;for(key in val)unique_name=name.replace(/\[[0-9]*\]$/,"["+i+"]"),n[unique_name]=val[key],i++}else(e(a).hasClass("wc_fns_input_positive_decimal")||e(a).hasClass("wc_fns_input_decimal"))&&(val=val.split(woocommerce_admin.decimal_point).join(".")),n[name]=val}}),n=JSON.stringify(n),e("body").append('<div id="fns_dialog"><p class="fns-tabbed">'+wcfns_data.i18n_export_ins+'</p><div class="export_wrapper">...</div></div>'),buttons_lang=[],buttons_lang.push(String(wcfns_data.i18n_close_bt),m),e("#fns_dialog").dialog({title:wcfns_data.i18n_export_tit,dialogClass:"wp-dialog",autoOpen:!1,draggable:!0,width:"auto",modal:!0,resizable:!0,closeOnEscape:!0,position:{my:"center",at:"center",of:window},open:function(){e(".ui-widget-overlay").bind("click",function(){m()})},create:function(){e(".ui-dialog-titlebar-close").addClass("ui-button")},buttons:[{text:wcfns_data.i18n_close_bt,click:m}],close:function(){m()}}),e("body").addClass("fns-popup"),e(".ui-dialog .ui-dialog-buttonset button").not(".ui-dialog-fns-samples button").attr("class","button button-primary button-large"),e("#fns_dialog").dialog("open"),e(".export_wrapper").html(n).click(function(){e(this).fns_selectText()}),!1}),jQuery.fn.fns_selectText=function(){this.find("input").each(function(){0!=e(this).prev().length&&e(this).prev().hasClass("p_copy")||e('<p class="p_copy" style="position: absolute; z-index: -1;"></p>').insertBefore(e(this)),e(this).prev().html(e(this).val())});var n=document,t=this[0];if(console.log(this,t),n.body.createTextRange){(a=document.body.createTextRange()).moveToElementText(t),a.select()}else if(window.getSelection){var s=window.getSelection(),a=document.createRange();a.selectNodeContents(t),s.removeAllRanges(),s.addRange(a)}},e("a.wc-fns-import").click(function(){return e("body").append('<div id="fns_dialog"><p class="fns-tabbed">'+wcfns_data.i18n_import_ins+'</p><textarea id="fns_import_field"></textarea></div>'),e("#fns_dialog").dialog({title:wcfns_data.i18n_import_tit,dialogClass:"wp-dialog",autoOpen:!1,draggable:!0,width:"auto",modal:!0,resizable:!0,closeOnEscape:!0,position:{my:"center",at:"center",of:window},open:function(){e(".ui-widget-overlay").bind("click",function(){m()})},create:function(){e(".ui-dialog-titlebar-close").addClass("ui-button")},buttons:[{text:wcfns_data.i18n_cancel_bt,click:m},{text:wcfns_data.i18n_import_bt,click:n}],close:function(){m()}}),e("body").addClass("fns-popup"),e(".ui-dialog .ui-dialog-buttonset button").not(".ui-dialog-fns-samples button").attr("class","button button-primary button-large"),e("#fns_dialog").dialog("open"),e('<p class="fns-tabbed"><em>'+wcfns_data.i18n_import_att+"</em></p>").insertAfter(".ui-dialog-buttonset"),!1}),e("#shipping-rules-table-fns input:radio").each(function(n,t){e(t).attr("data-save",e(t).is(":checked")?"1":"0")}),e("#shipping-rules-table-fns .column-handle").css("display","table-cell"),e("#shipping-rules-table-fns > tbody").sortable({cursor:"move",handle:".column-handle",axis:"y",forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"fns-rule-placeholder",scrollSensitivity:40,update:function(n,t){!function(n){e(n).each(function(e,n){e%2==0?jQuery(n).addClass("alternate"):jQuery(n).removeClass("alternate")})}("#shipping-rules-table-fns > tbody tr"),o()}}),e("#shipping-rules-table-fns a.add-rule").click(function(){return s("normal"),!1}),e("#shipping-rules-table-fns a.add-rule-extra").click(function(){return"1"==wcfns_data.im_pro?(s("extra"),new_rule=e("#shipping-rules-table-fns .fns-ruletype-container-extra tr:last"),e("select.wc-fns-selection-method",new_rule).val("always"),e(".add-action .button",new_rule).trigger("click"),setTimeout(function(){e("select.wc-fns-actions",new_rule).val("ship_rate_pct").trigger("change")},100)):b("pro",!1,wcfns_data.admin_lang),!1}),e("#shipping-rules-table-fns a.duplicate-rules").click(function(){return e("#shipping-rules-table-fns select").each(function(n,t){e(t).attr("data-save",e(t).val())}),e("#shipping-rules-table-fns tbody").each(function(n,t){cloned=e(".check-column input:checked",t).closest("tr").clone().addClass("animate-bg"),e(cloned).find(".select2-container").remove(),e(cloned).find("select.chosen_select").removeClass("select2-hidden-accessible enhanced").removeAttr("aria-hidden"),e(cloned).find(".slider.ui-slider").attr("class","slider").html(""),e(cloned).find(".hasDatepicker").removeClass("hasDatepicker"),e.fn.dropdownSubmenu&&e(cloned).find(".dropdown-submenu-tuned").dropdownSubmenu("destroy"),e(cloned).appendTo(t)}),e("#shipping-rules-table-fns select").each(function(n,t){values=e(t).attr("data-save"),e.each(values.split(","),function(n,s){e("option[value='"+s+"']",t).prop("selected",!0)})}),0!=e(".selection_details select.chosen_select").length&&e(document.body).trigger("wc-enhanced-select-init"),e("#shipping-rules-table-fns .check-column input").prop("checked",!1),setTimeout(function(){e("#shipping-rules-table-fns tbody tr").removeClass("animate-bg")},50),Q=!0,o(),e("#shipping-rules-table-fns .column-handle").css("display","table-cell"),e("#shipping-rules-table-fns > tbody").sortable("refresh"),!1}),e("#shipping-rules-table-fns a.delete-rules").click(function(){return e("#shipping-rules-table-fns > tbody .check-column input:checked").closest("tr").css("background","#c91010").fadeOut(function(){e("#shipping-rules-table-fns > tbody .check-column input:checked").closest("tr").remove(),0==e("#shipping-rules-table-fns > tbody.fns-ruletype-container-normal tr").length&&e("#shipping-rules-table-fns .add-rule").last().trigger("click"),e("#shipping-rules-table-fns .check-column input").prop("checked",!1),o(),e("#shipping-rules-table-fns .column-handle").css("display","table-cell"),e("#shipping-rules-table-fns > tbody").sortable("refresh")}),Q=!0,!1}),e("#shipping-rules-table-fns").on("change",".check-column input",function(){a()}),e(document).on("dropdown-submenu-newfield",function(n,t){e(".only_pro",t).each(function(n,t){text=e(t).text(),html=text.toString().replace("[PRO]",'<span class="fns-pro-icon">PRO</span>'),e(t).html(html)})}),e("#wrapper-shipping-rules-table-fns .nav-tab").click(function(){var n=e(this).closest("nav"),t=e(n).next();return e(".nav-tab",n).removeClass("nav-tab-active"),e(this).addClass("nav-tab-active"),e(".currency-fns-field",t).not(jQuery("table .currency-fns-field",t)).removeClass("currency-active"),currency=e(this).attr("data-fns-currency"),main=0==e(".nav-tab",n).index(this),main?e(t).removeClass("locked"):(e(t).addClass("locked"),e(".currency-fns-field.currency-"+currency,t).not(jQuery("table .currency-fns-field",t)).addClass("currency-active")),!1});var q=e("span.woocommerce-help-tip",e("#woocommerce_fish_n_ships_multiple_currency").closest("tr")).attr("data-tip");e("#woocommerce_fish_n_ships_multiple_currency").change(l),e(".min_shipping_price_field.currency-main, .max_shipping_price_field.currency-main").closest("tr").addClass("fns-currency-main"),e(".min_shipping_price_field.currency-secondary, .max_shipping_price_field.currency-secondary").closest("tr").addClass("fns-currency-secondary"),l(),d(),e("#shipping-rules-table-fns > tbody").on("click",".add-selector .button",function(){var n=e(this).closest("td");return e(".selectors",n).append(wcfns_data.new_selection_method_html),e(".selection_wrapper:last",n).addClass("animate-bg"),setTimeout(function(){e(".selection_wrapper:last",n).removeClass("animate-bg")},50),Q=!0,o(),!1}),e("#shipping-rules-table-fns > tbody").on("click",".selection_wrapper .delete",function(){return e(this).closest(".selection_wrapper").css("background","#c91010").fadeOut(function(){e(this).remove(),o()}),Q=!0,!1}),e("#shipping-rules-table-fns > tbody").on("focus","select.wc-fns-selection-method",function(){e(this).attr("data-last-value",e(this).val())}),e("#shipping-rules-table-fns > tbody").on("change","select.wc-fns-selection-method",function(){val=e(this).val(),"pro"==val?(e(this).val(e(this).attr("data-last-value")),b("pro",!1,wcfns_data.admin_lang)):(cont=e(this).closest(".selection_wrapper"),e(".selection_details",cont).html(""),""!=val&&e(".selection_details",cont).html(wcfns_data["selection_"+val+"_html"]),ajax_div=e(".selection_details .wc-fns-ajax-fields",cont),0!=ajax_div.length?e.ajax({url:wcfns_data.ajax_url_main_lang,data:{action:"wc_fns_fields",type:ajax_div.attr("data-type"),method_id:ajax_div.attr("data-method-id")},error:function(e,n,t){var s=e.status+": "+e.statusText;alert("Error loading auxiliary fields - "+s)},success:function(n){wcfns_data["selection_"+val+"_html"]=n,e(".selection_details",cont).html(n),r(),0!=e(".selection_details select.chosen_select",cont).length&&e(document.body).trigger("wc-enhanced-select-init"),o()},dataType:"html"}):(r(),0!=e(".selection_details select.chosen_select",cont).length&&e(document.body).trigger("wc-enhanced-select-init"),o()),e(this).attr("data-last-value",e(this).val()),Q=!0)}),c();var R=e("#woocommerce_fish_n_ships_global_group_by").is(":checked");e("#woocommerce_fish_n_ships_global_group_by, #woocommerce_fish_n_ships_global_group_by_method").change(function(){r()}),r(),e("#woocommerce_fish_n_ships_global_group_by").closest("tr").addClass("fns-no-bottom-padding"),e("#woocommerce_fish_n_ships_global_group_by_method").closest("tr").addClass("fns-no-top-padding"),e("#shipping-rules-table-fns > tbody").on({click:function(){return p(this,"ge"),!1}},"span.comp_icon.icon_ge"),e("#shipping-rules-table-fns > tbody").on({click:function(){return p(this,"greater"),!1}},"span.comp_icon.icon_greater"),e("#shipping-rules-table-fns > tbody").on({click:function(){return p(this,"less"),!1}},"span.comp_icon.icon_less"),e("#shipping-rules-table-fns > tbody").on({click:function(){return p(this,"le"),!1}},"span.comp_icon.icon_le"),e("#shipping-rules-table-fns").on("click",".logical_operator_radio",function(){var n=e(this).closest(".logical_operator_wrapper");e("input:radio",n).each(function(n,t){e(t).attr("data-save",e(t).is(":checked")?"1":"0")}),o()}),e("#shipping-rules-table-fns").on("mousedown",".logical_operator_radio",function(){if("readonly"==e(this).attr("readonly"))return b("pro",!1,wcfns_data.admin_lang),!1}),e("#shipping-rules-table-fns > tbody").on({focus:function(){e(this).attr("data-last-value",e(this).val())},change:function(){u(),cont=e(this).closest("td"),last_val=e(this).attr("data-last-value"),"composite"==e(this).val()?(e("div.cost_composite input",cont).val(0),e("input.fns-cost-"+last_val,cont).val(e("input.fns-cost",cont).val())):"composite"==last_val&&e("input.fns-cost",cont).val(e("input.fns-cost-"+e(this).val(),cont).val()),e(this).attr("data-last-value",e(this).val())}},".wc-fns-cost-method"),u(),e("#shipping-rules-table-fns > tbody").on("click",".add-action .button",function(){return cont=e(this).closest("td"),e(".actions",cont).append(wcfns_data.new_action_html),e(".action_wrapper:last",cont).addClass("animate-bg"),setTimeout(function(){e(".action_wrapper:last",cont).removeClass("animate-bg")},50),o(),Q=!0,!1}),e("#shipping-rules-table-fns > tbody").on("click",".action_wrapper .delete",function(){return e(this).closest(".action_wrapper").css("background","#c91010").fadeOut(function(){e(this).remove(),o()}),Q=!0,!1}),e("#shipping-rules-table-fns > tbody").on("focus",".wc-fns-actions",function(){e(this).attr("data-last-value",e(this).val())}),e("#shipping-rules-table-fns > tbody").on("change",".wc-fns-actions",function(){return val=e(this).val(),"pro"==val?(e(this).val(e(this).attr("data-last-value")),b("pro",!1,wcfns_data.admin_lang)):(cont=e(this).closest(".action_wrapper"),e(".action_details",cont).html(""),""!=val&&e(".action_details",cont).html(wcfns_data["action_"+val+"_html"]),e(this).attr("data-last-value",e(this).val()),o(),Q=!0),!1});var F=!1;e(document).on("change",".fns-add-boxes-mode",function(){wrapper=e(this).closest(".fns_fields_popup"),"auto"==e(this).val()?(e(".fns-add-boxes-manual",wrapper).hide(),e(".fns-add-boxes-max",wrapper).show()):(e(".fns-add-boxes-manual",wrapper).show(),e(".fns-add-boxes-max",wrapper).hide())}),e("#woocommerce_fish_n_ships_write_logs").change(function(){_()}),_(),jQuery(document).on("click","#fnslogs .open_close",function(){return cont=e(this).closest("tr"),cont.hasClass("fns-open-log")?(log_cont=e(cont).next(),log_cont.hasClass("log_content")&&e("div.fns-log-details",log_cont).slideUp(function(){setTimeout(function(){e(cont).removeClass("fns-open-log")},300),e(log_cont).hide(),e('<tr class="fix_stripped"><td colspan="6"></td></tr>').insertAfter(log_cont)})):cont.hasClass("loaded")?(log_cont=e(cont).next(),e(log_cont).show(),e("div.fns-log-details",log_cont).slideDown(function(){e(cont).addClass("fns-open-log"),fix=e(log_cont).next(),fix.hasClass("fix_stripped")&&fix.remove()})):cont.hasClass("loading")||(cont.addClass("loading"),e('<tr class="loading_log"><td colspan="6"><div class="fns-log-details"><span class="wc-fns-spinner"></span></div></td></tr>').insertAfter(cont),e.ajax({url:ajaxurl,data:{action:"wc_fns_logs",name:e(this).attr("data-fns-log")},error:function(n,t,s){var a=n.status+": "+n.statusText;alert("Error loading log - "+a),cont.removeClass("loading"),log_content_tr=e(cont).next(),log_content_tr.hasClass("loading_log")&&log_content_tr.remove()},success:function(n){e(cont).addClass("fns-open-log loaded").removeClass(""),log_content_tr=e(cont).next(),e(log_content_tr).addClass("log_content").removeClass("loading_log"),div_log=e(".fns-log-details",log_content_tr),div_log.css({height:60,overflow:"hidden"}).html('<div class="wrap">'+n+"</div>"),setTimeout(function(){e(div_log).animate({height:e(".wrap",div_log).height()},function(){e(div_log).css({overflow:"",height:""}),cont.removeClass("loading")})},10),current_wrapper=null,e("p",div_log).each(function(n,t){html=e(t).html(),"&nbsp;&nbsp;&nbsp;"==html.substr(0,18)?null!=current_wrapper&&e(current_wrapper).append(t):"&nbsp;&nbsp;"==html.substr(0,12)&&(html_next=e(t).next().html(),"&nbsp;&nbsp;&nbsp;"==html_next.substr(0,18)&&(null==current_wrapper&&e('<p style="padding: 1.2em 0;">Rule calculations are folded. Click on each to see the details, or [<a href="#" class="fns-log-opener-all">open all</a>]:</p>').insertBefore(t),e(t).html('<a href="#" class="fns-log-opener"><span class="dashicons-before dashicons-arrow-right-alt2"></span>'+html.substr(12)+"</a>"),current_wrapper=e('<div class="wrapper"></div>').insertAfter(t)))})},dataType:"html"})),!1}),e(document).on("click","#fnslogs .fns-log-opener-all",function(){return log_container=e(this).closest(".fns-log-details"),all_opened=!0,e(".fns-log-opener",log_container).each(function(n,t){e(t).closest("p").hasClass("opened")?console.log("opened"):(all_opened=!1,console.log("not opened"))}),all_opened?(e(".fns-log-opener",log_container).trigger("click"),console.log("close all")):(e(".fns-log-opener",log_container).each(function(n,t){e(t).closest("p").hasClass("opened")||e(t).trigger("click")}),console.log("open closed all")),!1}),e(document).on("click","#fnslogs .fns-log-opener",function(){return el=e(this).closest("p"),!!e(el).next().hasClass("wrapper")&&(e(el).hasClass("opened")?(e(el).removeClass("opened"),e(el).next().slideUp(function(){e(el).next().css({height:"",display:""})})):(e(el).addClass("opened"),e(el).next().css({height:"auto",display:"none"}).slideDown()),!1)}),e(document).on("click","#fnslogs .pagination-links a, #fns_logs_reload",function(){return g(e(this).attr("data-fns-logs-pag"),e(this).attr("data-instance_id"),e("select[name='fnslogsperpag']").val()),!1}),e(document).on("change","select[name='fnslogsperpag']",function(){return g(1,e(this).attr("data-instance_id"),e(this).val()),!1}),e(document).on("click","button[name='fns-remove_logs']",function(){if(!e("#logs_wrapper").hasClass("loading")){e("#logs_wrapper").addClass("loading").append('<div class="fns-loglist-loading"><span class="wc-fns-spinner"></span></div>');var n=[];e("input[name='log[]']:checked").each(function(){n.push(this.value)});var t={action:"wc_fns_logs_pane","fns-remove_logs":"1",log:n,instance_id:e("#fns_logs_reload").attr("data-instance_id"),fnslogspag:e("#fns_logs_reload").attr("data-fns-logs-pag"),fnslogsperpag:e("select[name='fnslogsperpag']").val(),_wpnonce:e("#_wpnonce").val(),_wp_http_referer:e("input[name='_wp_http_referer']").val()};return e.ajax({url:ajaxurl,data:t,method:"POST",error:function(n,t,s){var a=n.status+": "+n.statusText;console.log("Error deleting logs - "+a),e("#logs_wrapper").removeClass("loading").find(".fns-loglist-loading").remove()},success:function(n){if(console.log(n),"0"==n)return console.log("error deleting logs"),void e("#logs_wrapper").find(".fns-loglist-loading").remove();e("#logs_wrapper").html(n).removeClass("loading"),e("#wc_fns_logs_list").show()},dataType:"html"}),!1}}),e("#shipping-rules-table-fns > tbody").on("click",".fns_open_fields_popup",function(){return m(),v(),cont=e(this).closest(".action_details"),e(".fns_fields_popup_wrap",cont).addClass("fns_popup_opened"),e("body").append('<div id="fns_dialog"></div>'),e(".fns_fields_popup",cont).appendTo("#fns_dialog"),e("#fns_dialog").dialog({title:e("#fns_dialog .fns_fields_popup").attr("data-title"),dialogClass:"wp-dialog",autoOpen:!1,draggable:!1,width:"auto",modal:!0,resizable:!1,closeOnEscape:!0,position:{my:"center",at:"center",of:window},open:function(){e(".ui-widget-overlay").bind("click",function(){}),e(".fns-add-boxes-mode:checked").trigger("change")},create:function(){e(".ui-dialog-titlebar-close").addClass("ui-button")},buttons:[{text:wcfns_data.i18n_close_bt,click:m}],close:function(){Q=!0,m()}}),e("#fns_dialog").dialog("open"),e(".ui-widget-overlay").css("opacity",0).animate({opacity:1}),e("body").addClass("fns-popup"),e(".ui-dialog .ui-dialog-buttonset button").not(".ui-dialog-fns-samples button").attr("class","button button-primary button-large"),e("#fns_dialog textarea").each(function(e,n){h=n.scrollHeight,h>45&&h<200?jQuery(n).height(h):h>=200?jQuery(n).height(200):jQuery(n).css("height","auto")}),!1}),main_cont=e("#woocommerce_fish_n_ships_global_group_by, #woocommerce_fish_n_ships_global_group_by_method").closest("tr"),e(".woocommerce-help-tip",main_cont).click(function(){return b("group_by",!1,wcfns_data.admin_lang),!1}),main_cont=e("#woocommerce_fish_n_ships_title, #woocommerce_fish_n_ships_tax_status, #woocommerce_fish_n_ships_rules_charge, #woocommerce_fish_n_ships_min_shipping_price, #woocommerce_fish_n_ships_max_shipping_price, #woocommerce_fish_n_ships_write_logs").closest("tr"),e(".woocommerce-help-tip",main_cont).click(function(){return b("other_fields",!1,wcfns_data.admin_lang),!1}),main_cont=e("#woocommerce_fish_n_ships_volumetric_weight_factor").closest("tr"),e(".woocommerce-help-tip",main_cont).click(function(){return b("sel_conditions",!1,wcfns_data.admin_lang),!1}),e(document).on("click","a.woocommerce-fns-help-popup",function(){if(tip=e(this).attr("data-fns-tip"),"undefined"!=typeof tip&&!1!==tip)return 0!=e(this).closest(".wc-fns-wizard-notice-4").length&&(e(".wc-fns-wizard-notice-4").slideUp(function(){e("div.wc-fns-wizard").remove()}),e.ajax({url:ajaxurl,data:{action:"wc_fns_wizard",ajax:"wizard",param:"off"},error:function(e,n,t){var s=e.status+": "+e.statusText;console.log("Fish n Ships, AJAX error - "+s)},success:function(e){"1"!=e&&console.log("Fish n Ships, AJAX error - "+e)},dataType:"html"})),b(tip,!1,wcfns_data.admin_lang),!1}),e(document).on("click","nav.wc_fns_nav_popup a, nav.lang_switch a, a.wc_fns_nav_popup",function(){if(tip=e(this).attr("data-fns-tip"),"undefined"!=typeof tip)return lang=e(this).attr("data-fns-lang"),"undefined"!=typeof lang&&!1!==lang?wcfns_data.admin_lang=lang:lang=wcfns_data.admin_lang,0!=e("#fns_help").length&&e("#fns_help").dialog("close").remove(),b(tip,!0,lang),!1}),e(document).on("change","nav.lang_switch select",function(){return tip=e(this).closest("nav.lang_switch").attr("data-fns-tip"),lang=e(this).val(),"undefined"!=typeof lang&&!1!==lang?wcfns_data.admin_lang=lang:lang=wcfns_data.admin_lang,0!=e("#fns_help").length&&e("#fns_help").dialog("close").remove(),b(tip,!0,lang),!1}),e(document).on("click","#select_lang",function(){return jQuery("#fns_help").toggleClass("show_langs"),!1}),e(document).on("click","#fns_help",function(){jQuery("#fns_help").removeClass("show_langs")}),setTimeout(function(){e("#wrapper-shipping-rules-table-fns .overlay").animate({opacity:0},function(){e(this).remove()})},10),e("#wc-fns-freemium-panel .close_panel").click(function(){return e.ajax({url:ajaxurl,data:{action:"wc_fns_freemium",opened:"0"},error:function(e,n,t){var s=e.status+": "+e.statusText;console.log("Fish n Ships, AJAX error - "+s)},success:function(e){"1"!=e&&console.log("Fish n Ships, AJAX error - "+e)},dataType:"html"}),e("#wc-fns-freemium-panel").addClass("closed").removeClass("opened"),0!=e("#wc-fns-freemium-panel.pro-version").length&&e("body").addClass("wc-fish-and-ships-pro-closed"),!1}),e("#wc-fns-freemium-panel .open_panel").click(function(){return e.ajax({url:ajaxurl,data:{action:"wc_fns_freemium",opened:"1"},error:function(e,n,t){var s=e.status+": "+e.statusText;console.log("Fish n Ships, AJAX error - "+s)},success:function(e){"1"!=e&&console.log("Fish n Ships, AJAX error - "+e)},dataType:"html"}),e("#wc-fns-freemium-panel").addClass("opened").removeClass("closed"),0!=e("#wc-fns-freemium-panel.pro-version").length&&e("body").removeClass("wc-fish-and-ships-pro-closed"),!1}),e("div.wc_fns_change_serial a").click(function(){return e("div.wc_fns_change_serial").slideUp(),e("div.wc_fns_hide_serial").slideDown(),!1}),jQuery("#wc-fns-freemium-panel button").bind("click",function(e){Q||(window.onbeforeunload=function(){})}),e('#wc-fns-freemium-panel button[name="fns-register"]').click(function(){cont=jQuery(this).closest("form"),jQuery("input, textarea, select",cont).removeAttr("required")}),e("#woocommerce_fish_n_ships_disallow_other").change(function(){if(jQuery(this).hasClass("onlypro"))return jQuery(this).prop("checked",!1),b("pro",!1,wcfns_data.admin_lang),!1}),e("#woocommerce_fish_n_ships_free_shipping").closest("tr").addClass("fns-no-bottom-padding"),e("#woocommerce_fish_n_ships_disallow_other").closest("tr").addClass("fns_disallow_other_tr fns-no-top-padding"),e("#woocommerce_fish_n_ships_free_shipping").change(function(){y()}),y(),e(".woocommerce-layout__activity-panel-tabs").length>0&&(e(".woocommerce-layout__activity-panel-tabs").prepend(e("#activity-panel-tab-restart-fns")),0==e(".wc-fns-wizard").length&&e("#activity-panel-tab-restart-fns").css("display","flex")),e(document).on("click",".fns-samples-wizard nav a",function(){var n=e(this).closest(".fns-samples-wizard");return e(".wc_fns_nav_popup a",n).unwrap("strong"),tab=e(this).wrap("<strong>").attr("data-fns-tab"),e(".wc_fns_tab",n).hide(),e(".wc_fns_tab_"+tab,n).show(),1==e(this).closest(".ui-dialog").length&&(0==e(this).index(e(".wc_fns_nav_popup a",n))?e(".ui-dialog .fns-add-sel-snippets").hide():(e(".ui-dialog .fns-add-sel-snippets").show(),setTimeout(S,10))),!1}),e(document).on("click",".fns-samples-wizard .fns-case-wrapper > h2",function(){return cont=e(this).closest(".fns-case-wrapper"),e(cont).hasClass("open")?(e(".sample-list",cont).stop().slideUp(),e(cont).removeClass("open")):(e(".sample-list",cont).stop().slideDown(),e(cont).addClass("open")),!1}),e(document).on("click",".fns-samples-wizard .sample-list label",function(){return cont=e(this).closest("li"),e(cont).hasClass("open")?(e(".case",cont).stop().slideUp(),e(cont).removeClass("open")):(e(".case",cont).stop().slideDown(),e(cont).addClass("open")),!1}),e("body").append('<div id="fns_samples"><div class="popup_scroll_control"></div></div>'),e("#fns_samples .popup_scroll_control").append(e("form .fns-samples-wizard")),e("#fns_samples").dialog({title:"Add Snippets or Full case examples",dialogClass:"wp-dialog",autoOpen:!1,draggable:!0,width:.95*e("#wpcontent").width(),height:.7*e(window).height(),modal:!0,resizable:!0,closeOnEscape:!0,position:{my:"center",at:"center",of:window},open:function(){e(".ui-widget-overlay").bind("click",function(){T()})},create:function(){e(".ui-dialog-titlebar-close").addClass("ui-button")},buttons:[{text:wcfns_data.i18n_close_bt,click:T}],close:function(){v()}}),e("#fns_samples").closest(".ui-dialog").addClass("ui-dialog-fns-samples"),e(".ui-dialog-fns-samples .ui-dialog-buttonset").prepend(e(".ui-dialog .fns-add-sel-snippets")),e(".ui-dialog-fns-samples .ui-dialog-buttonset button").addClass("button button-large"),e("a.wc-fns-add-snippet").click(function(){return C(),e(".ui-dialog .wc_fns_nav_popup a").eq(1).trigger("click"),e("#fns_samples").dialog("open"),k(),e("body").addClass("fns-popup"),!1}),e("a.woocommerce-fns-case").click(function(){return C(),e(".ui-dialog .wc_fns_nav_popup a").eq(0).trigger("click"),e("#fns_samples").dialog("open"),k(),e("body").addClass("fns-popup"),!1}),e(".fns-samples-wizard").show(),e(document).on("change",'.wc_fns_tab_snippets input[type="checkbox"]',function(){!S(!0)&&e(this).is(":checked")&&(e(this).prop("checked",!1),S(!1))}),e(document).on("click",".fns-add-sel-snippets",function(){if(1==e(this).closest(".wc_fns_tab").length){n=e(this).closest(".wc_fns_tab");alert("1")}else var n=e(".ui-dialog .wc_fns_tab_snippets");return 0!=e("input:checked",n).length&&(e("#shipping-rules-table-fns input, #shipping-rules-table-fns select").removeAttr("required"),e("select",n).each(function(n,t){e("#mainform").append('<input type="hidden" name="'+e(t).attr("name")+'" value="'+e(t).val()+'" />')}),e("#mainform").append(e("input:checked",n).clone()).append('<input type="hidden" name="keep_current" value="1" />').find(".woocommerce-save-button").trigger("click"),!1)}),e(document).on("click",".wc_fns_tab_fullsamples button",function(){if(e(this).closest("li").length<1)return!1;var n=e(this).attr("value"),t=e(this).closest(".case");return e("#shipping-rules-table-fns input, #shipping-rules-table-fns select").removeAttr("required"),e("select",t).each(function(n,t){e("#mainform").append('<input type="hidden" name="'+e(t).attr("name")+'" value="'+e(t).val()+'" />')}),e("#mainform").append(e("select",t).clone()).append('<input type="hidden" name="wc-fns-samples[]" value="'+n+'" />').append('<input type="hidden" name="keep_current" value="0" />').find(".woocommerce-save-button").trigger("click"),!1}),o()}),jQuery(document).ready(function(e){e("#fns_sb_table tbody").sortable({cursor:"move",axis:"y",forcePlaceholderSize:!0,helper:"clone",opacity:.65,scrollSensitivity:40,update:function(e,n){}}),e("#fns_sb_table .add-box").click(function(){return cloned=e("#fns_sb_table tbody tr:first").clone(),e(cloned).find(".numid").text(""),e(cloned).find(".fns-sb-num input").val("0"),e(cloned).find('input[name="fns-sb-id[]"]').val(""),e(cloned).find('input[name="fns-sb-name[]"]').val("Unnamed"),e(cloned).find(".fns-sb-actions").html("<em>unsaved</em>"),e(cloned).appendTo("#fns_sb_table tbody"),!1}),e("#fns_sb_table").on("click",".fns-sb-delete",function(){var n=e(this).closest("tr");return e(n).fadeOut(function(){e(n).remove()}),!1})});
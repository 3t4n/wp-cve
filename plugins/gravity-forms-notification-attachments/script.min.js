var gform_notification_attachment;jQuery(document).ready(function(){var a=jQuery("#gform_notification_attachment"),b=jQuery.parseJSON(a.find(".attachment_ids").val());"object"==typeof b&&(b=null!=b?jQuery.map(b,function(a){return a}):[]),a.find(".details li").length>0&&a.show(),a.find(".remove").on("click",function(c){c.preventDefault();var d=jQuery(this).parent(),e=b.indexOf(d.data("id"));e>-1&&(b.splice(e,1),a.find(".attachment_ids").val(JSON.stringify(b))),d.remove()}),a.find(".add").on("click",function(c){return c.preventDefault(),gform_notification_attachment?(gform_notification_attachment.open(),void 0):(gform_notification_attachment=wp.media.frames.gform_notification_attachment=wp.media({title:jQuery(this).attr("title"),button:{text:jQuery(this).attr("title")},multiple:!1}),gform_notification_attachment.on("select",function(){attachment=gform_notification_attachment.state().get("selection").first().toJSON();var c={action:"gf_notification_attachment",attachment_id:attachment.id};jQuery.post(ajaxurl,c,function(c){if(c=jQuery.parseJSON(c),c.success){var d=jQuery("<li/>").data("id",attachment.id),e=[jQuery("<div/>").addClass("remove dashicons dashicons-dismiss"),jQuery("<img/>").addClass("fl").attr("src",c.data.mime_file),jQuery("<div/>").addClass("fl file-details").append(jQuery("<span/>").text(c.data.title).addClass("title"),jQuery("<span/>").text("["+c.data.mime+"]").addClass("mime")),jQuery("<br/>").addClass("clear")];d.append(e),a.find(".details").append(d),b.push(attachment.id),a.find(".attachment_ids").val(JSON.stringify(b))}else alert("The system could not attach the selected file to the notification. Please try again.")})}),gform_notification_attachment.open(),void 0)})});
const b=e=>{const{useState:t}=wp.element,{title:c,children:o,caret_img_src:n}=e,s=N=>{h(!C);let m=N.currentTarget.nextElementSibling,a=m.style.maxHeight;a=parseInt(a.replace("px","")),a=a>0?0:m.scrollHeight,m.style.maxHeight="".concat(a,"px")},T=()=>{if(n)return React.createElement("span",{className:"caret"},React.createElement("img",{src:n}))},[C,h]=t(!1);return React.createElement("div",{className:"acfw-accordion"},React.createElement("div",{className:"acfw-accordion acfw-store-credits-checkout-ui ".concat(C?"show":"")},React.createElement("h3",{onClick:s},React.createElement("span",{className:"acfw-accordion-title"},c),T()),React.createElement("div",{className:"acfw-accordion-inner"},React.createElement("div",{className:"acfw-accordion-content"},o))))},f=e=>{const{label:t,value:c,children:o}=e;return React.createElement("div",{className:"wp-block-woocommerce-checkout-order-summary-subtotal-block wc-block-components-totals-wrapper"},React.createElement("div",{className:"wc-block-components-totals-item"},React.createElement("span",{className:"wc-block-components-totals-item__label"},t),React.createElement("span",{className:"wc-block-components-totals-item__value"},React.createElement("div",{dangerouslySetInnerHTML:{__html:c}})),React.createElement("div",{className:"wc-block-components-totals-item__description"},o)))},k={Accordion:b,OrderSummarySubtotalBlock:f},{extensionCartUpdate:R}=wc.blocksCheckout,S=()=>R({namespace:"acfwf_dummy_update",data:{}}),I={dummyUpdateCart:S},{subscribe:K,select:F,dispatch:r,useSelect:i,useDispatch:z}=wp.data,{VALIDATION_STORE_KEY:_}=wc.wcBlocksData,d="wc/store/cart",g=F("wc/store/cart"),x=()=>!!g.getCartData().coupons.filter(t=>t.discount_type==="acfw_bogo"),v={hasBOGOCoupon:x};function Q(){acfwfObj.components=k,acfwfObj.wc=I,acfwfObj.utils=v}const y=()=>{const e=i(c=>{var s;const o=c("wc/store/cart").getCartData(),{acfwf_block:n}=o.extensions;return!n||!n.couponSummaries?[]:(s=n.couponSummaries)!=null?s:[]}),{ExperimentalDiscountsMeta:t}=wc.blocksCheckout;return e.length?React.createElement(t,null,e.map(c=>React.createElement(f,{label:c.coupon_code},React.createElement("div",{className:"acfwf-bogo-discount-summary-block",dangerouslySetInnerHTML:{__html:c.content}})))):null};function X(){const{registerPlugin:e}=wp.plugins;e("acfw-coupons-summary",{render:y,scope:"woocommerce-checkout"})}const w="wc/checkout",p="wc/cart",l="core/notices",u={ACFWF_NOTICE_BOGO:"ACFWF_NOTICE_BOGO",ACFWF_NOTICE_CART_CONDITIONS:"ACFWF_NOTICE_CART_CONDITIONS",ACFWF_NOTICE_STORE_CREDIT:"ACFWF_NOTICE_STORE_CREDIT"},E=e=>{let t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText},A=e=>/<[^>]+>|&[a-z]+;/i.test(e),D=e=>e.find(t=>t.code==="woocommerce_rest_cart_coupon_error"&&A(t.message));function W(){const e=i(o=>o(d).getCartErrors()),t=i(o=>o(_).getValidationError("coupon")),c=D(e);if(c&&t){r(_).setValidationErrors({coupon:{message:" ",hidden:!1}});const o=c.message||"";r(l).createNotice("error",E(o),{context:p,id:u.ACFWF_NOTICE_CART_CONDITIONS})}}function H(){const e=i(o=>o(d).getCartData()),{acfwf_block:t}=e.extensions;if(!t||!t.bogo_deals)return null;const c=t.bogo_deals;c&&c.forEach(o=>{r(l).createNotice("info",E(o),{context:p,id:u.ACFWF_NOTICE_BOGO})})}const B="acfwf-wc-checkout-block",G={integration:B},{wcSettings:L}=wc,M=e=>L.getSetting("".concat(e,"_data")),O=jQuery,j=e=>{setTimeout(function(){r(l).createNotice("error",e,{context:w,id:u.ACFWF_NOTICE_STORE_CREDIT}),O(".acfw-reapply-sc-discount").on("click",P)},400)},P=()=>{const e=O(".acfw-checkout-ui-block"),t=e.find(".acfw-store-credits-checkout-ui"),c=e.find("h3");t.hasClass("show")||c.trigger("click"),setTimeout(function(){var n;window.scroll({top:(n=e==null?void 0:e.offset())==null?void 0:n.top,behavior:"smooth"}),e.find("input").trigger("focus")},400)};function U(){const e=i(s=>s(d).getHasCalculatedShipping()),{store_credits:t}=M(G.integration);if(!t)return null;const{apply_type:c,notice_store_credits_text:o}=t,{acfwf_block:n}=g.getCartData().extensions;c!=="coupon"&&e&&n.store_credits.notice&&j(o)}const V=[p,w],$=()=>{V.forEach(e=>{r(l).removeNotices(Object.values(u).filter(t=>t),e)}),W(),H(),U()};function Y(){const{registerPlugin:e}=wp.plugins;e("acfwf-notices",{render:$,scope:"woocommerce-checkout"})}export{X as a,G as c,M as g,Q as i,Y as r,g as s};

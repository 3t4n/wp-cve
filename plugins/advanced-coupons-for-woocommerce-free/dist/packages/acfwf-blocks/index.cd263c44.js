function ie(){import.meta.url,import("_").catch(()=>1);async function*n(){}}const{contentDisplaySettings:C}=acfwfBlocksi18n,k=n=>{const{onChange:e,settings:c}=n,{discount_value:t,description:r,usage_limit:o,schedule:u}=c;return React.createElement(React.Fragment,null,React.createElement(wp.components.ToggleControl,{label:C.displayDiscountValue,checked:t,onChange:()=>e({...c,discount_value:!t})}),React.createElement(wp.components.ToggleControl,{label:C.displayDescription,checked:r,onChange:()=>e({...c,description:!r})}),React.createElement(wp.components.ToggleControl,{label:C.displayUsageLimit,checked:o,onChange:()=>e({...c,usage_limit:!o})}),React.createElement(wp.components.ToggleControl,{label:C.displaySchedule,checked:u,onChange:()=>e({...c,schedule:!u})}))},{searchAndSelectCouponLabel:D}=acfwfBlocksi18n,I=n=>{const{coupon_id:e,setAttributes:c}=n,[t,r]=wp.element.useState([]),[o,u]=wp.element.useState(""),[a,p]=wp.element.useState(null),[s,l]=wp.element.useState(!1),[b,_]=wp.element.useState(!1),F=m=>{_(!1),a&&(clearTimeout(a),p(null)),m||l(!1),!(m.length<3)&&(s||l(!0),p(setTimeout(async()=>{try{o&&o!==m&&r([]);const d=await wp.apiFetch({path:"/wc/v3/coupons/?search=".concat(m)});d.length?r(d.map(y=>({value:y.id,label:y.code}))):_(!0),l(!1)}catch(d){console.log(d)}},1e3)))},P=m=>{const d=t.findIndex(y=>y.value===m);0<=d&&c({coupon_id:m,coupon_code:t[d].label})};return React.createElement("div",{className:"acfw-coupon-search-field-wrap"},React.createElement(wp.components.ComboboxControl,{label:D,value:e,onChange:P,options:t,onFilterValueChange:F}),s&&React.createElement(wp.components.Spinner,null),b&&React.createElement("div",null,acfwfBlocksi18n.emptyCouponSearch))},{singleCouponTexts:g,contentDisplaySettings:V,currentlySelectedCouponLabel:L,doneBtnText:A}=acfwfBlocksi18n,M=n=>{const{attributes:e,name:c,setAttributes:t}=n,[r,o]=wp.element.useState(1>e.coupon_id);return React.createElement(React.Fragment,null,React.createElement(wp.blockEditor.BlockControls,null,React.createElement(wp.components.ToolbarGroup,{controls:[{icon:"edit",title:"Edit",onClick:()=>o(!r),isActive:r}]})),React.createElement(wp.blockEditor.InspectorControls,{key:"inspector"},React.createElement(wp.components.PanelBody,{title:V.title,initialOpen:!0},React.createElement(k,{settings:e.contentVisibility,onChange:u=>t({contentVisibility:u})}))),r?React.createElement(wp.components.Placeholder,{label:g.title,className:"acfw-block-single-coupon"},g.description,React.createElement("div",{className:"acfw-single-block-fields"},e.coupon_code!==""&&React.createElement("div",{className:"acfw-block-current-coupon-selected"},React.createElement("span",null,L),React.createElement("span",{className:"coupon-code",title:e.coupon_code},e.coupon_code)),React.createElement("div",{className:"acfw-block-coupon__selection"},React.createElement(I,{coupon_id:e.coupon_id,setAttributes:t}))),React.createElement("div",{className:"acfw-block-action-buttons"},React.createElement(wp.components.Button,{isPrimary:!0,onClick:()=>o(!1)},A))):React.createElement(React.Fragment,null,0<e.coupon_id?React.createElement(wp.serverSideRender,{block:c,attributes:e,EmptyResponsePlaceholder:()=>React.createElement(wp.components.Placeholder,{label:g.title,className:"acfw-block-single-coupon"},g.emptyDesc)}):React.createElement(wp.components.Placeholder,{label:g.title,className:"acfw-block-coupons-grid acfw-block-coupons-category"},React.createElement("p",null,g.selectDesc))))},O=wp.components.withSpokenMessages(M),{orderTypeFieldTexts:f}=acfwfBlocksi18n,i={minColumns:1,maxColumns:6,minCount:1,maxCount:100},N=[{value:"date/desc",label:f.options.newestToOldest},{value:"date/asc",label:f.options.oldestToNewest},{value:"title/asc",label:f.options.aToZ},{value:"title/desc",label:f.options.zToA},{value:"expire/asc",label:f.options.earliestToExpire}],$={order_by:{type:"string",default:"date/desc"},columns:{type:"number",default:3},count:{type:"number",default:10}},v={contentVisibility:{type:"object",default:{discount_value:!0,description:!0,usage_limit:!0,schedule:!0}},isPreview:{type:"boolean",default:!1}};const{singleCouponTexts:x}=acfwfBlocksi18n,G={name:"acfw/single-coupon",settings:{title:x.title,icon:"tickets-alt",category:"advancedcoupons",keywords:["coupon","advanced"],decription:x.description,supports:{align:["wide","full"],html:!1},example:{attributes:{isPreview:!0}},attributes:{coupon_id:{type:"number",default:0},coupon_code:{type:"string",default:""},...v},edit(n){return React.createElement(O,{...n})},save(){return null}}};function H(){const n=wp.element.useRef(!0),e=wp.element.useCallback(()=>n.current,[]);return wp.element.useEffect(()=>()=>void(n.current=!1),[]),e}const{couponsCategoryTexts:U}=acfwfBlocksi18n,j=n=>{const{categories:e,setCategories:c,selected:t,onChange:r}=n,o=H();wp.element.useEffect(()=>{0<e.length||wp.apiFetch({path:"/wp/v2/shop_coupon_cat?per_page=-1&order=desc&orderby=count"}).then(a=>{o&&c(a)})},[]);const u=(a,p)=>{r(a?[...t,p.id]:t.filter(s=>s!==p.id))};return React.createElement("div",{className:"acfw-coupon-categories"},React.createElement("div",{className:"acfw-coupon-categories__label"},U.selectCategories),React.createElement("div",{className:"acfw-coupon-categories__list"},e.length?React.createElement(React.Fragment,null,e.map(a=>React.createElement("div",{className:"acfw-coupon-categories__item",key:a.id},React.createElement(wp.components.CheckboxControl,{label:"".concat(a.name," (").concat(a.count,")"),checked:t.includes(a.id),onChange:p=>u(p,a)})))):React.createElement("div",{className:"acfw-coupon-categories__spinner"},React.createElement(wp.components.Spinner,null))))},{couponsCategoryTexts:w,orderTypeFieldTexts:z,numberofItemsFieldLabel:Z,numberofColumnsFieldLabel:q,contentDisplaySettings:J,doneBtnText:K}=acfwfBlocksi18n,Q=n=>{const{attributes:e,name:c,setAttributes:t,debouncedSpeak:r}=n,[o,u]=wp.element.useState(1>e.categories.length),[a,p]=wp.element.useState([]),s=e.categories.length>0;return React.createElement(React.Fragment,null,React.createElement(wp.blockEditor.BlockControls,null,React.createElement(wp.components.ToolbarGroup,{controls:[{icon:"edit",title:"Edit",onClick:()=>u(!o),isActive:o}]})),React.createElement(wp.blockEditor.InspectorControls,{key:"inspector"},React.createElement(wp.components.PanelBody,{title:J.title,initialOpen:!0},React.createElement(k,{settings:e.contentVisibility,onChange:l=>t({contentVisibility:l})}))),o?React.createElement(wp.components.Placeholder,{label:w.title,className:"acfw-block-coupons-grid acfw-block-coupons-category"},w.description,React.createElement("div",{className:"wc-block-coupon-category__selection fullwidth-field"},React.createElement(j,{categories:a,setCategories:p,selected:e.categories,onChange:(l=[])=>{t({categories:l})}})),React.createElement("div",{className:"order-by__selection one-third-col"},React.createElement(wp.components.SelectControl,{label:z.label,value:e.order_by,options:N,onChange:l=>t({order_by:l})})),React.createElement("div",{className:"items-count__range one-third-col"},React.createElement(wp.components.RangeControl,{label:Z,value:e.count,onChange:l=>{const b=window.lodash.clamp(l,i.minCount,i.maxCount);t({count:b})},min:i.minCount,max:i.maxCount})),React.createElement("div",{className:"column-count__range one-third-col"},React.createElement(wp.components.RangeControl,{label:q,value:e.columns,onChange:l=>{const b=window.lodash.clamp(l,i.minColumns,i.maxColumns);t({columns:b})},min:i.minColumns,max:i.maxColumns})),React.createElement(wp.components.Button,{isPrimary:!0,onClick:()=>u(!1)},K)):React.createElement(React.Fragment,null,s?React.createElement(wp.serverSideRender,{block:c,attributes:e,EmptyResponsePlaceholder:()=>React.createElement(wp.components.Placeholder,{label:w.title,className:"acfw-block-coupons-grid acfw-block-coupons-category"},w.emptyDesc)}):React.createElement(wp.components.Placeholder,{label:w.title,className:"acfw-block-coupons-grid acfw-block-coupons-category"},React.createElement("p",null,w.selectDesc))))},W=wp.components.withSpokenMessages(Q);const{couponsCategoryTexts:T}=acfwfBlocksi18n,X={name:"acfw/coupons-category",settings:{title:T.title,icon:"tickets-alt",category:"advancedcoupons",keywords:["coupon","advanced","category"],decription:T.description,supports:{align:["wide","full"],html:!1},example:{attributes:{isPreview:!0}},attributes:{categories:{type:"array",default:[]},...$,...v},edit(n){return React.createElement(W,{...n})},save(){return null}}},{isPremium:h,couponsCustomerTexts:E,displayTypeFieldTexts:R,orderTypeFieldTexts:Y,numberofItemsFieldLabel:ee,numberofColumnsFieldLabel:te,contentDisplaySettings:ne,premiumUpsellMessage:S,doneBtnText:oe}=acfwfBlocksi18n,ce=n=>{const{attributes:e,name:c,setAttributes:t,debouncedSpeak:r}=n,[o,u]=wp.element.useState(e.display_type===""),a=[{value:"both",label:R.options.couponsAndVirtualCoupons},{value:"coupons_only",label:R.options.couponsOnly},{value:"virtual_only",label:R.options.virtualCouponsOnly}],p=()=>{e.display_type===""&&t({display_type:"both"}),u(!1)};return React.createElement(React.Fragment,null,React.createElement(wp.blockEditor.BlockControls,null,React.createElement(wp.components.ToolbarGroup,{controls:[{icon:"edit",title:"Edit",onClick:()=>u(!o),isActive:o}]})),React.createElement(wp.blockEditor.InspectorControls,{key:"inspector"},React.createElement(wp.components.PanelBody,{title:ne.title,initialOpen:!0},React.createElement(k,{settings:e.contentVisibility,onChange:s=>t({contentVisibility:s})}))),o?React.createElement(wp.components.Placeholder,{label:E.title,className:"acfw-block-coupons-grid acfw-block-coupons-customer ".concat(h?"":"acfw-disabled-upsell")},React.createElement("div",{className:"description fullwidth-field"},E.description),React.createElement("div",{className:"display-type__selection one-half-col"},React.createElement(wp.components.SelectControl,{label:R.label,value:e.display_type,options:a,onChange:s=>t({display_type:s})})),React.createElement("div",{className:"order-by__selection one-half-col"},React.createElement(wp.components.SelectControl,{label:Y.label,value:e.order_by,options:N,onChange:s=>t({order_by:s})})),React.createElement("div",{className:"items-count__range one-third-col"},React.createElement(wp.components.RangeControl,{label:ee,value:e.count,onChange:s=>{const l=window.lodash.clamp(s,i.minCount,i.maxCount);t({count:l})},min:i.minCount,max:i.maxCount})),React.createElement("div",{className:"column-count__range one-third-col"},React.createElement(wp.components.RangeControl,{label:te,value:e.columns,onChange:s=>{const l=window.lodash.clamp(s,i.minColumns,i.maxColumns);t({columns:l})},min:i.minColumns,max:i.maxColumns})),React.createElement("div",{className:"block-actions fullwidth-field"},React.createElement(wp.components.Button,{isPrimary:!0,onClick:p},oe)),!h&&React.createElement("div",{className:"acfw-upsell-message",dangerouslySetInnerHTML:{__html:S}})):React.createElement(wp.serverSideRender,{block:c,attributes:e,EmptyResponsePlaceholder:()=>React.createElement(wp.components.Placeholder,{label:E.title,className:"acfw-block-coupons-grid acfw-block-coupons-customer"},E.emptyDesc,!h&&React.createElement("div",{className:"acfw-upsell-message",dangerouslySetInnerHTML:{__html:S}}))}))},le=wp.components.withSpokenMessages(ce);const{couponsCustomerTexts:B}=acfwfBlocksi18n,ae={name:"acfw/coupons-customer",settings:{title:B.title,icon:"tickets-alt",category:"advancedcoupons",keywords:["coupon","advanced","customer","user"],decription:B.title,supports:{align:["wide","full"],html:!1},example:{attributes:{isPreview:!0}},attributes:{display_type:{type:"string",default:""},...$,...v},edit(n){return React.createElement(le,{...n})},save(){return null}}};const se=n=>{if(!n)return;const{name:e,settings:c}=n;wp.blocks.registerBlockType(e,c)};wp.domReady(()=>{[G,X,ae].forEach(se)});export{ie as __vite_legacy_guard};

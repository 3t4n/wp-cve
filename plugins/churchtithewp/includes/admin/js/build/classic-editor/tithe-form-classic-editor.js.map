{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./includes/admin/js/src/classic-editor/shortcode-insert.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","window","Church_Tithe_WP_Classic_Editor_Shortcode_Inserter","_React$Component","props","_this","_classCallCheck","this","_possibleConstructorReturn","_getPrototypeOf","state","default_form_id","form_id","form_json","form_dynamic_settings","church_tithe_wp_classic_editor_vars","church_tithe_wp_dynamic_settings","default_modal_visual_state","ctwp_classic_editor","insert_to_tinymce","remount","_inherits","React","Component","_this2","setState","church_tithe_wp_block_default_json","_this3","get_form_json_from_server","set_all_current_visual_states","new_state","arguments","length","undefined","new_modal_state","all_current_visual_states","modal_visual_state","_this4","Promise","resolve","reject","postData","FormData","append","get_form_nonce","fetch","get_form_endpoint","method","credentials","body","then","response","status","console","log","json","data","success","JSON","parse","catch","err","_this5","stringify","create_or_update_form_nonce","create_or_update_form_endpoint","new_form_json","_this6","use_typing_delay","keypress_delay","clearTimeout","setTimeout","create_or_update_form","_this7","send_to_editor","close_lightbox","_this8","createElement","Church_Tithe_WP_Modal","main_component","slug","modal_contents","className","church_tithe_wp_editing_strings","insert_shortcode_area_title","onClick","sendShortcodeToEditor","insert_shortcode","update_shortcode","cancel_shortcode","Church_Tithe_WP_Form","id","form_number","editing_mode","editing_parent_component","payment","frontend_nonces","church_tithe_wp_js_vars","unique_settings","dynamic_settings","church_tithe_wp_refresh_classic_editor_shortcode_inserter","lightbox_container","document","getElementById","ReactDOM","render","church_tithe_wp_set_shortcode_insert_modal_to_open","church_tithe_wp_move_shortcode_edit_media_buttons","querySelector","querySelectorAll","forEach","church_tithe_wp_media_buttons_container","previousElementSibling","innerHTML","remove"],"mappings":"aACA,IAAAA,EAAA,GAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAC,QAGA,IAAAC,EAAAJ,EAAAE,GAAA,CACAG,EAAAH,EACAI,GAAA,EACAH,QAAA,IAUA,OANAI,EAAAL,GAAAM,KAAAJ,EAAAD,QAAAC,IAAAD,QAAAF,GAGAG,EAAAE,GAAA,EAGAF,EAAAD,QAKAF,EAAAQ,EAAAF,EAGAN,EAAAS,EAAAV,EAGAC,EAAAU,EAAA,SAAAR,EAAAS,EAAAC,GACAZ,EAAAa,EAAAX,EAAAS,IACAG,OAAAC,eAAAb,EAAAS,EAAA,CAA0CK,YAAA,EAAAC,IAAAL,KAK1CZ,EAAAkB,EAAA,SAAAhB,GACA,oBAAAiB,eAAAC,aACAN,OAAAC,eAAAb,EAAAiB,OAAAC,YAAA,CAAwDC,MAAA,WAExDP,OAAAC,eAAAb,EAAA,cAAiDmB,OAAA,KAQjDrB,EAAAsB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAArB,EAAAqB,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,iBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAX,OAAAY,OAAA,MAGA,GAFA1B,EAAAkB,EAAAO,GACAX,OAAAC,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAArB,EAAAU,EAAAe,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAzB,EAAA6B,EAAA,SAAA1B,GACA,IAAAS,EAAAT,KAAAqB,WACA,WAA2B,OAAArB,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAH,EAAAU,EAAAE,EAAA,IAAAA,GACAA,GAIAZ,EAAAa,EAAA,SAAAiB,EAAAC,GAAsD,OAAAjB,OAAAkB,UAAAC,eAAA1B,KAAAuB,EAAAC,IAGtD/B,EAAAkC,EAAA,GAIAlC,IAAAmC,EAAA,0zBCvEAC,OAAOC,6CAAP,SAAAC,GAEC,SAAAD,EAAaE,GAAO,IAAAC,EAAA,mGAAAC,CAAAC,KAAAL,IACnBG,EAAAG,EAAAD,KAAAE,EAAAP,GAAA9B,KAAAmC,KAAMH,KAEDM,MAAQ,CACZC,gBAAiB,KACjBC,QAAS,KACTC,UAAW,KACXC,sBAAuBC,+BAA+BC,4BACtDC,2BAA4B,CAC3BC,oBAAuB,IAExBC,mBAAmB,EACnBC,SAAS,GAZSf,YAFrB,yOAAAgB,CAAAnB,EAAiHoB,MAAMC,aAAvHrB,KAAA,EAAAV,IAAA,oBAAAN,MAAA,WAmBqB,IAAAsC,EAAAjB,KACnBA,KAAKkB,SAAU,CACdd,gBAAiBJ,KAAKH,MAAMO,gBAC5BC,QAASL,KAAKH,MAAMO,gBACpBQ,kBAAmBZ,KAAKH,MAAMe,mBAC5B,WAEKK,EAAKd,MAAME,SACjBY,EAAKC,SAAU,CACdZ,UAAWE,+BAA+BW,oCA5B/C,CAAAlC,IAAA,qBAAAN,MAAA,WAkCsB,IAAAyC,EAAApB,KAGfA,KAAKG,MAAMC,kBAAoBJ,KAAKH,MAAMO,iBAE9CJ,KAAKkB,SAAU,CACdL,SAAS,EACTT,gBAAiBJ,KAAKH,MAAMO,gBAC5BC,QAASL,KAAKH,MAAMO,gBACpBQ,kBAAmBZ,KAAKH,MAAMe,mBAC5B,WAEGQ,EAAKjB,MAAME,QACfe,EAAKC,4BAILD,EAAKF,SAAU,CACdZ,UAAWE,+BAA+BW,+BACxC,WACFC,EAAKF,SAAU,CACdL,SAAS,QAUTb,KAAKH,MAAMa,6BAA+BV,KAAKG,MAAMO,4BACzDV,KAAKkB,SAAU,CACdR,2BAA4BV,KAAKH,MAAMa,4BACrC,WACFU,EAAKE,+BAA+B,EAAOF,EAAKjB,MAAMO,gCArE1D,CAAAzB,IAAA,gCAAAN,MAAA,WA4E6E,IAA7C4C,EAA6CC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GAA1BG,EAA0BH,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GAKpED,IACNA,EAAYvB,KAAKG,MAAMyB,2BAIjBD,IACNA,EAAkB3B,KAAKG,MAAM0B,oBAG9B7B,KAAKkB,SAAU,CACdU,0BAA2BL,EAC3BM,mBAAoBF,MA5FvB,CAAA1C,IAAA,4BAAAN,MAAA,WAiG6B,IAAAmD,EAAA9B,KAE3B,OAAO,IAAI+B,QAAS,SAACC,EAASC,GAE7B,IAAIC,EAAW,IAAIC,SACnBD,EAASE,OAAO,SAAU,uBAC1BF,EAASE,OAAO,UAAWN,EAAK3B,MAAME,SACtC6B,EAASE,OAAO,4BAA6B5B,+BAA+B6B,gBAE5EC,MAAO9B,+BAA+B+B,kBAAmB,CACxDC,OAAQ,OACR3D,KAAM,cACN4D,YAAa,cACbC,KAAMR,IACHS,KACH,SAAEC,GACD,GAAyB,MAApBA,EAASC,OAGb,OAFAC,QAAQC,IAAI,gDAAkDH,EAASC,aACvEZ,EAAO,2BAKRW,EAASI,OAAOL,KACf,SAAEM,GACD,IAAKA,EAAKC,QAiBT,OAFAJ,QAAQC,IAAI,mCAAqCE,QACjDhB,EAAO,2BAdPH,EAAKZ,SAAU,CACdZ,UAAW6C,KAAKC,MAAOH,EAAKD,MAC5BnC,SAAS,GACP,WACFiB,EAAKZ,SAAU,CACdL,SAAS,GACP,WAEF,OADAmB,EAASiB,EAAK5C,SACP4C,EAAK5C,cAUfgD,MACD,SAAEC,GACDR,QAAQC,IAAI,gBAAiBO,GAC7BrB,EAAO,+BAKToB,MACD,SAAEC,GACDR,QAAQC,IAAI,gBAAiBO,GAC7BrB,EAAO,iCAzJZ,CAAAhD,IAAA,wBAAAN,MAAA,WAmKyB,IAAA4E,EAAAvD,KAEvB,OAAO,IAAI+B,QAAS,SAACC,EAASC,GAE7B,IAAIC,EAAW,IAAIC,SACnBD,EAASE,OAAO,SAAU,0BAC1BF,EAASE,OAAO,UAAWmB,EAAKpD,MAAME,SACtC6B,EAASE,OAAO,QAASe,KAAKK,UAAWD,EAAKpD,MAAMG,YACpD4B,EAASE,OAAO,yCAA0C5B,+BAA+BiD,6BAEzFnB,MAAO9B,+BAA+BkD,+BAAgC,CACrElB,OAAQ,OACR3D,KAAM,cACN4D,YAAa,cACbC,KAAMR,IACHS,KACH,SAAEC,GACD,GAAyB,MAApBA,EAASC,OAGb,OAFAC,QAAQC,IAAI,gDAAkDH,EAASC,aACvEZ,EAAO,yBAKRW,EAASI,OAAOL,KACf,SAAEM,GACD,IAAKA,EAAKC,QAYT,OAFAJ,QAAQC,IAAI,mCAAqCE,QACjDhB,EAAO,yBATPsB,EAAKrC,SAAU,CACdb,QAAS4C,EAAK5C,SACZ,WAEF,OADA2B,EAASiB,EAAK5C,SACP4C,EAAK5C,YASdgD,MACD,SAAEC,GACDR,QAAQC,IAAI,gBAAiBO,GAC7BrB,EAAO,6BAKToB,MACD,SAAEC,GACDR,QAAQC,IAAI,gBAAiBO,GAC7BrB,EAAO,+BAvNZ,CAAAhD,IAAA,kBAAAN,MAAA,SAgOkBgF,GAA0C,IAAAC,EAAA5D,KAA3B6D,EAA2BrC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GAE1D,OAAO,IAAIO,QAAS,SAACC,EAASC,GAE7B2B,EAAK1C,SAAU,CACdZ,UAAWqD,GACT,WAEGE,GAEAD,EAAKE,iBAERC,aAAcH,EAAKE,gBACnBF,EAAKE,eAAiB,MAIvBF,EAAKE,eAAiBE,WAAY,WACjCD,aAAcH,EAAKE,gBAGnBF,EAAKK,wBAAwBtB,KAAM,WAClCX,OAIC,MAGH4B,EAAKK,wBAAwBtB,KAAM,WAClCX,YA9PN,CAAA/C,IAAA,wBAAAN,MAAA,WAuQyB,IAAAuF,EAAAlE,KAEvBA,KAAKiE,wBAAwBtB,KAAM,WAGlC,IAAOuB,EAAK/D,MAAMS,kBACjB,OAAO,EAEPlB,OAAOyE,eAAgB,iBAAmBD,EAAK/D,MAAME,QAAU,QAMjEL,KAAKoE,mBArRP,CAAAnF,IAAA,iBAAAN,MAAA,WA2REqB,KAAKsB,8BAA+B,GAAI,MA3R1C,CAAArC,IAAA,SAAAN,MAAA,WA8RU,IAAA0F,EAAArE,KAER,IAAKA,KAAKG,MAAMU,SAAab,KAAKG,MAAMI,uBAA2BP,KAAKG,MAAMG,UAEvE,CAEN,OACCS,MAAAuD,cAACC,iBAAD,CACCC,eAAiBxE,KACjByE,KAAO,sBACPC,eACC3D,MAAAuD,cAAA,OAAKK,UAAU,iDACd5D,MAAAuD,cAAA,OAAKK,UAAU,oCACd5D,MAAAuD,cAAA,OAAKK,UAAU,wCACd5D,MAAAuD,cAAA,OAAKK,UAAU,+CACd5D,MAAAuD,cAAA,QAAMK,UAAU,8CAA+CC,2BAA2BC,8BAE3F9D,MAAAuD,cAAA,OAAKK,UAAU,6CACd5D,MAAAuD,cAAA,UAAQK,UAAU,SAASG,QAAU9E,KAAK+E,sBAAsB7F,KAAMc,OAE/DqE,EAAKlE,MAAMS,kBACNgE,2BAA2BI,iBAE3BJ,2BAA2BK,kBAGvClE,MAAAuD,cAAA,UAAQK,UAAU,qCAAqCG,QAAU9E,KAAKoE,eAAelF,KAAMc,OAAW4E,2BAA2BM,qBAIpInE,MAAAuD,cAAA,QAAMK,UAAU,sBACf5D,MAAAuD,cAACa,gBAAD,CACClG,IAAM,8BACNmG,GAAK,8BACLC,YA7BY,EA8BZC,cAAe,EACfC,yBAA2BvF,KAC3B4B,0BACC,CACC4D,QAAS,IAGXC,gBAAkBC,mBAAmBD,gBACrCE,gBAAkB3F,KAAKG,MAAMG,UAC7BsF,iBAAmB5F,KAAKG,MAAMI,4BAzCpC,MAAO,mCAjSVZ,EAAA,GAqVAD,OAAOmG,qDAAuD,SAA+DxF,GAAqE,IAA5DK,EAA4Dc,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAA/B,GAAIZ,IAA2BY,UAAAC,OAAA,QAAAC,IAAAF,UAAA,KAAAA,UAAA,GAC7LsE,EAAqBC,SAASC,eAAgB,sCAQlD,OANAC,SAASC,OAAQnF,MAAAuD,cAAC3E,6CAAD,CAChBS,gBAAkBC,EAClBK,2BAA6BA,EAC7BE,kBAAoBA,IACjBkF,IAEG,GAGRD,uDAGAnG,OAAOyG,8CAAgD,WAAuG,IAA/Cd,EAA+C7D,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAjC,KAAMZ,IAA2BY,UAAAC,OAAA,QAAAC,IAAAF,UAAA,KAAAA,UAAA,GAG7JqE,qDACCR,EACA,CACA1E,oBAAuB,IAEvBC,IAOFlB,OAAO0G,6CAA+C,WAEhBL,SAASM,cAAe,8BAKlBN,SAASO,iBAAkB,6BAGjCC,QAAQ,SAAUC,GAGrDA,EAAmCC,uBAAuBC,UAAYF,EAAmCC,uBAAuBC,UAAYF,EAAmCE,UAG/KF,EAAmCG","file":"includes/admin/js/build/classic-editor/tithe-form-classic-editor.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/*\n * Church Tithe WP\n * https://www.churchtithewp.com\n *\n * Licensed under the GPL license.\n *\n * Author: Church Tithe WP\n * Version: 1.0\n * Date: April 18, 2018\n */\n\nwindow.Church_Tithe_WP_Classic_Editor_Shortcode_Inserter = class Church_Tithe_WP_Classic_Editor_Shortcode_Inserter extends React.Component {\n\n\tconstructor( props ){\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\tdefault_form_id: null,\n\t\t\tform_id: null,\n\t\t\tform_json: null,\n\t\t\tform_dynamic_settings: church_tithe_wp_classic_editor_vars.church_tithe_wp_dynamic_settings,\n\t\t\tdefault_modal_visual_state: {\n\t\t\t\t'ctwp_classic_editor': {}\n\t\t\t},\n\t\t\tinsert_to_tinymce: true,\n\t\t\tremount: false,\n\t\t};\n\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.setState( {\n\t\t\tdefault_form_id: this.props.default_form_id,\n\t\t\tform_id: this.props.default_form_id,\n\t\t\tinsert_to_tinymce: this.props.insert_to_tinymce,\n\t\t}, () => {\n\t\t\t// If there's no form ID upon mount, this is a new Tithe Jar. Set the json to be the default values.\n\t\t\tif ( ! this.state.form_id ) {\n\t\t\t\tthis.setState( {\n\t\t\t\t\tform_json: church_tithe_wp_classic_editor_vars.church_tithe_wp_block_default_json\n\t\t\t\t} );\n\t\t\t}\n\t\t} );\n\t}\n\n\tcomponentDidUpdate() {\n\n\t\t// If the default form id in the props is different than the default form id in the state, fetch that new form ID from the server.\n\t\tif ( this.state.default_form_id !== this.props.default_form_id ) {\n\n\t\t\tthis.setState( {\n\t\t\t\tremount: true,\n\t\t\t\tdefault_form_id: this.props.default_form_id,\n\t\t\t\tform_id: this.props.default_form_id,\n\t\t\t\tinsert_to_tinymce: this.props.insert_to_tinymce,\n\t\t\t}, () => {\n\n\t\t\t\tif ( this.state.form_id ) {\n\t\t\t\t\tthis.get_form_json_from_server();\n\t\t\t\t} else {\n\n\t\t\t\t\t// If there's no form ID, this is a new form creation.\n\t\t\t\t\tthis.setState( {\n\t\t\t\t\t\tform_json: church_tithe_wp_classic_editor_vars.church_tithe_wp_block_default_json\n\t\t\t\t\t}, () => {\n\t\t\t\t\t\tthis.setState( {\n\t\t\t\t\t\t\tremount: false\n\t\t\t\t\t\t} );\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t\t// If the default modal setting for this changed, it needs to be reset and updated.\n\t\tif ( this.props.default_modal_visual_state !== this.state.default_modal_visual_state ) {\n\t\t\tthis.setState( {\n\t\t\t\tdefault_modal_visual_state: this.props.default_modal_visual_state\n\t\t\t}, () => {\n\t\t\t\tthis.set_all_current_visual_states( false, this.state.default_modal_visual_state );\n\t\t\t} );\n\t\t}\n\n\t}\n\n\t// This is a simplified version of the set_all_current_visual_states method from the main Tithe Form  component. This just doesn't do URL updating.\n\tset_all_current_visual_states( new_state = false, new_modal_state = false ) {\n\n\t\tvar in_initial_state = false;\n\n\t\t// If no new state was passed, we're probably just updating the modal state.\n\t\tif ( ! new_state ) {\n\t\t\tnew_state = this.state.all_current_visual_states;\n\t\t}\n\n\t\t// If no modal state was passed, we probably are just updating the main state.\n\t\tif ( ! new_modal_state ) {\n\t\t\tnew_modal_state = this.state.modal_visual_state;\n\t\t}\n\n\t\tthis.setState( {\n\t\t\tall_current_visual_states: new_state,\n\t\t\tmodal_visual_state: new_modal_state\n\t\t} );\n\t}\n\n\t// This will send a fetch call to the server to get the json for a form from the forms table.\n\tget_form_json_from_server() {\n\n\t\treturn new Promise( (resolve, reject) => {\n\n\t\t\tvar postData = new FormData();\n\t\t\tpostData.append('action', 'church_tithe_wp_get_form' );\n\t\t\tpostData.append('form_id', this.state.form_id );\n\t\t\tpostData.append('church_tithe_wp_get_form_nonce', church_tithe_wp_classic_editor_vars.get_form_nonce);\n\n\t\t\tfetch( church_tithe_wp_classic_editor_vars.get_form_endpoint, {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tmode: \"same-origin\",\n\t\t\t\tcredentials: \"same-origin\",\n\t\t\t\tbody: postData\n\t\t\t} ).then(\n\t\t\t\t( response ) => {\n\t\t\t\t\tif ( response.status !== 200 ) {\n\t\t\t\t\t\tconsole.log('Looks like there was a problem. Status Code: ' + response.status);\n\t\t\t\t\t\treject('unable_to_get_form_data');\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Examine the text in the response\n\t\t\t\t\tresponse.json().then(\n\t\t\t\t\t\t( data ) => {\n\t\t\t\t\t\t\tif ( data.success ) {\n\n\t\t\t\t\t\t\t\tthis.setState( {\n\t\t\t\t\t\t\t\t\tform_json: JSON.parse( data.json ),\n\t\t\t\t\t\t\t\t\tremount: true\n\t\t\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t\t\tthis.setState( {\n\t\t\t\t\t\t\t\t\t\tremount: false\n\t\t\t\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t\t\t\tresolve( data.form_id );\n\t\t\t\t\t\t\t\t\t\treturn data.form_id;\n\t\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tconsole.log('Looks like there was a problem: ' + data);\n\t\t\t\t\t\t\t\treject('unable_to_get_form_data');\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t).catch(\n\t\t\t\t\t\t( err ) => {\n\t\t\t\t\t\t\tconsole.log('Fetch Error: ', err);\n\t\t\t\t\t\t\treject('unable_to_get_form_data');\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t).catch(\n\t\t\t\t( err ) => {\n\t\t\t\t\tconsole.log('Fetch Error: ', err);\n\t\t\t\t\treject('unable_to_get_form_data');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t);\n\n\t\t} );\n\n\t}\n\n\t// This will send a fetch call to the server to generate or update a row in the forms table.\n\tcreate_or_update_form() {\n\n\t\treturn new Promise( (resolve, reject) => {\n\n\t\t\tvar postData = new FormData();\n\t\t\tpostData.append('action', 'church_tithe_wp_create_form' );\n\t\t\tpostData.append('form_id', this.state.form_id );\n\t\t\tpostData.append('state', JSON.stringify( this.state.form_json ) );\n\t\t\tpostData.append('church_tithe_wp_create_or_update_form_nonce', church_tithe_wp_classic_editor_vars.create_or_update_form_nonce);\n\n\t\t\tfetch( church_tithe_wp_classic_editor_vars.create_or_update_form_endpoint, {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tmode: \"same-origin\",\n\t\t\t\tcredentials: \"same-origin\",\n\t\t\t\tbody: postData\n\t\t\t} ).then(\n\t\t\t\t( response ) => {\n\t\t\t\t\tif ( response.status !== 200 ) {\n\t\t\t\t\t\tconsole.log('Looks like there was a problem. Status Code: ' + response.status);\n\t\t\t\t\t\treject('unable_to_create_form');\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Examine the text in the response\n\t\t\t\t\tresponse.json().then(\n\t\t\t\t\t\t( data ) => {\n\t\t\t\t\t\t\tif ( data.success ) {\n\n\t\t\t\t\t\t\t\tthis.setState( {\n\t\t\t\t\t\t\t\t\tform_id: data.form_id\n\t\t\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t\t\tresolve( data.form_id );\n\t\t\t\t\t\t\t\t\treturn data.form_id;\n\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tconsole.log('Looks like there was a problem: ' + data);\n\t\t\t\t\t\t\t\treject('unable_to_create_form');\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t).catch(\n\t\t\t\t\t\t( err ) => {\n\t\t\t\t\t\t\tconsole.log('Fetch Error: ', err);\n\t\t\t\t\t\t\treject('unable_to_create_form');\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t).catch(\n\t\t\t\t( err ) => {\n\t\t\t\t\tconsole.log('Fetch Error: ', err);\n\t\t\t\t\treject('unable_to_create_form');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t);\n\n\t\t} );\n\n\t}\n\n\tonChangeHandler( new_form_json, use_typing_delay = false ) {\n\n\t\treturn new Promise( (resolve, reject) => {\n\t\t\t// Temporarily store the value in the state of this component while we wait for the typing to stop.\n\t\t\tthis.setState( {\n\t\t\t\tform_json: new_form_json\n\t\t\t}, () => {\n\n\t\t\t\tif ( use_typing_delay ) {\n\t\t\t\t\t// Set up a delay which waits to save the tithe until .5 seconds after they stop typing.\n\t\t\t\t\tif( this.keypress_delay ) {\n\t\t\t\t\t\t// Clear the keypress delay if the user just typed\n\t\t\t\t\t\tclearTimeout( this.keypress_delay );\n\t\t\t\t\t\tthis.keypress_delay = null;\n\t\t\t\t\t}\n\n\t\t\t\t\t// (Re)-Set up the save_note_with_tithe to fire in 500ms\n\t\t\t\t\tthis.keypress_delay = setTimeout( () => {\n\t\t\t\t\t\tclearTimeout( this.keypress_delay );\n\n\t\t\t\t\t\t// Update the form data in the church_tithe_wp_forms custom table.\n\t\t\t\t\t\tthis.create_or_update_form().then( () => {\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t});\n\n\t\t\t\t\t}, 1000);\n\t\t\t\t} else {\n\t\t\t\t\t// Update the form data in the church_tithe_wp_forms custom table.\n\t\t\t\t\tthis.create_or_update_form().then( () => {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t});\n\t\t});\n\t};\n\n\tsendShortcodeToEditor() {\n\n\t\tthis.create_or_update_form().then( () => {\n\n\t\t\t// If we are only editing a shortcode, don't insert another shortcode into TinyMce.\n\t\t\tif ( ! this.state.insert_to_tinymce ) {\n\t\t\t\treturn false;\n\t\t\t} else {\n\t\t\t\twindow.send_to_editor( '[churchtithewp id=\"' + this.state.form_id + '\"]' );\n\t\t\t}\n\n\t\t} );\n\n\t\t// Close the lightbox.\n\t\tthis.close_lightbox();\n\n\t}\n\n\tclose_lightbox() {\n\t\t// Close the lightbox.\n\t\tthis.set_all_current_visual_states( {}, {} );\n\t}\n\n\trender() {\n\n\t\tif ( this.state.remount || ! this.state.form_dynamic_settings || ! this.state.form_json ) {\n\t\t\treturn '';\n\t\t} else {\n\t\t\tvar form_number = 1;\n\t\t\treturn (\n\t\t\t\t<Church_Tithe_WP_Modal\n\t\t\t\t\tmain_component={ this }\n\t\t\t\t\tslug={ 'ctwp_classic_editor' }\n\t\t\t\t\tmodal_contents={\n\t\t\t\t\t\t<div className=\"church-tithe-wp-classic-editor-shortcode-container\">\n\t\t\t\t\t\t\t<div className=\"church-tithe-wp-shortcode-insert-area\">\n\t\t\t\t\t\t\t\t<div className=\"church-tithe-wp-edit-container-admin-only\">\n\t\t\t\t\t\t\t\t\t<div className=\"church-tithe-wp-edit-container-admin-only-header\">\n\t\t\t\t\t\t\t\t\t\t<span className=\"church-tithe-wp-edit-container-admin-only-title\">{ church_tithe_wp_editing_strings.insert_shortcode_area_title }</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"church-tithe-wp-edit-container-admin-only-body\">\n\t\t\t\t\t\t\t\t\t\t<button className=\"button\" onClick={ this.sendShortcodeToEditor.bind( this ) }>{\n\t\t\t\t\t\t\t\t\t\t\t(() => {\n\t\t\t\t\t\t\t\t\t\t\t\tif ( this.state.insert_to_tinymce ) {\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn ( church_tithe_wp_editing_strings.insert_shortcode );\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn ( church_tithe_wp_editing_strings.update_shortcode );\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t})()}</button>\n\t\t\t\t\t\t\t\t\t\t<button className=\"button church-tithe-wp-cancel-shortcode\" onClick={ this.close_lightbox.bind( this ) }>{ church_tithe_wp_editing_strings.cancel_shortcode }</button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<span className=\"church-tithe-wp-element\">\n\t\t\t\t\t\t\t\t<Church_Tithe_WP_Form\n\t\t\t\t\t\t\t\t\tkey={ 'church_tithe_wp_button_element_' + form_number }\n\t\t\t\t\t\t\t\t\tid={ 'church_tithe_wp_button_element_' + form_number }\n\t\t\t\t\t\t\t\t\tform_number={ form_number }\n\t\t\t\t\t\t\t\t\tediting_mode={ true }\n\t\t\t\t\t\t\t\t\tediting_parent_component={ this }\n\t\t\t\t\t\t\t\t\tall_current_visual_states={\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tpayment: {}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tfrontend_nonces={ church_tithe_wp_js_vars.frontend_nonces }\n\t\t\t\t\t\t\t\t\tunique_settings={ this.state.form_json }\n\t\t\t\t\t\t\t\t\tdynamic_settings={ this.state.form_dynamic_settings }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t)\n\t\t}\n\t}\n}\n\nwindow.church_tithe_wp_refresh_classic_editor_shortcode_inserter = function church_tithe_wp_refresh_classic_editor_shortcode_inserter( form_id, default_modal_visual_state = {}, insert_to_tinymce = true ) {\n\tvar lightbox_container = document.getElementById( 'church_tithe_wp_classic_editor_lightbox' );\n\n\tReactDOM.render( <Church_Tithe_WP_Classic_Editor_Shortcode_Inserter\n\t\tdefault_form_id={ form_id }\n\t\tdefault_modal_visual_state={ default_modal_visual_state }\n\t\tinsert_to_tinymce={ insert_to_tinymce }\n\t/>, lightbox_container );\n\n\treturn false;\n\n}\nchurch_tithe_wp_refresh_classic_editor_shortcode_inserter();\n\n\nwindow.church_tithe_wp_set_shortcode_insert_modal_to_open = function church_tithe_wp_set_shortcode_insert_modal_to_open( form_number = null, insert_to_tinymce = true ) {\n\n\t//Open the Shortcode inserter lightbox\n\tchurch_tithe_wp_refresh_classic_editor_shortcode_inserter(\n\t\tform_number,\n\t\t{\n\t\t'ctwp_classic_editor': {}\n\t\t},\n\t\tinsert_to_tinymce\n\t);\n}\n\n// Move the media buttons into the right position.\n// We have to do this with javascript because the WordPress media_buttons hook is unable to scan the content of the wp_editor it is for.\n// This allows us to scan the contents for the churchtithewp shortcode, and output edit buttons dynamically, if the shortcode actually exists.\nwindow.church_tithe_wp_move_shortcode_edit_media_buttons = function church_tithe_wp_move_shortcode_edit_media_buttons() {\n\n\tvar church_tithe_wp_media_buttons_exist = document.querySelector( '.church-tithe-wp-media-buttons' );\n\n\t// Set all tithe jar forms on the page to have their modals closed, then we'll open this one.\n\tif ( church_tithe_wp_media_buttons_exist ) {\n\n\t\tvar church_tithe_wp_media_buttons_containers = document.querySelectorAll( '.church-tithe-wp-media-buttons' );\n\n\t\t// Loop through each Church Tithe WP Shortcode Media Buttons Container...\n\t\tchurch_tithe_wp_media_buttons_containers.forEach(function( church_tithe_wp_media_buttons_container ) {\n\n\t\t\t// Grab the contents of this container, and move them to the previous sibling's\n\t\t\tchurch_tithe_wp_media_buttons_container.previousElementSibling.innerHTML = church_tithe_wp_media_buttons_container.previousElementSibling.innerHTML + church_tithe_wp_media_buttons_container.innerHTML;\n\n\t\t\t// Remove the originals, which were in the wrong spot.\n\t\t\tchurch_tithe_wp_media_buttons_container.remove();\n\t\t} );\n\n\t}\n}\n//church_tithe_wp_move_shortcode_edit_media_buttons();\n"],"sourceRoot":""}
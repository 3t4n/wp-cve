!function(t){var e={};function o(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=e,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(r,n,function(e){return t[e]}.bind(null,n));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e){function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}window.Church_Tithe_WP_Classic_Editor_Shortcode_Inserter=function(t){function e(t){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=n(this,i(e).call(this,t))).state={default_form_id:null,form_id:null,form_json:null,form_dynamic_settings:church_tithe_wp_classic_editor_vars.church_tithe_wp_dynamic_settings,default_modal_visual_state:{ctwp_classic_editor:{}},insert_to_tinymce:!0,remount:!1},o}var o,_,s;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(e,React.Component),o=e,(_=[{key:"componentDidMount",value:function(){var t=this;this.setState({default_form_id:this.props.default_form_id,form_id:this.props.default_form_id,insert_to_tinymce:this.props.insert_to_tinymce},function(){t.state.form_id||t.setState({form_json:church_tithe_wp_classic_editor_vars.church_tithe_wp_block_default_json})})}},{key:"componentDidUpdate",value:function(){var t=this;this.state.default_form_id!==this.props.default_form_id&&this.setState({remount:!0,default_form_id:this.props.default_form_id,form_id:this.props.default_form_id,insert_to_tinymce:this.props.insert_to_tinymce},function(){t.state.form_id?t.get_form_json_from_server():t.setState({form_json:church_tithe_wp_classic_editor_vars.church_tithe_wp_block_default_json},function(){t.setState({remount:!1})})}),this.props.default_modal_visual_state!==this.state.default_modal_visual_state&&this.setState({default_modal_visual_state:this.props.default_modal_visual_state},function(){t.set_all_current_visual_states(!1,t.state.default_modal_visual_state)})}},{key:"set_all_current_visual_states",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t||(t=this.state.all_current_visual_states),e||(e=this.state.modal_visual_state),this.setState({all_current_visual_states:t,modal_visual_state:e})}},{key:"get_form_json_from_server",value:function(){var t=this;return new Promise(function(e,o){var r=new FormData;r.append("action","church_tithe_wp_get_form"),r.append("form_id",t.state.form_id),r.append("church_tithe_wp_get_form_nonce",church_tithe_wp_classic_editor_vars.get_form_nonce),fetch(church_tithe_wp_classic_editor_vars.get_form_endpoint,{method:"POST",mode:"same-origin",credentials:"same-origin",body:r}).then(function(r){if(200!==r.status)return console.log("Looks like there was a problem. Status Code: "+r.status),void o("unable_to_get_form_data");r.json().then(function(r){if(!r.success)return console.log("Looks like there was a problem: "+r),void o("unable_to_get_form_data");t.setState({form_json:JSON.parse(r.json),remount:!0},function(){t.setState({remount:!1},function(){return e(r.form_id),r.form_id})})}).catch(function(t){console.log("Fetch Error: ",t),o("unable_to_get_form_data")})}).catch(function(t){console.log("Fetch Error: ",t),o("unable_to_get_form_data")})})}},{key:"create_or_update_form",value:function(){var t=this;return new Promise(function(e,o){var r=new FormData;r.append("action","church_tithe_wp_create_form"),r.append("form_id",t.state.form_id),r.append("state",JSON.stringify(t.state.form_json)),r.append("church_tithe_wp_create_or_update_form_nonce",church_tithe_wp_classic_editor_vars.create_or_update_form_nonce),fetch(church_tithe_wp_classic_editor_vars.create_or_update_form_endpoint,{method:"POST",mode:"same-origin",credentials:"same-origin",body:r}).then(function(r){if(200!==r.status)return console.log("Looks like there was a problem. Status Code: "+r.status),void o("unable_to_create_form");r.json().then(function(r){if(!r.success)return console.log("Looks like there was a problem: "+r),void o("unable_to_create_form");t.setState({form_id:r.form_id},function(){return e(r.form_id),r.form_id})}).catch(function(t){console.log("Fetch Error: ",t),o("unable_to_create_form")})}).catch(function(t){console.log("Fetch Error: ",t),o("unable_to_create_form")})})}},{key:"onChangeHandler",value:function(t){var e=this,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise(function(r,n){e.setState({form_json:t},function(){o?(e.keypress_delay&&(clearTimeout(e.keypress_delay),e.keypress_delay=null),e.keypress_delay=setTimeout(function(){clearTimeout(e.keypress_delay),e.create_or_update_form().then(function(){r()})},1e3)):e.create_or_update_form().then(function(){r()})})})}},{key:"sendShortcodeToEditor",value:function(){var t=this;this.create_or_update_form().then(function(){if(!t.state.insert_to_tinymce)return!1;window.send_to_editor('[churchtithewp id="'+t.state.form_id+'"]')}),this.close_lightbox()}},{key:"close_lightbox",value:function(){this.set_all_current_visual_states({},{})}},{key:"render",value:function(){var t=this;if(!this.state.remount&&this.state.form_dynamic_settings&&this.state.form_json){return React.createElement(Church_Tithe_WP_Modal,{main_component:this,slug:"ctwp_classic_editor",modal_contents:React.createElement("div",{className:"church-tithe-wp-classic-editor-shortcode-container"},React.createElement("div",{className:"church-tithe-wp-shortcode-insert-area"},React.createElement("div",{className:"church-tithe-wp-edit-container-admin-only"},React.createElement("div",{className:"church-tithe-wp-edit-container-admin-only-header"},React.createElement("span",{className:"church-tithe-wp-edit-container-admin-only-title"},church_tithe_wp_editing_strings.insert_shortcode_area_title)),React.createElement("div",{className:"church-tithe-wp-edit-container-admin-only-body"},React.createElement("button",{className:"button",onClick:this.sendShortcodeToEditor.bind(this)},t.state.insert_to_tinymce?church_tithe_wp_editing_strings.insert_shortcode:church_tithe_wp_editing_strings.update_shortcode),React.createElement("button",{className:"button church-tithe-wp-cancel-shortcode",onClick:this.close_lightbox.bind(this)},church_tithe_wp_editing_strings.cancel_shortcode)))),React.createElement("span",{className:"church-tithe-wp-element"},React.createElement(Church_Tithe_WP_Form,{key:"church_tithe_wp_button_element_1",id:"church_tithe_wp_button_element_1",form_number:1,editing_mode:!0,editing_parent_component:this,all_current_visual_states:{payment:{}},frontend_nonces:church_tithe_wp_js_vars.frontend_nonces,unique_settings:this.state.form_json,dynamic_settings:this.state.form_dynamic_settings})))})}return""}}])&&r(o.prototype,_),s&&r(o,s),e}(),window.church_tithe_wp_refresh_classic_editor_shortcode_inserter=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=document.getElementById("church_tithe_wp_classic_editor_lightbox");return ReactDOM.render(React.createElement(Church_Tithe_WP_Classic_Editor_Shortcode_Inserter,{default_form_id:t,default_modal_visual_state:e,insert_to_tinymce:o}),r),!1},church_tithe_wp_refresh_classic_editor_shortcode_inserter(),window.church_tithe_wp_set_shortcode_insert_modal_to_open=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];church_tithe_wp_refresh_classic_editor_shortcode_inserter(t,{ctwp_classic_editor:{}},e)},window.church_tithe_wp_move_shortcode_edit_media_buttons=function(){document.querySelector(".church-tithe-wp-media-buttons")&&document.querySelectorAll(".church-tithe-wp-media-buttons").forEach(function(t){t.previousElementSibling.innerHTML=t.previousElementSibling.innerHTML+t.innerHTML,t.remove()})}}]);
//# sourceMappingURL=tithe-form-classic-editor.js.map
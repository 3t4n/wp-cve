!function(a){"use strict";a(function(){if(!(lock_your_updates.is_network_active&&!lock_your_updates.is_network_admin||!lock_your_updates.is_network_active&&lock_your_updates.is_network_admin)&&lock_your_updates["can_update_"+lock_your_updates.type]&&(jQuery("table.plugins").find("tr.lock-your-updates-update-tr, tr.lock-your-updates-preview-notes-tr").each(function(){var a=jQuery(this).data("file");void 0!==a&&null!==a&&(jQuery(this).hasClass("lock-your-updates-update-tr")&&jQuery("tr#"+a).addClass("update").addClass("lock-updates-update"),jQuery(this).hasClass("lock-your-updates-preview-notes-tr")&&jQuery("tr#"+a).addClass("preview-lock-updates-notes"))}),lock_your_updates.is_multisite||"themes"!=lock_your_updates.type)){if(jQuery(".wrap > h2").length>0){var a="",b="",c="",d=window.location.search.substring(1);if(d=d.split("&"),jQuery.each(d,function(d,e){var f=e.split("=");f.length>=2&&("action"==f[0]?a=f[1]:"empty"==f[0]?(b="empty",c=f[1]):"error"==f[0]?(b="error",c=f[1]):"success"==f[0]&&(b="success",c=f[1]))}),""!=a&&""!=b&&""!=c){var e="",f="success"==b?"updated":"error";b in lock_your_updates.confirmations&&a in lock_your_updates.confirmations[b]&&(e=lock_your_updates.confirmations[b][a]),""!=e&&jQuery(".wrap > h2").after('<div id="message" class="'+f+'"><p>'+e+"</p></div>")}}jQuery(".bulkactions").length>0&&jQuery(".bulkactions").find('select[name="action"]').append('<option value="lock-selected-updates">'+lock_your_updates.lock_updates_text+'</option><option value="unlock-selected-updates">'+lock_your_updates.unlock_updates_text+"</option>"),jQuery(".lock-your-updates-edit-notes").on("click",function(a){a.preventDefault(),jQuery("#"+jQuery(this).data("item-row")).lock_your_updates_list_table_edit_note(jQuery(this).attr("href"))}),jQuery.fn.lock_your_updates_list_table_edit_note=function(a){{var b={};a.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(a,c,d){b[c]=d})}if("action"in b&&"lock-your-updates-edit-notes-"+lock_your_updates.type==b.action&&lock_your_updates.type in b&&""!=b[lock_your_updates.type]&&"_wpnonce"in b&&""!=b._wpnonce){var c=jQuery(this);if(""!=c.attr("id")){var d=c.children().length,e=c.attr("id"),f=void 0;jQuery("#lock-your-updates-update-"+e+"-row").length>0?f=jQuery("#lock-your-updates-update-"+e+"-row"):c.next().hasClass("plugin-update-tr")&&(f=c.next());var g=jQuery("#lock-your-updates-"+e+"-preview-notes-row"),h="lock-your-updates-edit-"+e+"-notes";if(!(jQuery("tr#"+h).length>0)){var i=jQuery('<tr id="'+h+'" class="lock_your_updates_inline_edit_notes inline-edit-row"></tr>');c.hasClass("active")&&i.addClass("active"),c.hasClass("update")&&i.addClass("update");var j=jQuery('<td class="wrapper loading"></td>');j.height(c.outerHeight()),d>1&&j.attr("colspan",d),i.append(j),c.hide();var k=!1;void 0!==g&&g.length>0&&(i.hide().insertAfter(g).fadeIn(),k=!0,g.hide()),void 0!==f&&f.length>0&&(k||(i.hide().insertAfter(f).fadeIn(),k=!0),f.hide()),k||i.hide().insertAfter(c).fadeIn(),jQuery.ajax({url:ajaxurl,type:"POST",dataType:"json",async:!1,cache:!1,data:{action:"lock_your_updates_get_item_data",item_type:lock_your_updates.type,item_id:b[lock_your_updates.type],nonce_required:!0,nonce:b._wpnonce},error:function(){c.lock_your_updates_list_table_edit_notes_error()},success:function(a){if(!a||void 0===typeof a||null==a)return void c.lock_your_updates_list_table_edit_notes_error();if(void 0===typeof a.passed_nonce||null==a.passed_nonce||!a.passed_nonce)return void c.lock_your_updates_list_table_edit_notes_error();if(void 0===typeof a.name||null==a.name||void 0===typeof a.locked||null==a.locked)return void c.lock_your_updates_list_table_edit_notes_error();var d=jQuery('<table cellpadding="0" cellspacing="0" border="0"></table>');d.append("<tr></tr>");var e=jQuery('<td class="icon"></td>');e.append(a.locked?'<div class="locked-update-icon"></div>':'<div class="unlocked-update-icon"></div>'),d.find("tr").append(e).fadeIn();var f=jQuery('<td class="main"></td>');f.append('<h3><span class="notes-for">'+lock_your_updates.notes_for+"</span> "+a.name+"</h3>"),f.append(a.locked?'<h4 class="locked">'+lock_your_updates.type_locked+"</h4>":'<h4 class="unlocked">'+lock_your_updates.type_unlocked+"</h4>");var g=jQuery("<textarea></textarea>");void 0!=a.notes&&null!=a.notes&&g.val(a.notes),f.append(g);var h=jQuery('<a class="button-primary save alignleft" href="" accesskey="s">Save</a>');h.on("click",function(a){a.preventDefault(),c.lock_your_updates_list_table_save_note(b,g.val())}),f.append(h);var i=jQuery('<a class="button-secondary cancel alignleft" href="" accesskey="c">Cancel</a>');i.on("click",function(a){a.preventDefault(),c.lock_your_updates_list_table_close_edit_note()}),f.append(i),d.find("tr").append(f),j.append(d),j.removeClass("loading").css("height","auto")},complete:function(){}})}}}},jQuery.fn.lock_your_updates_list_table_save_note=function(a,b){if("action"in a&&"lock-your-updates-edit-notes-"+lock_your_updates.type==a.action&&lock_your_updates.type in a&&""!=a[lock_your_updates.type]&&"_wpnonce"in a&&""!=a._wpnonce){var c=jQuery(this);if(""!=c.attr("id")){var d=c.attr("id"),e=a[lock_your_updates.type];jQuery.ajax({url:ajaxurl,type:"POST",dataType:"json",async:!1,cache:!1,data:{action:"lock_your_updates_save_item_notes",item_type:lock_your_updates.type,item_id:e,nonce:a._wpnonce,item_notes:b},error:function(){alert(lock_your_updates.errors.save_notes)},success:function(a){if(!a||void 0===typeof a||null==a)return void alert(lock_your_updates.errors.save_notes);if(void 0===typeof a.passed_nonce||null==a.passed_nonce||!a.passed_nonce)return void alert(lock_your_updates.errors.save_notes);if(void 0==a.saved_note||null==a.saved_note||!a.saved_note)return void alert(lock_your_updates.errors.save_notes);var b=null;if("item_notes"in a){b=a.item_notes;var f=c.find("td.column-lock-your-updates").find(".icon-wrapper.notes");null!=a.item_notes&&""!=a.item_notes?f.removeClass("empty"):f.addClass("empty")}var g=jQuery("#lock-your-updates-update-"+d+"-row"),h=jQuery("#lock-your-updates-"+d+"-preview-notes-row");void 0===b||""==b?(h.remove(),c.removeClass("preview-lock-updates-notes"),g.removeClass("lock-your-updates-item-has-notes")):jQuery.ajax({url:ajaxurl,type:"POST",dataType:"html",async:!1,cache:!1,data:{action:"lock_your_updates_get_item_preview_notes_row",item_type:lock_your_updates.type,item_id:e,item_html_id:d,wp_list_table_column_count:c.children().length,item_notes:b},error:function(){},success:function(a){if(void 0!==a&&""!=a){var b=jQuery(a);0==h.length?(c.addClass("preview-lock-updates-notes"),g.length>0?(g.addClass("lock-your-updates-item-has-notes"),b.insertAfter(g)):b.insertAfter(c)):h.replaceWith(b),jQuery(".lock-your-updates-edit-notes").on("click",function(a){a.preventDefault(),jQuery("#"+jQuery(this).data("item-row")).lock_your_updates_list_table_edit_note(jQuery(this).attr("href"))})}},complete:function(){}}),c.lock_your_updates_list_table_close_edit_note();var i=jQuery('<div class="lock-your-updates-checkmark"></div>').hide();i.appendTo(jQuery("body")).css({width:c.outerWidth(),height:c.outerHeight(),left:c.offset().left+"px",top:c.offset().top+"px","background-size":c.outerHeight()+"px"}).show().animate({opacity:0},1e3,function(){i.remove()})},complete:function(){}})}}},jQuery.fn.lock_your_updates_list_table_close_edit_note=function(){var a=jQuery(this),b=a.attr("id");jQuery("tr#lock-your-updates-edit-"+b+"-notes").remove(),a.fadeIn(),jQuery("#lock-your-updates-update-"+b+"-row").length>0?jQuery("#lock-your-updates-update-"+b+"-row").fadeIn():a.next().hasClass("plugin-update-tr")&&a.next().fadeIn(),jQuery("#lock-your-updates-"+b+"-preview-notes-row").length>0&&jQuery("#lock-your-updates-"+b+"-preview-notes-row").fadeIn()},jQuery.fn.lock_your_updates_list_table_edit_notes_error=function(a){var b=jQuery(this),c=b.attr("id"),d=jQuery("tr#lock-your-updates-edit-"+c+"-notes td.wrapper");(void 0===a||""==a)&&(a=lock_your_updates.errors.load_notes);var e=jQuery('<a class="button-secondary close" href="" accesskey="c">Close this message</a>');e.on("click",function(a){a.preventDefault(),b.lock_your_updates_list_table_close_edit_note()}),d.append("<p>"+a+"</p>").append(e).removeClass("loading").addClass("error")}}})}(jQuery);
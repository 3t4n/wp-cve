"use strict";if(cawpItemData.mapsApiKey){google.charts.load("current",{mapsApiKey:cawpItemData.mapsApiKey,packages:["corechart","table","orgchart","geochart","controls"]})}else{google.charts.load("current",{packages:["corechart","table","orgchart","geochart","controls"]})}google.charts.setOnLoadCallback(CAWPReportLoad);cawpItemData.getID=function(a){if(cawpItemData.scope=="admin-item"){if(typeof a.id=="undefined"){return 0}if(a.id.split("-")[1]=="undefined"){return 0}else{return a.id.split("-")[1]}}else{if(typeof a.id=="undefined"){return 1}if(a.id.split("-")[4]=="undefined"){return 1}else{return a.id.split("-")[4]}}};cawpItemData.getSelector=function(a){if(a=="admin-item"){return'a[id^="cawp-"]'}else{return'li[id^="wp-admin-bar-cawp"] a'}};cawpItemData.responsiveDialog=function(){var b,a,c;c=jQuery(".ui-dialog:visible");c.each(function(){b=jQuery(this).find(".ui-dialog-content").data("ui-dialog");if(b.options.fluid){a=jQuery(window).width();if(a<(parseInt(b.options.maxWidth)+50)){jQuery(this).css("max-width","90%")}else{jQuery(this).css("max-width",b.options.maxWidth+"px")}b.option("position",b.options.position)}})};jQuery.fn.extend({cawpItemReport:function(g){var a,d,h,e,f,i,c,b="-"+g;d={setCookie:function(k,m){var j,l=new Date();if(cawpItemData.scope=="admin-widgets"){k="cawp_wg_"+k}else{k="cawp_ir_"+k}l.setTime(l.getTime()+(24*60*60*1000*365));j="expires="+l.toUTCString();document.cookie=k+"="+m+"; "+j+"; path=/"},getCookie:function(j){var l,m,n,k=0;if(cawpItemData.scope=="admin-widgets"){j="cawp_wg_"+j+"="}else{j="cawp_ir_"+j+"="}m=document.cookie.split(";");for(k=0;k<m.length;k++){l=m[k];while(l.charAt(0)==" "){l=l.substring(1)}if(l.indexOf(j)==0){return l.substring(j.length,l.length)}}return false},escape:function(j){div=document.createElement("div");div.appendChild(document.createTextNode(j));return div.innerHTML},isNumeric:function(j){return !isNaN(parseFloat(j))&&isFinite(j)}};h={addOptions:function(p,o){var j,m,n,l,k=[];if(!d.getCookie("default_metric")||!d.getCookie("default_dimension")||!d.getCookie("default_swmetric")||!d.getCookie("default_interval")){j="sessions";m=moment().subtract(30,"days").format("YYYY-MM-DD")+" - "+moment().subtract(1,"days").format("YYYY-MM-DD");c="visitors";l="Last 30 Days";d.setCookie("default_metric",j);d.setCookie("default_dimension",m);d.setCookie("default_interval",l);d.setCookie("default_swmetric",c)}else{j=d.getCookie("default_metric");m=d.getCookie("default_dimension");n=d.getCookie("default_view");l=d.getCookie("default_interval");switch(l){case"Today":m=moment().subtract(0,"days").format("YYYY-MM-DD")+" - "+moment().format("YYYY-MM-DD");break;case"Yesterday":m=moment().subtract(1,"days").format("YYYY-MM-DD")+" - "+moment().subtract(1,"days").format("YYYY-MM-DD");break;case"Last 7 Days":m=moment().subtract(6,"days").format("YYYY-MM-DD")+" - "+moment().format("YYYY-MM-DD");break;case"Last 30 Days":m=moment().subtract(29,"days").format("YYYY-MM-DD")+" - "+moment().format("YYYY-MM-DD");break;case"Last 90 Days":m=moment().subtract(89,"days").format("YYYY-MM-DD")+" - "+moment().format("YYYY-MM-DD");break;case"This Month":m=moment().startOf("month").format("YYYY-MM-DD")+" - "+moment().endOf("month").format("YYYY-MM-DD");break;case"Last Month":m=moment().subtract(1,"month").startOf("month").format("YYYY-MM-DD")+" - "+moment().subtract(1,"month").endOf("month").format("YYYY-MM-DD");break}c=d.getCookie("default_swmetric")}if(o=="submetrics"){jQuery(p).html(k)}else{if(o=="range"){jQuery(p).val(m)}else{jQuery.each(o,function(q,r){if(q==j||q==m||q==n){k.push('<option value="'+q+'" selected="selected">'+r+"</option>")}else{k.push('<option value="'+q+'">'+r+"</option>")}});jQuery(p).html(k.join(""))}}},init:function(){var j;if(!jQuery("#cawp-window"+b).length){return}if(jQuery("#cawp-window"+b).html().length){return}j='<div id="cawp-container'+b+'">';if(cawpItemData.propertyList!=false){j+='<select id="cawp-sel-property'+b+'"></select>'}j+='<input type="text" id="cawp-sel-period'+b+'" name="cawp-sel-period'+b+'" size="21"/>';j+='<select id="cawp-sel-report'+b+'"></select>';j+='<div id="cawp-sel-metric'+b+'" style="float:right;display:none;">';j+="</div>";j+='<div id="cawp-progressbar'+b+'"></div>';j+='<div id="cawp-status'+b+'"></div>';j+='<div id="cawp-reports'+b+'"></div>';j+='<div style="text-align:right;width:100%;font-size:0.8em;clear:both;margin-right:5px;margin-top:10px;">';j+=cawpItemData.i18n[14];j+=' <a href="https://deconf.com/clicky-analytics-dashboard-wordpress/" rel="nofollow" style="text-decoration:none;font-size:1em;color:#0073aa;">Clicky Analytics</a>&nbsp;';j+="</div>";j+="</div>",jQuery("#cawp-window"+b).append(j);h.addOptions("#cawp-sel-period"+b,"range");h.addOptions("#cawp-sel-property"+b,cawpItemData.propertyList);h.addOptions("#cawp-sel-report"+b,cawpItemData.reportList);h.addOptions("#cawp-sel-metric"+b,"submetrics")}};e={oldViewPort:0,inProgress:0,orgChartTableChartData:"",tableChartData:"",orgChartPieChartsData:"",geoChartTableChartData:"",areachartSummaryData:"",rtRuns:null,i18n:null,getTitle:function(j){if(j=="admin-item"){return jQuery("#cawp"+b).attr("title")}else{return cawpItemData.i18n[16]}},alertMessage:function(j){jQuery("#cawp-status"+b).css({"margin-top":"3px","padding-left":"5px",height:"auto",color:"#000","border-left":"5px solid red"});jQuery("#cawp-status"+b).html(j)},areachartSummary:function(j){var k;jQuery("#cawp-sel-metric"+b).hide();k='<div id="cawp-areachartsummary'+b+'">';k+='<div id="cawp-summary'+b+'">';k+='<div class="inside">';k+='<div class="small-box first"><h3>'+cawpItemData.i18n[5]+'</h3><p id="cawpvisitors'+b+'">&nbsp;</p></div>';k+='<div class="small-box second"><h3>'+cawpItemData.i18n[6]+'</h3><p id="cawppageviews'+b+'">&nbsp;</p></div>';k+='<div class="small-box third"><h3>'+cawpItemData.i18n[7]+'</h3><p id="cawptimeaverage'+b+'">&nbsp;</p></div>';k+='<div class="small-box last"><h3>'+cawpItemData.i18n[8]+'</h3><p id="cawpbouncerate'+b+'">&nbsp;</p></div>';k+="</div>";k+='<div id="cawp-areachart'+b+'"></div>';k+="</div>";k+="</div>";if(!jQuery("#cawp-areachartsummary"+b).length){jQuery("#cawp-reports"+b).html(k)}e.areachartSummaryData=j;if(Array.isArray(j)){if(!d.isNumeric(j[0])){if(Array.isArray(j[0])){if(a.query=="visitBounceRate,summary"){e.drawareachart(j[0],true)}else{e.drawareachart(j[0],false)}}else{e.throwDebug(j[0])}}else{e.throwError("#cawp-areachart"+b,j[0],"125px")}if(!d.isNumeric(j[1])){if(Array.isArray(j[1])){e.drawSummary(j[1])}else{e.throwDebug(j[1])}}else{e.throwError("#cawp-summary"+b,j[1],"40px")}}else{e.throwDebug(j)}CAWPNProgress.done()},orgChartPieCharts:function(j){var l=0;var k;k='<div id="cawp-orgchartpiecharts'+b+'">';k+='<div id="cawp-orgchart'+b+'"></div>';k+='<div class="cawp-floatwraper">';k+='<div id="cawp-piechart-1'+b+'" class="halfsize floatleft"></div>';k+='<div id="cawp-piechart-2'+b+'" class="halfsize floatright"></div>';k+="</div>";k+='<div class="cawp-floatwraper">';k+='<div id="cawp-piechart-3'+b+'" class="halfsize floatleft"></div>';k+='<div id="cawp-piechart-4'+b+'" class="halfsize floatright"></div>';k+="</div>";k+="</div>";if(!jQuery("#cawp-orgchartpiecharts"+b).length){jQuery("#cawp-reports"+b).html(k)}e.orgChartPieChartsData=j;if(Array.isArray(j)){if(!d.isNumeric(j[0])){if(Array.isArray(j[0])){e.drawOrgChart(j[0])}else{e.throwDebug(j[0])}}else{e.throwError("#cawp-orgchart"+b,j[0],"125px")}for(l=1;l<j.length;l++){if(!d.isNumeric(j[l])){if(Array.isArray(j[l])){e.drawPieChart("piechart-"+l,j[l],e.i18n[l])}else{e.throwDebug(j[l])}}else{e.throwError("#cawp-piechart-"+l+b,j[l],"80px")}}}else{e.throwDebug(j)}CAWPNProgress.done()},geoChartTableChart:function(j){var k;k='<div id="cawp-geocharttablechart'+b+'">';k+='<div id="cawp-geochart'+b+'"></div>';k+='<div id="cawp-dashboard'+b+'">';k+='<div id="cawp-control'+b+'"></div>';k+='<div id="cawp-tablechart'+b+'"></div>';k+="</div>";k+="</div>";if(!jQuery("#cawp-geocharttablechart"+b).length){jQuery("#cawp-reports"+b).html(k)}e.geoChartTableChartData=j;if(Array.isArray(j)){if(!d.isNumeric(j[0])){if(Array.isArray(j[0])){e.drawGeoChart(j[0]);e.drawTableChart(j[0])}else{e.throwDebug(j[0])}}else{e.throwError("#cawp-geochart"+b,j[0],"125px");e.throwError("#cawp-tablechart"+b,j[0],"125px")}}else{e.throwDebug(j)}CAWPNProgress.done()},orgChartTableChart:function(j){var k;k='<div id="cawp-orgcharttablechart'+b+'">';k+='<div id="cawp-orgchart'+b+'"></div>';k+='<div id="cawp-dashboard'+b+'">';k+='<div id="cawp-control'+b+'"></div>';k+='<div id="cawp-tablechart'+b+'"></div>';k+="</div>";k+="</div>";if(!jQuery("#cawp-orgcharttablechart"+b).length){jQuery("#cawp-reports"+b).html(k)}e.orgChartTableChartData=j;if(Array.isArray(j)){if(!d.isNumeric(j[0])){if(Array.isArray(j[0])){e.drawOrgChart(j[0])}else{e.throwDebug(j[0])}}else{e.throwError("#cawp-orgchart"+b,j[0],"125px")}if(!d.isNumeric(j[1])){if(Array.isArray(j[1])){e.drawTableChart(j[1])}else{e.throwDebug(j[1])}}else{e.throwError("#cawp-tablechart"+b,j[1],"125px")}}else{e.throwDebug(j)}CAWPNProgress.done()},tableChart:function(j){var k;k='<div id="cawp-404tablechart'+b+'">';k+='<div id="cawp-tablechart'+b+'"></div>';k+="</div>";if(!jQuery("#cawp-404tablechart"+b).length){jQuery("#cawp-reports"+b).html(k)}e.tableChartData=j;if(Array.isArray(j)){if(!d.isNumeric(j[0])){if(Array.isArray(j[0])){e.drawTableChart(j[0])}else{e.throwDebug(j[0])}}else{e.throwError("#cawp-tablechart"+b,j[0],"125px")}}else{e.throwDebug(j)}CAWPNProgress.done()},drawTableChart:function(o){var n,k,m,l,j,p,q;l=false;n=google.visualization.arrayToDataTable(o);k={page:"enable",pageSize:10,width:"100%",allowHtml:true,sortColumn:1,sortAscending:l};j=new google.visualization.Dashboard(document.getElementById("cawp-dashboard"+b));p=new google.visualization.ControlWrapper({controlType:"StringFilter",containerId:"cawp-control"+b,options:{filterColumnIndex:0,matchType:"any",ui:{label:"",cssClass:"cawp-dashboard-control"}}});google.visualization.events.addListener(p,"ready",function(){jQuery(".cawp-dashboard-control input").prop("placeholder",cawpItemData.i18n[1])});q=new google.visualization.ChartWrapper({chartType:"Table",containerId:"cawp-tablechart"+b,options:k});j.bind(p,q);j.draw(n);google.visualization.events.addListener(q,"select",function(){console.log(q.getDataTable().getValue(q.getChart().getSelection()[0].row,0))})},drawOrgChart:function(m){var l,j,k;l=google.visualization.arrayToDataTable(m);j={allowCollapse:true,allowHtml:true,height:"100%",nodeClass:"cawp-orgchart",selectedNodeClass:"cawp-orgchart-selected"};k=new google.visualization.OrgChart(document.getElementById("cawp-orgchart"+b));k.draw(l,j)},drawPieChart:function(o,m,n){var l,j,k;l=google.visualization.arrayToDataTable(m);j={is3D:false,tooltipText:"percentage",legend:"none",chartArea:{width:"99%",height:"80%"},title:n,pieSliceText:"value",colors:cawpItemData.colorVariations};k=new google.visualization.PieChart(document.getElementById("cawp-"+o+b));k.draw(l,j)},drawGeoChart:function(m){var l,j,k;l=google.visualization.arrayToDataTable(m);j={chartArea:{width:"99%",height:"90%"},colors:[cawpItemData.colorVariations[5],cawpItemData.colorVariations[4]]};k=new google.visualization.GeoChart(document.getElementById("cawp-geochart"+b));k.draw(l,j)},drawareachart:function(n,o){var m,j,l,k;m=google.visualization.arrayToDataTable(n);if(o){k=new google.visualization.NumberFormat({suffix:"%",fractionDigits:2});k.format(m,1)}j={legend:{position:"none"},pointSize:3,colors:[cawpItemData.colorVariations[0],cawpItemData.colorVariations[4]],areaOpacity:0.7,chartArea:{width:"99%",height:"90%"},vAxis:{textPosition:"in",minValue:0,textStyle:{auraColor:"white",color:"black"}},hAxis:{textPosition:"none"},curveType:"function"};l=new google.visualization.AreaChart(document.getElementById("cawp-areachart"+b));l.draw(m,j)},drawSummary:function(j){jQuery("#cawpvisitors"+b).html(j[0]);jQuery("#cawppageviews"+b).html(j[1]);jQuery("#cawptimeaverage"+b).html(j[2]);jQuery("#cawpbouncerate"+b).html(j[3]);jQuery("#cawpservererrors"+b).html(j[5]);jQuery("#cawpnotfound"+b).html(j[4])},throwDebug:function(j){jQuery("#cawp-status"+b).css({"margin-top":"3px","padding-left":"5px",height:"auto",color:"#000","border-left":"5px solid red"});if(j=="-24"){jQuery("#cawp-status"+b).html(cawpItemData.i18n[15])}else{jQuery("#cawp-reports"+b).css({"background-color":"#F7F7F7",height:"auto","margin-top":"10px","padding-top":"50px","padding-bottom":"50px",color:"#000","text-align":"center"});jQuery("#cawp-reports"+b).html(j);jQuery("#cawp-reports"+b).show();jQuery("#cawp-status"+b).html(cawpItemData.i18n[11]);console.log("\n********************* CAWP Log ********************* \n\n"+j);a={action:"cawp_set_error",response:j,cawp_security_set_error:cawpItemData.security};jQuery.post(cawpItemData.ajaxurl,a)}},throwError:function(l,j,k){jQuery(l).css({"background-color":"#F7F7F7",height:"auto","padding-top":k,"padding-bottom":k,color:"#000","text-align":"center"});if(j==-21){jQuery(l).html('<p><span style="font-size:4em;color:#778899;margin-left:-20px;" class="dashicons dashicons-clock"></span></p><br><p style="font-size:1.1em;color:#778899;">'+cawpItemData.i18n[12]+"</p>")}else{jQuery(l).html(cawpItemData.i18n[13]+" ("+j+")")}},render:function(p,m,n){var l,q,r,k,o;jQuery("#cawp-sel-report"+b).show();jQuery("#cawp-status"+b).html("");if(m){q=m.split(" - ")[0];r=m.split(" - ")[1]}else{var j=new Date();j.setDate(j.getDate()-30);q=j.toISOString().split("T")[0];j=new Date();r=j.toISOString().split("T")[0]}d.setCookie("default_metric",n);if(m){d.setCookie("default_dimension",m)}if(typeof p!=="undefined"){d.setCookie("default_view",p);l=p}else{l=false}if(cawpItemData.scope=="admin-item"){a={action:"cawp_backend_item_reports",cawp_security_backend_item_reports:cawpItemData.security,from:q,to:r,filter:g}}else{if(cawpItemData.scope=="front-item"){a={action:"cawp_frontend_item_reports",cawp_security_frontend_item_reports:cawpItemData.security,from:q,to:r,filter:cawpItemData.filter}}else{a={action:"cawp_backend_item_reports",cawp_security_backend_item_reports:cawpItemData.security,projectId:l,from:q,to:r}}}if(jQuery.inArray(n,["pages","referrers"])>-1){jQuery("#cawp-sel-metric"+b).show();a.query="channelGrouping,"+n;a.metric=c;jQuery.post(cawpItemData.ajaxurl,a,function(s){e.orgChartTableChart(s)})}else{if(n=="404errors"){jQuery("#cawp-sel-metric"+b).show();a.query=n;a.metric=c;jQuery.post(cawpItemData.ajaxurl,a,function(s){e.tableChart(s)})}else{if(n=="siteperformance"||n=="technologydetails"){jQuery("#cawp-sel-metric"+b).show();if(n=="siteperformance"){a.query="channelGrouping,medium,visitorType,source,socialNetwork";e.i18n=cawpItemData.i18n.slice(0,5)}else{e.i18n=cawpItemData.i18n.slice(15,20);a.query="deviceCategory,browser,operatingSystem,screenResolution,mobileDeviceBranding"}a.metric=c;jQuery.post(cawpItemData.ajaxurl,a,function(s){e.orgChartPieCharts(s)})}else{if(n=="locations"){jQuery("#cawp-sel-metric"+b).show();a.query=n;a.metric=c;jQuery.post(cawpItemData.ajaxurl,a,function(s){e.geoChartTableChart(s)})}else{a.query=n+",summary";jQuery.post(cawpItemData.ajaxurl,a,function(s){e.areachartSummary(s)})}}}}},refresh:function(){if(jQuery("#cawp-areachartsummary"+b).length>0&&Array.isArray(e.areachartSummaryData)){e.areachartSummary(e.areachartSummaryData)}if(jQuery("#cawp-orgchartpiecharts"+b).length>0&&Array.isArray(e.orgChartPieChartsData)){e.orgChartPieCharts(e.orgChartPieChartsData)}if(jQuery("#cawp-geocharttablechart"+b).length>0&&Array.isArray(e.geoChartTableChartData)){e.geoChartTableChart(e.geoChartTableChartData)}if(jQuery("#cawp-orgcharttablechart"+b).length>0&&Array.isArray(e.orgChartTableChartData)){e.orgChartTableChart(e.orgChartTableChartData)}if(jQuery("#cawp-404tablechart"+b).length>0&&Array.isArray(e.tableChartData)){e.tableChart(e.tableChartData)}},init:function(){if(!e.inProgress){e.inProgress=1;try{CAWPNProgress.configure({parent:"#cawp-progressbar"+b,showSpinner:false});CAWPNProgress.start()}catch(j){e.alertMessage(cawpItemData.i18n[0])}e.render(jQuery("#cawp-sel-property"+b).val(),jQuery('input[name="cawp-sel-period'+b+'"]').val(),jQuery("#cawp-sel-report"+b).val());jQuery(window).on("resize",function(){var k=jQuery(window).width()-e.oldViewPort;if((k<-5)||(k>5)){e.oldViewPort=jQuery(window).width();e.refresh()}});e.inProgress=0}}};h.init();e.init();setTimeout(function(){jQuery("#cawp-sel-property"+b).on("change",function(){e.init()});jQuery('input[name="cawp-sel-period'+b+'"]').on("change",function(){e.init()});jQuery("#cawp-sel-report"+b).on("change",function(){e.init()})},1000);jQuery(function(){jQuery('input[name="cawp-sel-period'+b+'"]').daterangepicker({ranges:{Today:[moment().subtract(0,"days"),moment()],Yesterday:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Last 7 Days":[moment().subtract(6,"days"),moment()],"Last 30 Days":[moment().subtract(29,"days"),moment()],"Last 90 Days":[moment().subtract(89,"days"),moment()],"This Month":[moment().startOf("month"),moment().endOf("month")],"Last Month":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]},minDate:moment().subtract(16,"months"),maxDate:moment(),autoUpdateInput:true,locale:{format:"YYYY-MM-DD"}},function(l,j,k){d.setCookie("default_interval",k)})});jQuery("[id^=cawp-swmetric-]").on("click",function(){c=this.id.replace("cawp-swmetric-","");d.setCookie("default_swmetric",c);jQuery("#"+this.id).css("color","#008ec2");e.init()});if(cawpItemData.scope=="admin-widgets"){return}else{return this.dialog({width:"auto",maxWidth:510,height:"auto",modal:true,fluid:true,dialogClass:"cawp wp-dialog",resizable:false,title:e.getTitle(cawpItemData.scope),position:{my:"top",at:"top+100",of:window}})}}});function CAWPReportLoad(){if(cawpItemData.scope=="admin-widgets"){jQuery("#cawp-window-1").cawpItemReport(1)}else{if(cawpItemData.scope=="front-item"){jQuery(cawpItemData.getSelector(cawpItemData.scope)).on("click",function(){if(!jQuery("#cawp-window-1").length>0){jQuery("body").append('<div id="cawp-window-1"></div>')}jQuery("#cawp-window-1").cawpItemReport(1)})}else{jQuery(cawpItemData.getSelector(cawpItemData.scope)).on("click",function(){if(!jQuery("#cawp-window-"+cawpItemData.getID(this)).length>0){jQuery("body").append('<div id="cawp-window-'+cawpItemData.getID(this)+'"></div>')}jQuery("#cawp-window-"+cawpItemData.getID(this)).cawpItemReport(cawpItemData.getID(this))})}}jQuery(window).on("resize",function(){cawpItemData.responsiveDialog()});jQuery(document).on("dialogopen",".ui-dialog",function(a,b){cawpItemData.responsiveDialog()})};
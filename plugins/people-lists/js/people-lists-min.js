function save_field_info(){jQuery("#ajax-response2").show();field_info=jQuery("#profile-field-form").serialize();var data={action:'people_settings_save',field_info:field_info};jQuery.post(ajaxurl,data,function(response){jQuery("#ajax-response2").hide();jQuery("#add-field-button").removeAttr("disabled");});}
function make_field_slug(fieldName){fieldName=fieldName.toLowerCase();var accents={a:/\u00e1/g,e:/u00e9/g,i:/\u00ed/g,o:/\u00f3/g,u:/\u00fa/g,n:/\u00f1/g}
for(var i in accents)fieldName=fieldName.replace(accents[i],i);var fieldName_hyphens=fieldName.replace(/\s/g,'_');var finishedslug=fieldName_hyphens.replace(/[^a-zA-Z0-9\-]/g,'_');finishedslug=finishedslug.toLowerCase();return"people_lists_"+finishedslug;}
jQuery(function($){$("ul.droptrue").sortable({connectWith:'ul',placeholder:'ui-state-highlight'});$('#submit-people-list').live("click",function(){if(!$('#submit-people-list').attr("disabled")){var groupList=$("#sortable2").sortable("serialize",{attribute:"id"});var list_title=$("#list-title").val();var avatar_size=$("#avatar_size").val();var list_id=$("#list-id").val();var template_text=$("#template-text").val();var data={action:'people_list_save',list:groupList,title:list_title,template:template_text,avatar_size:avatar_size,id:list_id};if($('#list-title').val()!='')
{$(this).attr("disabled",true);$("#ajax-response").show();$.post(ajaxurl,data,function(response){if($.trim(response)=="new")
{window.location="options-general.php?page=people_lists&panel=manage";}
if($('#template-text').val()=='')
$('#template-text').val($('#default-template').html());$("#ajax-response").hide();if($.trim(response)!="new")
$("#submit-people-list").removeAttr("disabled");});}else{alert('Please enter a list name.');}}
return false;});$("#sortable-profile-field").sortable({connectWith:'ul',placeholder:'ui-state-highlight',update:function(event,ui){save_field_info()}});$('#add-field-button').live("click",function(){if(!$('#add-field-button').attr("disabled")){if($.trim($('#contact-info-field').val())!=''){$(this).attr("disabled",true);$("#ajax-response2").show();var userInput=$.trim($('#contact-info-field').val());$('#contact-info-field').val(' ');var madeSlug=make_field_slug(userInput);var fieldSlug=madeSlug;var flag=true;var counter=1;var inputValues=$("#sortable-profile-field input");while(flag){flag=false;inputValues.each(function(){if($(this).val()==madeSlug){flag=true;madeSlug=make_field_slug(userInput)+"_"+counter;counter++;}
else{fieldSlug=madeSlug;}});}
html='<li class="ui-state-default" >'+userInput+'<span>Template Code: %'+fieldSlug+'%</span>'+'<span><a href="#" class="delete-field-link">Delete</a></span>';html+='<input type="hidden" value="'+fieldSlug+'" name="field_slug_list[]" />';html+='<input type="hidden" value="'+userInput+'" name="field_name_list[]" /></li>';$("#sortable-profile-field").append(html);save_field_info();}else{alert('Please enter a field name.');}}});$(".delete-field-link").live("click",function(){if(confirm("Are you sure you want to delete this field?")){$(this).parent().parent().remove();save_field_info();}});$("#selected-lock").toggle(function(){$(this).html("Unpin");$("#selectedUserList").addClass("fixed");return false;},function(){$(this).html("Pin");$("#selectedUserList").removeClass("fixed");return false;});$(".delete-list").click(function(){return confirm("Are you sure you want to delete the list?");});$(".template-area").tabs();$('#template-link').click(function(){if($('#template-text').val()=='')
$('#template-text').val($('#default-template').html());$(this).siblings(".template-info").slideToggle();return false;});});
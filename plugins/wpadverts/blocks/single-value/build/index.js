(()=>{"use strict";window.wp.i18n;const e=window.wp.blocks;function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function a(e,a,l){return o=function(e,a){if("object"!=t(e)||!e)return e;var l=e[Symbol.toPrimitive];if(void 0!==l){var o=l.call(e,"string");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(a),(a="symbol"==t(o)?o:String(o))in e?Object.defineProperty(e,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[a]=l,e;var o}const l=window.React,o=window.wp.element,n=window.wp.blockEditor,s=window.wp.components,i=window.wp.primitives,r=(0,l.createElement)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,l.createElement)(i.Path,{fillRule:"evenodd",d:"M6.863 13.644L5 13.25h-.5a.5.5 0 01-.5-.5v-3a.5.5 0 01.5-.5H5L18 6.5h2V16h-2l-3.854-.815.026.008a3.75 3.75 0 01-7.31-1.549zm1.477.313a2.251 2.251 0 004.356.921l-4.356-.921zm-2.84-3.28L18.157 8h.343v6.5h-.343L5.5 11.823v-1.146z",clipRule:"evenodd"}));window.wp.serverSideRender,o.Component,window.wp.compose;class p extends o.Component{constructor(e){super(e),a(this,"onChange",(e=>{"-1"!=e.target.value&&(this.addOption(e.target.value),this.props.onChange(this.data.options),e.target.value="-1")})),a(this,"onChangeSingle",(e=>{"-1"!=e.target.value?(this.data.options=[e.target.value],this.props.onChange(this.data.options)):this.data.options=[]})),a(this,"maybeSelected",(e=>"multi"!==this.props.mode&&!!this.data.options.includes(e)&&"selected")),a(this,"onCustomizeQuery",(e=>{})),a(this,"onMove",((e,t)=>{this.data.options=this.arrayMove(this.data.options,e,t),this.props.onChange(this.data.options)})),a(this,"onTrashClick",(e=>{this.data.options.splice(e,1),this.props.onChange(this.data.options)})),a(this,"getOptionLabel",(e=>{for(var t=0;t<this.props.data.builtin.data.length;t++)if(this.props.data.builtin.data[t].name===e)return this.props.data.builtin.data[t].label;for(t=0;t<this.props.data.meta.data.length;t++)if(this.props.data.meta.data[t].name===e)return this.props.data.meta.data[t].label;for(var a=0;a<this.props.data.length;a++)for(t=0;t<this.props.data[a].data.length;t++)if(this.props.data[a].data[t].name===e)return this.props.data[a].data[t].label;return e})),this.data={text:this.props.placeholder,options:[],...e.data},this.data.options=[...this.props.value],this.state={mode:"normal"},void 0===this.props.mode&&(this.props.mode="multi")}shouldComponentUpdate(e){return!0}addOption(e){this.data.options.push({name:e})}arrayMove(e,t,a){if(a>=e.length)for(var l=a-e.length+1;l--;)e.push(void 0);return e.splice(a,0,e.splice(t,1)[0]),e}render(){const{options:e}=this.data;if("multi"===this.props.mode)var t=this.onChange,a="multi";else t=this.onChangeSingle,a="single";if(void 0===this.props.label)var o="List Data";else o=this.props.label;if(void 0===this.props.placeholder)var n="";else n=this.props.placeholder;return(0,l.createElement)(l.Fragment,null,(0,l.createElement)(s.BaseControl,{label:o,labelPosition:"top"},(0,l.createElement)("select",{style:{width:"100%"},className:"components-select-control__input",onChange:t},(0,l.createElement)("option",{key:"-1",value:"-1"}),(0,l.createElement)("optgroup",{label:this.props.data.builtin.label},this.props.data.builtin.data.map(((e,t)=>(0,l.createElement)("option",{key:t,value:e.name,selected:this.maybeSelected(e.name)},e.label)))),this.props.data.meta.data.length>0&&(0,l.createElement)("optgroup",{label:this.props.data.meta.label},this.props.data.meta.data.map(((e,t)=>(0,l.createElement)("option",{key:t,value:e.name},e.label)))),this.props.data.taxonomies.data.length>0&&(0,l.createElement)("optgroup",{label:this.props.data.taxonomies.label},this.props.data.taxonomies.data.map(((e,t)=>(0,l.createElement)("option",{key:t,value:e.name},e.label))))),"multi"==a&&e.length>0&&(0,l.createElement)(l.Fragment,null,e.map(((t,a)=>(0,l.createElement)(s.Flex,{key:a},(0,l.createElement)(s.FlexBlock,{title:this.getOptionLabel(t.name),style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}},this.getOptionLabel(t.name)),(0,l.createElement)(s.FlexItem,null,(0,l.createElement)(s.Button,{label:"",variant:"trynitary",icon:"arrow-down-alt2",value:t.name,isSmall:!0,onClick:e=>this.onMove(a,a+1,t),disabled:a+1>=e.length}),(0,l.createElement)(s.Button,{label:"",variant:"trynitary",icon:"arrow-up-alt2",isSmall:!0,onClick:e=>this.onMove(a,a-1,t),disabled:a<=0}),(0,l.createElement)(s.Button,{label:"",variant:"trynitary",icon:"trash",isSmall:!0,onClick:e=>this.onTrashClick(a)})))))),"multi"==a&&0===e.length&&n.length>0&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)("div",null,(0,l.createElement)("em",null,n)))))}}const u=p;class h extends o.Component{constructor(e){super(e),a(this,"togglePopover",(()=>{this.setState({popover:!this.state.popover})})),a(this,"setColor",(e=>{console.log(e),this.setState({color:e.hex})})),a(this,"applyColor",(()=>{this.value=this.state.color,this.setState({popover:!1,color:null}),this.props.onChange(this.value)})),a(this,"cancelColor",(()=>{this.setState({popover:!1,color:null})})),a(this,"resetColor",(()=>{this.value="",this.setState({popover:!1,color:null}),this.props.onChange(this.value)})),this.state={popover:!1,color:null},this.value=this.props.value}render(){const{value:e,label:t,labelPosition:a}=this.props;return(0,l.createElement)(l.Fragment,null,(0,l.createElement)(s.BaseControl,{label:t,labelPosition:"top"},(0,l.createElement)("div",{className:"wpa-color-indicator-wrap"},(0,l.createElement)("span",{className:"wpa-color-indicator",style:{background:this.value}}),(0,l.createElement)(s.Button,{variant:"secondary",isSmall:"true",onClick:this.togglePopover},"Select Color"),(0,l.createElement)(s.Button,{variant:"link",onClick:this.resetColor},"Reset")),!0===this.state.popover&&(0,l.createElement)(s.Popover,null,(0,l.createElement)(s.ColorPicker,{style:{padding:"5px"},color:this.value,onChangeComplete:this.setColor,enableAlpha:!0,defaultValue:"#000"}),(0,l.createElement)("div",{style:{padding:"0px 16px 12px 16px"}},(0,l.createElement)(s.Button,{onClick:this.applyColor,variant:"primary"},"Apply"),"Â ",(0,l.createElement)(s.Button,{onClick:this.cancelColor,variant:"secondary"},"Cancel")))))}}const m=h;class c extends o.Component{render(){return(0,l.createElement)(l.Fragment,null,(0,l.createElement)("div",{class:"atw-flex atw-px-2 atw-py-4 atw-mb-4 atw-bg-gray-100 atw-rounded-lg"},(0,l.createElement)("span",{class:"fas fa-circle-info atw-mr-2 atw-py-2"}),(0,l.createElement)("div",null,(0,l.createElement)("span",{class:"atw-inline-block atw-pb-2 atw-mx-0"},"In this ection you can enter here data that will be used in the preview,"),(0,l.createElement)("span",{class:"atw-inline-block atw-pt-2 atw-mx-0"},"This will allow you to get a better idea of how the page will look like in the frontend."))))}}const d=c;class b extends o.Component{constructor(e){super(e),a(this,"onChangeColor",(e=>{this.props.setAttributes({color:e})})),a(this,"onFormStyleChange",(e=>{this.props.setAttributes({form_style:e})})),a(this,"onSelectPostType",(e=>{this.props.setAttributes({post_type:e,form_scheme:""})})),a(this,"onSelectFormScheme",(e=>{this.props.setAttributes({form_scheme:e})})),a(this,"onCustomizeQuery",((e,t)=>{var a={...this.props.attributes.query};0===t.length?delete a[e]:a[e]=t,this.props.setAttributes({query:a})})),a(this,"getQueryParam",(e=>void 0===this.props.attributes.query[e]?"":this.props.attributes.query[e])),a(this,"getAvailablePostTypes",(()=>{var e=[{label:"",value:""}];return this.state.post_types.forEach((function(t,a){e.push({label:t.label,value:t.post_type})})),e})),a(this,"getCurrentPostType",(()=>this.state.post_types[0])),a(this,"getSelectedFormScheme",(e=>{if(""===this.props.attributes.form_scheme)return null;for(var t=this.getCurrentPostType(),a=0;a<t.form_schemes[e].length;a++)if(t.form_schemes[e][a].name===this.props.attributes.form_scheme)return t.form_schemes[e][a];return null})),a(this,"getSelectedFormSchemeData",(e=>{var t=this.getSelectedFormScheme(e);return null===t?[]:t.data})),a(this,"getAvailableSearchForms",(e=>{var t=this.getCurrentPostType();return[{label:"",value:""}].concat(t.form_schemes.search)})),a(this,"getCurrentPostType",(()=>this.state.post_types[0])),a(this,"getSelectedFormScheme",(e=>{if(""===this.props.attributes.form_scheme)return null;for(var t=this.getCurrentPostType(),a=0;a<t.form_schemes[e].length;a++)if(t.form_schemes[e][a].name===this.props.attributes.form_scheme)return t.form_schemes[e][a];return null})),a(this,"getSelectedFormSchemeData",(e=>{for(var t=this.getCurrentPostType(),a=[],l=0;l<t.form_schemes[e].length;l++)Object.entries(t.form_schemes[e][l].data).map((([e,t])=>{a.push(t)})),(a=this.getUnique(a,"name")).sort(((e,t)=>e.label>t.label?1:-1));return a})),a(this,"getUnique",((e,t)=>{if("function"!=typeof t){const e=t;t=function(t){return t[e]}}return Array.from(e.reduce((function(e,a){const l=t(a);return e.has(l)||e.set(l,a),e}),new Map).values())})),a(this,"getAvailableSearchForms",(e=>{var t=this.getCurrentPostType();return[{label:"",value:""}].concat(t.form_schemes.search)})),a(this,"getAdvertsListData",(()=>{for(var e=this.getCurrentPostType(),t={builtin:{label:"Builtin",data:e.form_schemes_default.publish},meta:{label:"Custom Fields",data:this.getSelectedFormSchemeData("publish")},taxonomies:{label:"Taxonomies",data:[]}},a=0;a<e.taxonomies.length;a++)t.taxonomies.data.push({name:"taxonomy__"+e.taxonomies[a].name,label:e.taxonomies[a].label});return t})),a(this,"onListDataChange",(e=>{this.props.setAttributes({data:[...e]})})),a(this,"onChangeEmptyValue",(e=>{this.props.setAttributes({empty_value:e})})),a(this,"onChangeRenderAs",(e=>{this.props.setAttributes({render_as:e})})),a(this,"onChangeTextSize",(e=>{this.props.setAttributes({text_size:e})})),a(this,"onChangeFontWeight",(e=>{this.props.setAttributes({font_weight:e})})),a(this,"onChangeType",(e=>{this.props.setAttributes({type:e})})),a(this,"onChangeColor",(e=>{this.props.setAttributes({color:e})})),a(this,"onChangeColorBg",(e=>{this.props.setAttributes({color_bg:e})})),a(this,"onChangeMarginX",(e=>{this.props.setAttributes({margin_x:e})})),a(this,"onChangeMarginY",(e=>{this.props.setAttributes({margin_y:e})})),a(this,"onChangePaddingX",(e=>{this.props.setAttributes({padding_x:e})})),a(this,"onChangePaddingY",(e=>{this.props.setAttributes({padding_y:e})})),a(this,"onChangeBorderRadius",(e=>{this.props.setAttributes({border_radius:e})})),a(this,"onPreviewValueChange",(e=>{this.props.setAttributes({p_value:e})})),a(this,"initVisuals",(()=>{const{post_type:e}=this.props.attributes;""!==e&&this.setState({initiated:!0})})),a(this,"resetVisuals",(()=>{this.props.setAttributes({post_type:""}),this.setState({initiated:!1,loading:!0}),this.runApiFetchForms()})),this.state={initiated:!1,post_types:[],loading:!0,show_instructions:!1},this.initVisuals()}componentDidMount(){this.runApiFetchForms()}runApiFetchForms(){wp.apiFetch({path:"wpadverts/v1/classifieds-types"}).then((e=>{this.setState({post_types:e.data,loading:!1,initiated:""!==this.props.attributes.post_type})}))}getDataOptions(){var e=this.getAdvertsListData(),t=0,a=[{label:"Builtin",options:[]},{label:"Patterns",options:[]},{label:"Custom Fields",options:[]},{label:"Taxonomies",options:[]}];for(t=0;t<e.builtin.data.length;t++)a[e.builtin.data[t].name.startsWith("pattern__")?1:0].options.push({value:e.builtin.data[t].name,label:e.builtin.data[t].label});for(t=0;t<e.meta.data.length;t++)a[2].options.push({value:e.meta.data[t].name,label:e.meta.data[t].label});for(t=0;t<e.taxonomies.data.length;t++)a[3].options.push({value:e.taxonomies.data[t].name,label:e.taxonomies.data[t].label});return a}renderInit(){const{post_type:e}=this.props.attributes,{show_instructions:t}=this.state;return(0,l.createElement)(l.Fragment,null,(0,l.createElement)(s.Placeholder,{icon:r,label:"Classifieds Single Value",instructions:"Select custom post type and search form scheme to continue.",isColumnLayout:"true"},!0===this.state.loading?(0,l.createElement)(s.Spinner,null):(0,l.createElement)(l.Fragment,null,(0,l.createElement)(s.SelectControl,{label:"Custom Post Type",labelPosition:"top",value:e,options:this.getAvailablePostTypes(),onChange:this.onSelectPostType,style:{lineHeight:"1rem"}}),(0,l.createElement)("div",null,(0,l.createElement)(s.Button,{variant:"primary",disabled:""===e,onClick:this.initVisuals},"Apply")))))}render(){const{className:e,attributes:t}=this.props,{data:a,empty_value:o,render_as:i,text_size:r,font_weight:p,type:h,color:c,color_bg:b,margin_x:v,margin_y:g,padding_x:x,padding_y:w,border_radius:y,p_value:C}=t;var f={color:c,backgroundColor:b},E=[r,p,h,v,g,x,w,y].join(" ");const{show_instructions:_}=this.state;return(0,l.createElement)(l.Fragment,null,!0===this.state.initiated?(0,l.createElement)(l.Fragment,null,(0,l.createElement)(n.InspectorControls,null,(0,l.createElement)(s.PanelBody,{title:"Display Options"},(0,l.createElement)(u,{label:"Property",data:this.getAdvertsListData(),onChange:this.onListDataChange,value:a,mode:"single"}),(0,l.createElement)(s.TextControl,{label:"Empty Value",value:o,onChange:this.onChangeEmptyValue,type:"text"}),(0,l.createElement)(s.SelectControl,{label:"Render As",labelPosition:"top",value:i,options:[{label:"Text",value:"text"},{label:"HTML",value:"html"}],onChange:this.onChangeRenderAs})),"html"===i&&(0,l.createElement)(s.PanelBody,{title:"Formatting"},(0,l.createElement)(s.SelectControl,{label:"Text Size",labelPosition:"top",value:r,options:[{label:"Extra Small",value:"atw-text-xs"},{label:"Small",value:"atw-text-sm"},{label:"Normal",value:"atw-text-base"},{label:"Large",value:"atw-text-lg"},{label:"Extra Large",value:"atw-text-xl"},{label:"Extra Large x2",value:"atw-text-2xl"},{label:"Extra Large x3",value:"atw-text-3xl"},{label:"Extra Large x4",value:"atw-text-4xl"},{label:"Extra Large x5",value:"atw-text-5xl"},{label:"Extra Large x6",value:"atw-text-6xl"},{label:"Extra Large x7",value:"atw-text-7xl"},{label:"Extra Large x8",value:"atw-text-8xl"},{label:"Extra Large x9",value:"atw-text-9xl"}],onChange:this.onChangeTextSize}),(0,l.createElement)(s.SelectControl,{label:"Font Weight",labelPosition:"top",value:p,options:[{label:"Thin",value:"atw-font-thin"},{label:"Normal",value:"atw-font-normal"},{label:"Semi-Bold",value:"atw-font-semibold"},{label:"Bold",value:"atw-font-bold"}],onChange:this.onChangeFontWeight}),(0,l.createElement)(s.SelectControl,{label:"Type",labelPosition:"top",value:h,options:[{label:"Inline",value:"atw-inline"},{label:"Inline Block",value:"atw-inline-block"},{label:"Block",value:"atw-block"}],onChange:this.onChangeType}),(0,l.createElement)(m,{label:"Text Color",labelPosition:"top",value:c,onChange:this.onChangeColor}),(0,l.createElement)(m,{label:"Background Color",labelPosition:"top",value:b,onChange:this.onChangeColorBg}),(0,l.createElement)(s.SelectControl,{label:"Border Radius",labelPosition:"top",value:y,options:[{label:"None",value:"atw-rounded-none"},{label:"Extra Small",value:"atw-rounded-sm"},{label:"Small",value:"atw-rounded"},{label:"Medium",value:"atw-rounded-md"},{label:"Large",value:"atw-rounded-lg"},{label:"Extra Large",value:"atw-rounded-xl"},{label:"Full",value:"atw-rounded-full"}],onChange:this.onChangeBorderRadius}),(0,l.createElement)("div",{style:{display:"flex"}},(0,l.createElement)(s.SelectControl,{label:"Margin (width)",labelPosition:"top",value:v,options:[{label:"None",value:""},{label:"~2px",value:"atw-mx-0.5"},{label:"~4px",value:"atw-mx-1"},{label:"~6px",value:"atw-mx-1.5"},{label:"~8px",value:"atw-mx-2"},{label:"~10px",value:"atw-mx-2.5"},{label:"~12px",value:"atw-mx-3"},{label:"~14px",value:"atw-mx-3.5"},{label:"~16px",value:"atw-mx-4"},{label:"~18px",value:"atw-mx-4.5"},{label:"~20px",value:"atw-mx-5"},{label:"~24px",value:"atw-mx-6"},{label:"~28px",value:"atw-mx-7"},{label:"~32px",value:"atw-mx-8"},{label:"~36px",value:"atw-mx-9"},{label:"~40px",value:"atw-mx-10"}],onChange:this.onChangeMarginX}),(0,l.createElement)("span",null," "),(0,l.createElement)(s.SelectControl,{label:"Margin (height)",labelPosition:"top",value:g,options:[{label:"None",value:""},{label:"~2px",value:"atw-my-0.5"},{label:"~4px",value:"atw-my-1"},{label:"~6px",value:"atw-my-1.5"},{label:"~8px",value:"atw-my-2"},{label:"~10px",value:"atw-my-2.5"},{label:"~12px",value:"atw-my-3"},{label:"~14px",value:"atw-my-3.5"},{label:"~16px",value:"atw-my-4"},{label:"~18px",value:"atw-my-4.5"},{label:"~20px",value:"atw-my-5"},{label:"~24px",value:"atw-my-6"},{label:"~28px",value:"atw-my-7"},{label:"~32px",value:"atw-my-8"},{label:"~36px",value:"atw-my-9"},{label:"~40px",value:"atw-my-10"}],onChange:this.onChangeMarginY})),(0,l.createElement)("div",{style:{display:"flex"}},(0,l.createElement)(s.SelectControl,{label:"Padding (width)",labelPosition:"top",value:x,options:[{label:"None",value:""},{label:"~2px",value:"atw-px-0.5"},{label:"~4px",value:"atw-px-1"},{label:"~6px",value:"atw-px-1.5"},{label:"~8px",value:"atw-px-2"},{label:"~10px",value:"atw-px-2.5"},{label:"~12px",value:"atw-px-3"},{label:"~14px",value:"atw-px-3.5"},{label:"~16px",value:"atw-px-4"},{label:"~18px",value:"atw-px-4.5"},{label:"~20px",value:"atw-px-5"},{label:"~24px",value:"atw-px-6"},{label:"~28px",value:"atw-px-7"},{label:"~32px",value:"atw-px-8"},{label:"~36px",value:"atw-px-9"},{label:"~40px",value:"atw-px-10"}],onChange:this.onChangePaddingX}),(0,l.createElement)("span",null," "),(0,l.createElement)(s.SelectControl,{label:"Padding (height)",labelPosition:"top",value:w,options:[{label:"None",value:""},{label:"~2px",value:"atw-py-0.5"},{label:"~4px",value:"atw-py-1"},{label:"~6px",value:"atw-py-1.5"},{label:"~8px",value:"atw-py-2"},{label:"~10px",value:"atw-py-2.5"},{label:"~12px",value:"atw-py-3"},{label:"~14px",value:"atw-py-3.5"},{label:"~16px",value:"atw-py-4"},{label:"~18px",value:"atw-py-4.5"},{label:"~20px",value:"atw-py-5"},{label:"~24px",value:"atw-py-6"},{label:"~28px",value:"atw-py-7"},{label:"~32px",value:"atw-py-8"},{label:"~36px",value:"atw-py-9"},{label:"~40px",value:"atw-py-10"}],onChange:this.onChangePaddingY}))),(0,l.createElement)(s.PanelBody,{title:"Preview"},(0,l.createElement)(d,null),(0,l.createElement)(s.TextControl,{label:"Preview Value",value:C,onChange:this.onPreviewValueChange,type:"text"}))),(0,l.createElement)(n.BlockControls,null,(0,l.createElement)(s.Toolbar,{controls:[{icon:"controls-repeat",title:"Reset post type and form scheme",onClick:this.resetVisuals}]})),(0,l.createElement)(s.Disabled,null,(0,l.createElement)("div",{className:"-wpa-block-editor-common-tip"},"html"===i&&(0,l.createElement)("span",{class:E,style:f},(0,l.createElement)("span",null,C)),"text"===i&&(0,l.createElement)("span",null,C)))):(0,l.createElement)(l.Fragment,null,this.renderInit()))}}const v=b,g=JSON.parse('{"name":"wpadverts/single-value","textdomain":"wpadverts","apiVersion":1,"title":"Classifieds Single Value","icon":"megaphone","category":"wpadverts","example":{},"attributes":{"post_type":{"type":"string","default":""},"data":{"type":"array","default":[]},"empty_value":{"type":"string","default":""},"render_as":{"type":"string","default":"text"},"text_size":{"type":"string","default":"atw-text-base"},"font_weight":{"type":"string","default":"atw-font-normal"},"type":{"type":"string","default":"atw-inline"},"color":{"type":"string","default":""},"color_bg":{"type":"string","default":""},"margin_x":{"type":"string","default":""},"margin_y":{"type":"string","default":""},"padding_x":{"type":"string","default":""},"padding_y":{"type":"string","default":""},"border_radius":{"type":"string","default":""},"p_value":{"type":"string","default":"text ..."}}}');(0,e.registerBlockType)(g,{edit:v,save:({attributes:e})=>null})})();